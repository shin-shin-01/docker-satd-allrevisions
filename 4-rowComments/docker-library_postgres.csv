,CommitID,Dockerfile,Comment
0,442a92590b7f22d3ab6b2ebdbf0217c1554541c5,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1,442a92590b7f22d3ab6b2ebdbf0217c1554541c5,/9.5/alpine/Dockerfile,"# explicitly set user/group IDs
#RUN adduser -S -G postgres -u 999 postgres

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2,442a92590b7f22d3ab6b2ebdbf0217c1554541c5,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
7,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
8,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
9,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
12,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
16,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
18,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
19,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
20,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
21,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
22,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
23,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
24,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
25,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile," # backwards compat
"
26,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# vim:set ft=dockerfile:
"
27,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# explicitly set user/group IDs
"
28,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
29,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
30,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# grab gosu for easy step-down from root
"
31,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
32,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
33,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
34,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
35,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
36,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# arches officialy built by upstream
"
37,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
38,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
39,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
40,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
41,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
42,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
43,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
44,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
45,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
46,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
47,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
48,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
49,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
50,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile," # backwards compat
"
51,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
52,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
53,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
54,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
55,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
56,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
57,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
58,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
59,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
60,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
61,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
62,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
63,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
64,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
65,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
66,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
67,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
68,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
69,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
70,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
71,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile," # backwards compat
"
72,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
73,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
74,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
75,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
76,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
77,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
78,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
79,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
80,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
81,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
82,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
83,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
84,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
85,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
86,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
87,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
88,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
89,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
90,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
91,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.2/alpine/Dockerfile," # backwards compat
"
92,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
93,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
94,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
95,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
96,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
97,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
98,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
99,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
100,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
101,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
102,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
103,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
104,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
105,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
106,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
107,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
108,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
109,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
110,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
111,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
112,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
113,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
114,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile," # backwards compat
"
115,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
116,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
117,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
118,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
119,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
120,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
121,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
122,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
123,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
124,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
125,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
126,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
127,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
128,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
129,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
130,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
131,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
132,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
133,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
134,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
135,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.6/alpine/Dockerfile," # backwards compat
"
136,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
137,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"# explicitly set user/group IDs
"
138,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
139,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
140,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
141,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
142,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
143,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
144,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
145,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"# see note below about ""*.pyc"" files
"
146,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"# arches officialy built by upstream
"
147,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
148,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
149,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
150,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
151,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
152,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
153,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
154,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
155,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
156,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
157,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
158,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
159,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
160,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.3/Dockerfile," # backwards compat
"
161,972294a377463156c8d61297320c872fc7d370a9,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
162,972294a377463156c8d61297320c872fc7d370a9,/9.6/Dockerfile,"# explicitly set user/group IDs
"
163,972294a377463156c8d61297320c872fc7d370a9,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
164,972294a377463156c8d61297320c872fc7d370a9,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
165,972294a377463156c8d61297320c872fc7d370a9,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
166,972294a377463156c8d61297320c872fc7d370a9,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
167,972294a377463156c8d61297320c872fc7d370a9,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
168,972294a377463156c8d61297320c872fc7d370a9,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
169,972294a377463156c8d61297320c872fc7d370a9,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
170,972294a377463156c8d61297320c872fc7d370a9,/9.6/Dockerfile," # backwards compat
"
171,40cfe262061b4da708f1d5e9f5b7c69b5568d0e2,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
172,40cfe262061b4da708f1d5e9f5b7c69b5568d0e2,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
173,40cfe262061b4da708f1d5e9f5b7c69b5568d0e2,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
174,40cfe262061b4da708f1d5e9f5b7c69b5568d0e2,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
175,40cfe262061b4da708f1d5e9f5b7c69b5568d0e2,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
176,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
177,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# explicitly set user/group IDs
"
178,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
179,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
180,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
181,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# arches officialy built by upstream
"
182,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
183,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
184,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
185,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
186,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
187,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
188,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
189,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
190,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
191,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
192,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
193,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile," # backwards compat
"
194,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# vim:set ft=dockerfile:
"
195,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# explicitly set user/group IDs
"
196,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
197,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
198,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# grab gosu for easy step-down from root
"
199,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
200,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
201,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
202,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
203,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
204,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# arches officialy built by upstream
"
205,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
206,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
207,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
208,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
209,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
210,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
211,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
212,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
213,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
214,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
215,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
216,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
217,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
218,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile," # backwards compat
"
219,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
220,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# explicitly set user/group IDs
"
221,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
222,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
223,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
224,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# arches officialy built by upstream
"
225,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
226,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
227,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
228,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
229,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
230,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
231,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
232,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
233,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
234,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
235,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
236,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile," # backwards compat
"
237,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
238,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.5/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
239,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
240,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
241,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
242,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
243,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# explicitly set user/group IDs
"
244,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
245,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
246,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
247,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
248,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
249,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
250,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
251,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
252,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# arches officialy built by upstream
"
253,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
254,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
255,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
256,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
257,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
258,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
259,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
260,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
261,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
262,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
263,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
264,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
265,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
266,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/Dockerfile," # backwards compat
"
267,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
268,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
269,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
270,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"#		krb5-dev \
"
271,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"#		openldap-dev \
"
272,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# configure: error: prove not found
"
273,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
274,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
275,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
276,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
277,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
278,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
279,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
280,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
281,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
282,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
283,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
284,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
285,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
286,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
287,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile," # backwards compat
"
288,6750eda25a2f0856b3997309ef393475f008d6a3,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
289,6750eda25a2f0856b3997309ef393475f008d6a3,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
290,6750eda25a2f0856b3997309ef393475f008d6a3,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
291,6750eda25a2f0856b3997309ef393475f008d6a3,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
292,6750eda25a2f0856b3997309ef393475f008d6a3,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
293,6750eda25a2f0856b3997309ef393475f008d6a3,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
294,6750eda25a2f0856b3997309ef393475f008d6a3,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
295,6750eda25a2f0856b3997309ef393475f008d6a3,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
296,6750eda25a2f0856b3997309ef393475f008d6a3,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
297,6750eda25a2f0856b3997309ef393475f008d6a3,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
298,6750eda25a2f0856b3997309ef393475f008d6a3,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
299,6750eda25a2f0856b3997309ef393475f008d6a3,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
300,6750eda25a2f0856b3997309ef393475f008d6a3,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
301,6750eda25a2f0856b3997309ef393475f008d6a3,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
302,6750eda25a2f0856b3997309ef393475f008d6a3,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
303,6750eda25a2f0856b3997309ef393475f008d6a3,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
304,6750eda25a2f0856b3997309ef393475f008d6a3,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
305,6750eda25a2f0856b3997309ef393475f008d6a3,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
306,6750eda25a2f0856b3997309ef393475f008d6a3,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
307,6750eda25a2f0856b3997309ef393475f008d6a3,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
308,6750eda25a2f0856b3997309ef393475f008d6a3,/9.4/alpine/Dockerfile," # backwards compat
"
309,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
310,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
311,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
312,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
313,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
314,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
315,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
316,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
317,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
318,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
319,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
320,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
321,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
322,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
323,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
324,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
325,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
326,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
327,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
328,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
329,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.5/alpine/Dockerfile," # backwards compat
"
330,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# vim:set ft=dockerfile:
"
331,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# explicitly set user/group IDs
"
332,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
333,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
334,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# grab gosu for easy step-down from root
"
335,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
336,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
337,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
338,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
339,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
340,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# arches officialy built by upstream
"
341,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
342,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
343,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
344,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
345,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
346,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
347,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
348,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
349,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
350,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
351,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
352,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
353,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
354,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile," # backwards compat
"
355,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
356,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
357,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
358,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
359,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
360,a00e979002aaa80840d58a5f8cc541342e06788f,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
361,a00e979002aaa80840d58a5f8cc541342e06788f,/9.6/Dockerfile,"# explicitly set user/group IDs
"
362,a00e979002aaa80840d58a5f8cc541342e06788f,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
363,a00e979002aaa80840d58a5f8cc541342e06788f,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
364,a00e979002aaa80840d58a5f8cc541342e06788f,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
365,a00e979002aaa80840d58a5f8cc541342e06788f,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
366,a00e979002aaa80840d58a5f8cc541342e06788f,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
367,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
368,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
369,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
370,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/alpine/Dockerfile,"#		krb5-dev \
"
371,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/alpine/Dockerfile,"#		openldap-dev \
"
372,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/alpine/Dockerfile,"# configure: error: prove not found
"
373,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
374,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
375,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
376,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
377,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
378,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
379,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
380,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
381,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
382,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
383,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
384,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
385,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
386,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
387,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/alpine/Dockerfile," # backwards compat
"
388,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
389,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.4/Dockerfile,"# explicitly set user/group IDs
"
390,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
391,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
392,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
393,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
394,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
395,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
396,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
397,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
398,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
399,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
400,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
401,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
402,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
403,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
404,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
405,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
406,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
407,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
408,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
409,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
410,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile," # backwards compat
"
411,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
412,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# explicitly set user/group IDs
"
413,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
414,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
415,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
416,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
417,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
418,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
419,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
420,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
421,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# arches officialy built by upstream
"
422,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
423,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
424,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
425,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
426,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
427,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
428,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
429,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
430,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
431,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
432,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
433,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
434,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
435,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile," # backwards compat
"
436,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# vim:set ft=dockerfile:
"
437,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# explicitly set user/group IDs
"
438,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
439,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
440,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# grab gosu for easy step-down from root
"
441,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
442,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
443,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
444,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
445,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
446,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# arches officialy built by upstream
"
447,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
448,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
449,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
450,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
451,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
452,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
453,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
454,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
455,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
456,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
457,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
458,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
459,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
460,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile," # backwards compat
"
461,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
462,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.3/Dockerfile,"# explicitly set user/group IDs
"
463,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
464,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
465,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
466,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
467,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
468,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
469,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.2/Dockerfile,"# explicitly set user/group IDs
"
470,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
471,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
472,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
473,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
474,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# explicitly set user/group IDs
"
475,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
476,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
477,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
478,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
479,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
480,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
481,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
482,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
483,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# arches officialy built by upstream
"
484,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
485,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
486,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
487,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
488,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
489,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
490,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
491,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
492,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
493,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
494,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
495,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
496,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
497,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile," # backwards compat
"
498,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# vim:set ft=dockerfile:
"
499,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# explicitly set user/group IDs
"
500,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
501,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
502,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
503,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
504,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
505,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
506,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
507,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
508,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# see note below about ""*.pyc"" files
"
509,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# arches officialy built by upstream
"
510,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
511,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
512,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
513,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# we need DEBIAN_FRONTEND on postgresql-13 for slapd (""Please enter the password for the admin entry in your LDAP directory.""); see https://bugs.debian.org/929417
"
514,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
515,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
516,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
517,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
518,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
519,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
520,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
521,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
522,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
523,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
524,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/Dockerfile," # backwards compat
"
525,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
526,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
527,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
528,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/alpine/Dockerfile,"#		krb5-dev \
"
529,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/alpine/Dockerfile,"#		openldap-dev \
"
530,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/alpine/Dockerfile,"# configure: error: prove not found
"
531,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
532,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
533,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
534,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
535,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
536,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
537,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
538,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
539,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
540,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/alpine/Dockerfile,"#p' --recursive /usr/local \
"
541,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
542,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
543,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
544,9c5ca99fdc9af3e2cbefbc3bfa3348fe12fe9514,/13/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
545,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
546,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
547,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
548,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
549,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
550,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
551,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
552,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
553,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
554,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
555,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
556,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
557,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
558,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
559,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
560,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
561,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
562,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
563,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
564,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
565,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile," # backwards compat
"
566,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
567,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
568,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
569,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
570,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
571,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
572,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
573,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
574,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
575,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
576,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
577,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
578,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
579,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
580,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
581,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
582,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
583,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
584,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
585,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
586,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
587,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
588,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile," # backwards compat
"
589,f59e5f0edba2e5d4d38516e5765c1aaa8932c51e,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
590,f59e5f0edba2e5d4d38516e5765c1aaa8932c51e,/9.5/Dockerfile,"# explicitly set user/group IDs
"
591,f59e5f0edba2e5d4d38516e5765c1aaa8932c51e,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
592,f59e5f0edba2e5d4d38516e5765c1aaa8932c51e,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
593,f59e5f0edba2e5d4d38516e5765c1aaa8932c51e,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
594,f59e5f0edba2e5d4d38516e5765c1aaa8932c51e,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
595,f59e5f0edba2e5d4d38516e5765c1aaa8932c51e,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
596,f59e5f0edba2e5d4d38516e5765c1aaa8932c51e,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
597,f59e5f0edba2e5d4d38516e5765c1aaa8932c51e,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
598,f59e5f0edba2e5d4d38516e5765c1aaa8932c51e,/9.5/Dockerfile," # backwards compat
"
599,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
600,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
601,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
602,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
603,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
604,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
605,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
606,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
607,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
608,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
609,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
610,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
611,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
612,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
613,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
614,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
615,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
616,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
617,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
618,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.4/alpine/Dockerfile," # backwards compat
"
619,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
620,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"# explicitly set user/group IDs
"
621,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
622,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
623,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
624,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
625,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
626,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
627,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
628,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
629,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"# arches officialy built by upstream
"
630,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
631,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
632,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
633,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
634,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
635,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
636,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
637,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
638,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
639,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
640,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
641,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
642,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
643,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.5/Dockerfile," # backwards compat
"
644,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
645,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# explicitly set user/group IDs
"
646,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
647,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
648,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
649,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
650,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# arches officialy built by upstream
"
651,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
652,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
653,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
654,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
655,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
656,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
657,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
658,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
659,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
660,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
661,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
662,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile," # backwards compat
"
663,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
664,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
665,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
666,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/11/alpine/Dockerfile,"#		krb5-dev \
"
667,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/11/alpine/Dockerfile,"#		openldap-dev \
"
668,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/11/alpine/Dockerfile,"# configure: error: prove not found
"
669,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
670,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
671,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
672,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
673,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
674,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
675,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
676,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
677,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
678,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
679,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
680,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
681,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
682,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
683,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/11/alpine/Dockerfile," # backwards compat
"
684,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
685,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
686,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
687,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"#		krb5-dev \
"
688,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"#		openldap-dev \
"
689,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# configure: error: prove not found
"
690,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
691,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
692,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
693,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
694,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
695,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
696,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
697,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
698,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
699,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
700,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
701,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
702,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
703,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
704,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile," # backwards compat
"
705,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
706,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
707,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
708,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
709,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
710,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
711,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
712,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
713,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
714,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
715,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
716,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
717,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
718,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
719,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# vim:set ft=dockerfile:
"
720,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# explicitly set user/group IDs
"
721,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# grab gosu for easy step-down from root
"
722,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
723,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
724,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# arches officialy built by upstream
"
725,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
726,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
727,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
728,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
729,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
730,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
731,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
732,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
733,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
734,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
735,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
736,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile," # backwards compat
"
737,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
738,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/Dockerfile,"# explicitly set user/group IDs
"
739,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
740,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
741,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
742,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
743,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
744,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
745,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
746,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
747,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
748,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
749,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
750,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
751,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
752,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
753,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
754,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
755,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
756,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
757,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
758,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
759,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
760,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
761,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
762,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
763,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
764,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
765,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
766,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/alpine/Dockerfile," # backwards compat
"
767,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
768,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
769,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
770,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
771,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
772,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
773,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
774,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
775,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
776,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
777,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
778,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
779,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
780,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
781,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
782,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
783,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
784,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
785,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
786,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
787,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile," # backwards compat
"
788,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# vim:set ft=dockerfile:
"
789,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# explicitly set user/group IDs
"
790,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
791,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
792,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# grab gosu for easy step-down from root
"
793,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
794,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
795,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
796,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
797,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
798,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# arches officialy built by upstream
"
799,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
800,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
801,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
802,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
803,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
804,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
805,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
806,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
807,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
808,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
809,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
810,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
811,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
812,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile," # backwards compat
"
813,6abeb8590f35c5251b9f100a667024febaeee06b,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
814,6abeb8590f35c5251b9f100a667024febaeee06b,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
815,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
816,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# explicitly set user/group IDs
"
817,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
818,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
819,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
820,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
821,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
822,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
823,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
824,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
825,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# arches officialy built by upstream
"
826,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
827,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
828,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
829,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
830,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
831,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
832,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
833,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
834,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
835,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
836,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
837,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
838,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
839,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile," # backwards compat
"
840,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
841,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/Dockerfile,"# explicitly set user/group IDs
"
842,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
843,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
844,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
845,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/Dockerfile,"# arches officialy built by upstream
"
846,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
847,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
848,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
849,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
850,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
851,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
852,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
853,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
854,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
855,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
856,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
857,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/Dockerfile," # backwards compat
"
858,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# vim:set ft=dockerfile:
"
859,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# explicitly set user/group IDs
"
860,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# grab gosu for easy step-down from root
"
861,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
862,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
863,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
864,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# arches officialy built by upstream
"
865,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
866,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
867,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
868,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
869,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
870,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
871,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
872,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
873,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
874,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
875,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
876,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile," # backwards compat
"
877,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# vim:set ft=dockerfile:
"
878,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# explicitly set user/group IDs
"
879,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
880,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
881,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# grab gosu for easy step-down from root
"
882,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
883,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
884,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
885,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
886,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
887,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
888,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# arches officialy built by upstream
"
889,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
890,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
891,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
892,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
893,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
894,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
895,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
896,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
897,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
898,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
899,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
900,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
901,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
902,4dc16e44d16480d9c8e5eb705c15468d65366e43,/10/Dockerfile," # backwards compat
"
903,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# vim:set ft=dockerfile:
"
904,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# explicitly set user/group IDs
"
905,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
906,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
907,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# grab gosu for easy step-down from root
"
908,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
909,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
910,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
911,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
912,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
913,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# arches officialy built by upstream
"
914,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
915,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
916,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
917,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
918,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
919,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
920,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
921,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
922,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
923,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
924,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
925,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
926,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
927,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile," # backwards compat
"
928,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
929,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
930,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
931,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
932,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
933,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
934,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
935,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
936,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
937,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"# tzdata loading functionality is optional, and fails gracefully
#		tzdata \
"
938,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
939,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
940,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# vim:set ft=dockerfile:
"
941,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# explicitly set user/group IDs
"
942,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# grab gosu for easy step-down from root
"
943,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
944,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
945,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
946,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
947,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# arches officialy built by upstream
"
948,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
949,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
950,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
951,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
952,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
953,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
954,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
955,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
956,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
957,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
958,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
959,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile," # backwards compat
"
960,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
961,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
962,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
963,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"#		krb5-dev \
"
964,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"#		openldap-dev \
"
965,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# configure: error: prove not found
"
966,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
967,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
968,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
969,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
970,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
971,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
972,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
973,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
974,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
975,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
976,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
977,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
978,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
979,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
980,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile," # backwards compat
"
981,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# vim:set ft=dockerfile:
"
982,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# explicitly set user/group IDs
"
983,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
984,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
985,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
986,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
987,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
988,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
989,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
990,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
991,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
992,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# arches officialy built by upstream
"
993,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
994,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
995,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
996,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
997,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
998,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
999,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1000,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1001,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1002,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
1003,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1004,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
1005,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1006,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile," # backwards compat
"
1007,570ca9e8ea81cb6da73ea765132755f277cd0b66,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
1008,570ca9e8ea81cb6da73ea765132755f277cd0b66,/9.3/Dockerfile,"# explicitly set user/group IDs
"
1009,570ca9e8ea81cb6da73ea765132755f277cd0b66,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
1010,570ca9e8ea81cb6da73ea765132755f277cd0b66,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1011,570ca9e8ea81cb6da73ea765132755f277cd0b66,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1012,570ca9e8ea81cb6da73ea765132755f277cd0b66,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1013,570ca9e8ea81cb6da73ea765132755f277cd0b66,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1014,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1015,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1016,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1017,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"#		krb5-dev \
"
1018,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"#		openldap-dev \
"
1019,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# configure: error: prove not found
"
1020,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1021,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1022,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1023,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1024,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1025,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1026,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1027,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1028,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1029,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1030,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1031,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1032,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1033,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1034,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile," # backwards compat
"
1035,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1036,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1037,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1038,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
1039,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
1040,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1041,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1042,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1043,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1044,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1045,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1046,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1047,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1048,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1049,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1050,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1051,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1052,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile," # backwards compat
"
1053,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1054,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1055,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
1056,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
1057,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1058,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1059,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1060,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1061,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1062,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1063,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1064,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1065,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1066,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1067,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# vim:set ft=dockerfile:
"
1068,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# explicitly set user/group IDs
"
1069,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1070,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1071,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# grab gosu for easy step-down from root
"
1072,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1073,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1074,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1075,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1076,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
1077,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# arches officialy built by upstream
"
1078,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1079,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
1080,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1081,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1082,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1083,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1084,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1085,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1086,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1087,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
1088,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1089,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
1090,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1091,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile," # backwards compat
"
1092,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# vim:set ft=dockerfile:
"
1093,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# explicitly set user/group IDs
"
1094,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1095,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1096,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# grab gosu for easy step-down from root
"
1097,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1098,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1099,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1100,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
1101,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1102,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
1103,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# arches officialy built by upstream
"
1104,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1105,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
1106,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1107,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1108,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1109,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1110,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1111,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1112,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1113,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
1114,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1115,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
1116,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1117,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile," # backwards compat
"
1118,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
1119,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.2/Dockerfile,"# explicitly set user/group IDs
"
1120,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
1121,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1122,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1123,63d966973d9593c0d9890b96f10ac73566913520,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
1124,63d966973d9593c0d9890b96f10ac73566913520,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1125,63d966973d9593c0d9890b96f10ac73566913520,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
1126,63d966973d9593c0d9890b96f10ac73566913520,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1127,63d966973d9593c0d9890b96f10ac73566913520,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1128,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1129,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1130,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1131,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/alpine/Dockerfile,"#		krb5-dev \
"
1132,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/alpine/Dockerfile,"#		openldap-dev \
"
1133,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/alpine/Dockerfile,"# configure: error: prove not found
"
1134,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1135,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1136,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1137,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1138,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1139,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1140,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1141,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1142,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1143,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1144,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1145,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1146,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1147,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/alpine/Dockerfile," # backwards compat
"
1148,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# vim:set ft=dockerfile:
"
1149,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# explicitly set user/group IDs
"
1150,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1151,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1152,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
1153,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1154,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1155,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1156,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
1157,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1158,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
1159,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# arches officialy built by upstream
"
1160,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1161,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
1162,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1163,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1164,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1165,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1166,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1167,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1168,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1169,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
1170,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1171,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
1172,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1173,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile," # backwards compat
"
1174,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
1175,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# explicitly set user/group IDs
"
1176,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
1177,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1178,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1179,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# arches officialy built by upstream
"
1180,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1181,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1182,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1183,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1184,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1185,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1186,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1187,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1188,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1189,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1190,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1191,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile," # backwards compat
"
1192,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
1193,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/Dockerfile,"# explicitly set user/group IDs
"
1194,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
1195,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1196,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1197,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1198,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1199,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1200,09b09edbea4339a008ef81f00475330172fe7630,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
1201,09b09edbea4339a008ef81f00475330172fe7630,/9.4/Dockerfile,"# explicitly set user/group IDs
"
1202,09b09edbea4339a008ef81f00475330172fe7630,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
1203,09b09edbea4339a008ef81f00475330172fe7630,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1204,09b09edbea4339a008ef81f00475330172fe7630,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1205,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
1206,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1207,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
1208,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1209,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1210,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1211,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1212,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1213,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
1214,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
1215,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
1216,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1217,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1218,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1219,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1220,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1221,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1222,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1223,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1224,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1225,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1226,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1227,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1228,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1229,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1230,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile," # backwards compat
"
1231,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1232,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1233,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1234,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
1235,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
1236,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
1237,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1238,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1239,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1240,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1241,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1242,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1243,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1244,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1245,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1246,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1247,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1248,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1249,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1250,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/alpine/Dockerfile," # backwards compat
"
1251,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1252,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1253,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1254,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
1255,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
1256,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1257,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1258,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1259,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1260,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1261,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1262,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1263,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1264,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1265,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1266,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1267,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile," # backwards compat
"
1268,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1269,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1270,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
1271,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
1272,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1273,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1274,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1275,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1276,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1277,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1278,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1279,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1280,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1281,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1282,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1283,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile," # backwards compat
"
1284,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1285,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
1286,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1287,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
1288,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
1289,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
1290,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1291,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1292,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1293,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1294,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1295,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1296,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1297,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1298,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1299,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1300,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1301,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1302,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1303,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1304,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.5/alpine/Dockerfile," # backwards compat
"
1305,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
1306,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1307,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
1308,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1309,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1310,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
1311,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# explicitly set user/group IDs
"
1312,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1313,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1314,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
1315,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1316,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1317,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1318,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1319,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
1320,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# arches officialy built by upstream
"
1321,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1322,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
1323,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1324,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1325,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1326,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1327,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1328,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1329,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1330,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
1331,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1332,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
1333,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1334,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile," # backwards compat
"
1335,7b518a11cf0d1bcebbf27b3cbbc64cb69839db11,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
1336,7b518a11cf0d1bcebbf27b3cbbc64cb69839db11,/9.2/Dockerfile,"# explicitly set user/group IDs
"
1337,7b518a11cf0d1bcebbf27b3cbbc64cb69839db11,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
1338,7b518a11cf0d1bcebbf27b3cbbc64cb69839db11,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1339,7b518a11cf0d1bcebbf27b3cbbc64cb69839db11,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1340,7b518a11cf0d1bcebbf27b3cbbc64cb69839db11,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1341,7b518a11cf0d1bcebbf27b3cbbc64cb69839db11,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1342,7b518a11cf0d1bcebbf27b3cbbc64cb69839db11,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1343,7b518a11cf0d1bcebbf27b3cbbc64cb69839db11,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1344,7b518a11cf0d1bcebbf27b3cbbc64cb69839db11,/9.2/Dockerfile," # backwards compat
"
1345,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1346,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1347,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
1348,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
1349,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1350,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1351,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1352,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1353,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1354,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1355,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1356,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1357,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# vim:set ft=dockerfile:
"
1358,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# explicitly set user/group IDs
"
1359,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1360,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1361,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# grab gosu for easy step-down from root
"
1362,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1363,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1364,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1365,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1366,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
1367,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# arches officialy built by upstream
"
1368,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1369,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
1370,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1371,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1372,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1373,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1374,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1375,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1376,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1377,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
1378,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1379,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
1380,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1381,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile," # backwards compat
"
1382,54f46e57136635b484295b985acd6e422d0b9583,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
1383,54f46e57136635b484295b985acd6e422d0b9583,/9.6/Dockerfile,"# explicitly set user/group IDs
"
1384,54f46e57136635b484295b985acd6e422d0b9583,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
1385,54f46e57136635b484295b985acd6e422d0b9583,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1386,54f46e57136635b484295b985acd6e422d0b9583,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1387,54f46e57136635b484295b985acd6e422d0b9583,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1388,54f46e57136635b484295b985acd6e422d0b9583,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1389,54f46e57136635b484295b985acd6e422d0b9583,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1390,54f46e57136635b484295b985acd6e422d0b9583,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1391,54f46e57136635b484295b985acd6e422d0b9583,/9.6/Dockerfile," # backwards compat
"
1392,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
1393,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# explicitly set user/group IDs
"
1394,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1395,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1396,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
1397,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1398,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1399,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1400,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1401,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
1402,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# arches officialy built by upstream
"
1403,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1404,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
1405,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1406,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1407,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1408,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1409,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1410,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1411,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1412,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
1413,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1414,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
1415,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1416,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile," # backwards compat
"
1417,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
1418,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.5/Dockerfile,"# explicitly set user/group IDs
"
1419,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
1420,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1421,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1422,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.5/Dockerfile,"# arches officialy built by upstream
"
1423,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1424,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1425,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1426,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1427,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1428,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1429,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1430,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1431,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1432,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1433,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1434,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.5/Dockerfile," # backwards compat
"
1435,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
1436,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.2/Dockerfile,"# explicitly set user/group IDs
"
1437,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
1438,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1439,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1440,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1441,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1442,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1443,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1444,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1445,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1446,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"#		krb5-dev \
"
1447,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"#		openldap-dev \
"
1448,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1449,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1450,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1451,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1452,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1453,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1454,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1455,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1456,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1457,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1458,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1459,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1460,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile," # backwards compat
"
1461,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1462,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1463,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1464,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"#		krb5-dev \
"
1465,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"#		openldap-dev \
"
1466,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# configure: error: prove not found
"
1467,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1468,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1469,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1470,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1471,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1472,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1473,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1474,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1475,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1476,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1477,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1478,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1479,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1480,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1481,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile," # backwards compat
"
1482,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
1483,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.5/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1484,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
1485,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1486,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1487,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
1488,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# explicitly set user/group IDs
"
1489,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
1490,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1491,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1492,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1493,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1494,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# arches officialy built by upstream
"
1495,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1496,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1497,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1498,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1499,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1500,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1501,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1502,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1503,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1504,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1505,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1506,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile," # backwards compat
"
1507,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
1508,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1509,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
1510,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1511,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1512,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
1513,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1514,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
1515,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1516,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1517,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
1518,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# explicitly set user/group IDs
"
1519,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1520,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1521,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
1522,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1523,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1524,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1525,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
1526,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1527,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
1528,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# arches officialy built by upstream
"
1529,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1530,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
1531,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1532,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1533,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1534,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1535,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1536,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1537,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1538,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
1539,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1540,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
1541,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1542,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile," # backwards compat
"
1543,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1544,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
1545,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1546,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"#		krb5-dev \
"
1547,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"#		openldap-dev \
"
1548,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# configure: error: prove not found
"
1549,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1550,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1551,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1552,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1553,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1554,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1555,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1556,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1557,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1558,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1559,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1560,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1561,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1562,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1563,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
1564,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# explicitly set user/group IDs
"
1565,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
1566,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1567,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1568,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# arches officialy built by upstream
"
1569,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1570,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1571,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1572,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1573,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1574,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1575,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1576,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1577,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1578,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1579,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1580,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile," # backwards compat
"
1581,a6d4922823aa8011513bb9c160c26c689301823a,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
1582,a6d4922823aa8011513bb9c160c26c689301823a,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1583,a6d4922823aa8011513bb9c160c26c689301823a,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
1584,a6d4922823aa8011513bb9c160c26c689301823a,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1585,a6d4922823aa8011513bb9c160c26c689301823a,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1586,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
1587,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/Dockerfile,"# explicitly set user/group IDs
"
1588,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
1589,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1590,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1591,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1592,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1593,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1594,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1595,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/Dockerfile," # backwards compat
"
1596,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
1597,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.1/Dockerfile,"# explicitly set user/group IDs
"
1598,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
1599,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1600,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1601,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.1/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1602,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.1/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1603,2cab5040341f46331367f8766b4d249a5b7a9366,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
1604,2cab5040341f46331367f8766b4d249a5b7a9366,/9.4/Dockerfile,"# explicitly set user/group IDs
"
1605,2cab5040341f46331367f8766b4d249a5b7a9366,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
1606,2cab5040341f46331367f8766b4d249a5b7a9366,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1607,2cab5040341f46331367f8766b4d249a5b7a9366,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1608,2cab5040341f46331367f8766b4d249a5b7a9366,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1609,2cab5040341f46331367f8766b4d249a5b7a9366,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1610,2cab5040341f46331367f8766b4d249a5b7a9366,/9.4/Dockerfile,"# arches officialy built by upstream
"
1611,2cab5040341f46331367f8766b4d249a5b7a9366,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1612,2cab5040341f46331367f8766b4d249a5b7a9366,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1613,2cab5040341f46331367f8766b4d249a5b7a9366,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1614,2cab5040341f46331367f8766b4d249a5b7a9366,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1615,2cab5040341f46331367f8766b4d249a5b7a9366,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1616,2cab5040341f46331367f8766b4d249a5b7a9366,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1617,2cab5040341f46331367f8766b4d249a5b7a9366,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1618,2cab5040341f46331367f8766b4d249a5b7a9366,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1619,2cab5040341f46331367f8766b4d249a5b7a9366,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1620,2cab5040341f46331367f8766b4d249a5b7a9366,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1621,2cab5040341f46331367f8766b4d249a5b7a9366,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1622,2cab5040341f46331367f8766b4d249a5b7a9366,/9.4/Dockerfile," # backwards compat
"
1623,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1624,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1625,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1626,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
1627,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
1628,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
1629,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1630,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1631,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1632,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1633,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1634,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1635,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1636,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1637,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1638,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1639,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1640,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1641,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1642,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1643,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile," # backwards compat
"
1644,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1645,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
1646,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1647,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"#		krb5-dev \
"
1648,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"#		openldap-dev \
"
1649,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# configure: error: prove not found
"
1650,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1651,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1652,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1653,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
1654,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1655,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1656,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1657,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1658,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1659,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1660,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1661,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1662,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1663,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1664,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# vim:set ft=dockerfile:
"
1665,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# explicitly set user/group IDs
"
1666,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1667,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1668,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# grab gosu for easy step-down from root
"
1669,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1670,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1671,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1672,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1673,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
1674,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# arches officialy built by upstream
"
1675,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1676,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
1677,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1678,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1679,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1680,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1681,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1682,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1683,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1684,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
1685,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1686,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
1687,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1688,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile," # backwards compat
"
1689,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1690,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
1691,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1692,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
1693,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
1694,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
1695,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1696,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1697,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1698,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1699,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1700,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1701,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1702,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1703,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1704,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1705,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1706,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1707,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1708,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1709,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile," # backwards compat
"
1710,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
1711,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/Dockerfile,"# explicitly set user/group IDs
"
1712,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
1713,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1714,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1715,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1716,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1717,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1718,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1719,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/Dockerfile," # backwards compat
"
1720,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
1721,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/Dockerfile,"# explicitly set user/group IDs
"
1722,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
1723,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1724,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1725,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1726,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1727,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1728,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1729,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/Dockerfile," # backwards compat
"
1730,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/10/Dockerfile,"# vim:set ft=dockerfile:
"
1731,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/10/Dockerfile,"# explicitly set user/group IDs
"
1732,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/10/Dockerfile,"# grab gosu for easy step-down from root
"
1733,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1734,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1735,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1736,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1737,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/10/Dockerfile,"# arches officialy built by upstream
"
1738,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1739,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1740,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1741,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1742,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1743,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1744,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1745,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1746,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1747,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1748,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1749,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/10/Dockerfile," # backwards compat
"
1750,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1751,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
1752,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1753,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/10/alpine/Dockerfile,"#		krb5-dev \
"
1754,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/10/alpine/Dockerfile,"#		openldap-dev \
"
1755,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/10/alpine/Dockerfile,"# configure: error: prove not found
"
1756,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1757,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1758,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1759,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1760,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1761,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1762,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1763,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1764,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1765,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1766,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1767,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1768,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1769,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1770,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/10/alpine/Dockerfile," # backwards compat
"
1771,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1772,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1773,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
1774,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
1775,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1776,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1777,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1778,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1779,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1780,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1781,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1782,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1783,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1784,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1785,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1786,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1787,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1788,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
1789,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
1790,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1791,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1792,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1793,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1794,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1795,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1796,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1797,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1798,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
1799,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1800,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
1801,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1802,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1803,b2317dd369030a5f3f030b1daa1fc80da3cab9e0,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
1804,b2317dd369030a5f3f030b1daa1fc80da3cab9e0,/9.6/Dockerfile,"# explicitly set user/group IDs
"
1805,b2317dd369030a5f3f030b1daa1fc80da3cab9e0,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
1806,b2317dd369030a5f3f030b1daa1fc80da3cab9e0,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1807,b2317dd369030a5f3f030b1daa1fc80da3cab9e0,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1808,b2317dd369030a5f3f030b1daa1fc80da3cab9e0,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1809,b2317dd369030a5f3f030b1daa1fc80da3cab9e0,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1810,80ebeda0a68be6a8b10ce0de1846a49228af0795,/8.4/Dockerfile,"# vim:set ft=dockerfile:
"
1811,80ebeda0a68be6a8b10ce0de1846a49228af0795,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1812,80ebeda0a68be6a8b10ce0de1846a49228af0795,/8.4/Dockerfile,"# grab gosu for easy step-down from root
"
1813,80ebeda0a68be6a8b10ce0de1846a49228af0795,/8.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1814,80ebeda0a68be6a8b10ce0de1846a49228af0795,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1815,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
1816,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.4/Dockerfile,"# explicitly set user/group IDs
"
1817,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
1818,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1819,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1820,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
1821,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1822,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
1823,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1824,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1825,5159417968c6a08e2ed784498cba28f22a74b03e,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
1826,5159417968c6a08e2ed784498cba28f22a74b03e,/9.6/Dockerfile,"# explicitly set user/group IDs
"
1827,5159417968c6a08e2ed784498cba28f22a74b03e,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
1828,5159417968c6a08e2ed784498cba28f22a74b03e,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1829,5159417968c6a08e2ed784498cba28f22a74b03e,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1830,5159417968c6a08e2ed784498cba28f22a74b03e,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1831,5159417968c6a08e2ed784498cba28f22a74b03e,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1832,5159417968c6a08e2ed784498cba28f22a74b03e,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1833,5159417968c6a08e2ed784498cba28f22a74b03e,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1834,5159417968c6a08e2ed784498cba28f22a74b03e,/9.6/Dockerfile," # backwards compat
"
1835,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1836,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1837,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1838,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
1839,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
1840,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
1841,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1842,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1843,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1844,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1845,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1846,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1847,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1848,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1849,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1850,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1851,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1852,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1853,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1854,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1855,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile," # backwards compat
"
1856,d74474439c5ce1b0d7a2e17a310e53ae975e519b,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
1857,d74474439c5ce1b0d7a2e17a310e53ae975e519b,/9.5/Dockerfile,"# explicitly set user/group IDs
"
1858,d74474439c5ce1b0d7a2e17a310e53ae975e519b,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
1859,d74474439c5ce1b0d7a2e17a310e53ae975e519b,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1860,d74474439c5ce1b0d7a2e17a310e53ae975e519b,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1861,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
1862,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.5/Dockerfile,"# explicitly set user/group IDs
"
1863,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
1864,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1865,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1866,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1867,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1868,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
1869,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
1870,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1871,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1872,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1873,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1874,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1875,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1876,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1877,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1878,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
1879,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"# explicitly set user/group IDs
"
1880,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1881,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1882,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
1883,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1884,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1885,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1886,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1887,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
1888,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"# arches officialy built by upstream
"
1889,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1890,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
1891,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1892,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1893,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1894,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1895,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1896,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1897,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1898,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
1899,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1900,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1901,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1902,91939daa3f42d2796952f03353534cd87d181ccc,/9.4/Dockerfile," # backwards compat
"
1903,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
1904,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.1/Dockerfile,"# explicitly set user/group IDs
"
1905,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
1906,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1907,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1908,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.1/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1909,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.1/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1910,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1911,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1912,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
1913,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
1914,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1915,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1916,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1917,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1918,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1919,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1920,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1921,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1922,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1923,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1924,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1925,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.6/alpine/Dockerfile," # backwards compat
"
1926,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
1927,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.1/Dockerfile,"# explicitly set user/group IDs
"
1928,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
1929,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1930,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1931,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.1/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1932,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.1/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1933,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1934,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1935,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1936,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/11/alpine/Dockerfile,"#		krb5-dev \
"
1937,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/11/alpine/Dockerfile,"#		openldap-dev \
"
1938,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/11/alpine/Dockerfile,"# configure: error: prove not found
"
1939,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1940,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1941,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1942,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1943,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1944,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1945,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1946,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1947,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1948,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1949,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1950,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1951,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1952,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1953,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/11/alpine/Dockerfile," # backwards compat
"
1954,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
1955,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1956,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
1957,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1958,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1959,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1960,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1961,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1962,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"#		krb5-dev \
"
1963,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"#		openldap-dev \
"
1964,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# configure: error: prove not found
"
1965,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1966,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1967,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1968,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1969,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1970,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1971,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1972,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1973,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1974,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1975,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1976,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1977,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1978,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1979,54f46e57136635b484295b985acd6e422d0b9583,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1980,54f46e57136635b484295b985acd6e422d0b9583,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1981,54f46e57136635b484295b985acd6e422d0b9583,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
1982,54f46e57136635b484295b985acd6e422d0b9583,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
1983,54f46e57136635b484295b985acd6e422d0b9583,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1984,54f46e57136635b484295b985acd6e422d0b9583,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1985,54f46e57136635b484295b985acd6e422d0b9583,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1986,54f46e57136635b484295b985acd6e422d0b9583,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1987,54f46e57136635b484295b985acd6e422d0b9583,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1988,54f46e57136635b484295b985acd6e422d0b9583,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1989,54f46e57136635b484295b985acd6e422d0b9583,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1990,54f46e57136635b484295b985acd6e422d0b9583,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1991,54f46e57136635b484295b985acd6e422d0b9583,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1992,54f46e57136635b484295b985acd6e422d0b9583,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1993,54f46e57136635b484295b985acd6e422d0b9583,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1994,54f46e57136635b484295b985acd6e422d0b9583,/9.2/alpine/Dockerfile," # backwards compat
"
1995,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
1996,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# explicitly set user/group IDs
"
1997,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1998,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1999,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
2000,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2001,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2002,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2003,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
2004,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2005,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
2006,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# arches officialy built by upstream
"
2007,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2008,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
2009,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2010,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2011,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2012,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2013,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2014,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2015,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2016,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
2017,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2018,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
2019,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2020,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.6/Dockerfile," # backwards compat
"
2021,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
2022,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2023,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
2024,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2025,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2026,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2027,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
2028,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2029,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
2030,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
2031,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
2032,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2033,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2034,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2035,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2036,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2037,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2038,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2039,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2040,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2041,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
2042,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2043,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2044,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2045,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2046,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile," # backwards compat
"
2047,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
2048,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2049,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
2050,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2051,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2052,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# vim:set ft=dockerfile:
"
2053,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# explicitly set user/group IDs
"
2054,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
2055,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
2056,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# grab gosu for easy step-down from root
"
2057,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2058,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2059,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2060,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2061,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
2062,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# arches officialy built by upstream
"
2063,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2064,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
2065,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2066,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2067,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2068,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2069,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2070,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2071,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2072,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
2073,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2074,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
2075,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2076,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile," # backwards compat
"
2077,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
2078,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2079,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
2080,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2081,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2082,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2083,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
2084,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2085,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/12/alpine/Dockerfile,"#		krb5-dev \
"
2086,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/12/alpine/Dockerfile,"#		openldap-dev \
"
2087,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/12/alpine/Dockerfile,"# configure: error: prove not found
"
2088,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2089,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2090,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2091,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2092,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2093,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2094,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2095,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2096,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2097,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
2098,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2099,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2100,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2101,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2102,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
2103,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.2/Dockerfile,"# explicitly set user/group IDs
"
2104,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
2105,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2106,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2107,51e5166d69320581cb707d6fb102d3ba04803400,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
2108,51e5166d69320581cb707d6fb102d3ba04803400,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2109,51e5166d69320581cb707d6fb102d3ba04803400,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
2110,51e5166d69320581cb707d6fb102d3ba04803400,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2111,51e5166d69320581cb707d6fb102d3ba04803400,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2112,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
2113,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.0/Dockerfile,"# explicitly set user/group IDs
"
2114,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
2115,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2116,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2117,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
2118,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# explicitly set user/group IDs
"
2119,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
2120,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
2121,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
2122,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2123,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2124,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2125,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2126,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# arches officialy built by upstream
"
2127,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2128,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2129,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2130,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2131,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2132,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2133,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2134,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2135,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2136,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2137,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2138,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile," # backwards compat
"
2139,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2140,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
2141,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2142,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
2143,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
2144,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
2145,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2146,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2147,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2148,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2149,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2150,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2151,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2152,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2153,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2154,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2155,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2156,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2157,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2158,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile," # backwards compat
"
2159,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
2160,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.2/Dockerfile,"# explicitly set user/group IDs
"
2161,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
2162,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2163,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2164,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2165,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2166,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
2167,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.1/Dockerfile,"# explicitly set user/group IDs
"
2168,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
2169,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2170,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2171,54f46e57136635b484295b985acd6e422d0b9583,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2172,54f46e57136635b484295b985acd6e422d0b9583,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2173,54f46e57136635b484295b985acd6e422d0b9583,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
2174,54f46e57136635b484295b985acd6e422d0b9583,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
2175,54f46e57136635b484295b985acd6e422d0b9583,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2176,54f46e57136635b484295b985acd6e422d0b9583,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2177,54f46e57136635b484295b985acd6e422d0b9583,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2178,54f46e57136635b484295b985acd6e422d0b9583,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2179,54f46e57136635b484295b985acd6e422d0b9583,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2180,54f46e57136635b484295b985acd6e422d0b9583,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2181,54f46e57136635b484295b985acd6e422d0b9583,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2182,54f46e57136635b484295b985acd6e422d0b9583,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2183,54f46e57136635b484295b985acd6e422d0b9583,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2184,54f46e57136635b484295b985acd6e422d0b9583,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2185,54f46e57136635b484295b985acd6e422d0b9583,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2186,54f46e57136635b484295b985acd6e422d0b9583,/9.5/alpine/Dockerfile," # backwards compat
"
2187,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
2188,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2189,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
2190,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2191,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2192,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
2193,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/Dockerfile,"# explicitly set user/group IDs
"
2194,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
2195,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2196,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2197,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2198,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2199,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2200,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
2201,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/Dockerfile,"# explicitly set user/group IDs
"
2202,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
2203,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2204,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2205,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2206,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/Dockerfile,"# arches officialy built by upstream
"
2207,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2208,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2209,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2210,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2211,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2212,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2213,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2214,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2215,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2216,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2217,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2218,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/Dockerfile," # backwards compat
"
2219,c6484bf22f5a0f72a49658ae9e5569bc01785eff,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
2220,c6484bf22f5a0f72a49658ae9e5569bc01785eff,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2221,c6484bf22f5a0f72a49658ae9e5569bc01785eff,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2222,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2223,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
2224,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2225,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"#		krb5-dev \
"
2226,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"#		openldap-dev \
"
2227,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# configure: error: prove not found
"
2228,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2229,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2230,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2231,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2232,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2233,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2234,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2235,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2236,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2237,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
2238,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2239,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2240,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2241,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2242,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile," # backwards compat
"
2243,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2244,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
2245,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2246,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"#		krb5-dev \
"
2247,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"#		openldap-dev \
"
2248,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# configure: error: prove not found
"
2249,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2250,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2251,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2252,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2253,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2254,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2255,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2256,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2257,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2258,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
2259,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2260,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2261,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2262,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2263,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile," # backwards compat
"
2264,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
2265,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/Dockerfile,"# explicitly set user/group IDs
"
2266,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
2267,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2268,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2269,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/Dockerfile,"# arches officialy built by upstream
"
2270,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2271,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2272,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2273,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2274,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2275,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2276,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2277,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2278,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2279,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2280,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2281,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/Dockerfile," # backwards compat
"
2282,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# vim:set ft=dockerfile:
"
2283,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# explicitly set user/group IDs
"
2284,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# grab gosu for easy step-down from root
"
2285,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2286,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2287,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2288,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2289,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# arches officialy built by upstream
"
2290,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2291,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2292,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2293,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2294,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2295,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2296,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2297,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2298,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2299,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2300,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2301,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile," # backwards compat
"
2302,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# vim:set ft=dockerfile:
"
2303,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# explicitly set user/group IDs
"
2304,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
2305,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
2306,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# grab gosu for easy step-down from root
"
2307,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2308,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2309,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2310,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2311,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
2312,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# arches officialy built by upstream
"
2313,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2314,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
2315,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2316,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2317,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2318,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2319,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2320,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2321,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2322,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
2323,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2324,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
2325,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2326,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile," # backwards compat
"
2327,de4122a80157b1a0a73c14bdd4f11479011a2a51,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
2328,de4122a80157b1a0a73c14bdd4f11479011a2a51,/9.2/Dockerfile,"# explicitly set user/group IDs
"
2329,de4122a80157b1a0a73c14bdd4f11479011a2a51,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
2330,de4122a80157b1a0a73c14bdd4f11479011a2a51,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2331,de4122a80157b1a0a73c14bdd4f11479011a2a51,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2332,de4122a80157b1a0a73c14bdd4f11479011a2a51,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2333,de4122a80157b1a0a73c14bdd4f11479011a2a51,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2334,de4122a80157b1a0a73c14bdd4f11479011a2a51,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2335,de4122a80157b1a0a73c14bdd4f11479011a2a51,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2336,de4122a80157b1a0a73c14bdd4f11479011a2a51,/9.2/Dockerfile," # backwards compat
"
2337,ae81e91148991e9807b7275485e37b92a9cf13eb,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
2338,ae81e91148991e9807b7275485e37b92a9cf13eb,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2339,ae81e91148991e9807b7275485e37b92a9cf13eb,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
2340,ae81e91148991e9807b7275485e37b92a9cf13eb,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2341,ae81e91148991e9807b7275485e37b92a9cf13eb,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2342,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/10/Dockerfile,"# vim:set ft=dockerfile:
"
2343,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/10/Dockerfile,"# explicitly set user/group IDs
"
2344,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/10/Dockerfile,"# grab gosu for easy step-down from root
"
2345,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2346,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2347,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2348,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2349,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2350,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2351,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/10/Dockerfile," # backwards compat
"
2352,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2353,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2354,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
2355,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
2356,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2357,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2358,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2359,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2360,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2361,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2362,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2363,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2364,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
2365,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# explicitly set user/group IDs
"
2366,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
2367,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
2368,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
2369,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2370,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2371,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2372,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2373,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
2374,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# arches officialy built by upstream
"
2375,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2376,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
2377,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2378,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2379,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2380,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2381,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2382,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2383,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2384,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
2385,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2386,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
2387,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2388,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/Dockerfile," # backwards compat
"
2389,9e6a83faa9859b35fc4df18be513320c00ecd493,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
2390,9e6a83faa9859b35fc4df18be513320c00ecd493,/9.4/Dockerfile,"# explicitly set user/group IDs
"
2391,9e6a83faa9859b35fc4df18be513320c00ecd493,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
2392,9e6a83faa9859b35fc4df18be513320c00ecd493,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2393,9e6a83faa9859b35fc4df18be513320c00ecd493,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2394,9e6a83faa9859b35fc4df18be513320c00ecd493,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2395,9e6a83faa9859b35fc4df18be513320c00ecd493,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2396,9e6a83faa9859b35fc4df18be513320c00ecd493,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2397,9e6a83faa9859b35fc4df18be513320c00ecd493,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2398,9e6a83faa9859b35fc4df18be513320c00ecd493,/9.4/Dockerfile," # backwards compat
"
2399,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# vim:set ft=dockerfile:
"
2400,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# explicitly set user/group IDs
"
2401,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
2402,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
2403,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# grab gosu for easy step-down from root
"
2404,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2405,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2406,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2407,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2408,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
2409,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# arches officialy built by upstream
"
2410,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2411,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
2412,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2413,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2414,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2415,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2416,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2417,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2418,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2419,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
2420,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2421,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
2422,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2423,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/Dockerfile," # backwards compat
"
2424,d2b38544770a63fed430694a7aed33de3ad8b808,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2425,d2b38544770a63fed430694a7aed33de3ad8b808,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2426,d2b38544770a63fed430694a7aed33de3ad8b808,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
2427,d2b38544770a63fed430694a7aed33de3ad8b808,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
2428,d2b38544770a63fed430694a7aed33de3ad8b808,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2429,d2b38544770a63fed430694a7aed33de3ad8b808,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2430,d2b38544770a63fed430694a7aed33de3ad8b808,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2431,d2b38544770a63fed430694a7aed33de3ad8b808,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2432,d2b38544770a63fed430694a7aed33de3ad8b808,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2433,d2b38544770a63fed430694a7aed33de3ad8b808,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2434,d2b38544770a63fed430694a7aed33de3ad8b808,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2435,d2b38544770a63fed430694a7aed33de3ad8b808,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2436,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
2437,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2438,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
2439,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2440,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2441,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
2442,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# explicitly set user/group IDs
"
2443,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
2444,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2445,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2446,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# arches officialy built by upstream
"
2447,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2448,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2449,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2450,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2451,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2452,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2453,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2454,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2455,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2456,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2457,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2458,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile," # backwards compat
"
2459,2cab5040341f46331367f8766b4d249a5b7a9366,/10/Dockerfile,"# vim:set ft=dockerfile:
"
2460,2cab5040341f46331367f8766b4d249a5b7a9366,/10/Dockerfile,"# explicitly set user/group IDs
"
2461,2cab5040341f46331367f8766b4d249a5b7a9366,/10/Dockerfile,"# grab gosu for easy step-down from root
"
2462,2cab5040341f46331367f8766b4d249a5b7a9366,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2463,2cab5040341f46331367f8766b4d249a5b7a9366,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2464,2cab5040341f46331367f8766b4d249a5b7a9366,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2465,2cab5040341f46331367f8766b4d249a5b7a9366,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2466,2cab5040341f46331367f8766b4d249a5b7a9366,/10/Dockerfile,"# arches officialy built by upstream
"
2467,2cab5040341f46331367f8766b4d249a5b7a9366,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2468,2cab5040341f46331367f8766b4d249a5b7a9366,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2469,2cab5040341f46331367f8766b4d249a5b7a9366,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2470,2cab5040341f46331367f8766b4d249a5b7a9366,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2471,2cab5040341f46331367f8766b4d249a5b7a9366,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2472,2cab5040341f46331367f8766b4d249a5b7a9366,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2473,2cab5040341f46331367f8766b4d249a5b7a9366,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2474,2cab5040341f46331367f8766b4d249a5b7a9366,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2475,2cab5040341f46331367f8766b4d249a5b7a9366,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2476,2cab5040341f46331367f8766b4d249a5b7a9366,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2477,2cab5040341f46331367f8766b4d249a5b7a9366,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2478,2cab5040341f46331367f8766b4d249a5b7a9366,/10/Dockerfile," # backwards compat
"
2479,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
2480,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2481,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
2482,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2483,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2484,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
2485,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.6/Dockerfile,"# explicitly set user/group IDs
"
2486,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
2487,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2488,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2489,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2490,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2491,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.6/Dockerfile,"# arches officialy built by upstream
"
2492,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2493,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2494,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2495,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2496,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2497,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2498,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2499,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2500,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2501,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2502,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2503,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.6/Dockerfile," # backwards compat
"
2504,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
2505,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.5/Dockerfile,"# explicitly set user/group IDs
"
2506,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
2507,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2508,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2509,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2510,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2511,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
2512,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# explicitly set user/group IDs
"
2513,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
2514,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
2515,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
2516,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2517,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2518,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2519,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2520,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
2521,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# arches officialy built by upstream
"
2522,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2523,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
2524,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2525,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2526,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2527,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2528,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2529,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2530,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2531,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
2532,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2533,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
2534,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2535,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile," # backwards compat
"
2536,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2537,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2538,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
2539,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
2540,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2541,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2542,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2543,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2544,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2545,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2546,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2547,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2548,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2549,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2550,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
2551,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
2552,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2553,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2554,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2555,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2556,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2557,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2558,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2559,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2560,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2561,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2562,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2563,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# vim:set ft=dockerfile:
"
2564,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# explicitly set user/group IDs
"
2565,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
2566,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
2567,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# grab gosu for easy step-down from root
"
2568,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2569,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2570,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2571,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2572,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# arches officialy built by upstream
"
2573,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2574,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2575,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2576,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2577,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2578,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2579,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2580,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2581,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2582,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2583,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2584,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile," # backwards compat
"
2585,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
2586,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2587,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
2588,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2589,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2590,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
2591,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# explicitly set user/group IDs
"
2592,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
2593,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
2594,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
2595,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2596,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2597,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2598,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2599,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
2600,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# arches officialy built by upstream
"
2601,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2602,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
2603,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2604,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2605,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2606,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2607,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2608,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2609,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2610,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
2611,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2612,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
2613,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2614,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile," # backwards compat
"
2615,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
2616,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.5/Dockerfile,"# explicitly set user/group IDs
"
2617,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
2618,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2619,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2620,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2621,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2622,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2623,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
2624,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2625,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"#		krb5-dev \
"
2626,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"#		openldap-dev \
"
2627,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# configure: error: prove not found
"
2628,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2629,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2630,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2631,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2632,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2633,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2634,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2635,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2636,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2637,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
2638,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2639,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2640,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2641,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2642,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile," # backwards compat
"
2643,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
2644,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# explicitly set user/group IDs
"
2645,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
2646,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
2647,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
2648,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2649,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2650,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2651,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
2652,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2653,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
2654,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# arches officialy built by upstream
"
2655,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2656,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
2657,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2658,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2659,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2660,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2661,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2662,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2663,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2664,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
2665,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2666,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
2667,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2668,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile," # backwards compat
"
2669,54f46e57136635b484295b985acd6e422d0b9583,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
2670,54f46e57136635b484295b985acd6e422d0b9583,/9.2/Dockerfile,"# explicitly set user/group IDs
"
2671,54f46e57136635b484295b985acd6e422d0b9583,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
2672,54f46e57136635b484295b985acd6e422d0b9583,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2673,54f46e57136635b484295b985acd6e422d0b9583,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2674,54f46e57136635b484295b985acd6e422d0b9583,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2675,54f46e57136635b484295b985acd6e422d0b9583,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2676,54f46e57136635b484295b985acd6e422d0b9583,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2677,54f46e57136635b484295b985acd6e422d0b9583,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2678,54f46e57136635b484295b985acd6e422d0b9583,/9.2/Dockerfile," # backwards compat
"
2679,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2680,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
2681,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2682,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
2683,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
2684,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
2685,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2686,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2687,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2688,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2689,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2690,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2691,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2692,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2693,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2694,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
2695,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2696,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2697,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2698,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2699,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile," # backwards compat
"
2700,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2701,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
2702,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2703,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
2704,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
2705,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
2706,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2707,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2708,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2709,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2710,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2711,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2712,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2713,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2714,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2715,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
2716,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2717,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2718,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2719,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2720,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.6/alpine/Dockerfile," # backwards compat
"
2721,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# vim:set ft=dockerfile:
"
2722,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# explicitly set user/group IDs
"
2723,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# grab gosu for easy step-down from root
"
2724,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2725,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2726,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2727,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2728,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# arches officialy built by upstream
"
2729,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2730,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2731,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2732,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2733,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2734,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2735,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2736,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2737,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2738,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2739,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2740,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile," # backwards compat
"
2741,639f83fb14161c8be60119b97bb9f88796776058,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
2742,639f83fb14161c8be60119b97bb9f88796776058,/9.3/Dockerfile,"# explicitly set user/group IDs
"
2743,639f83fb14161c8be60119b97bb9f88796776058,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
2744,639f83fb14161c8be60119b97bb9f88796776058,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2745,639f83fb14161c8be60119b97bb9f88796776058,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2746,639f83fb14161c8be60119b97bb9f88796776058,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2747,639f83fb14161c8be60119b97bb9f88796776058,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2748,639f83fb14161c8be60119b97bb9f88796776058,/9.3/Dockerfile,"# arches officialy built by upstream
"
2749,639f83fb14161c8be60119b97bb9f88796776058,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2750,639f83fb14161c8be60119b97bb9f88796776058,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2751,639f83fb14161c8be60119b97bb9f88796776058,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2752,639f83fb14161c8be60119b97bb9f88796776058,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2753,639f83fb14161c8be60119b97bb9f88796776058,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2754,639f83fb14161c8be60119b97bb9f88796776058,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2755,639f83fb14161c8be60119b97bb9f88796776058,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2756,639f83fb14161c8be60119b97bb9f88796776058,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2757,639f83fb14161c8be60119b97bb9f88796776058,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2758,639f83fb14161c8be60119b97bb9f88796776058,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2759,639f83fb14161c8be60119b97bb9f88796776058,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2760,639f83fb14161c8be60119b97bb9f88796776058,/9.3/Dockerfile," # backwards compat
"
2761,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
2762,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2763,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
2764,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2765,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2766,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/Dockerfile,"# vim:set ft=dockerfile:
"
2767,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/Dockerfile,"# explicitly set user/group IDs
"
2768,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/Dockerfile,"# grab gosu for easy step-down from root
"
2769,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2770,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2771,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/Dockerfile,"# arches officialy built by upstream
"
2772,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2773,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2774,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2775,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2776,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2777,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2778,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2779,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2780,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2781,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2782,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2783,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/Dockerfile," # backwards compat
"
2784,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# vim:set ft=dockerfile:
"
2785,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# explicitly set user/group IDs
"
2786,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
2787,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
2788,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# grab gosu for easy step-down from root
"
2789,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2790,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2791,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2792,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2793,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
2794,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# arches officialy built by upstream
"
2795,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2796,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
2797,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2798,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2799,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2800,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2801,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2802,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2803,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2804,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
2805,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2806,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
2807,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2808,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile," # backwards compat
"
2809,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2810,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2811,ea490430aabd553f34656e8f0e846d2ed3c42930,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2812,ea490430aabd553f34656e8f0e846d2ed3c42930,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2813,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2814,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2815,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
2816,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/Dockerfile,"# explicitly set user/group IDs
"
2817,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
2818,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2819,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2820,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2821,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2822,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2823,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2824,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2825,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2826,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
2827,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
2828,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2829,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2830,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2831,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2832,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2833,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2834,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2835,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2836,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
2837,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/Dockerfile,"# explicitly set user/group IDs
"
2838,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
2839,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2840,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2841,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2842,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2843,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2844,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2845,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/Dockerfile," # backwards compat
"
2846,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2847,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2848,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
2849,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
2850,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2851,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2852,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2853,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2854,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2855,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2856,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2857,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2858,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2859,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2860,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2861,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile," # backwards compat
"
2862,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# vim:set ft=dockerfile:
"
2863,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# explicitly set user/group IDs
"
2864,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
2865,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
2866,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# grab gosu for easy step-down from root
"
2867,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2868,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2869,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2870,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
2871,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2872,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
2873,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# arches officialy built by upstream
"
2874,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2875,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
2876,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2877,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2878,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2879,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2880,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2881,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2882,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2883,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
2884,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2885,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
2886,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2887,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/10/Dockerfile," # backwards compat
"
2888,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2889,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
2890,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2891,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"#		krb5-dev \
"
2892,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"#		openldap-dev \
"
2893,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# configure: error: prove not found
"
2894,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2895,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2896,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2897,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
2898,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2899,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2900,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2901,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2902,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2903,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
2904,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2905,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2906,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2907,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2908,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile," # backwards compat
"
2909,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2910,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
2911,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2912,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/alpine/Dockerfile,"#		krb5-dev \
"
2913,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/alpine/Dockerfile,"#		openldap-dev \
"
2914,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/alpine/Dockerfile,"# configure: error: prove not found
"
2915,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2916,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2917,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2918,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2919,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2920,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2921,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2922,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2923,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2924,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2925,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2926,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2927,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2928,bef8f02d1fe2bb4547280ba609f19abd20230180,/10/alpine/Dockerfile," # backwards compat
"
2929,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
2930,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# explicitly set user/group IDs
"
2931,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
2932,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2933,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2934,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# arches officialy built by upstream
"
2935,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2936,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2937,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2938,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2939,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2940,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2941,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2942,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2943,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2944,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2945,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2946,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile," # backwards compat
"
2947,639f83fb14161c8be60119b97bb9f88796776058,/11/Dockerfile,"# vim:set ft=dockerfile:
"
2948,639f83fb14161c8be60119b97bb9f88796776058,/11/Dockerfile,"# explicitly set user/group IDs
"
2949,639f83fb14161c8be60119b97bb9f88796776058,/11/Dockerfile,"# grab gosu for easy step-down from root
"
2950,639f83fb14161c8be60119b97bb9f88796776058,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2951,639f83fb14161c8be60119b97bb9f88796776058,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2952,639f83fb14161c8be60119b97bb9f88796776058,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2953,639f83fb14161c8be60119b97bb9f88796776058,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2954,639f83fb14161c8be60119b97bb9f88796776058,/11/Dockerfile,"# arches officialy built by upstream
"
2955,639f83fb14161c8be60119b97bb9f88796776058,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2956,639f83fb14161c8be60119b97bb9f88796776058,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2957,639f83fb14161c8be60119b97bb9f88796776058,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2958,639f83fb14161c8be60119b97bb9f88796776058,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2959,639f83fb14161c8be60119b97bb9f88796776058,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2960,639f83fb14161c8be60119b97bb9f88796776058,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2961,639f83fb14161c8be60119b97bb9f88796776058,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2962,639f83fb14161c8be60119b97bb9f88796776058,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2963,639f83fb14161c8be60119b97bb9f88796776058,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2964,639f83fb14161c8be60119b97bb9f88796776058,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2965,639f83fb14161c8be60119b97bb9f88796776058,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2966,639f83fb14161c8be60119b97bb9f88796776058,/11/Dockerfile," # backwards compat
"
2967,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
2968,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/Dockerfile,"# explicitly set user/group IDs
"
2969,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
2970,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2971,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2972,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2973,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2974,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2975,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2976,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/Dockerfile," # backwards compat
"
2977,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2978,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2979,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
2980,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
2981,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2982,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2983,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2984,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2985,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2986,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2987,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2988,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2989,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2990,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2991,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2992,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
2993,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.5/Dockerfile,"# explicitly set user/group IDs
"
2994,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
2995,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2996,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2997,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2998,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2999,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
3000,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# explicitly set user/group IDs
"
3001,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3002,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3003,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
3004,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3005,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3006,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3007,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3008,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# see note below about ""*.pyc"" files
"
3009,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# arches officialy built by upstream
"
3010,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3011,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3012,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3013,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3014,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3015,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3016,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3017,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3018,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3019,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3020,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3021,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3022,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3023,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile," # backwards compat
"
3024,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
3025,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
3026,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
3027,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3028,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3029,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3030,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3031,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3032,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
3033,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
3034,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
3035,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3036,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3037,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3038,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3039,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3040,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3041,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3042,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3043,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3044,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3045,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3046,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3047,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3048,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3049,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/alpine/Dockerfile," # backwards compat
"
3050,bcfa58b2f0c971ad55f541f3fb868607cd391089,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
3051,bcfa58b2f0c971ad55f541f3fb868607cd391089,/9.6/Dockerfile,"# explicitly set user/group IDs
"
3052,bcfa58b2f0c971ad55f541f3fb868607cd391089,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
3053,bcfa58b2f0c971ad55f541f3fb868607cd391089,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3054,bcfa58b2f0c971ad55f541f3fb868607cd391089,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3055,bcfa58b2f0c971ad55f541f3fb868607cd391089,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3056,bcfa58b2f0c971ad55f541f3fb868607cd391089,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3057,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
3058,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
3059,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
3060,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3061,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3062,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
3063,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# explicitly set user/group IDs
"
3064,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3065,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3066,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
3067,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3068,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3069,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3070,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3071,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
3072,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# arches officialy built by upstream
"
3073,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3074,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3075,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3076,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3077,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3078,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3079,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3080,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3081,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3082,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3083,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3084,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3085,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3086,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile," # backwards compat
"
3087,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
3088,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# explicitly set user/group IDs
"
3089,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
3090,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3091,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3092,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3093,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# arches officialy built by upstream
"
3094,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3095,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3096,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3097,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3098,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3099,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3100,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3101,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3102,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3103,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3104,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3105,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile," # backwards compat
"
3106,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
3107,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.6/Dockerfile,"# explicitly set user/group IDs
"
3108,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
3109,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3110,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3111,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3112,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3113,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3114,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3115,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3116,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3117,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
3118,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
3119,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3120,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
3121,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3122,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3123,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3124,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3125,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3126,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3127,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3128,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3129,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3130,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3131,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile," # backwards compat
"
3132,981ac750a3ef6160aab69509a9e8a56304366eb2,/8.4/Dockerfile,"# vim:set ft=dockerfile:
"
3133,981ac750a3ef6160aab69509a9e8a56304366eb2,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
3134,981ac750a3ef6160aab69509a9e8a56304366eb2,/8.4/Dockerfile,"# grab gosu for easy step-down from root
"
3135,981ac750a3ef6160aab69509a9e8a56304366eb2,/8.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3136,981ac750a3ef6160aab69509a9e8a56304366eb2,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3137,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3138,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3139,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3140,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
3141,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
3142,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
3143,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3144,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3145,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
3146,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3147,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3148,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3149,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3150,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3151,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3152,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3153,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3154,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3155,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3156,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3157,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3158,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/alpine/Dockerfile," # backwards compat
"
3159,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# vim:set ft=dockerfile:
"
3160,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# explicitly set user/group IDs
"
3161,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3162,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3163,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# grab gosu for easy step-down from root
"
3164,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3165,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3166,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3167,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
3168,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3169,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
3170,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# arches officialy built by upstream
"
3171,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3172,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3173,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3174,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3175,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3176,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3177,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3178,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3179,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3180,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3181,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3182,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
3183,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3184,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile," # backwards compat
"
3185,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3186,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3187,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3188,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"#		krb5-dev \
"
3189,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"#		openldap-dev \
"
3190,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# configure: error: prove not found
"
3191,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3192,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3193,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3194,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3195,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3196,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3197,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3198,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3199,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3200,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3201,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3202,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3203,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3204,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile," # backwards compat
"
3205,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3206,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3207,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3208,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
3209,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
3210,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
3211,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3212,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3213,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
3214,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3215,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3216,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3217,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3218,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3219,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3220,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3221,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3222,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3223,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3224,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3225,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3226,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3227,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile," # backwards compat
"
3228,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
3229,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
3230,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
3231,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3232,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3233,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
3234,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
3235,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
3236,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3237,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3238,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
3239,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/Dockerfile,"# explicitly set user/group IDs
"
3240,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
3241,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3242,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3243,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3244,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3245,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3246,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3247,783906f551b9bc1472751200296f93bb2c55bc44,/8.4/Dockerfile,"# vim:set ft=dockerfile:
"
3248,783906f551b9bc1472751200296f93bb2c55bc44,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
3249,783906f551b9bc1472751200296f93bb2c55bc44,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3250,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/13/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3251,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/13/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
3252,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/13/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3253,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/13/alpine/Dockerfile,"#		krb5-dev \
"
3254,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/13/alpine/Dockerfile,"#		openldap-dev \
"
3255,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/13/alpine/Dockerfile,"# configure: error: prove not found
"
3256,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/13/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3257,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/13/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3258,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/13/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3259,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/13/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
3260,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/13/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3261,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/13/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3262,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/13/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3263,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/13/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3264,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/13/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3265,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/13/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3266,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/13/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3267,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/13/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3268,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/13/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3269,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/13/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3270,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3271,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3272,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3273,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
3274,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
3275,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3276,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
3277,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3278,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3279,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3280,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3281,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3282,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3283,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3284,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3285,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3286,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3287,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3288,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3289,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile," # backwards compat
"
3290,8836191de6100bfae541c6d9a02cb4ec6e97471e,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
3291,8836191de6100bfae541c6d9a02cb4ec6e97471e,/9.5/Dockerfile,"# explicitly set user/group IDs
"
3292,8836191de6100bfae541c6d9a02cb4ec6e97471e,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
3293,8836191de6100bfae541c6d9a02cb4ec6e97471e,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3294,8836191de6100bfae541c6d9a02cb4ec6e97471e,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3295,8836191de6100bfae541c6d9a02cb4ec6e97471e,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3296,8836191de6100bfae541c6d9a02cb4ec6e97471e,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3297,8836191de6100bfae541c6d9a02cb4ec6e97471e,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3298,8836191de6100bfae541c6d9a02cb4ec6e97471e,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3299,8836191de6100bfae541c6d9a02cb4ec6e97471e,/9.5/Dockerfile," # backwards compat
"
3300,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3301,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3302,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3303,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
3304,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
3305,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
3306,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3307,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3308,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3309,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3310,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3311,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3312,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3313,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3314,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3315,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3316,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3317,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3318,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3319,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3320,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/alpine/Dockerfile," # backwards compat
"
3321,b8bc661d9222e4f91b291368a1f7f92ee67ac627,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
3322,b8bc661d9222e4f91b291368a1f7f92ee67ac627,/9.3/Dockerfile,"# explicitly set user/group IDs
"
3323,b8bc661d9222e4f91b291368a1f7f92ee67ac627,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
3324,b8bc661d9222e4f91b291368a1f7f92ee67ac627,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3325,b8bc661d9222e4f91b291368a1f7f92ee67ac627,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3326,b8bc661d9222e4f91b291368a1f7f92ee67ac627,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3327,b8bc661d9222e4f91b291368a1f7f92ee67ac627,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3328,b8bc661d9222e4f91b291368a1f7f92ee67ac627,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3329,b8bc661d9222e4f91b291368a1f7f92ee67ac627,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3330,b8bc661d9222e4f91b291368a1f7f92ee67ac627,/9.3/Dockerfile," # backwards compat
"
3331,7c8e945a80097e80fa1c8d69d2a027145177b701,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
3332,7c8e945a80097e80fa1c8d69d2a027145177b701,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3333,783906f551b9bc1472751200296f93bb2c55bc44,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
3334,783906f551b9bc1472751200296f93bb2c55bc44,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
3335,783906f551b9bc1472751200296f93bb2c55bc44,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3336,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
3337,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# explicitly set user/group IDs
"
3338,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
3339,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3340,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3341,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# arches officialy built by upstream
"
3342,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3343,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3344,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3345,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3346,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3347,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3348,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3349,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3350,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3351,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3352,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3353,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile," # backwards compat
"
3354,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
3355,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
3356,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
3357,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3358,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3359,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3360,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3361,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
3362,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
3363,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3364,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3365,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3366,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3367,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3368,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3369,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3370,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3371,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3372,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3373,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3374,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
3375,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# explicitly set user/group IDs
"
3376,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
3377,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3378,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3379,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3380,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3381,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# arches officialy built by upstream
"
3382,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3383,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3384,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3385,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3386,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3387,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3388,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3389,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3390,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3391,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3392,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3393,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile," # backwards compat
"
3394,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/Dockerfile,"# vim:set ft=dockerfile:
"
3395,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/Dockerfile,"# explicitly set user/group IDs
"
3396,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/Dockerfile,"# grab gosu for easy step-down from root
"
3397,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3398,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3399,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3400,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3401,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3402,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3403,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/Dockerfile," # backwards compat
"
3404,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
3405,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# explicitly set user/group IDs
"
3406,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3407,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3408,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
3409,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3410,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3411,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3412,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3413,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
3414,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# arches officialy built by upstream
"
3415,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3416,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3417,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3418,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3419,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3420,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3421,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3422,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3423,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3424,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3425,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3426,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
3427,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3428,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile," # backwards compat
"
3429,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
3430,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# explicitly set user/group IDs
"
3431,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3432,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3433,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
3434,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3435,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3436,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3437,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3438,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
3439,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# arches officialy built by upstream
"
3440,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3441,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3442,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3443,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3444,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3445,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3446,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3447,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3448,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3449,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3450,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3451,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
3452,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3453,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.5/Dockerfile," # backwards compat
"
3454,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3455,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3456,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
3457,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
3458,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3459,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3460,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3461,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3462,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3463,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"# tzdata loading functionality is optional, and fails gracefully
#		tzdata \
"
3464,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3465,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3466,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3467,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3468,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3469,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
3470,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
3471,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
3472,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3473,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3474,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3475,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3476,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3477,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3478,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3479,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3480,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3481,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3482,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3483,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3484,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile," # backwards compat
"
3485,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3486,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3487,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3488,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
3489,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
3490,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
3491,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3492,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3493,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3494,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3495,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3496,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3497,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3498,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3499,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3500,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3501,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3502,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3503,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3504,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3505,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile," # backwards compat
"
3506,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
3507,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# explicitly set user/group IDs
"
3508,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
3509,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3510,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3511,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# arches officialy built by upstream
"
3512,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3513,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3514,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3515,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3516,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3517,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3518,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3519,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3520,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3521,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3522,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3523,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile," # backwards compat
"
3524,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
3525,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.2/Dockerfile,"# explicitly set user/group IDs
"
3526,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
3527,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3528,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3529,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
3530,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# explicitly set user/group IDs
"
3531,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
3532,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3533,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3534,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3535,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3536,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# arches officialy built by upstream
"
3537,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3538,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3539,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3540,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3541,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3542,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3543,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3544,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3545,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3546,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3547,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3548,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile," # backwards compat
"
3549,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
3550,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
3551,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
3552,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3553,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3554,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# vim:set ft=dockerfile:
"
3555,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# explicitly set user/group IDs
"
3556,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3557,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3558,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# grab gosu for easy step-down from root
"
3559,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3560,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3561,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3562,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
3563,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3564,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
3565,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# arches officialy built by upstream
"
3566,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3567,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3568,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3569,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3570,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3571,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3572,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3573,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3574,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3575,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3576,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3577,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
3578,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3579,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile," # backwards compat
"
3580,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3581,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
3582,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3583,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"#		krb5-dev \
"
3584,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"#		openldap-dev \
"
3585,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# configure: error: prove not found
"
3586,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3587,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3588,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3589,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
3590,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3591,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3592,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3593,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3594,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3595,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3596,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3597,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3598,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3599,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3600,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile," # backwards compat
"
3601,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3602,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
3603,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3604,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
3605,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
3606,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
3607,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3608,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3609,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3610,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3611,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3612,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3613,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3614,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3615,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3616,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3617,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3618,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3619,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3620,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3621,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile," # backwards compat
"
3622,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3623,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3624,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
3625,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
3626,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3627,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3628,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3629,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3630,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3631,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3632,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3633,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3634,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# vim:set ft=dockerfile:
"
3635,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# explicitly set user/group IDs
"
3636,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3637,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3638,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
3639,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3640,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3641,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3642,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
3643,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3644,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
3645,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# arches officialy built by upstream
"
3646,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3647,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3648,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3649,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3650,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3651,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3652,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3653,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3654,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3655,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3656,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3657,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
3658,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3659,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile," # backwards compat
"
3660,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3661,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3662,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
3663,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
3664,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3665,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3666,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3667,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3668,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3669,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3670,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3671,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3672,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3673,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
3674,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3675,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"#		krb5-dev \
"
3676,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"#		openldap-dev \
"
3677,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# configure: error: prove not found
"
3678,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3679,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3680,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3681,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3682,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3683,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3684,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3685,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3686,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3687,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3688,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3689,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3690,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3691,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3692,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile," # backwards compat
"
3693,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3694,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3695,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3696,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"#		krb5-dev \
"
3697,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"#		openldap-dev \
"
3698,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# configure: error: prove not found
"
3699,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3700,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3701,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3702,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3703,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3704,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3705,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3706,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3707,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3708,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3709,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3710,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3711,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3712,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3713,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile," # backwards compat
"
3714,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
3715,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# explicitly set user/group IDs
"
3716,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3717,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3718,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
3719,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3720,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3721,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3722,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3723,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
3724,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# arches officialy built by upstream
"
3725,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3726,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3727,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3728,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3729,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3730,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3731,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3732,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3733,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3734,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3735,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3736,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
3737,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3738,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile," # backwards compat
"
3739,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3740,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3741,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3742,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
3743,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
3744,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
3745,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3746,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3747,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
3748,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3749,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3750,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3751,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3752,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3753,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3754,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3755,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3756,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3757,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3758,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3759,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3760,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3761,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile," # backwards compat
"
3762,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
3763,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
3764,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
3765,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3766,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3767,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3768,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3769,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3770,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
3771,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
3772,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
3773,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3774,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3775,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3776,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3777,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3778,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3779,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3780,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3781,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3782,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3783,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3784,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3785,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3786,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3787,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile," # backwards compat
"
3788,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
3789,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile,"# explicitly set user/group IDs
"
3790,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3791,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3792,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
3793,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3794,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3795,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3796,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3797,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile,"# arches officialy built by upstream
"
3798,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3799,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3800,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3801,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3802,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3803,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3804,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3805,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3806,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3807,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3808,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3809,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.3/Dockerfile," # backwards compat
"
3810,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3811,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3812,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
3813,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
3814,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3815,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3816,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3817,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3818,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3819,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3820,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3821,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3822,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3823,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3824,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3825,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
3826,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3827,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"#		krb5-dev \
"
3828,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"#		openldap-dev \
"
3829,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# configure: error: prove not found
"
3830,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3831,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3832,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3833,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3834,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3835,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3836,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3837,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3838,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3839,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3840,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3841,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3842,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3843,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3844,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile," # backwards compat
"
3845,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
3846,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# explicitly set user/group IDs
"
3847,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3848,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3849,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
3850,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3851,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3852,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3853,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3854,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
3855,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# arches officialy built by upstream
"
3856,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3857,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3858,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3859,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3860,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3861,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3862,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3863,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3864,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3865,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3866,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3867,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
3868,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3869,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile," # backwards compat
"
3870,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
3871,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# explicitly set user/group IDs
"
3872,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
3873,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3874,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3875,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# arches officialy built by upstream
"
3876,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3877,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3878,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3879,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3880,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3881,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3882,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3883,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3884,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3885,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3886,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3887,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile," # backwards compat
"
3888,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3889,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3890,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3891,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
3892,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
3893,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3894,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3895,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3896,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3897,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3898,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3899,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3900,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3901,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3902,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3903,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3904,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3905,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile," # backwards compat
"
3906,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
3907,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
3908,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
3909,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3910,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3911,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3912,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
3913,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3914,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"#		krb5-dev \
"
3915,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"#		openldap-dev \
"
3916,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# configure: error: prove not found
"
3917,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3918,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3919,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3920,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3921,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3922,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3923,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3924,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3925,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3926,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3927,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3928,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3929,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3930,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3931,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile," # backwards compat
"
3932,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
3933,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.3/Dockerfile,"# explicitly set user/group IDs
"
3934,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
3935,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3936,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3937,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3938,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3939,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3940,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3941,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3942,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3943,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
3944,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
3945,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
3946,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3947,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3948,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
3949,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3950,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3951,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3952,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3953,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3954,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3955,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3956,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3957,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3958,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3959,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3960,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3961,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.3/alpine/Dockerfile," # backwards compat
"
3962,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
3963,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
3964,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
3965,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3966,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3967,e4942cb0f79b61024963dc0ac196375b26fa60dd,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
3968,e4942cb0f79b61024963dc0ac196375b26fa60dd,/9.6/Dockerfile,"# explicitly set user/group IDs
"
3969,e4942cb0f79b61024963dc0ac196375b26fa60dd,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
3970,e4942cb0f79b61024963dc0ac196375b26fa60dd,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3971,e4942cb0f79b61024963dc0ac196375b26fa60dd,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3972,e4942cb0f79b61024963dc0ac196375b26fa60dd,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3973,e4942cb0f79b61024963dc0ac196375b26fa60dd,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3974,972294a377463156c8d61297320c872fc7d370a9,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
3975,972294a377463156c8d61297320c872fc7d370a9,/9.2/Dockerfile,"# explicitly set user/group IDs
"
3976,972294a377463156c8d61297320c872fc7d370a9,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
3977,972294a377463156c8d61297320c872fc7d370a9,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3978,972294a377463156c8d61297320c872fc7d370a9,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3979,972294a377463156c8d61297320c872fc7d370a9,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3980,972294a377463156c8d61297320c872fc7d370a9,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3981,972294a377463156c8d61297320c872fc7d370a9,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3982,972294a377463156c8d61297320c872fc7d370a9,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3983,972294a377463156c8d61297320c872fc7d370a9,/9.2/Dockerfile," # backwards compat
"
3984,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3985,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
3986,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3987,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
3988,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
3989,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
3990,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3991,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3992,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3993,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
3994,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3995,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3996,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3997,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3998,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3999,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4000,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4001,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4002,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4003,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4004,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile," # backwards compat
"
4005,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4006,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4007,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
4008,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
4009,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4010,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
4011,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4012,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4013,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4014,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4015,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4016,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4017,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4018,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4019,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4020,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4021,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile," # backwards compat
"
4022,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4023,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4024,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4025,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"#		krb5-dev \
"
4026,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"#		openldap-dev \
"
4027,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# configure: error: prove not found
"
4028,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4029,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4030,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4031,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4032,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4033,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4034,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4035,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4036,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4037,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4038,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4039,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4040,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4041,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4042,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile," # backwards compat
"
4043,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4044,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
4045,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4046,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/alpine/Dockerfile,"#		krb5-dev \
"
4047,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/alpine/Dockerfile,"#		openldap-dev \
"
4048,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/alpine/Dockerfile,"# configure: error: prove not found
"
4049,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4050,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4051,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4052,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4053,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4054,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4055,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4056,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4057,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4058,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4059,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4060,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4061,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4062,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4063,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4064,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4065,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4066,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
4067,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
4068,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4069,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4070,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4071,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4072,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4073,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4074,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4075,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4076,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4077,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4078,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4079,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile," # backwards compat
"
4080,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4081,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4082,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
4083,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
4084,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4085,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4086,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4087,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4088,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4089,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4090,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4091,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4092,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4093,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4094,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4095,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile," # backwards compat
"
4096,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
4097,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# explicitly set user/group IDs
"
4098,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4099,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4100,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
4101,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4102,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4103,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4104,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4105,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
4106,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# arches officialy built by upstream
"
4107,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4108,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4109,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4110,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4111,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4112,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4113,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4114,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4115,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4116,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4117,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4118,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4119,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4120,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile," # backwards compat
"
4121,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4122,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4123,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4124,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
4125,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
4126,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
4127,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4128,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4129,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
4130,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4131,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4132,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4133,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4134,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4135,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4136,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4137,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4138,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4139,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4140,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4141,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4142,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4143,6750eda25a2f0856b3997309ef393475f008d6a3,/9.3/alpine/Dockerfile," # backwards compat
"
4144,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4145,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4146,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4147,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"#		krb5-dev \
"
4148,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"#		openldap-dev \
"
4149,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# configure: error: prove not found
"
4150,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4151,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4152,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4153,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4154,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4155,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4156,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4157,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4158,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4159,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4160,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4161,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4162,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4163,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4164,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile," # backwards compat
"
4165,010a4e7e8321a692cd2fdb41c87cb8d4023567aa,/10/Dockerfile,"# vim:set ft=dockerfile:
"
4166,010a4e7e8321a692cd2fdb41c87cb8d4023567aa,/10/Dockerfile,"# explicitly set user/group IDs
"
4167,010a4e7e8321a692cd2fdb41c87cb8d4023567aa,/10/Dockerfile,"# grab gosu for easy step-down from root
"
4168,010a4e7e8321a692cd2fdb41c87cb8d4023567aa,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4169,010a4e7e8321a692cd2fdb41c87cb8d4023567aa,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4170,010a4e7e8321a692cd2fdb41c87cb8d4023567aa,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4171,010a4e7e8321a692cd2fdb41c87cb8d4023567aa,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4172,010a4e7e8321a692cd2fdb41c87cb8d4023567aa,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4173,010a4e7e8321a692cd2fdb41c87cb8d4023567aa,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4174,010a4e7e8321a692cd2fdb41c87cb8d4023567aa,/10/Dockerfile," # backwards compat
"
4175,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4176,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4177,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4178,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
4179,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
4180,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4181,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4182,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4183,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4184,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4185,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4186,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4187,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4188,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4189,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4190,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4191,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4192,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/alpine/Dockerfile," # backwards compat
"
4193,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4194,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4195,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4196,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
4197,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
4198,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4199,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4200,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4201,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4202,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4203,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4204,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4205,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4206,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4207,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4208,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4209,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4210,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.5/alpine/Dockerfile," # backwards compat
"
4211,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
4212,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/Dockerfile,"# explicitly set user/group IDs
"
4213,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
4214,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4215,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4216,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4217,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4218,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4219,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4220,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/Dockerfile," # backwards compat
"
4221,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
4222,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.2/Dockerfile,"# explicitly set user/group IDs
"
4223,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
4224,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4225,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4226,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
4227,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# explicitly set user/group IDs
"
4228,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
4229,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4230,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4231,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# arches officialy built by upstream
"
4232,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4233,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4234,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4235,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4236,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4237,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4238,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4239,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4240,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4241,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4242,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4243,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile," # backwards compat
"
4244,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
4245,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# explicitly set user/group IDs
"
4246,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4247,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4248,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
4249,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4250,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4251,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4252,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
4253,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4254,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
4255,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# arches officialy built by upstream
"
4256,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4257,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4258,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4259,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4260,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4261,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4262,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4263,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4264,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4265,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4266,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4267,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4268,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4269,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.6/Dockerfile," # backwards compat
"
4270,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4271,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4272,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4273,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
4274,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
4275,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4276,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
4277,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4278,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4279,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4280,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4281,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4282,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4283,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4284,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4285,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4286,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4287,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile," # backwards compat
"
4288,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# vim:set ft=dockerfile:
"
4289,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# explicitly set user/group IDs
"
4290,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4291,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4292,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# grab gosu for easy step-down from root
"
4293,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4294,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4295,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4296,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4297,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
4298,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# arches officialy built by upstream
"
4299,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4300,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4301,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4302,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4303,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4304,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4305,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4306,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4307,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4308,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4309,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4310,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4311,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4312,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile," # backwards compat
"
4313,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4314,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4315,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4316,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
4317,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
4318,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4319,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4320,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4321,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4322,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4323,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4324,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4325,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4326,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4327,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4328,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4329,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4330,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile," # backwards compat
"
4331,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4332,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4333,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4334,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
4335,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
4336,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4337,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
4338,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4339,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4340,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4341,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4342,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4343,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4344,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4345,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4346,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4347,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4348,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4349,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4350,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile," # backwards compat
"
4351,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
4352,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# explicitly set user/group IDs
"
4353,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
4354,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4355,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4356,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4357,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4358,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# arches officialy built by upstream
"
4359,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4360,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4361,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4362,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4363,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4364,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4365,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4366,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4367,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4368,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4369,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4370,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile," # backwards compat
"
4371,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
4372,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.3/Dockerfile,"# explicitly set user/group IDs
"
4373,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
4374,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4375,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4376,0f910e3495412a854dae3add691f79d6f18a7aa5,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
4377,0f910e3495412a854dae3add691f79d6f18a7aa5,/9.6/Dockerfile,"# explicitly set user/group IDs
"
4378,0f910e3495412a854dae3add691f79d6f18a7aa5,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
4379,0f910e3495412a854dae3add691f79d6f18a7aa5,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4380,0f910e3495412a854dae3add691f79d6f18a7aa5,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4381,0f910e3495412a854dae3add691f79d6f18a7aa5,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4382,0f910e3495412a854dae3add691f79d6f18a7aa5,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4383,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4384,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4385,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4386,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
4387,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
4388,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
4389,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4390,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4391,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4392,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4393,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4394,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4395,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4396,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4397,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4398,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4399,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4400,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4401,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4402,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4403,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.5/alpine/Dockerfile," # backwards compat
"
4404,6750eda25a2f0856b3997309ef393475f008d6a3,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4405,6750eda25a2f0856b3997309ef393475f008d6a3,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4406,6750eda25a2f0856b3997309ef393475f008d6a3,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4407,6750eda25a2f0856b3997309ef393475f008d6a3,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
4408,6750eda25a2f0856b3997309ef393475f008d6a3,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
4409,6750eda25a2f0856b3997309ef393475f008d6a3,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
4410,6750eda25a2f0856b3997309ef393475f008d6a3,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4411,6750eda25a2f0856b3997309ef393475f008d6a3,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4412,6750eda25a2f0856b3997309ef393475f008d6a3,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4413,6750eda25a2f0856b3997309ef393475f008d6a3,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4414,6750eda25a2f0856b3997309ef393475f008d6a3,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4415,6750eda25a2f0856b3997309ef393475f008d6a3,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4416,6750eda25a2f0856b3997309ef393475f008d6a3,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4417,6750eda25a2f0856b3997309ef393475f008d6a3,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4418,6750eda25a2f0856b3997309ef393475f008d6a3,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4419,6750eda25a2f0856b3997309ef393475f008d6a3,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4420,6750eda25a2f0856b3997309ef393475f008d6a3,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4421,6750eda25a2f0856b3997309ef393475f008d6a3,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4422,6750eda25a2f0856b3997309ef393475f008d6a3,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4423,6750eda25a2f0856b3997309ef393475f008d6a3,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4424,6750eda25a2f0856b3997309ef393475f008d6a3,/9.6/alpine/Dockerfile," # backwards compat
"
4425,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# vim:set ft=dockerfile:
"
4426,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# explicitly set user/group IDs
"
4427,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4428,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4429,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# grab gosu for easy step-down from root
"
4430,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4431,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4432,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4433,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
4434,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4435,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
4436,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# arches officialy built by upstream
"
4437,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4438,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4439,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4440,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4441,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4442,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4443,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4444,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4445,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4446,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4447,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4448,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4449,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4450,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile," # backwards compat
"
4451,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4452,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4453,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4454,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
4455,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
4456,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4457,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
4458,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4459,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4460,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4461,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4462,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4463,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4464,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4465,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4466,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4467,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4468,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4469,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4470,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.3/alpine/Dockerfile," # backwards compat
"
4471,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
4472,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile,"# explicitly set user/group IDs
"
4473,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4474,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4475,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
4476,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4477,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4478,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4479,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4480,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile,"# arches officialy built by upstream
"
4481,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4482,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4483,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4484,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4485,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4486,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4487,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4488,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4489,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4490,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4491,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4492,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.6/Dockerfile," # backwards compat
"
4493,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# vim:set ft=dockerfile:
"
4494,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# explicitly set user/group IDs
"
4495,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4496,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4497,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# grab gosu for easy step-down from root
"
4498,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4499,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4500,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4501,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
4502,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4503,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
4504,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# arches officialy built by upstream
"
4505,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4506,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4507,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4508,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4509,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4510,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4511,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4512,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4513,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4514,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4515,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4516,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4517,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4518,4dc16e44d16480d9c8e5eb705c15468d65366e43,/11/Dockerfile," # backwards compat
"
4519,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
4520,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# explicitly set user/group IDs
"
4521,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4522,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4523,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
4524,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4525,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4526,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4527,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
4528,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4529,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
4530,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# arches officialy built by upstream
"
4531,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4532,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4533,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4534,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4535,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4536,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4537,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4538,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4539,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4540,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4541,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4542,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4543,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4544,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile," # backwards compat
"
4545,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
4546,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
4547,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
4548,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4549,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4550,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4551,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4552,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4553,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
4554,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
4555,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4556,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4557,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4558,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4559,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4560,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4561,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4562,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4563,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4564,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4565,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4566,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4567,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile," # backwards compat
"
4568,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4569,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4570,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4571,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/alpine/Dockerfile,"#		krb5-dev \
"
4572,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/alpine/Dockerfile,"#		openldap-dev \
"
4573,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/alpine/Dockerfile,"# configure: error: prove not found
"
4574,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4575,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4576,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4577,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4578,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4579,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4580,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4581,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4582,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4583,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4584,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4585,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4586,0f55625d25faf7ad6adf821e91612d7df53d9a11,/10/alpine/Dockerfile," # backwards compat
"
4587,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4588,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
4589,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4590,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
4591,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
4592,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
4593,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4594,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4595,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4596,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4597,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4598,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4599,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4600,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4601,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4602,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4603,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4604,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4605,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4606,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4607,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile," # backwards compat
"
4608,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# vim:set ft=dockerfile:
"
4609,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# explicitly set user/group IDs
"
4610,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4611,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4612,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
4613,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4614,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4615,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4616,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
4617,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4618,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
4619,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# arches officialy built by upstream
"
4620,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4621,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4622,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4623,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4624,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4625,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4626,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4627,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4628,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4629,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4630,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4631,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4632,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4633,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile," # backwards compat
"
4634,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# vim:set ft=dockerfile:
"
4635,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# explicitly set user/group IDs
"
4636,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4637,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4638,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# grab gosu for easy step-down from root
"
4639,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4640,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4641,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4642,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4643,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
4644,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# arches officialy built by upstream
"
4645,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4646,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4647,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4648,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4649,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4650,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4651,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4652,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4653,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4654,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4655,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4656,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4657,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4658,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile," # backwards compat
"
4659,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
4660,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# explicitly set user/group IDs
"
4661,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4662,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4663,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
4664,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4665,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4666,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4667,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4668,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
4669,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# arches officialy built by upstream
"
4670,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4671,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4672,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4673,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4674,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4675,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4676,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4677,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4678,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4679,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4680,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4681,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4682,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4683,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile," # backwards compat
"
4684,6abeb8590f35c5251b9f100a667024febaeee06b,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
4685,6abeb8590f35c5251b9f100a667024febaeee06b,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4686,7c8e945a80097e80fa1c8d69d2a027145177b701,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
4687,7c8e945a80097e80fa1c8d69d2a027145177b701,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4688,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# vim:set ft=dockerfile:
"
4689,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# explicitly set user/group IDs
"
4690,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4691,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4692,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# grab gosu for easy step-down from root
"
4693,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4694,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4695,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4696,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4697,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
4698,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# arches officialy built by upstream
"
4699,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4700,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4701,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4702,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4703,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4704,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4705,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4706,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4707,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4708,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4709,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4710,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4711,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4712,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile," # backwards compat
"
4713,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4714,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4715,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4716,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
4717,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
4718,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
4719,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4720,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4721,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4722,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4723,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4724,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4725,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4726,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4727,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4728,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4729,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4730,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4731,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4732,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.6/alpine/Dockerfile," # backwards compat
"
4733,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# vim:set ft=dockerfile:
"
4734,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# explicitly set user/group IDs
"
4735,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4736,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4737,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# grab gosu for easy step-down from root
"
4738,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4739,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4740,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4741,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
4742,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4743,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
4744,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# arches officialy built by upstream
"
4745,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4746,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4747,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4748,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4749,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4750,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4751,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4752,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4753,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4754,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4755,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4756,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4757,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4758,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile," # backwards compat
"
4759,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4760,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4761,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4762,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
4763,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
4764,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
4765,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4766,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4767,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4768,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4769,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4770,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4771,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4772,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4773,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4774,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4775,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4776,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4777,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4778,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4779,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile," # backwards compat
"
4780,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
4781,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/Dockerfile,"# explicitly set user/group IDs
"
4782,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
4783,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4784,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4785,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/Dockerfile,"# arches officialy built by upstream
"
4786,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4787,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4788,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4789,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4790,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4791,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4792,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4793,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4794,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4795,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4796,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4797,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/Dockerfile," # backwards compat
"
4798,6abeb8590f35c5251b9f100a667024febaeee06b,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
4799,6abeb8590f35c5251b9f100a667024febaeee06b,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4800,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4801,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4802,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4803,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/alpine/Dockerfile,"#		krb5-dev \
"
4804,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/alpine/Dockerfile,"#		openldap-dev \
"
4805,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/alpine/Dockerfile,"# configure: error: prove not found
"
4806,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4807,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4808,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4809,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4810,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4811,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4812,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4813,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4814,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4815,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4816,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4817,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4818,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4819,ba24350aa02996f75cf5b44eea0af082775cc8ec,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4820,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# vim:set ft=dockerfile:
"
4821,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# explicitly set user/group IDs
"
4822,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4823,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4824,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# grab gosu for easy step-down from root
"
4825,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4826,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4827,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4828,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4829,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
4830,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# arches officialy built by upstream
"
4831,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4832,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4833,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4834,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4835,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4836,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4837,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4838,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4839,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4840,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4841,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4842,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4843,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4844,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile," # backwards compat
"
4845,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4846,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4847,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4848,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
4849,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
4850,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4851,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4852,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4853,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4854,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4855,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4856,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4857,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4858,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4859,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4860,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4861,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.5/alpine/Dockerfile," # backwards compat
"
4862,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
4863,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/Dockerfile,"# explicitly set user/group IDs
"
4864,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
4865,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4866,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4867,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4868,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4869,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4870,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4871,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
4872,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# explicitly set user/group IDs
"
4873,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
4874,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4875,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4876,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4877,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4878,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# arches officialy built by upstream
"
4879,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4880,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4881,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4882,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4883,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4884,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4885,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4886,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4887,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4888,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4889,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4890,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile," # backwards compat
"
4891,fa36941d6835d8cd86f891d44fcf2c634ee261c2,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
4892,fa36941d6835d8cd86f891d44fcf2c634ee261c2,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4893,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4894,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4895,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4896,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
4897,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
4898,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
4899,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4900,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4901,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4902,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4903,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4904,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4905,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4906,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4907,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4908,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4909,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4910,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4911,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4912,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4913,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile," # backwards compat
"
4914,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
4915,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# explicitly set user/group IDs
"
4916,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4917,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4918,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
4919,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4920,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4921,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4922,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4923,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
4924,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# arches officialy built by upstream
"
4925,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4926,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4927,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4928,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4929,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4930,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4931,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4932,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4933,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4934,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4935,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4936,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4937,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4938,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile," # backwards compat
"
4939,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
4940,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# explicitly set user/group IDs
"
4941,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4942,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4943,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
4944,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4945,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4946,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4947,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4948,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
4949,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# arches officialy built by upstream
"
4950,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4951,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4952,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4953,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4954,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4955,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4956,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4957,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4958,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4959,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4960,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4961,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4962,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4963,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile," # backwards compat
"
4964,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
4965,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# explicitly set user/group IDs
"
4966,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4967,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4968,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
4969,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4970,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4971,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4972,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4973,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
4974,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# arches officialy built by upstream
"
4975,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4976,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4977,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4978,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4979,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4980,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4981,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4982,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4983,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4984,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4985,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4986,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4987,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4988,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile," # backwards compat
"
4989,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# vim:set ft=dockerfile:
"
4990,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# explicitly set user/group IDs
"
4991,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4992,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4993,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# grab gosu for easy step-down from root
"
4994,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4995,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4996,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4997,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4998,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
4999,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# arches officialy built by upstream
"
5000,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5001,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
5002,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5003,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5004,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5005,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5006,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5007,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5008,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5009,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
5010,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5011,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
5012,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5013,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile," # backwards compat
"
5014,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
5015,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.3/Dockerfile,"# explicitly set user/group IDs
"
5016,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
5017,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5018,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5019,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
5020,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.2/Dockerfile,"# explicitly set user/group IDs
"
5021,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
5022,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5023,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5024,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5025,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5026,1c0bc9d905d569fead777b9b8e3836e8af1c394c,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
5027,1c0bc9d905d569fead777b9b8e3836e8af1c394c,/9.5/Dockerfile,"# explicitly set user/group IDs
"
5028,1c0bc9d905d569fead777b9b8e3836e8af1c394c,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
5029,1c0bc9d905d569fead777b9b8e3836e8af1c394c,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5030,1c0bc9d905d569fead777b9b8e3836e8af1c394c,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5031,1c0bc9d905d569fead777b9b8e3836e8af1c394c,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5032,1c0bc9d905d569fead777b9b8e3836e8af1c394c,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5033,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
5034,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# explicitly set user/group IDs
"
5035,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
5036,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
5037,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
5038,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5039,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5040,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
5041,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5042,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
5043,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# arches officialy built by upstream
"
5044,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5045,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
5046,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5047,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5048,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5049,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5050,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5051,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5052,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5053,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
5054,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5055,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5056,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5057,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile," # backwards compat
"
5058,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5059,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5060,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
5061,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
5062,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5063,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5064,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5065,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5066,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5067,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5068,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5069,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5070,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
5071,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"# explicitly set user/group IDs
"
5072,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
5073,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
5074,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
5075,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5076,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5077,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
5078,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5079,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
5080,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"# arches officialy built by upstream
"
5081,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5082,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
5083,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5084,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5085,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5086,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5087,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5088,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5089,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5090,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
5091,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5092,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
5093,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5094,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.4/Dockerfile," # backwards compat
"
5095,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5096,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5097,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
5098,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
5099,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5100,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5101,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5102,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5103,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5104,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5105,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5106,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5107,1e7af691a3981ec1c86d23d585dcebd9154d1cd0,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
5108,1e7af691a3981ec1c86d23d585dcebd9154d1cd0,/9.4/Dockerfile,"# explicitly set user/group IDs
"
5109,1e7af691a3981ec1c86d23d585dcebd9154d1cd0,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
5110,1e7af691a3981ec1c86d23d585dcebd9154d1cd0,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5111,1e7af691a3981ec1c86d23d585dcebd9154d1cd0,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5112,1e7af691a3981ec1c86d23d585dcebd9154d1cd0,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5113,1e7af691a3981ec1c86d23d585dcebd9154d1cd0,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5114,1e7af691a3981ec1c86d23d585dcebd9154d1cd0,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5115,1e7af691a3981ec1c86d23d585dcebd9154d1cd0,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5116,1e7af691a3981ec1c86d23d585dcebd9154d1cd0,/9.4/Dockerfile," # backwards compat
"
5117,762e07937086fb43082ab1523ac9d0191c2c347f,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
5118,762e07937086fb43082ab1523ac9d0191c2c347f,/9.4/Dockerfile,"# explicitly set user/group IDs
"
5119,762e07937086fb43082ab1523ac9d0191c2c347f,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
5120,762e07937086fb43082ab1523ac9d0191c2c347f,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5121,762e07937086fb43082ab1523ac9d0191c2c347f,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5122,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5123,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5124,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5125,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
5126,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
5127,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
5128,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5129,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5130,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5131,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5132,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5133,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5134,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5135,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5136,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5137,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5138,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5139,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5140,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5141,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5142,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile," # backwards compat
"
5143,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5144,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5145,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5146,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"#		krb5-dev \
"
5147,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"#		openldap-dev \
"
5148,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# configure: error: prove not found
"
5149,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5150,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5151,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5152,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5153,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5154,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5155,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5156,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5157,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5158,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5159,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5160,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5161,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5162,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5163,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile," # backwards compat
"
5164,c01405b7c324350cc796ba9e861326aee158f75e,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
5165,c01405b7c324350cc796ba9e861326aee158f75e,/9.2/Dockerfile,"# explicitly set user/group IDs
"
5166,c01405b7c324350cc796ba9e861326aee158f75e,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
5167,c01405b7c324350cc796ba9e861326aee158f75e,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5168,c01405b7c324350cc796ba9e861326aee158f75e,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5169,c01405b7c324350cc796ba9e861326aee158f75e,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5170,c01405b7c324350cc796ba9e861326aee158f75e,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5171,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5172,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5173,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5174,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
5175,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
5176,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5177,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5178,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5179,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5180,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5181,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5182,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5183,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5184,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5185,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5186,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5187,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5188,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile," # backwards compat
"
5189,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5190,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5191,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
5192,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
5193,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5194,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5195,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5196,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5197,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5198,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"# tzdata adds around 1Mb to image size, but it is suggested by Django documentation that timezone should be set for performance reasons: http://bit.ly/2fMYhh1
"
5199,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5200,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5201,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/13/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5202,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/13/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
5203,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/13/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5204,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/13/alpine/Dockerfile,"#		krb5-dev \
"
5205,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/13/alpine/Dockerfile,"#		openldap-dev \
"
5206,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/13/alpine/Dockerfile,"# configure: error: prove not found
"
5207,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/13/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5208,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/13/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5209,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/13/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5210,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/13/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5211,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/13/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5212,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/13/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5213,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/13/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5214,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/13/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5215,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/13/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5216,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/13/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5217,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/13/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5218,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/13/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5219,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/13/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5220,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/13/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5221,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# vim:set ft=dockerfile:
"
5222,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# explicitly set user/group IDs
"
5223,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
5224,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
5225,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
5226,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5227,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5228,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
5229,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
5230,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5231,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
5232,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# arches officialy built by upstream
"
5233,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5234,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
5235,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5236,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5237,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5238,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5239,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5240,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5241,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5242,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
5243,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5244,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
5245,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5246,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile," # backwards compat
"
5247,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5248,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5249,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5250,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
5251,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
5252,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
5253,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5254,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5255,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
5256,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5257,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5258,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5259,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5260,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5261,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5262,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5263,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5264,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5265,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5266,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5267,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5268,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5269,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile," # backwards compat
"
5270,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5271,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5272,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5273,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
5274,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
5275,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
5276,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5277,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5278,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5279,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5280,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5281,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5282,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5283,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5284,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5285,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5286,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5287,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5288,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5289,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5290,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile," # backwards compat
"
5291,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
5292,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/Dockerfile,"# explicitly set user/group IDs
"
5293,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
5294,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5295,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5296,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5297,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5298,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5299,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5300,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.6/Dockerfile," # backwards compat
"
5301,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5302,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
5303,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5304,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
5305,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
5306,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
5307,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5308,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5309,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5310,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5311,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5312,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5313,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5314,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5315,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5316,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5317,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5318,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5319,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5320,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5321,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile," # backwards compat
"
5322,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
5323,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.5/Dockerfile,"# explicitly set user/group IDs
"
5324,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
5325,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5326,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5327,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5328,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5329,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
5330,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# explicitly set user/group IDs
"
5331,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
5332,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
5333,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
5334,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5335,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5336,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
5337,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
5338,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5339,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
5340,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# arches officialy built by upstream
"
5341,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5342,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
5343,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5344,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5345,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5346,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5347,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5348,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5349,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5350,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
5351,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5352,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
5353,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5354,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile," # backwards compat
"
5355,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
5356,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# explicitly set user/group IDs
"
5357,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
5358,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
5359,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
5360,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5361,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5362,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
5363,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5364,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
5365,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# arches officialy built by upstream
"
5366,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5367,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
5368,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5369,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5370,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5371,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5372,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5373,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5374,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5375,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
5376,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5377,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
5378,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5379,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.5/Dockerfile," # backwards compat
"
5380,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5381,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5382,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5383,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
5384,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
5385,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5386,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5387,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5388,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5389,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5390,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5391,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5392,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5393,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5394,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5395,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5396,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5397,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile," # backwards compat
"
5398,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5399,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5400,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
5401,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
5402,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5403,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5404,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5405,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5406,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5407,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5408,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5409,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5410,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5411,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5412,123aedc09bc067740fb28921c500ded83c018bd4,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5413,123aedc09bc067740fb28921c500ded83c018bd4,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5414,123aedc09bc067740fb28921c500ded83c018bd4,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
5415,123aedc09bc067740fb28921c500ded83c018bd4,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
5416,123aedc09bc067740fb28921c500ded83c018bd4,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5417,123aedc09bc067740fb28921c500ded83c018bd4,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5418,123aedc09bc067740fb28921c500ded83c018bd4,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5419,123aedc09bc067740fb28921c500ded83c018bd4,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5420,123aedc09bc067740fb28921c500ded83c018bd4,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5421,123aedc09bc067740fb28921c500ded83c018bd4,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5422,123aedc09bc067740fb28921c500ded83c018bd4,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5423,123aedc09bc067740fb28921c500ded83c018bd4,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5424,123aedc09bc067740fb28921c500ded83c018bd4,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5425,123aedc09bc067740fb28921c500ded83c018bd4,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5426,123aedc09bc067740fb28921c500ded83c018bd4,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5427,123aedc09bc067740fb28921c500ded83c018bd4,/9.5/alpine/Dockerfile," # backwards compat
"
5428,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5429,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5430,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5431,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
5432,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
5433,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
5434,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5435,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5436,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5437,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5438,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5439,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5440,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5441,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5442,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5443,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5444,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5445,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5446,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5447,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5448,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile," # backwards compat
"
5449,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5450,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5451,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5452,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"#		krb5-dev \
"
5453,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"#		openldap-dev \
"
5454,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# configure: error: prove not found
"
5455,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5456,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5457,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5458,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5459,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5460,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5461,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5462,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5463,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5464,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5465,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5466,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5467,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5468,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5469,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile," # backwards compat
"
5470,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
5471,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5472,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
5473,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5474,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5475,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
5476,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.6/Dockerfile,"# explicitly set user/group IDs
"
5477,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
5478,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5479,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5480,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5481,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5482,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5483,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
5484,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5485,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
5486,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5487,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5488,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5489,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5490,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5491,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
5492,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
5493,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
5494,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5495,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5496,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5497,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5498,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5499,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5500,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5501,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5502,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5503,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5504,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5505,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5506,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/alpine/Dockerfile," # backwards compat
"
5507,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5508,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5509,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5510,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"#		krb5-dev \
"
5511,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"#		openldap-dev \
"
5512,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# configure: error: prove not found
"
5513,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5514,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5515,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5516,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5517,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5518,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5519,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5520,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5521,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5522,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5523,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5524,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5525,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5526,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5527,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile," # backwards compat
"
5528,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5529,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5530,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
5531,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
5532,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5533,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5534,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5535,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5536,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5537,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5538,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5539,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5540,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5541,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5542,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5543,bfa7152926890a27e9fd8925fdffa824c353480a,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
5544,bfa7152926890a27e9fd8925fdffa824c353480a,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5545,bfa7152926890a27e9fd8925fdffa824c353480a,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
5546,bfa7152926890a27e9fd8925fdffa824c353480a,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5547,bfa7152926890a27e9fd8925fdffa824c353480a,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5548,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5549,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
5550,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5551,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
5552,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
5553,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
5554,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5555,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5556,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5557,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5558,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5559,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5560,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5561,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5562,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5563,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5564,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5565,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5566,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5567,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5568,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile," # backwards compat
"
5569,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# vim:set ft=dockerfile:
"
5570,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# explicitly set user/group IDs
"
5571,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
5572,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
5573,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# grab gosu for easy step-down from root
"
5574,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5575,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5576,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
5577,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5578,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
5579,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# arches officialy built by upstream
"
5580,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5581,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
5582,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5583,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5584,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5585,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5586,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5587,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5588,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5589,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
5590,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5591,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
5592,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5593,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile," # backwards compat
"
5594,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# vim:set ft=dockerfile:
"
5595,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# explicitly set user/group IDs
"
5596,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
5597,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
5598,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# grab gosu for easy step-down from root
"
5599,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5600,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5601,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
5602,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5603,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
5604,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# arches officialy built by upstream
"
5605,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5606,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
5607,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5608,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5609,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5610,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5611,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5612,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5613,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5614,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
5615,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5616,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
5617,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5618,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile," # backwards compat
"
5619,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5620,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
5621,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5622,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"#		krb5-dev \
"
5623,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"#		openldap-dev \
"
5624,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# configure: error: prove not found
"
5625,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5626,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5627,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5628,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5629,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5630,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5631,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5632,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5633,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5634,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5635,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5636,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5637,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5638,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5639,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
5640,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# explicitly set user/group IDs
"
5641,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
5642,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
5643,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
5644,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5645,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5646,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
5647,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
5648,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5649,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
5650,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# arches officialy built by upstream
"
5651,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5652,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
5653,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5654,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5655,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5656,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5657,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5658,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5659,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5660,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
5661,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5662,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
5663,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5664,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile," # backwards compat
"
5665,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5666,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5667,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5668,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
5669,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
5670,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
5671,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5672,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
5673,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5674,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5675,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5676,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5677,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5678,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5679,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5680,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5681,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5682,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5683,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5684,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5685,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile," # backwards compat
"
5686,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
5687,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5688,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
5689,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5690,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5691,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
5692,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5693,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
5694,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5695,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5696,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5697,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5698,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5699,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
5700,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
5701,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5702,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
5703,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5704,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5705,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5706,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5707,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5708,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5709,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5710,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5711,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5712,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5713,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5714,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5715,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile," # backwards compat
"
5716,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5717,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5718,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
5719,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
5720,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5721,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5722,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5723,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5724,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5725,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5726,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5727,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5728,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5729,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5730,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5731,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile," # backwards compat
"
5732,51e5166d69320581cb707d6fb102d3ba04803400,/8.4/Dockerfile,"# vim:set ft=dockerfile:
"
5733,51e5166d69320581cb707d6fb102d3ba04803400,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5734,51e5166d69320581cb707d6fb102d3ba04803400,/8.4/Dockerfile,"# grab gosu for easy step-down from root
"
5735,51e5166d69320581cb707d6fb102d3ba04803400,/8.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5736,51e5166d69320581cb707d6fb102d3ba04803400,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5737,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
5738,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.3/Dockerfile,"# explicitly set user/group IDs
"
5739,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
5740,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5741,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5742,51e5166d69320581cb707d6fb102d3ba04803400,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
5743,51e5166d69320581cb707d6fb102d3ba04803400,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5744,51e5166d69320581cb707d6fb102d3ba04803400,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
5745,51e5166d69320581cb707d6fb102d3ba04803400,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5746,51e5166d69320581cb707d6fb102d3ba04803400,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5747,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
5748,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5749,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
5750,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5751,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5752,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5753,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5754,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
5755,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
5756,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5757,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5758,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5759,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5760,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5761,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5762,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5763,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5764,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5765,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5766,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5767,5036e92f87fa8f3d559996e50e91596127bcc2c1,/8.4/Dockerfile,"# vim:set ft=dockerfile:
"
5768,5036e92f87fa8f3d559996e50e91596127bcc2c1,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5769,5036e92f87fa8f3d559996e50e91596127bcc2c1,/8.4/Dockerfile,"# grab gosu for easy step-down from root
"
5770,5036e92f87fa8f3d559996e50e91596127bcc2c1,/8.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5771,5036e92f87fa8f3d559996e50e91596127bcc2c1,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5772,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
5773,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5774,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
5775,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5776,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5777,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
5778,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"# explicitly set user/group IDs
"
5779,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
5780,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
5781,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
5782,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5783,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5784,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
5785,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5786,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
5787,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"# arches officialy built by upstream
"
5788,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5789,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
5790,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5791,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5792,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5793,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5794,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5795,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5796,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5797,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
5798,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5799,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5800,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5801,91939daa3f42d2796952f03353534cd87d181ccc,/9.5/Dockerfile," # backwards compat
"
5802,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5803,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5804,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5805,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"#		krb5-dev \
"
5806,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"#		openldap-dev \
"
5807,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# configure: error: prove not found
"
5808,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5809,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5810,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5811,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5812,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5813,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5814,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5815,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5816,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5817,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5818,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5819,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5820,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5821,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5822,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5823,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
5824,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5825,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
5826,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
5827,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
5828,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5829,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5830,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5831,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5832,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5833,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5834,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5835,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5836,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5837,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5838,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5839,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5840,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5841,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5842,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.5/alpine/Dockerfile," # backwards compat
"
5843,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5844,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5845,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5846,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
5847,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
5848,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5849,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5850,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5851,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5852,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5853,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5854,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5855,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5856,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5857,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5858,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5859,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile," # backwards compat
"
5860,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5861,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5862,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5863,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
5864,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
5865,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
5866,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5867,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5868,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5869,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5870,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5871,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5872,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5873,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5874,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5875,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5876,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5877,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5878,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5879,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5880,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile," # backwards compat
"
5881,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# vim:set ft=dockerfile:
"
5882,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# explicitly set user/group IDs
"
5883,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# grab gosu for easy step-down from root
"
5884,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5885,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5886,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5887,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# arches officialy built by upstream
"
5888,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5889,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5890,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5891,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5892,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5893,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5894,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5895,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5896,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5897,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5898,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5899,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile," # backwards compat
"
5900,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5901,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5902,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5903,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
5904,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
5905,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
5906,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5907,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5908,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5909,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5910,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5911,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5912,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5913,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5914,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5915,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5916,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5917,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5918,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5919,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/alpine/Dockerfile," # backwards compat
"
5920,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
5921,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.3/Dockerfile,"# explicitly set user/group IDs
"
5922,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
5923,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5924,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5925,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
5926,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5927,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.3/Dockerfile,"# arches officialy built by upstream
"
5928,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5929,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5930,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5931,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5932,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5933,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5934,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5935,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5936,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5937,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5938,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5939,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.3/Dockerfile," # backwards compat
"
5940,94aee2022d2014230fad3d054c048678137281d1,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
5941,94aee2022d2014230fad3d054c048678137281d1,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5942,94aee2022d2014230fad3d054c048678137281d1,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
5943,94aee2022d2014230fad3d054c048678137281d1,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5944,94aee2022d2014230fad3d054c048678137281d1,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5945,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
5946,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5947,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
5948,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5949,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5950,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5951,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5952,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
5953,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
5954,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5955,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5956,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5957,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5958,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5959,c6484bf22f5a0f72a49658ae9e5569bc01785eff,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
5960,c6484bf22f5a0f72a49658ae9e5569bc01785eff,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5961,c6484bf22f5a0f72a49658ae9e5569bc01785eff,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5962,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# vim:set ft=dockerfile:
"
5963,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# explicitly set user/group IDs
"
5964,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
5965,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
5966,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# grab gosu for easy step-down from root
"
5967,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5968,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5969,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
5970,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5971,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
5972,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# arches officialy built by upstream
"
5973,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5974,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
5975,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5976,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5977,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5978,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5979,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5980,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5981,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5982,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
5983,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5984,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
5985,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5986,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile," # backwards compat
"
5987,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
5988,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/Dockerfile,"# explicitly set user/group IDs
"
5989,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
5990,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5991,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5992,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5993,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/Dockerfile,"# arches officialy built by upstream
"
5994,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5995,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5996,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5997,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5998,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5999,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6000,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6001,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6002,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6003,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6004,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6005,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/Dockerfile," # backwards compat
"
6006,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6007,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6008,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6009,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
6010,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
6011,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
6012,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6013,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6014,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
6015,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6016,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6017,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6018,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6019,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6020,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6021,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6022,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6023,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6024,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6025,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6026,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6027,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6028,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.3/alpine/Dockerfile," # backwards compat
"
6029,9375cde5569bcfbe814a2788d97c1f8f9590e514,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
6030,9375cde5569bcfbe814a2788d97c1f8f9590e514,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6031,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6032,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
6033,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6034,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"#		krb5-dev \
"
6035,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"#		openldap-dev \
"
6036,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# configure: error: prove not found
"
6037,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6038,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6039,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6040,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6041,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6042,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6043,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6044,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6045,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6046,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6047,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6048,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6049,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6050,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6051,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile," # backwards compat
"
6052,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
6053,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
6054,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
6055,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6056,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6057,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# vim:set ft=dockerfile:
"
6058,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# explicitly set user/group IDs
"
6059,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
6060,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
6061,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
6062,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6063,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6064,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6065,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
6066,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6067,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
6068,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# arches officialy built by upstream
"
6069,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6070,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
6071,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6072,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6073,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6074,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6075,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6076,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6077,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6078,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
6079,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6080,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
6081,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6082,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile," # backwards compat
"
6083,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
6084,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.4/Dockerfile,"# explicitly set user/group IDs
"
6085,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
6086,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6087,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6088,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
6089,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# explicitly set user/group IDs
"
6090,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
6091,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
6092,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
6093,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6094,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6095,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6096,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6097,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# arches officialy built by upstream
"
6098,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6099,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6100,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6101,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6102,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6103,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6104,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6105,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6106,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6107,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6108,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6109,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile," # backwards compat
"
6110,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
6111,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
6112,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
6113,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6114,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6115,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
6116,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.5/Dockerfile,"# explicitly set user/group IDs
"
6117,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
6118,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6119,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6120,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
6121,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/Dockerfile,"# explicitly set user/group IDs
"
6122,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
6123,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6124,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6125,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6126,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6127,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6128,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6129,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/Dockerfile," # backwards compat
"
6130,a869eeccfb98c9653fca9f135f3bafa758c6f4f7,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
6131,a869eeccfb98c9653fca9f135f3bafa758c6f4f7,/9.5/Dockerfile,"# explicitly set user/group IDs
"
6132,a869eeccfb98c9653fca9f135f3bafa758c6f4f7,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
6133,a869eeccfb98c9653fca9f135f3bafa758c6f4f7,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6134,a869eeccfb98c9653fca9f135f3bafa758c6f4f7,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6135,a869eeccfb98c9653fca9f135f3bafa758c6f4f7,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6136,a869eeccfb98c9653fca9f135f3bafa758c6f4f7,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6137,a869eeccfb98c9653fca9f135f3bafa758c6f4f7,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6138,a869eeccfb98c9653fca9f135f3bafa758c6f4f7,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6139,a869eeccfb98c9653fca9f135f3bafa758c6f4f7,/9.5/Dockerfile," # backwards compat
"
6140,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
6141,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/Dockerfile,"# explicitly set user/group IDs
"
6142,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
6143,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6144,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6145,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6146,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6147,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6148,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6149,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/Dockerfile," # backwards compat
"
6150,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
6151,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# explicitly set user/group IDs
"
6152,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
6153,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
6154,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
6155,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6156,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6157,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6158,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6159,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
6160,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# arches officialy built by upstream
"
6161,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6162,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
6163,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6164,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6165,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6166,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6167,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6168,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6169,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6170,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
6171,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6172,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
6173,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6174,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile," # backwards compat
"
6175,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6176,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6177,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6178,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"#		krb5-dev \
"
6179,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"#		openldap-dev \
"
6180,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# configure: error: prove not found
"
6181,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6182,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6183,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6184,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6185,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6186,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6187,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6188,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6189,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6190,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6191,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6192,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6193,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6194,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6195,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile," # backwards compat
"
6196,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6197,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
6198,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6199,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
6200,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
6201,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
6202,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6203,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6204,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6205,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6206,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6207,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6208,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6209,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6210,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6211,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6212,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6213,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6214,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6215,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6216,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.5/alpine/Dockerfile," # backwards compat
"
6217,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6218,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
6219,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6220,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
6221,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
6222,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
6223,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6224,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6225,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6226,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
6227,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6228,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6229,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6230,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6231,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6232,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6233,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6234,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6235,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6236,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6237,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile," # backwards compat
"
6238,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6239,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6240,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6241,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/10/alpine/Dockerfile,"#		krb5-dev \
"
6242,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/10/alpine/Dockerfile,"#		openldap-dev \
"
6243,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/10/alpine/Dockerfile,"# configure: error: prove not found
"
6244,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6245,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6246,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6247,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6248,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6249,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6250,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6251,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6252,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6253,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6254,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6255,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6256,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6257,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6258,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/10/alpine/Dockerfile," # backwards compat
"
6259,2cab5040341f46331367f8766b4d249a5b7a9366,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
6260,2cab5040341f46331367f8766b4d249a5b7a9366,/9.5/Dockerfile,"# explicitly set user/group IDs
"
6261,2cab5040341f46331367f8766b4d249a5b7a9366,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
6262,2cab5040341f46331367f8766b4d249a5b7a9366,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6263,2cab5040341f46331367f8766b4d249a5b7a9366,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6264,2cab5040341f46331367f8766b4d249a5b7a9366,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6265,2cab5040341f46331367f8766b4d249a5b7a9366,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6266,2cab5040341f46331367f8766b4d249a5b7a9366,/9.5/Dockerfile,"# arches officialy built by upstream
"
6267,2cab5040341f46331367f8766b4d249a5b7a9366,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6268,2cab5040341f46331367f8766b4d249a5b7a9366,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6269,2cab5040341f46331367f8766b4d249a5b7a9366,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6270,2cab5040341f46331367f8766b4d249a5b7a9366,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6271,2cab5040341f46331367f8766b4d249a5b7a9366,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6272,2cab5040341f46331367f8766b4d249a5b7a9366,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6273,2cab5040341f46331367f8766b4d249a5b7a9366,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6274,2cab5040341f46331367f8766b4d249a5b7a9366,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6275,2cab5040341f46331367f8766b4d249a5b7a9366,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6276,2cab5040341f46331367f8766b4d249a5b7a9366,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6277,2cab5040341f46331367f8766b4d249a5b7a9366,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6278,2cab5040341f46331367f8766b4d249a5b7a9366,/9.5/Dockerfile," # backwards compat
"
6279,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
6280,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# explicitly set user/group IDs
"
6281,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
6282,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
6283,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
6284,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6285,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6286,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6287,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6288,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
6289,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# arches officialy built by upstream
"
6290,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6291,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
6292,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6293,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6294,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6295,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6296,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6297,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6298,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6299,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
6300,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6301,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6302,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6303,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile," # backwards compat
"
6304,a6d4922823aa8011513bb9c160c26c689301823a,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
6305,a6d4922823aa8011513bb9c160c26c689301823a,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
6306,a6d4922823aa8011513bb9c160c26c689301823a,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
6307,a6d4922823aa8011513bb9c160c26c689301823a,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6308,a6d4922823aa8011513bb9c160c26c689301823a,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6309,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
6310,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/Dockerfile,"# explicitly set user/group IDs
"
6311,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
6312,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6313,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6314,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6315,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6316,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6317,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6318,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/Dockerfile," # backwards compat
"
6319,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
6320,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# explicitly set user/group IDs
"
6321,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
6322,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6323,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6324,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# arches officialy built by upstream
"
6325,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6326,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6327,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6328,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6329,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6330,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6331,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6332,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6333,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6334,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6335,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6336,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile," # backwards compat
"
6337,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6338,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6339,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
6340,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
6341,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6342,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6343,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6344,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6345,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6346,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6347,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6348,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6349,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# vim:set ft=dockerfile:
"
6350,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# explicitly set user/group IDs
"
6351,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
6352,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
6353,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# grab gosu for easy step-down from root
"
6354,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6355,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6356,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6357,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6358,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
6359,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# arches officialy built by upstream
"
6360,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6361,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
6362,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6363,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6364,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6365,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6366,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6367,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6368,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6369,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
6370,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6371,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
6372,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6373,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile," # backwards compat
"
6374,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6375,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6376,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6377,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
6378,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
6379,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
6380,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6381,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6382,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6383,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6384,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6385,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6386,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6387,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6388,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6389,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6390,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6391,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6392,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6393,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6394,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile," # backwards compat
"
6395,d2b38544770a63fed430694a7aed33de3ad8b808,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6396,d2b38544770a63fed430694a7aed33de3ad8b808,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6397,d2b38544770a63fed430694a7aed33de3ad8b808,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
6398,d2b38544770a63fed430694a7aed33de3ad8b808,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
6399,d2b38544770a63fed430694a7aed33de3ad8b808,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6400,d2b38544770a63fed430694a7aed33de3ad8b808,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6401,d2b38544770a63fed430694a7aed33de3ad8b808,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6402,d2b38544770a63fed430694a7aed33de3ad8b808,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6403,d2b38544770a63fed430694a7aed33de3ad8b808,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6404,d2b38544770a63fed430694a7aed33de3ad8b808,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6405,d2b38544770a63fed430694a7aed33de3ad8b808,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6406,d2b38544770a63fed430694a7aed33de3ad8b808,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6407,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6408,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
6409,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6410,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/12/alpine/Dockerfile,"#		krb5-dev \
"
6411,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/12/alpine/Dockerfile,"#		openldap-dev \
"
6412,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/12/alpine/Dockerfile,"# configure: error: prove not found
"
6413,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6414,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6415,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6416,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6417,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6418,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6419,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6420,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6421,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6422,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6423,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6424,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6425,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6426,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6427,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
6428,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/Dockerfile,"# explicitly set user/group IDs
"
6429,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
6430,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6431,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6432,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6433,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6434,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6435,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6436,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# vim:set ft=dockerfile:
"
6437,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# explicitly set user/group IDs
"
6438,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
6439,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
6440,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
6441,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6442,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6443,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6444,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
6445,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6446,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# see note below about ""*.pyc"" files
"
6447,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# arches officialy built by upstream
"
6448,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6449,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
6450,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6451,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# we need DEBIAN_FRONTEND on postgresql-13 for slapd (""Please enter the password for the admin entry in your LDAP directory.""); see https://bugs.debian.org/929417
"
6452,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6453,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6454,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6455,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6456,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6457,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6458,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
6459,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6460,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
6461,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6462,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile," # backwards compat
"
6463,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
6464,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
6465,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
6466,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6467,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6468,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
6469,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
6470,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
6471,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6472,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6473,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
6474,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.3/Dockerfile,"# explicitly set user/group IDs
"
6475,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
6476,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6477,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6478,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6479,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6480,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6481,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
6482,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# explicitly set user/group IDs
"
6483,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
6484,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6485,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6486,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6487,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# arches officialy built by upstream
"
6488,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6489,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6490,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6491,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6492,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6493,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6494,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6495,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6496,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6497,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6498,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6499,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile," # backwards compat
"
6500,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6501,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6502,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6503,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
6504,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
6505,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
6506,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6507,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6508,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6509,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6510,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6511,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6512,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6513,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6514,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6515,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6516,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6517,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6518,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6519,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile," # backwards compat
"
6520,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6521,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6522,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
6523,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
6524,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6525,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6526,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6527,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6528,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6529,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6530,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6531,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6532,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6533,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6534,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
6535,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
6536,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6537,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6538,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6539,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6540,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6541,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6542,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6543,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6544,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
6545,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
6546,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
6547,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6548,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6549,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
6550,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# explicitly set user/group IDs
"
6551,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
6552,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
6553,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
6554,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6555,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6556,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6557,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6558,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
6559,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# arches officialy built by upstream
"
6560,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6561,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
6562,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6563,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6564,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6565,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6566,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6567,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6568,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6569,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
6570,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6571,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
6572,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6573,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile," # backwards compat
"
6574,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6575,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6576,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6577,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
6578,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
6579,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
6580,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6581,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6582,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
6583,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6584,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6585,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6586,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6587,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6588,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6589,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6590,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6591,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6592,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6593,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6594,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6595,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile," # backwards compat
"
6596,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6597,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6598,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6599,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
6600,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
6601,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
6602,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6603,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6604,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6605,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6606,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6607,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6608,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6609,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6610,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6611,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6612,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6613,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6614,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6615,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6616,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile," # backwards compat
"
6617,639f83fb14161c8be60119b97bb9f88796776058,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
6618,639f83fb14161c8be60119b97bb9f88796776058,/9.6/Dockerfile,"# explicitly set user/group IDs
"
6619,639f83fb14161c8be60119b97bb9f88796776058,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
6620,639f83fb14161c8be60119b97bb9f88796776058,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6621,639f83fb14161c8be60119b97bb9f88796776058,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6622,639f83fb14161c8be60119b97bb9f88796776058,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6623,639f83fb14161c8be60119b97bb9f88796776058,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6624,639f83fb14161c8be60119b97bb9f88796776058,/9.6/Dockerfile,"# arches officialy built by upstream
"
6625,639f83fb14161c8be60119b97bb9f88796776058,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6626,639f83fb14161c8be60119b97bb9f88796776058,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6627,639f83fb14161c8be60119b97bb9f88796776058,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6628,639f83fb14161c8be60119b97bb9f88796776058,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6629,639f83fb14161c8be60119b97bb9f88796776058,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6630,639f83fb14161c8be60119b97bb9f88796776058,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6631,639f83fb14161c8be60119b97bb9f88796776058,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6632,639f83fb14161c8be60119b97bb9f88796776058,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6633,639f83fb14161c8be60119b97bb9f88796776058,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6634,639f83fb14161c8be60119b97bb9f88796776058,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6635,639f83fb14161c8be60119b97bb9f88796776058,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6636,639f83fb14161c8be60119b97bb9f88796776058,/9.6/Dockerfile," # backwards compat
"
6637,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6638,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
6639,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6640,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/10/alpine/Dockerfile,"#		krb5-dev \
"
6641,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/10/alpine/Dockerfile,"#		openldap-dev \
"
6642,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/10/alpine/Dockerfile,"# configure: error: prove not found
"
6643,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6644,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6645,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6646,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6647,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6648,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6649,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6650,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6651,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6652,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6653,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6654,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6655,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6656,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6657,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/10/alpine/Dockerfile," # backwards compat
"
6658,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
6659,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.4/Dockerfile,"# explicitly set user/group IDs
"
6660,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
6661,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6662,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6663,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.4/Dockerfile,"# arches officialy built by upstream
"
6664,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6665,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6666,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6667,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6668,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6669,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6670,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6671,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6672,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6673,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6674,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6675,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.4/Dockerfile," # backwards compat
"
6676,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
6677,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# explicitly set user/group IDs
"
6678,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
6679,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
6680,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
6681,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6682,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6683,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6684,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
6685,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6686,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
6687,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# arches officialy built by upstream
"
6688,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6689,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
6690,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6691,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6692,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6693,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6694,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6695,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6696,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6697,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
6698,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6699,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
6700,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6701,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile," # backwards compat
"
6702,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
6703,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# explicitly set user/group IDs
"
6704,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
6705,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6706,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6707,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# arches officialy built by upstream
"
6708,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6709,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6710,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6711,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6712,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6713,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6714,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6715,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6716,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6717,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6718,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6719,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile," # backwards compat
"
6720,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6721,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6722,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6723,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"#		krb5-dev \
"
6724,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"#		openldap-dev \
"
6725,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# configure: error: prove not found
"
6726,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6727,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6728,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6729,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6730,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6731,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6732,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6733,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6734,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6735,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6736,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6737,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6738,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6739,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6740,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile," # backwards compat
"
6741,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# vim:set ft=dockerfile:
"
6742,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# explicitly set user/group IDs
"
6743,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
6744,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
6745,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# grab gosu for easy step-down from root
"
6746,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6747,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6748,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6749,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6750,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
6751,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# arches officialy built by upstream
"
6752,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6753,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
6754,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6755,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6756,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6757,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6758,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6759,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6760,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6761,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
6762,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6763,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
6764,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6765,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile," # backwards compat
"
6766,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# vim:set ft=dockerfile:
"
6767,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# explicitly set user/group IDs
"
6768,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
6769,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
6770,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# grab gosu for easy step-down from root
"
6771,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6772,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6773,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6774,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6775,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
6776,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# arches officialy built by upstream
"
6777,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6778,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
6779,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6780,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6781,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6782,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6783,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6784,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6785,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6786,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
6787,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6788,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
6789,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6790,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile," # backwards compat
"
6791,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
6792,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
6793,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
6794,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6795,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6796,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
6797,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/Dockerfile,"# explicitly set user/group IDs
"
6798,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
6799,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6800,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6801,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6802,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6803,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6804,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6805,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
6806,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/Dockerfile,"# explicitly set user/group IDs
"
6807,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
6808,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6809,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6810,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6811,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6812,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6813,09b09edbea4339a008ef81f00475330172fe7630,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
6814,09b09edbea4339a008ef81f00475330172fe7630,/9.5/Dockerfile,"# explicitly set user/group IDs
"
6815,09b09edbea4339a008ef81f00475330172fe7630,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
6816,09b09edbea4339a008ef81f00475330172fe7630,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6817,09b09edbea4339a008ef81f00475330172fe7630,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6818,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6819,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6820,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
6821,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
6822,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6823,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6824,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6825,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6826,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6827,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6828,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6829,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6830,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6831,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6832,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6833,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.4/alpine/Dockerfile," # backwards compat
"
6834,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# vim:set ft=dockerfile:
"
6835,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# explicitly set user/group IDs
"
6836,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
6837,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
6838,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# grab gosu for easy step-down from root
"
6839,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6840,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6841,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6842,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6843,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
6844,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# arches officialy built by upstream
"
6845,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6846,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
6847,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6848,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6849,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6850,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6851,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6852,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6853,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6854,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
6855,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6856,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
6857,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6858,6d1f671dcd2c8d51484d19767a33c37110dd650f,/12/Dockerfile," # backwards compat
"
6859,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6860,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6861,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6862,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
6863,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
6864,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
6865,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6866,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6867,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6868,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6869,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6870,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6871,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6872,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6873,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6874,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6875,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6876,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6877,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6878,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6879,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile," # backwards compat
"
6880,63d966973d9593c0d9890b96f10ac73566913520,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
6881,63d966973d9593c0d9890b96f10ac73566913520,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
6882,63d966973d9593c0d9890b96f10ac73566913520,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
6883,63d966973d9593c0d9890b96f10ac73566913520,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6884,63d966973d9593c0d9890b96f10ac73566913520,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6885,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6886,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6887,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6888,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
6889,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
6890,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
6891,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6892,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6893,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6894,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6895,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6896,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6897,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6898,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6899,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6900,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6901,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6902,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6903,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6904,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6905,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile," # backwards compat
"
6906,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6907,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6908,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6909,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
6910,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
6911,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
6912,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6913,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6914,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6915,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6916,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6917,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6918,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6919,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6920,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6921,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6922,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6923,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6924,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6925,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6926,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile," # backwards compat
"
6927,fbfc076af59e0f1ac47023da27b2a4b1e34a808b,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
6928,fbfc076af59e0f1ac47023da27b2a4b1e34a808b,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
6929,fbfc076af59e0f1ac47023da27b2a4b1e34a808b,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
6930,fbfc076af59e0f1ac47023da27b2a4b1e34a808b,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6931,fbfc076af59e0f1ac47023da27b2a4b1e34a808b,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6932,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/8.4/Dockerfile,"# vim:set ft=dockerfile:
"
6933,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
6934,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/8.4/Dockerfile,"# grab gosu for easy step-down from root
"
6935,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/8.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6936,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6937,03f4064a045114f56fa445eb602339faaf79eeec,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6938,03f4064a045114f56fa445eb602339faaf79eeec,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6939,03f4064a045114f56fa445eb602339faaf79eeec,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
6940,03f4064a045114f56fa445eb602339faaf79eeec,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
6941,03f4064a045114f56fa445eb602339faaf79eeec,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6942,03f4064a045114f56fa445eb602339faaf79eeec,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6943,03f4064a045114f56fa445eb602339faaf79eeec,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6944,03f4064a045114f56fa445eb602339faaf79eeec,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6945,03f4064a045114f56fa445eb602339faaf79eeec,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6946,03f4064a045114f56fa445eb602339faaf79eeec,/9.2/alpine/Dockerfile,"# tzdata loading functionality is optional, and fails gracefully
#		tzdata \
"
6947,03f4064a045114f56fa445eb602339faaf79eeec,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6948,03f4064a045114f56fa445eb602339faaf79eeec,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6949,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
6950,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# explicitly set user/group IDs
"
6951,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
6952,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
6953,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
6954,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6955,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6956,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6957,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
6958,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6959,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
6960,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# arches officialy built by upstream
"
6961,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6962,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
6963,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6964,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6965,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6966,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6967,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6968,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6969,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6970,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
6971,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6972,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
6973,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6974,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile," # backwards compat
"
6975,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
6976,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
6977,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
6978,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6979,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6980,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6981,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6982,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6983,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
6984,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
6985,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# configure: error: prove not found
"
6986,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6987,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6988,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
6989,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6990,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6991,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6992,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6993,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6994,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6995,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6996,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6997,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6998,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6999,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7000,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7001,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7002,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile," # backwards compat
"
7003,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7004,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7005,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
7006,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
7007,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7008,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
7009,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7010,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7011,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7012,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7013,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7014,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7015,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7016,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7017,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7018,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7019,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.3/alpine/Dockerfile," # backwards compat
"
7020,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7021,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
7022,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7023,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/11/alpine/Dockerfile,"#		krb5-dev \
"
7024,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/11/alpine/Dockerfile,"#		openldap-dev \
"
7025,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/11/alpine/Dockerfile,"# configure: error: prove not found
"
7026,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7027,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7028,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7029,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7030,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7031,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7032,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7033,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7034,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7035,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7036,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7037,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7038,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7039,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7040,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/11/alpine/Dockerfile," # backwards compat
"
7041,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
7042,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
7043,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
7044,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7045,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7046,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7047,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7048,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7049,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
7050,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
7051,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
7052,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7053,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7054,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7055,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7056,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7057,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7058,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7059,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7060,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7061,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7062,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7063,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7064,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7065,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7066,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile," # backwards compat
"
7067,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
7068,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/Dockerfile,"# explicitly set user/group IDs
"
7069,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
7070,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7071,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7072,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7073,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7074,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7075,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7076,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
7077,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# explicitly set user/group IDs
"
7078,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
7079,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7080,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7081,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# arches officialy built by upstream
"
7082,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7083,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7084,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7085,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7086,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7087,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7088,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7089,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7090,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7091,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7092,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7093,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile," # backwards compat
"
7094,03f4064a045114f56fa445eb602339faaf79eeec,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7095,03f4064a045114f56fa445eb602339faaf79eeec,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7096,03f4064a045114f56fa445eb602339faaf79eeec,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
7097,03f4064a045114f56fa445eb602339faaf79eeec,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
7098,03f4064a045114f56fa445eb602339faaf79eeec,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7099,03f4064a045114f56fa445eb602339faaf79eeec,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7100,03f4064a045114f56fa445eb602339faaf79eeec,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7101,03f4064a045114f56fa445eb602339faaf79eeec,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7102,03f4064a045114f56fa445eb602339faaf79eeec,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7103,03f4064a045114f56fa445eb602339faaf79eeec,/9.5/alpine/Dockerfile,"# tzdata loading functionality is optional, and fails gracefully
#		tzdata \
"
7104,03f4064a045114f56fa445eb602339faaf79eeec,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7105,03f4064a045114f56fa445eb602339faaf79eeec,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7106,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7107,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
7108,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7109,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"#		krb5-dev \
"
7110,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"#		openldap-dev \
"
7111,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# configure: error: prove not found
"
7112,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7113,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7114,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7115,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7116,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7117,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7118,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7119,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7120,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7121,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7122,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7123,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7124,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7125,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7126,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile," # backwards compat
"
7127,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7128,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7129,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7130,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
7131,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
7132,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
7133,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7134,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7135,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7136,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7137,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7138,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7139,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7140,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7141,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7142,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7143,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7144,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7145,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7146,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7147,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile," # backwards compat
"
7148,c6d76847c03ff9bc95ab11ebac769cf24e163ca6,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
7149,c6d76847c03ff9bc95ab11ebac769cf24e163ca6,/9.6/Dockerfile,"# explicitly set user/group IDs
"
7150,c6d76847c03ff9bc95ab11ebac769cf24e163ca6,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
7151,c6d76847c03ff9bc95ab11ebac769cf24e163ca6,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7152,c6d76847c03ff9bc95ab11ebac769cf24e163ca6,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7153,c6d76847c03ff9bc95ab11ebac769cf24e163ca6,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7154,c6d76847c03ff9bc95ab11ebac769cf24e163ca6,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7155,c6d76847c03ff9bc95ab11ebac769cf24e163ca6,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7156,c6d76847c03ff9bc95ab11ebac769cf24e163ca6,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7157,c6d76847c03ff9bc95ab11ebac769cf24e163ca6,/9.6/Dockerfile," # backwards compat
"
7158,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7159,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7160,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7161,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
7162,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
7163,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
7164,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7165,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7166,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7167,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7168,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7169,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7170,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7171,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7172,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7173,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7174,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7175,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7176,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7177,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7178,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile," # backwards compat
"
7179,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7180,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7181,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7182,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
7183,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
7184,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
7185,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7186,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7187,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7188,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7189,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7190,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7191,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7192,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7193,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7194,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7195,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7196,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7197,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7198,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile," # backwards compat
"
7199,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# vim:set ft=dockerfile:
"
7200,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# explicitly set user/group IDs
"
7201,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
7202,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
7203,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# grab gosu for easy step-down from root
"
7204,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7205,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7206,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7207,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
7208,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7209,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
7210,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# arches officialy built by upstream
"
7211,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7212,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
7213,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7214,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7215,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7216,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7217,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7218,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7219,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7220,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
7221,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7222,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
7223,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7224,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/11/Dockerfile," # backwards compat
"
7225,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7226,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7227,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7228,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
7229,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
7230,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
7231,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7232,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7233,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7234,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7235,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7236,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7237,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7238,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7239,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7240,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7241,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7242,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7243,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7244,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7245,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/alpine/Dockerfile," # backwards compat
"
7246,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
7247,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/Dockerfile,"# explicitly set user/group IDs
"
7248,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
7249,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7250,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7251,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7252,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7253,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7254,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7255,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.5/Dockerfile," # backwards compat
"
7256,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
7257,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.4/Dockerfile,"# explicitly set user/group IDs
"
7258,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
7259,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7260,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7261,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7262,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7263,639f83fb14161c8be60119b97bb9f88796776058,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7264,639f83fb14161c8be60119b97bb9f88796776058,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7265,639f83fb14161c8be60119b97bb9f88796776058,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7266,639f83fb14161c8be60119b97bb9f88796776058,/10/alpine/Dockerfile,"#		krb5-dev \
"
7267,639f83fb14161c8be60119b97bb9f88796776058,/10/alpine/Dockerfile,"#		openldap-dev \
"
7268,639f83fb14161c8be60119b97bb9f88796776058,/10/alpine/Dockerfile,"# configure: error: prove not found
"
7269,639f83fb14161c8be60119b97bb9f88796776058,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7270,639f83fb14161c8be60119b97bb9f88796776058,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7271,639f83fb14161c8be60119b97bb9f88796776058,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7272,639f83fb14161c8be60119b97bb9f88796776058,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7273,639f83fb14161c8be60119b97bb9f88796776058,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7274,639f83fb14161c8be60119b97bb9f88796776058,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7275,639f83fb14161c8be60119b97bb9f88796776058,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7276,639f83fb14161c8be60119b97bb9f88796776058,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7277,639f83fb14161c8be60119b97bb9f88796776058,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7278,639f83fb14161c8be60119b97bb9f88796776058,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7279,639f83fb14161c8be60119b97bb9f88796776058,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7280,639f83fb14161c8be60119b97bb9f88796776058,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7281,639f83fb14161c8be60119b97bb9f88796776058,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7282,639f83fb14161c8be60119b97bb9f88796776058,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7283,639f83fb14161c8be60119b97bb9f88796776058,/10/alpine/Dockerfile," # backwards compat
"
7284,639f83fb14161c8be60119b97bb9f88796776058,/10/Dockerfile,"# vim:set ft=dockerfile:
"
7285,639f83fb14161c8be60119b97bb9f88796776058,/10/Dockerfile,"# explicitly set user/group IDs
"
7286,639f83fb14161c8be60119b97bb9f88796776058,/10/Dockerfile,"# grab gosu for easy step-down from root
"
7287,639f83fb14161c8be60119b97bb9f88796776058,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7288,639f83fb14161c8be60119b97bb9f88796776058,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7289,639f83fb14161c8be60119b97bb9f88796776058,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7290,639f83fb14161c8be60119b97bb9f88796776058,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7291,639f83fb14161c8be60119b97bb9f88796776058,/10/Dockerfile,"# arches officialy built by upstream
"
7292,639f83fb14161c8be60119b97bb9f88796776058,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7293,639f83fb14161c8be60119b97bb9f88796776058,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7294,639f83fb14161c8be60119b97bb9f88796776058,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7295,639f83fb14161c8be60119b97bb9f88796776058,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7296,639f83fb14161c8be60119b97bb9f88796776058,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7297,639f83fb14161c8be60119b97bb9f88796776058,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7298,639f83fb14161c8be60119b97bb9f88796776058,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7299,639f83fb14161c8be60119b97bb9f88796776058,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7300,639f83fb14161c8be60119b97bb9f88796776058,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7301,639f83fb14161c8be60119b97bb9f88796776058,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7302,639f83fb14161c8be60119b97bb9f88796776058,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7303,639f83fb14161c8be60119b97bb9f88796776058,/10/Dockerfile," # backwards compat
"
7304,77b5f005d45f4b0747f5a719f329499b6ad454dc,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
7305,77b5f005d45f4b0747f5a719f329499b6ad454dc,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7306,ea490430aabd553f34656e8f0e846d2ed3c42930,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
7307,ea490430aabd553f34656e8f0e846d2ed3c42930,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7308,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
7309,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7310,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7311,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7312,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7313,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
7314,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
7315,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
7316,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7317,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7318,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7319,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7320,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7321,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7322,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7323,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7324,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7325,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7326,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7327,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7328,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7329,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7330,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile," # backwards compat
"
7331,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
7332,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/Dockerfile,"# explicitly set user/group IDs
"
7333,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
7334,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7335,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7336,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7337,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7338,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7339,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7340,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
7341,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/Dockerfile,"# explicitly set user/group IDs
"
7342,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
7343,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7344,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7345,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7346,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7347,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7348,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7349,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7350,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
7351,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
7352,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7353,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7354,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7355,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7356,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7357,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7358,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7359,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7360,09b09edbea4339a008ef81f00475330172fe7630,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
7361,09b09edbea4339a008ef81f00475330172fe7630,/9.1/Dockerfile,"# explicitly set user/group IDs
"
7362,09b09edbea4339a008ef81f00475330172fe7630,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
7363,09b09edbea4339a008ef81f00475330172fe7630,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7364,09b09edbea4339a008ef81f00475330172fe7630,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7365,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7366,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7367,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7368,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"#		krb5-dev \
"
7369,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"#		openldap-dev \
"
7370,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# configure: error: prove not found
"
7371,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7372,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7373,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7374,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7375,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7376,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7377,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7378,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7379,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7380,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7381,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7382,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7383,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7384,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7385,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile," # backwards compat
"
7386,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7387,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7388,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7389,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"#		krb5-dev \
"
7390,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"#		openldap-dev \
"
7391,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# configure: error: prove not found
"
7392,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7393,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7394,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7395,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7396,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7397,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7398,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7399,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7400,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7401,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7402,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7403,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7404,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7405,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7406,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile," # backwards compat
"
7407,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
7408,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# explicitly set user/group IDs
"
7409,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
7410,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7411,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7412,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# arches officialy built by upstream
"
7413,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7414,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7415,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7416,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7417,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7418,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7419,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7420,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7421,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7422,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7423,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7424,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile," # backwards compat
"
7425,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# vim:set ft=dockerfile:
"
7426,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# explicitly set user/group IDs
"
7427,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# grab gosu for easy step-down from root
"
7428,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7429,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7430,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7431,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7432,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# arches officialy built by upstream
"
7433,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7434,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7435,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7436,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7437,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7438,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7439,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7440,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7441,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7442,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7443,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7444,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile," # backwards compat
"
7445,01058c1847400919de5282ca825a7806a9dafcda,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7446,01058c1847400919de5282ca825a7806a9dafcda,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7447,01058c1847400919de5282ca825a7806a9dafcda,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7448,01058c1847400919de5282ca825a7806a9dafcda,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
7449,01058c1847400919de5282ca825a7806a9dafcda,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
7450,01058c1847400919de5282ca825a7806a9dafcda,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
7451,01058c1847400919de5282ca825a7806a9dafcda,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7452,01058c1847400919de5282ca825a7806a9dafcda,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7453,01058c1847400919de5282ca825a7806a9dafcda,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7454,01058c1847400919de5282ca825a7806a9dafcda,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7455,01058c1847400919de5282ca825a7806a9dafcda,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7456,01058c1847400919de5282ca825a7806a9dafcda,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7457,01058c1847400919de5282ca825a7806a9dafcda,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7458,01058c1847400919de5282ca825a7806a9dafcda,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7459,01058c1847400919de5282ca825a7806a9dafcda,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7460,01058c1847400919de5282ca825a7806a9dafcda,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7461,01058c1847400919de5282ca825a7806a9dafcda,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7462,01058c1847400919de5282ca825a7806a9dafcda,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7463,01058c1847400919de5282ca825a7806a9dafcda,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7464,01058c1847400919de5282ca825a7806a9dafcda,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7465,01058c1847400919de5282ca825a7806a9dafcda,/9.5/alpine/Dockerfile," # backwards compat
"
7466,54f46e57136635b484295b985acd6e422d0b9583,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
7467,54f46e57136635b484295b985acd6e422d0b9583,/9.3/Dockerfile,"# explicitly set user/group IDs
"
7468,54f46e57136635b484295b985acd6e422d0b9583,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
7469,54f46e57136635b484295b985acd6e422d0b9583,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7470,54f46e57136635b484295b985acd6e422d0b9583,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7471,54f46e57136635b484295b985acd6e422d0b9583,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7472,54f46e57136635b484295b985acd6e422d0b9583,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7473,54f46e57136635b484295b985acd6e422d0b9583,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7474,54f46e57136635b484295b985acd6e422d0b9583,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7475,54f46e57136635b484295b985acd6e422d0b9583,/9.3/Dockerfile," # backwards compat
"
7476,96498cc9b353adf67b8bada27b4aaf1fde858bd8,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
7477,96498cc9b353adf67b8bada27b4aaf1fde858bd8,/9.4/Dockerfile,"# explicitly set user/group IDs
"
7478,96498cc9b353adf67b8bada27b4aaf1fde858bd8,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
7479,96498cc9b353adf67b8bada27b4aaf1fde858bd8,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7480,96498cc9b353adf67b8bada27b4aaf1fde858bd8,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7481,96498cc9b353adf67b8bada27b4aaf1fde858bd8,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7482,96498cc9b353adf67b8bada27b4aaf1fde858bd8,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7483,96498cc9b353adf67b8bada27b4aaf1fde858bd8,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7484,96498cc9b353adf67b8bada27b4aaf1fde858bd8,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7485,96498cc9b353adf67b8bada27b4aaf1fde858bd8,/9.4/Dockerfile," # backwards compat
"
7486,d2b38544770a63fed430694a7aed33de3ad8b808,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7487,d2b38544770a63fed430694a7aed33de3ad8b808,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7488,d2b38544770a63fed430694a7aed33de3ad8b808,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
7489,d2b38544770a63fed430694a7aed33de3ad8b808,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
7490,d2b38544770a63fed430694a7aed33de3ad8b808,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7491,d2b38544770a63fed430694a7aed33de3ad8b808,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7492,d2b38544770a63fed430694a7aed33de3ad8b808,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7493,d2b38544770a63fed430694a7aed33de3ad8b808,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7494,d2b38544770a63fed430694a7aed33de3ad8b808,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7495,d2b38544770a63fed430694a7aed33de3ad8b808,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7496,d2b38544770a63fed430694a7aed33de3ad8b808,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7497,d2b38544770a63fed430694a7aed33de3ad8b808,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7498,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7499,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7500,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7501,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"#		krb5-dev \
"
7502,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"#		openldap-dev \
"
7503,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# configure: error: prove not found
"
7504,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7505,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7506,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7507,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7508,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7509,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7510,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7511,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7512,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7513,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7514,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7515,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7516,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7517,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7518,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile," # backwards compat
"
7519,01058c1847400919de5282ca825a7806a9dafcda,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7520,01058c1847400919de5282ca825a7806a9dafcda,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7521,01058c1847400919de5282ca825a7806a9dafcda,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7522,01058c1847400919de5282ca825a7806a9dafcda,/10/alpine/Dockerfile,"#		krb5-dev \
"
7523,01058c1847400919de5282ca825a7806a9dafcda,/10/alpine/Dockerfile,"#		openldap-dev \
"
7524,01058c1847400919de5282ca825a7806a9dafcda,/10/alpine/Dockerfile,"# configure: error: prove not found
"
7525,01058c1847400919de5282ca825a7806a9dafcda,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7526,01058c1847400919de5282ca825a7806a9dafcda,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7527,01058c1847400919de5282ca825a7806a9dafcda,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7528,01058c1847400919de5282ca825a7806a9dafcda,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7529,01058c1847400919de5282ca825a7806a9dafcda,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7530,01058c1847400919de5282ca825a7806a9dafcda,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7531,01058c1847400919de5282ca825a7806a9dafcda,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7532,01058c1847400919de5282ca825a7806a9dafcda,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7533,01058c1847400919de5282ca825a7806a9dafcda,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7534,01058c1847400919de5282ca825a7806a9dafcda,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7535,01058c1847400919de5282ca825a7806a9dafcda,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7536,01058c1847400919de5282ca825a7806a9dafcda,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7537,01058c1847400919de5282ca825a7806a9dafcda,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7538,01058c1847400919de5282ca825a7806a9dafcda,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7539,01058c1847400919de5282ca825a7806a9dafcda,/10/alpine/Dockerfile," # backwards compat
"
7540,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7541,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7542,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7543,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"#		krb5-dev \
"
7544,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"#		openldap-dev \
"
7545,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# configure: error: prove not found
"
7546,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7547,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7548,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7549,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7550,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7551,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7552,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7553,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7554,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7555,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7556,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7557,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7558,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7559,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7560,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile," # backwards compat
"
7561,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# vim:set ft=dockerfile:
"
7562,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# explicitly set user/group IDs
"
7563,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# grab gosu for easy step-down from root
"
7564,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7565,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7566,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# arches officialy built by upstream
"
7567,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7568,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7569,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7570,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7571,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7572,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7573,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7574,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7575,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7576,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7577,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7578,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile," # backwards compat
"
7579,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
7580,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.4/Dockerfile,"# explicitly set user/group IDs
"
7581,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
7582,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7583,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7584,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7585,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7586,4c4693ef1306a391785c7b73b2784d5634903467,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7587,4c4693ef1306a391785c7b73b2784d5634903467,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7588,4c4693ef1306a391785c7b73b2784d5634903467,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7589,4c4693ef1306a391785c7b73b2784d5634903467,/12/alpine/Dockerfile,"#		krb5-dev \
"
7590,4c4693ef1306a391785c7b73b2784d5634903467,/12/alpine/Dockerfile,"#		openldap-dev \
"
7591,4c4693ef1306a391785c7b73b2784d5634903467,/12/alpine/Dockerfile,"# configure: error: prove not found
"
7592,4c4693ef1306a391785c7b73b2784d5634903467,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7593,4c4693ef1306a391785c7b73b2784d5634903467,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7594,4c4693ef1306a391785c7b73b2784d5634903467,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7595,4c4693ef1306a391785c7b73b2784d5634903467,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7596,4c4693ef1306a391785c7b73b2784d5634903467,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7597,4c4693ef1306a391785c7b73b2784d5634903467,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7598,4c4693ef1306a391785c7b73b2784d5634903467,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7599,4c4693ef1306a391785c7b73b2784d5634903467,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7600,4c4693ef1306a391785c7b73b2784d5634903467,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7601,4c4693ef1306a391785c7b73b2784d5634903467,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7602,4c4693ef1306a391785c7b73b2784d5634903467,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7603,4c4693ef1306a391785c7b73b2784d5634903467,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7604,4c4693ef1306a391785c7b73b2784d5634903467,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7605,4c4693ef1306a391785c7b73b2784d5634903467,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7606,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
7607,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# explicitly set user/group IDs
"
7608,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
7609,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
7610,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
7611,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7612,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7613,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7614,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7615,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
7616,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# arches officialy built by upstream
"
7617,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7618,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
7619,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7620,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7621,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7622,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7623,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7624,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7625,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7626,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
7627,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7628,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
7629,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7630,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile," # backwards compat
"
7631,e677b561722c7cc9fc8181bb29cebe5f7c96c6e8,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
7632,e677b561722c7cc9fc8181bb29cebe5f7c96c6e8,/9.5/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
7633,e677b561722c7cc9fc8181bb29cebe5f7c96c6e8,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
7634,e677b561722c7cc9fc8181bb29cebe5f7c96c6e8,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7635,e677b561722c7cc9fc8181bb29cebe5f7c96c6e8,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7636,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
7637,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
7638,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
7639,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7640,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7641,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# vim:set ft=dockerfile:
"
7642,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# explicitly set user/group IDs
"
7643,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
7644,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
7645,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# grab gosu for easy step-down from root
"
7646,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7647,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7648,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7649,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7650,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# arches officialy built by upstream
"
7651,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7652,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7653,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7654,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7655,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7656,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7657,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7658,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7659,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7660,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7661,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7662,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile," # backwards compat
"
7663,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
7664,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.4/Dockerfile,"# explicitly set user/group IDs
"
7665,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
7666,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7667,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7668,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7669,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7670,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7671,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7672,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7673,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
7674,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
7675,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
7676,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7677,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7678,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7679,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7680,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7681,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7682,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7683,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7684,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7685,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7686,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7687,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7688,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7689,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7690,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile," # backwards compat
"
7691,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
7692,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# explicitly set user/group IDs
"
7693,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
7694,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7695,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7696,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7697,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# arches officialy built by upstream
"
7698,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7699,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7700,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7701,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7702,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7703,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7704,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7705,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7706,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7707,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7708,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7709,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile," # backwards compat
"
7710,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7711,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
7712,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7713,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
7714,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
7715,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
7716,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7717,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7718,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7719,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7720,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7721,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7722,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7723,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7724,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7725,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7726,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7727,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7728,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7729,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7730,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile," # backwards compat
"
7731,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7732,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7733,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7734,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"#		krb5-dev \
"
7735,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"#		openldap-dev \
"
7736,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# configure: error: prove not found
"
7737,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7738,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7739,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7740,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7741,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7742,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7743,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7744,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7745,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7746,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7747,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7748,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7749,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7750,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7751,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile," # backwards compat
"
7752,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7753,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7754,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7755,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
7756,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
7757,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
7758,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7759,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7760,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7761,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7762,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7763,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7764,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7765,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7766,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7767,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7768,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7769,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7770,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7771,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7772,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.4/alpine/Dockerfile," # backwards compat
"
7773,2cab5040341f46331367f8766b4d249a5b7a9366,/11/Dockerfile,"# vim:set ft=dockerfile:
"
7774,2cab5040341f46331367f8766b4d249a5b7a9366,/11/Dockerfile,"# explicitly set user/group IDs
"
7775,2cab5040341f46331367f8766b4d249a5b7a9366,/11/Dockerfile,"# grab gosu for easy step-down from root
"
7776,2cab5040341f46331367f8766b4d249a5b7a9366,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7777,2cab5040341f46331367f8766b4d249a5b7a9366,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7778,2cab5040341f46331367f8766b4d249a5b7a9366,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7779,2cab5040341f46331367f8766b4d249a5b7a9366,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7780,2cab5040341f46331367f8766b4d249a5b7a9366,/11/Dockerfile,"# arches officialy built by upstream
"
7781,2cab5040341f46331367f8766b4d249a5b7a9366,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7782,2cab5040341f46331367f8766b4d249a5b7a9366,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7783,2cab5040341f46331367f8766b4d249a5b7a9366,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7784,2cab5040341f46331367f8766b4d249a5b7a9366,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7785,2cab5040341f46331367f8766b4d249a5b7a9366,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7786,2cab5040341f46331367f8766b4d249a5b7a9366,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7787,2cab5040341f46331367f8766b4d249a5b7a9366,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7788,2cab5040341f46331367f8766b4d249a5b7a9366,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7789,2cab5040341f46331367f8766b4d249a5b7a9366,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7790,2cab5040341f46331367f8766b4d249a5b7a9366,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7791,2cab5040341f46331367f8766b4d249a5b7a9366,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7792,2cab5040341f46331367f8766b4d249a5b7a9366,/11/Dockerfile," # backwards compat
"
7793,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# vim:set ft=dockerfile:
"
7794,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# explicitly set user/group IDs
"
7795,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
7796,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
7797,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
7798,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7799,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7800,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7801,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
7802,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7803,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# see note below about ""*.pyc"" files
"
7804,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# arches officialy built by upstream
"
7805,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7806,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
7807,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7808,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7809,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7810,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7811,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7812,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7813,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7814,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
7815,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7816,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
7817,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7818,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile," # backwards compat
"
7819,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
7820,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# explicitly set user/group IDs
"
7821,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
7822,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
7823,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
7824,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7825,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7826,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7827,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7828,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
7829,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# arches officialy built by upstream
"
7830,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7831,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
7832,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7833,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7834,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7835,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7836,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7837,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7838,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7839,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
7840,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7841,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
7842,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7843,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.5/Dockerfile," # backwards compat
"
7844,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
7845,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/Dockerfile,"# explicitly set user/group IDs
"
7846,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
7847,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7848,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7849,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/Dockerfile,"# arches officialy built by upstream
"
7850,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7851,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7852,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7853,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7854,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7855,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7856,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7857,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7858,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7859,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7860,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7861,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.4/Dockerfile," # backwards compat
"
7862,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7863,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7864,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7865,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"#		krb5-dev \
"
7866,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"#		openldap-dev \
"
7867,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# configure: error: prove not found
"
7868,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7869,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7870,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7871,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7872,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7873,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7874,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7875,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7876,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7877,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7878,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7879,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7880,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7881,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile," # backwards compat
"
7882,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7883,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7884,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
7885,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
7886,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7887,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7888,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7889,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7890,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7891,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# vim:set ft=dockerfile:
"
7892,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# explicitly set user/group IDs
"
7893,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# grab gosu for easy step-down from root
"
7894,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7895,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7896,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7897,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# arches officialy built by upstream
"
7898,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7899,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7900,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7901,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7902,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7903,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7904,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7905,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7906,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7907,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7908,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7909,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile," # backwards compat
"
7910,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
7911,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.3/Dockerfile,"# explicitly set user/group IDs
"
7912,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
7913,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7914,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7915,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7916,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7917,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7918,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
7919,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7920,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"#		krb5-dev \
"
7921,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"#		openldap-dev \
"
7922,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# configure: error: prove not found
"
7923,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7924,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7925,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7926,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
7927,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7928,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7929,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7930,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7931,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7932,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7933,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7934,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7935,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7936,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7937,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7938,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7939,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
7940,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
7941,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7942,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7943,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7944,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7945,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7946,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7947,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7948,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7949,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7950,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7951,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7952,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile," # backwards compat
"
7953,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
7954,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.1/Dockerfile,"# explicitly set user/group IDs
"
7955,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
7956,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7957,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7958,c6484bf22f5a0f72a49658ae9e5569bc01785eff,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
7959,c6484bf22f5a0f72a49658ae9e5569bc01785eff,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
7960,c6484bf22f5a0f72a49658ae9e5569bc01785eff,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7961,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7962,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7963,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7964,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
7965,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
7966,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7967,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
7968,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7969,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7970,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7971,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7972,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7973,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7974,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7975,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7976,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7977,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7978,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7979,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7980,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile," # backwards compat
"
7981,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7982,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7983,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
7984,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
7985,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7986,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7987,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7988,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7989,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7990,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7991,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7992,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7993,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7994,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7995,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7996,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
7997,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/Dockerfile,"# explicitly set user/group IDs
"
7998,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
7999,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8000,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8001,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8002,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8003,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8004,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
8005,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.5/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
8006,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
8007,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8008,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8009,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# vim:set ft=dockerfile:
"
8010,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# explicitly set user/group IDs
"
8011,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# grab gosu for easy step-down from root
"
8012,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8013,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8014,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# arches officialy built by upstream
"
8015,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8016,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8017,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8018,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8019,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8020,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8021,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8022,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8023,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8024,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8025,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8026,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile," # backwards compat
"
8027,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8028,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8029,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
8030,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
8031,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8032,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8033,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8034,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8035,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8036,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8037,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8038,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8039,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8040,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8041,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8042,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
8043,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/Dockerfile,"# explicitly set user/group IDs
"
8044,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
8045,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8046,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8047,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8048,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8049,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8050,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8051,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/Dockerfile," # backwards compat
"
8052,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
8053,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.1/Dockerfile,"# explicitly set user/group IDs
"
8054,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
8055,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8056,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8057,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.1/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8058,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.1/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8059,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8060,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8061,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8062,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
8063,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
8064,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
8065,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8066,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8067,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8068,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8069,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8070,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8071,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8072,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8073,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8074,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8075,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8076,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8077,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile," # backwards compat
"
8078,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8079,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
8080,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8081,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"#		krb5-dev \
"
8082,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"#		openldap-dev \
"
8083,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# configure: error: prove not found
"
8084,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8085,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8086,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8087,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8088,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8089,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8090,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8091,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8092,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8093,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8094,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8095,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8096,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8097,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8098,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile," # backwards compat
"
8099,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
8100,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# explicitly set user/group IDs
"
8101,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
8102,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8103,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8104,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8105,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# arches officialy built by upstream
"
8106,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8107,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8108,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8109,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8110,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8111,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8112,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8113,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8114,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8115,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8116,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8117,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile," # backwards compat
"
8118,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8119,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
8120,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8121,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
8122,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
8123,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
8124,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8125,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8126,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8127,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8128,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8129,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8130,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8131,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8132,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8133,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8134,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8135,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8136,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8137,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8138,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile," # backwards compat
"
8139,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
8140,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.3/Dockerfile,"# explicitly set user/group IDs
"
8141,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
8142,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8143,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8144,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# vim:set ft=dockerfile:
"
8145,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# explicitly set user/group IDs
"
8146,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# grab gosu for easy step-down from root
"
8147,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8148,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8149,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# arches officialy built by upstream
"
8150,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8151,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8152,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8153,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8154,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8155,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8156,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8157,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8158,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8159,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8160,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8161,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile," # backwards compat
"
8162,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
8163,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# explicitly set user/group IDs
"
8164,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
8165,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
8166,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
8167,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8168,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8169,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
8170,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
8171,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8172,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
8173,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# arches officialy built by upstream
"
8174,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8175,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
8176,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8177,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8178,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8179,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8180,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8181,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8182,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8183,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
8184,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8185,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
8186,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8187,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile," # backwards compat
"
8188,123aedc09bc067740fb28921c500ded83c018bd4,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8189,123aedc09bc067740fb28921c500ded83c018bd4,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8190,123aedc09bc067740fb28921c500ded83c018bd4,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
8191,123aedc09bc067740fb28921c500ded83c018bd4,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
8192,123aedc09bc067740fb28921c500ded83c018bd4,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8193,123aedc09bc067740fb28921c500ded83c018bd4,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
8194,123aedc09bc067740fb28921c500ded83c018bd4,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8195,123aedc09bc067740fb28921c500ded83c018bd4,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8196,123aedc09bc067740fb28921c500ded83c018bd4,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8197,123aedc09bc067740fb28921c500ded83c018bd4,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8198,123aedc09bc067740fb28921c500ded83c018bd4,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8199,123aedc09bc067740fb28921c500ded83c018bd4,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8200,123aedc09bc067740fb28921c500ded83c018bd4,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8201,123aedc09bc067740fb28921c500ded83c018bd4,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8202,123aedc09bc067740fb28921c500ded83c018bd4,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8203,123aedc09bc067740fb28921c500ded83c018bd4,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8204,123aedc09bc067740fb28921c500ded83c018bd4,/9.2/alpine/Dockerfile," # backwards compat
"
8205,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8206,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8207,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
8208,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
8209,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8210,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8211,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8212,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8213,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8214,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8215,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8216,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8217,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8218,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8219,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8220,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
8221,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8222,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/11/alpine/Dockerfile,"#		krb5-dev \
"
8223,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/11/alpine/Dockerfile,"#		openldap-dev \
"
8224,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/11/alpine/Dockerfile,"# configure: error: prove not found
"
8225,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8226,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8227,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8228,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
8229,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8230,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8231,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8232,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8233,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8234,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8235,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8236,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8237,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8238,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8239,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/11/alpine/Dockerfile," # backwards compat
"
8240,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8241,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8242,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8243,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
8244,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
8245,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/alpine/Dockerfile,"# configure: error: prove not found
"
8246,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8247,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
8248,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8249,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8250,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8251,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8252,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8253,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8254,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8255,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8256,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8257,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8258,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8259,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8260,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/alpine/Dockerfile," # backwards compat
"
8261,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
8262,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"# explicitly set user/group IDs
"
8263,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
8264,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
8265,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
8266,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8267,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8268,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
8269,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8270,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
8271,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"# arches officialy built by upstream
"
8272,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8273,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
8274,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8275,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8276,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8277,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8278,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8279,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8280,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8281,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
8282,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8283,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
8284,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8285,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.6/Dockerfile," # backwards compat
"
8286,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
8287,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# explicitly set user/group IDs
"
8288,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
8289,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8290,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8291,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# arches officialy built by upstream
"
8292,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8293,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8294,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8295,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8296,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8297,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8298,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8299,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8300,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8301,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8302,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8303,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile," # backwards compat
"
8304,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8305,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8306,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8307,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"#		krb5-dev \
"
8308,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"#		openldap-dev \
"
8309,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# configure: error: prove not found
"
8310,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8311,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8312,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8313,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8314,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8315,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8316,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8317,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8318,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8319,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8320,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8321,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8322,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8323,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8324,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile," # backwards compat
"
8325,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8326,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8327,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
8328,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
8329,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8330,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8331,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8332,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8333,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8334,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"# tzdata adds around 1Mb to image size, but it is suggested by Django documentation that timezone should be set for performance reasons: http://bit.ly/2fMYhh1
"
8335,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8336,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8337,972294a377463156c8d61297320c872fc7d370a9,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
8338,972294a377463156c8d61297320c872fc7d370a9,/9.3/Dockerfile,"# explicitly set user/group IDs
"
8339,972294a377463156c8d61297320c872fc7d370a9,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
8340,972294a377463156c8d61297320c872fc7d370a9,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8341,972294a377463156c8d61297320c872fc7d370a9,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8342,972294a377463156c8d61297320c872fc7d370a9,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8343,972294a377463156c8d61297320c872fc7d370a9,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8344,972294a377463156c8d61297320c872fc7d370a9,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8345,972294a377463156c8d61297320c872fc7d370a9,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8346,972294a377463156c8d61297320c872fc7d370a9,/9.3/Dockerfile," # backwards compat
"
8347,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
8348,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"# explicitly set user/group IDs
"
8349,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
8350,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
8351,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
8352,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8353,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8354,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
8355,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8356,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
8357,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"# arches officialy built by upstream
"
8358,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8359,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
8360,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8361,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8362,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8363,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8364,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8365,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8366,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8367,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
8368,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8369,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8370,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8371,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.6/Dockerfile," # backwards compat
"
8372,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8373,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8374,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
8375,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
8376,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8377,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8378,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8379,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8380,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8381,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8382,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8383,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8384,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8385,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8386,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8387,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile," # backwards compat
"
8388,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8389,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
8390,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8391,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"#		krb5-dev \
"
8392,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"#		openldap-dev \
"
8393,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# configure: error: prove not found
"
8394,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8395,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8396,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8397,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8398,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8399,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8400,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8401,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8402,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8403,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8404,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8405,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8406,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8407,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8408,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8409,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8410,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8411,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/alpine/Dockerfile,"#		krb5-dev \
"
8412,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/alpine/Dockerfile,"#		openldap-dev \
"
8413,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/alpine/Dockerfile,"# configure: error: prove not found
"
8414,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8415,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8416,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8417,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8418,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8419,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8420,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8421,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8422,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8423,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8424,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8425,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8426,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8427,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8428,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/alpine/Dockerfile," # backwards compat
"
8429,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8430,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
8431,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8432,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"#		krb5-dev \
"
8433,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"#		openldap-dev \
"
8434,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# configure: error: prove not found
"
8435,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8436,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8437,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8438,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8439,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8440,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8441,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8442,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8443,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8444,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8445,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8446,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8447,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8448,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8449,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8450,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
8451,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8452,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
8453,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
8454,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
8455,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8456,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8457,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8458,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8459,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8460,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8461,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8462,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8463,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8464,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8465,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8466,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8467,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8468,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8469,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile," # backwards compat
"
8470,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8471,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8472,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8473,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
8474,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
8475,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
8476,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8477,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8478,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
8479,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8480,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8481,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8482,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8483,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8484,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8485,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8486,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8487,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8488,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8489,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8490,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8491,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8492,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile," # backwards compat
"
8493,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# vim:set ft=dockerfile:
"
8494,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# explicitly set user/group IDs
"
8495,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# grab gosu for easy step-down from root
"
8496,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8497,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8498,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
8499,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8500,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# arches officialy built by upstream
"
8501,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8502,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8503,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8504,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8505,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8506,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8507,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8508,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8509,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8510,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8511,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8512,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile," # backwards compat
"
8513,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8514,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8515,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8516,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"#		krb5-dev \
"
8517,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"#		openldap-dev \
"
8518,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# configure: error: prove not found
"
8519,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8520,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8521,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8522,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8523,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8524,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8525,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8526,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8527,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8528,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8529,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8530,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8531,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8532,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8533,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile," # backwards compat
"
8534,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# vim:set ft=dockerfile:
"
8535,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# explicitly set user/group IDs
"
8536,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# grab gosu for easy step-down from root
"
8537,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8538,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8539,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# arches officialy built by upstream
"
8540,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8541,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8542,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8543,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8544,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8545,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8546,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8547,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8548,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8549,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8550,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8551,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile," # backwards compat
"
8552,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
8553,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# explicitly set user/group IDs
"
8554,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
8555,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8556,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8557,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# arches officialy built by upstream
"
8558,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8559,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8560,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8561,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8562,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8563,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8564,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8565,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8566,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8567,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8568,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8569,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile," # backwards compat
"
8570,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8571,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
8572,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8573,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"#		krb5-dev \
"
8574,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"#		openldap-dev \
"
8575,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# configure: error: prove not found
"
8576,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8577,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8578,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8579,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8580,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8581,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8582,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8583,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8584,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8585,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8586,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8587,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8588,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8589,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8590,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile," # backwards compat
"
8591,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8592,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8593,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8594,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
8595,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
8596,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
8597,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8598,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8599,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8600,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8601,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8602,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8603,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8604,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8605,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8606,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8607,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8608,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8609,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8610,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8611,57213ab012e6a38a27283eeac65c4726c069647a,/9.5/alpine/Dockerfile," # backwards compat
"
8612,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8613,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8614,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
8615,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
8616,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8617,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8618,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8619,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8620,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8621,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8622,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8623,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8624,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# vim:set ft=dockerfile:
"
8625,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# explicitly set user/group IDs
"
8626,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
8627,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
8628,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# grab gosu for easy step-down from root
"
8629,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8630,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8631,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
8632,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8633,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
8634,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# arches officialy built by upstream
"
8635,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8636,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
8637,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8638,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8639,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8640,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8641,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8642,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8643,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8644,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
8645,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8646,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
8647,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8648,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile," # backwards compat
"
8649,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
8650,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.2/Dockerfile,"# explicitly set user/group IDs
"
8651,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
8652,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8653,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8654,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8655,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8656,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8657,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
8658,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
8659,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
8660,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8661,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8662,7fed4298db2dc8fb86844a1a41c86f4356f5f45b,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
8663,7fed4298db2dc8fb86844a1a41c86f4356f5f45b,/9.5/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
8664,7fed4298db2dc8fb86844a1a41c86f4356f5f45b,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
8665,7fed4298db2dc8fb86844a1a41c86f4356f5f45b,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8666,7fed4298db2dc8fb86844a1a41c86f4356f5f45b,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8667,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8668,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8669,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
8670,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
8671,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8672,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8673,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8674,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8675,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8676,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8677,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8678,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8679,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
8680,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# explicitly set user/group IDs
"
8681,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
8682,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
8683,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
8684,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8685,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8686,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
8687,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
8688,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8689,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
8690,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# arches officialy built by upstream
"
8691,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8692,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
8693,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8694,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8695,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8696,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8697,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8698,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8699,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8700,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
8701,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8702,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
8703,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8704,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile," # backwards compat
"
8705,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8706,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
8707,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8708,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/alpine/Dockerfile,"#		krb5-dev \
"
8709,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/alpine/Dockerfile,"#		openldap-dev \
"
8710,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/alpine/Dockerfile,"# configure: error: prove not found
"
8711,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8712,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8713,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8714,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8715,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8716,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8717,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8718,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8719,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8720,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8721,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8722,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8723,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8724,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8725,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/alpine/Dockerfile," # backwards compat
"
8726,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8727,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
8728,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8729,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"#		krb5-dev \
"
8730,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"#		openldap-dev \
"
8731,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# configure: error: prove not found
"
8732,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8733,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8734,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8735,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
8736,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8737,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8738,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8739,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8740,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8741,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8742,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8743,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8744,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8745,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8746,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile," # backwards compat
"
8747,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
8748,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
8749,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
8750,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8751,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8752,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8753,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8754,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8755,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
8756,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
8757,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8758,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
8759,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8760,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8761,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8762,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8763,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8764,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8765,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8766,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8767,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8768,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8769,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.2/alpine/Dockerfile," # backwards compat
"
8770,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
8771,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
8772,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
8773,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8774,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8775,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# vim:set ft=dockerfile:
"
8776,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# explicitly set user/group IDs
"
8777,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
8778,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
8779,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# grab gosu for easy step-down from root
"
8780,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8781,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8782,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
8783,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
8784,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8785,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
8786,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# arches officialy built by upstream
"
8787,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8788,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
8789,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8790,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8791,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8792,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8793,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8794,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8795,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8796,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
8797,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8798,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
8799,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8800,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile," # backwards compat
"
8801,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8802,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8803,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8804,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
8805,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
8806,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
8807,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8808,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8809,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8810,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8811,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8812,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8813,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8814,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8815,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8816,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8817,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8818,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8819,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8820,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile," # backwards compat
"
8821,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8822,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8823,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8824,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
8825,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
8826,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
8827,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8828,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8829,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8830,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8831,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8832,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8833,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8834,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8835,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8836,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8837,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8838,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8839,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8840,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8841,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile," # backwards compat
"
8842,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
8843,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# explicitly set user/group IDs
"
8844,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
8845,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8846,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8847,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8848,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# arches officialy built by upstream
"
8849,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8850,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8851,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8852,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8853,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8854,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8855,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8856,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8857,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8858,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8859,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8860,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile," # backwards compat
"
8861,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8862,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8863,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8864,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"#		krb5-dev \
"
8865,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"#		openldap-dev \
"
8866,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# configure: error: prove not found
"
8867,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8868,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8869,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8870,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8871,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8872,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8873,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8874,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8875,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8876,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8877,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8878,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8879,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8880,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8881,20c85c686ac1cc4424f3c690e0f971560efd240e,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8882,20c85c686ac1cc4424f3c690e0f971560efd240e,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8883,20c85c686ac1cc4424f3c690e0f971560efd240e,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8884,20c85c686ac1cc4424f3c690e0f971560efd240e,/10/alpine/Dockerfile,"#		krb5-dev \
"
8885,20c85c686ac1cc4424f3c690e0f971560efd240e,/10/alpine/Dockerfile,"#		openldap-dev \
"
8886,20c85c686ac1cc4424f3c690e0f971560efd240e,/10/alpine/Dockerfile,"# configure: error: prove not found
"
8887,20c85c686ac1cc4424f3c690e0f971560efd240e,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8888,20c85c686ac1cc4424f3c690e0f971560efd240e,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8889,20c85c686ac1cc4424f3c690e0f971560efd240e,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8890,20c85c686ac1cc4424f3c690e0f971560efd240e,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8891,20c85c686ac1cc4424f3c690e0f971560efd240e,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8892,20c85c686ac1cc4424f3c690e0f971560efd240e,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8893,20c85c686ac1cc4424f3c690e0f971560efd240e,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8894,20c85c686ac1cc4424f3c690e0f971560efd240e,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8895,20c85c686ac1cc4424f3c690e0f971560efd240e,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8896,20c85c686ac1cc4424f3c690e0f971560efd240e,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8897,20c85c686ac1cc4424f3c690e0f971560efd240e,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8898,20c85c686ac1cc4424f3c690e0f971560efd240e,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8899,20c85c686ac1cc4424f3c690e0f971560efd240e,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8900,20c85c686ac1cc4424f3c690e0f971560efd240e,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8901,20c85c686ac1cc4424f3c690e0f971560efd240e,/10/alpine/Dockerfile," # backwards compat
"
8902,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8903,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8904,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8905,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
8906,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
8907,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8908,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
8909,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8910,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8911,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8912,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8913,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8914,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8915,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8916,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8917,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8918,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8919,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8920,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8921,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile," # backwards compat
"
8922,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8923,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8924,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8925,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
8926,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
8927,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8928,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8929,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8930,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8931,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8932,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8933,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8934,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8935,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8936,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8937,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8938,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8939,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/alpine/Dockerfile," # backwards compat
"
8940,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
8941,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
8942,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
8943,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8944,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8945,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
8946,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.3/Dockerfile,"# explicitly set user/group IDs
"
8947,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
8948,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8949,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8950,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# vim:set ft=dockerfile:
"
8951,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# explicitly set user/group IDs
"
8952,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
8953,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
8954,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# grab gosu for easy step-down from root
"
8955,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8956,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8957,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
8958,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8959,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
8960,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# arches officialy built by upstream
"
8961,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8962,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
8963,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8964,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8965,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8966,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8967,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8968,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8969,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8970,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
8971,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8972,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
8973,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8974,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile," # backwards compat
"
8975,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8976,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8977,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8978,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
8979,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
8980,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
8981,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8982,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8983,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8984,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8985,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8986,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8987,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8988,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8989,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8990,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8991,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8992,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8993,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8994,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8995,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.5/alpine/Dockerfile," # backwards compat
"
8996,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
8997,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# explicitly set user/group IDs
"
8998,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
8999,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
9000,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
9001,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9002,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9003,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9004,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9005,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
9006,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# arches officialy built by upstream
"
9007,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9008,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
9009,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9010,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9011,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9012,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9013,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9014,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9015,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9016,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
9017,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9018,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
9019,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9020,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/Dockerfile," # backwards compat
"
9021,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9022,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9023,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9024,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"#		krb5-dev \
"
9025,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"#		openldap-dev \
"
9026,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# configure: error: prove not found
"
9027,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9028,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9029,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9030,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9031,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9032,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9033,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9034,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9035,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9036,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9037,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9038,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9039,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9040,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9041,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile," # backwards compat
"
9042,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9043,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9044,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9045,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
9046,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
9047,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9048,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9049,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9050,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9051,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9052,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9053,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9054,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9055,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9056,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9057,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9058,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9059,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile," # backwards compat
"
9060,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9061,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9062,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9063,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
9064,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
9065,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9066,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9067,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9068,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9069,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9070,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9071,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9072,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9073,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9074,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9075,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9076,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile," # backwards compat
"
9077,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# vim:set ft=dockerfile:
"
9078,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# explicitly set user/group IDs
"
9079,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# grab gosu for easy step-down from root
"
9080,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9081,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9082,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# arches officialy built by upstream
"
9083,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9084,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9085,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9086,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9087,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9088,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9089,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9090,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9091,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9092,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9093,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9094,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile," # backwards compat
"
9095,783906f551b9bc1472751200296f93bb2c55bc44,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
9096,783906f551b9bc1472751200296f93bb2c55bc44,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9097,783906f551b9bc1472751200296f93bb2c55bc44,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9098,7c8e945a80097e80fa1c8d69d2a027145177b701,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9099,7c8e945a80097e80fa1c8d69d2a027145177b701,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9100,43f393cccec4b3c6066531fc5c3d594327825940,/10/Dockerfile,"# vim:set ft=dockerfile:
"
9101,43f393cccec4b3c6066531fc5c3d594327825940,/10/Dockerfile,"# explicitly set user/group IDs
"
9102,43f393cccec4b3c6066531fc5c3d594327825940,/10/Dockerfile,"# grab gosu for easy step-down from root
"
9103,43f393cccec4b3c6066531fc5c3d594327825940,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9104,43f393cccec4b3c6066531fc5c3d594327825940,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9105,43f393cccec4b3c6066531fc5c3d594327825940,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9106,43f393cccec4b3c6066531fc5c3d594327825940,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9107,43f393cccec4b3c6066531fc5c3d594327825940,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9108,43f393cccec4b3c6066531fc5c3d594327825940,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9109,43f393cccec4b3c6066531fc5c3d594327825940,/10/Dockerfile," # backwards compat
"
9110,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
9111,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# explicitly set user/group IDs
"
9112,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
9113,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9114,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9115,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# arches officialy built by upstream
"
9116,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9117,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9118,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9119,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9120,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9121,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9122,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9123,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9124,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9125,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9126,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9127,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile," # backwards compat
"
9128,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9129,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
9130,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9131,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
9132,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
9133,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
9134,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9135,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9136,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9137,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
9138,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9139,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9140,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9141,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9142,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9143,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9144,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9145,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9146,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9147,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9148,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile," # backwards compat
"
9149,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9150,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9151,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9152,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
9153,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
9154,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9155,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
9156,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9157,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9158,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9159,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9160,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9161,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9162,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9163,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9164,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9165,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9166,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.3/alpine/Dockerfile," # backwards compat
"
9167,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9168,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
9169,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9170,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/alpine/Dockerfile,"#		krb5-dev \
"
9171,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/alpine/Dockerfile,"#		openldap-dev \
"
9172,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/alpine/Dockerfile,"# configure: error: prove not found
"
9173,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9174,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9175,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9176,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9177,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9178,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9179,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9180,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9181,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9182,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9183,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9184,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9185,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9186,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9187,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/alpine/Dockerfile," # backwards compat
"
9188,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
9189,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9190,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
9191,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9192,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9193,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
9194,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.3/Dockerfile,"# explicitly set user/group IDs
"
9195,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
9196,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9197,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9198,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9199,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9200,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
9201,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"# explicitly set user/group IDs
"
9202,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
9203,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
9204,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
9205,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9206,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9207,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9208,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9209,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
9210,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"# arches officialy built by upstream
"
9211,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9212,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
9213,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9214,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9215,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9216,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9217,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9218,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9219,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9220,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
9221,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9222,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9223,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9224,91939daa3f42d2796952f03353534cd87d181ccc,/9.6/Dockerfile," # backwards compat
"
9225,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
9226,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.3/Dockerfile,"# explicitly set user/group IDs
"
9227,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
9228,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9229,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9230,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9231,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9232,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9233,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9234,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9235,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"#		krb5-dev \
"
9236,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"#		openldap-dev \
"
9237,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# configure: error: prove not found
"
9238,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9239,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9240,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9241,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9242,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9243,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9244,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9245,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9246,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9247,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9248,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9249,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9250,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9251,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9252,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile," # backwards compat
"
9253,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9254,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9255,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9256,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"#		krb5-dev \
"
9257,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"#		openldap-dev \
"
9258,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# configure: error: prove not found
"
9259,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9260,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9261,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9262,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9263,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9264,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9265,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9266,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9267,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9268,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9269,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9270,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9271,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9272,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile," # backwards compat
"
9273,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
9274,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9275,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
9276,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9277,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9278,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9279,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9280,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9281,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"#		krb5-dev \
"
9282,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"#		openldap-dev \
"
9283,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# configure: error: prove not found
"
9284,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9285,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9286,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9287,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9288,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9289,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9290,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9291,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9292,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9293,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9294,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9295,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9296,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9297,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9298,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile," # backwards compat
"
9299,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
9300,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# explicitly set user/group IDs
"
9301,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
9302,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
9303,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
9304,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9305,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9306,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9307,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9308,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
9309,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# arches officialy built by upstream
"
9310,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9311,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
9312,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9313,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9314,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9315,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9316,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9317,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9318,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9319,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
9320,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9321,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
9322,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9323,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile," # backwards compat
"
9324,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
9325,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.0/Dockerfile,"# explicitly set user/group IDs
"
9326,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
9327,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9328,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9329,51e5166d69320581cb707d6fb102d3ba04803400,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
9330,51e5166d69320581cb707d6fb102d3ba04803400,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9331,51e5166d69320581cb707d6fb102d3ba04803400,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
9332,51e5166d69320581cb707d6fb102d3ba04803400,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9333,51e5166d69320581cb707d6fb102d3ba04803400,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9334,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
9335,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9336,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
9337,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9338,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9339,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
9340,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9341,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
9342,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9343,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9344,09eabaadf53341f65f7c7036ac13bddf788fea65,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
9345,09eabaadf53341f65f7c7036ac13bddf788fea65,/9.5/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9346,09eabaadf53341f65f7c7036ac13bddf788fea65,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
9347,09eabaadf53341f65f7c7036ac13bddf788fea65,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9348,09eabaadf53341f65f7c7036ac13bddf788fea65,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9349,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
9350,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/Dockerfile,"# explicitly set user/group IDs
"
9351,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
9352,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9353,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9354,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/Dockerfile,"# arches officialy built by upstream
"
9355,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9356,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9357,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9358,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9359,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9360,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9361,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9362,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9363,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9364,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9365,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9366,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.3/Dockerfile," # backwards compat
"
9367,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# vim:set ft=dockerfile:
"
9368,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# explicitly set user/group IDs
"
9369,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
9370,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
9371,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# grab gosu for easy step-down from root
"
9372,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9373,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9374,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9375,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9376,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
9377,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# arches officialy built by upstream
"
9378,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9379,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
9380,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9381,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9382,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9383,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9384,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9385,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9386,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9387,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
9388,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9389,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
9390,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9391,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile," # backwards compat
"
9392,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9393,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9394,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9395,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
9396,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
9397,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
9398,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9399,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9400,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9401,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9402,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9403,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9404,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9405,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9406,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9407,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9408,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9409,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9410,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9411,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9412,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.4/alpine/Dockerfile," # backwards compat
"
9413,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9414,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9415,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9416,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
9417,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
9418,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9419,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9420,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9421,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9422,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9423,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9424,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9425,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9426,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9427,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9428,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9429,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9430,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.6/alpine/Dockerfile," # backwards compat
"
9431,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
9432,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/Dockerfile,"# explicitly set user/group IDs
"
9433,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
9434,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9435,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9436,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9437,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9438,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9439,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9440,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/Dockerfile," # backwards compat
"
9441,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9442,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9443,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9444,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
9445,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
9446,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9447,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9448,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9449,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9450,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9451,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9452,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9453,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9454,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9455,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9456,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9457,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9458,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/alpine/Dockerfile," # backwards compat
"
9459,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
9460,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# explicitly set user/group IDs
"
9461,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
9462,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
9463,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
9464,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9465,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9466,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9467,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9468,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
9469,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# arches officialy built by upstream
"
9470,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9471,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
9472,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9473,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9474,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9475,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9476,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9477,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9478,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9479,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
9480,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9481,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
9482,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9483,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile," # backwards compat
"
9484,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9485,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9486,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9487,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
9488,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
9489,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9490,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
9491,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9492,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9493,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9494,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9495,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9496,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9497,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9498,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9499,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9500,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9501,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9502,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9503,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile," # backwards compat
"
9504,3cff98db82f2dd6c3647296335bbc37233e0b9bc,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
9505,3cff98db82f2dd6c3647296335bbc37233e0b9bc,/9.6/Dockerfile,"# explicitly set user/group IDs
"
9506,3cff98db82f2dd6c3647296335bbc37233e0b9bc,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
9507,3cff98db82f2dd6c3647296335bbc37233e0b9bc,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9508,3cff98db82f2dd6c3647296335bbc37233e0b9bc,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9509,3cff98db82f2dd6c3647296335bbc37233e0b9bc,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9510,3cff98db82f2dd6c3647296335bbc37233e0b9bc,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9511,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
9512,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# explicitly set user/group IDs
"
9513,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
9514,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
9515,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
9516,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9517,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9518,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9519,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9520,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
9521,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# arches officialy built by upstream
"
9522,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9523,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
9524,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9525,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9526,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9527,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9528,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9529,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9530,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9531,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
9532,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9533,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
9534,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9535,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile," # backwards compat
"
9536,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
9537,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.4/Dockerfile,"# explicitly set user/group IDs
"
9538,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
9539,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9540,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9541,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9542,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9543,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
9544,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9545,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
9546,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9547,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9548,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
9549,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# explicitly set user/group IDs
"
9550,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
9551,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
9552,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
9553,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9554,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9555,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9556,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9557,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# arches officialy built by upstream
"
9558,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9559,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9560,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9561,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9562,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9563,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9564,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9565,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9566,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9567,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9568,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9569,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile," # backwards compat
"
9570,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9571,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9572,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9573,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
9574,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
9575,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
9576,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9577,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9578,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
9579,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9580,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9581,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9582,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9583,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9584,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9585,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9586,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9587,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9588,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9589,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9590,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9591,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9592,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.3/alpine/Dockerfile," # backwards compat
"
9593,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
9594,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9595,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
9596,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9597,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9598,595fb3798892feb36bc81f01317861ddcdc6521b,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
9599,595fb3798892feb36bc81f01317861ddcdc6521b,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9600,595fb3798892feb36bc81f01317861ddcdc6521b,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
9601,595fb3798892feb36bc81f01317861ddcdc6521b,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9602,595fb3798892feb36bc81f01317861ddcdc6521b,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9603,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9604,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9605,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9606,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
9607,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
9608,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9609,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9610,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9611,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9612,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9613,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9614,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9615,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9616,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9617,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9618,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9619,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9620,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile," # backwards compat
"
9621,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
9622,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/Dockerfile,"# explicitly set user/group IDs
"
9623,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
9624,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9625,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9626,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9627,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9628,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9629,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9630,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9631,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9632,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
9633,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
9634,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9635,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9636,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9637,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9638,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9639,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9640,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9641,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9642,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9643,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9644,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9645,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile," # backwards compat
"
9646,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
9647,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# explicitly set user/group IDs
"
9648,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
9649,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9650,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9651,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9652,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# arches officialy built by upstream
"
9653,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9654,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9655,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9656,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9657,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9658,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9659,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9660,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9661,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9662,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9663,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9664,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile," # backwards compat
"
9665,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# vim:set ft=dockerfile:
"
9666,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# explicitly set user/group IDs
"
9667,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
9668,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
9669,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# grab gosu for easy step-down from root
"
9670,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9671,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9672,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9673,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9674,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
9675,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# arches officialy built by upstream
"
9676,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9677,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
9678,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9679,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9680,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9681,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9682,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9683,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9684,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9685,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
9686,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9687,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
9688,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9689,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile," # backwards compat
"
9690,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9691,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9692,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9693,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
9694,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
9695,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
9696,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9697,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9698,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9699,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9700,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9701,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9702,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9703,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9704,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9705,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9706,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9707,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9708,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9709,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9710,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile," # backwards compat
"
9711,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9712,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9713,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9714,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
9715,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
9716,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
9717,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9718,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9719,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9720,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9721,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9722,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9723,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9724,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9725,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9726,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9727,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9728,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9729,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile," # backwards compat
"
9730,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9731,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
9732,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9733,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"#		krb5-dev \
"
9734,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"#		openldap-dev \
"
9735,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# configure: error: prove not found
"
9736,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9737,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9738,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9739,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9740,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9741,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9742,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9743,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9744,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9745,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9746,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9747,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9748,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9749,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9750,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile," # backwards compat
"
9751,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9752,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9753,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
9754,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
9755,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9756,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9757,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9758,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9759,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9760,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9761,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9762,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9763,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9764,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9765,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9766,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
9767,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/Dockerfile,"# explicitly set user/group IDs
"
9768,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
9769,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9770,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9771,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9772,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9773,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9774,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9775,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
9776,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9777,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
9778,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9779,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9780,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9781,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
9782,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9783,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"#		krb5-dev \
"
9784,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"#		openldap-dev \
"
9785,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# configure: error: prove not found
"
9786,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9787,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9788,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9789,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9790,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9791,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9792,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9793,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9794,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9795,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9796,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9797,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9798,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9799,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9800,1b305a586eb552197fe96e3bf2fd95f3d5b81f79,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
9801,1b305a586eb552197fe96e3bf2fd95f3d5b81f79,/9.6/Dockerfile,"# explicitly set user/group IDs
"
9802,1b305a586eb552197fe96e3bf2fd95f3d5b81f79,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
9803,1b305a586eb552197fe96e3bf2fd95f3d5b81f79,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9804,1b305a586eb552197fe96e3bf2fd95f3d5b81f79,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9805,1b305a586eb552197fe96e3bf2fd95f3d5b81f79,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9806,1b305a586eb552197fe96e3bf2fd95f3d5b81f79,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9807,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
9808,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/Dockerfile,"# explicitly set user/group IDs
"
9809,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
9810,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9811,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9812,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9813,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9814,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9815,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9816,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.2/Dockerfile," # backwards compat
"
9817,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# vim:set ft=dockerfile:
"
9818,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# explicitly set user/group IDs
"
9819,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
9820,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
9821,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# grab gosu for easy step-down from root
"
9822,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9823,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9824,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9825,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
9826,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9827,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
9828,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# arches officialy built by upstream
"
9829,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9830,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
9831,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9832,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9833,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9834,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9835,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9836,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9837,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9838,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
9839,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9840,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
9841,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9842,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile," # backwards compat
"
9843,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9844,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9845,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9846,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
9847,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
9848,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
9849,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9850,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
9851,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9852,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9853,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9854,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9855,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9856,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9857,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9858,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9859,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9860,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9861,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9862,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9863,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/alpine/Dockerfile," # backwards compat
"
9864,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
9865,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# explicitly set user/group IDs
"
9866,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
9867,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9868,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9869,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9870,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9871,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# arches officialy built by upstream
"
9872,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9873,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9874,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9875,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9876,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9877,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9878,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9879,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9880,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9881,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9882,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9883,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile," # backwards compat
"
9884,a6d4922823aa8011513bb9c160c26c689301823a,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
9885,a6d4922823aa8011513bb9c160c26c689301823a,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9886,a6d4922823aa8011513bb9c160c26c689301823a,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
9887,a6d4922823aa8011513bb9c160c26c689301823a,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9888,a6d4922823aa8011513bb9c160c26c689301823a,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9889,123aedc09bc067740fb28921c500ded83c018bd4,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9890,123aedc09bc067740fb28921c500ded83c018bd4,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9891,123aedc09bc067740fb28921c500ded83c018bd4,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
9892,123aedc09bc067740fb28921c500ded83c018bd4,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
9893,123aedc09bc067740fb28921c500ded83c018bd4,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9894,123aedc09bc067740fb28921c500ded83c018bd4,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
9895,123aedc09bc067740fb28921c500ded83c018bd4,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9896,123aedc09bc067740fb28921c500ded83c018bd4,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9897,123aedc09bc067740fb28921c500ded83c018bd4,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9898,123aedc09bc067740fb28921c500ded83c018bd4,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9899,123aedc09bc067740fb28921c500ded83c018bd4,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9900,123aedc09bc067740fb28921c500ded83c018bd4,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9901,123aedc09bc067740fb28921c500ded83c018bd4,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9902,123aedc09bc067740fb28921c500ded83c018bd4,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9903,123aedc09bc067740fb28921c500ded83c018bd4,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9904,123aedc09bc067740fb28921c500ded83c018bd4,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9905,123aedc09bc067740fb28921c500ded83c018bd4,/9.3/alpine/Dockerfile," # backwards compat
"
9906,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9907,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9908,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
9909,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
9910,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9911,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9912,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9913,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9914,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9915,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9916,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9917,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9918,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9919,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9920,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
9921,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# explicitly set user/group IDs
"
9922,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
9923,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
9924,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
9925,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9926,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9927,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9928,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9929,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
9930,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# arches officialy built by upstream
"
9931,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9932,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
9933,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9934,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9935,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9936,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9937,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9938,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9939,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9940,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
9941,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9942,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9943,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9944,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile," # backwards compat
"
9945,2cab5040341f46331367f8766b4d249a5b7a9366,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
9946,2cab5040341f46331367f8766b4d249a5b7a9366,/9.6/Dockerfile,"# explicitly set user/group IDs
"
9947,2cab5040341f46331367f8766b4d249a5b7a9366,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
9948,2cab5040341f46331367f8766b4d249a5b7a9366,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9949,2cab5040341f46331367f8766b4d249a5b7a9366,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9950,2cab5040341f46331367f8766b4d249a5b7a9366,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9951,2cab5040341f46331367f8766b4d249a5b7a9366,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9952,2cab5040341f46331367f8766b4d249a5b7a9366,/9.6/Dockerfile,"# arches officialy built by upstream
"
9953,2cab5040341f46331367f8766b4d249a5b7a9366,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9954,2cab5040341f46331367f8766b4d249a5b7a9366,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9955,2cab5040341f46331367f8766b4d249a5b7a9366,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9956,2cab5040341f46331367f8766b4d249a5b7a9366,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9957,2cab5040341f46331367f8766b4d249a5b7a9366,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9958,2cab5040341f46331367f8766b4d249a5b7a9366,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9959,2cab5040341f46331367f8766b4d249a5b7a9366,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9960,2cab5040341f46331367f8766b4d249a5b7a9366,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9961,2cab5040341f46331367f8766b4d249a5b7a9366,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9962,2cab5040341f46331367f8766b4d249a5b7a9366,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9963,2cab5040341f46331367f8766b4d249a5b7a9366,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9964,2cab5040341f46331367f8766b4d249a5b7a9366,/9.6/Dockerfile," # backwards compat
"
9965,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
9966,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.3/Dockerfile,"# explicitly set user/group IDs
"
9967,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
9968,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9969,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9970,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9971,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9972,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9973,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
9974,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9975,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/10/alpine/Dockerfile,"#		krb5-dev \
"
9976,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/10/alpine/Dockerfile,"#		openldap-dev \
"
9977,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/10/alpine/Dockerfile,"# configure: error: prove not found
"
9978,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9979,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9980,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9981,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
9982,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9983,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9984,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9985,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9986,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9987,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9988,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9989,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9990,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9991,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9992,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/10/alpine/Dockerfile," # backwards compat
"
9993,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9994,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9995,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9996,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
9997,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
9998,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
9999,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10000,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10001,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10002,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10003,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10004,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10005,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10006,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10007,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10008,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10009,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10010,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10011,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10012,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10013,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/alpine/Dockerfile," # backwards compat
"
10014,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10015,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10016,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10017,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
10018,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
10019,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
10020,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10021,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10022,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10023,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10024,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10025,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10026,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10027,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10028,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10029,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10030,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10031,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10032,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10033,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile," # backwards compat
"
10034,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# vim:set ft=dockerfile:
"
10035,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# explicitly set user/group IDs
"
10036,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10037,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10038,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# grab gosu for easy step-down from root
"
10039,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10040,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10041,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10042,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10043,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
10044,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# arches officialy built by upstream
"
10045,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10046,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10047,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10048,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10049,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10050,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10051,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10052,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10053,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10054,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10055,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10056,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10057,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10058,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile," # backwards compat
"
10059,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10060,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10061,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10062,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/alpine/Dockerfile,"#		krb5-dev \
"
10063,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/alpine/Dockerfile,"#		openldap-dev \
"
10064,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/alpine/Dockerfile,"# configure: error: prove not found
"
10065,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10066,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10067,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10068,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10069,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10070,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10071,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10072,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10073,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10074,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10075,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10076,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10077,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10078,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10079,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/alpine/Dockerfile," # backwards compat
"
10080,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10081,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
10082,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10083,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"#		krb5-dev \
"
10084,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"#		openldap-dev \
"
10085,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# configure: error: prove not found
"
10086,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10087,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10088,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10089,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10090,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10091,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10092,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10093,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10094,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10095,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10096,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10097,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10098,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10099,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10100,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/Dockerfile,"# vim:set ft=dockerfile:
"
10101,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/Dockerfile,"# explicitly set user/group IDs
"
10102,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/Dockerfile,"# grab gosu for easy step-down from root
"
10103,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10104,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10105,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10106,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10107,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10108,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10109,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/Dockerfile," # backwards compat
"
10110,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10111,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10112,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
10113,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
10114,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10115,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10116,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10117,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10118,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10119,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10120,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10121,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10122,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10123,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10124,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10125,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10126,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10127,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"#		krb5-dev \
"
10128,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"#		openldap-dev \
"
10129,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# configure: error: prove not found
"
10130,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10131,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10132,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10133,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10134,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10135,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10136,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10137,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10138,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10139,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10140,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10141,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10142,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10143,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10144,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
10145,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
10146,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
10147,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10148,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10149,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10150,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10151,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10152,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
10153,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
10154,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
10155,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10156,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10157,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
10158,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10159,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10160,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10161,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10162,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10163,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10164,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10165,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10166,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10167,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10168,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10169,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10170,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10171,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile," # backwards compat
"
10172,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
10173,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/Dockerfile,"# explicitly set user/group IDs
"
10174,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
10175,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10176,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10177,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10178,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10179,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10180,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10181,63d966973d9593c0d9890b96f10ac73566913520,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
10182,63d966973d9593c0d9890b96f10ac73566913520,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
10183,63d966973d9593c0d9890b96f10ac73566913520,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
10184,63d966973d9593c0d9890b96f10ac73566913520,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10185,63d966973d9593c0d9890b96f10ac73566913520,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10186,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10187,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
10188,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10189,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
10190,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
10191,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
10192,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10193,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10194,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10195,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10196,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10197,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10198,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10199,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10200,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10201,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10202,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10203,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10204,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10205,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10206,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile," # backwards compat
"
10207,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# vim:set ft=dockerfile:
"
10208,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# explicitly set user/group IDs
"
10209,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10210,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10211,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# grab gosu for easy step-down from root
"
10212,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10213,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10214,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10215,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10216,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
10217,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# arches officialy built by upstream
"
10218,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10219,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10220,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10221,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10222,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10223,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10224,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10225,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10226,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10227,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10228,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10229,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10230,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10231,6d1f671dcd2c8d51484d19767a33c37110dd650f,/11/Dockerfile," # backwards compat
"
10232,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10233,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10234,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
10235,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
10236,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10237,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10238,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10239,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10240,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10241,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"# tzdata adds around 1Mb to image size, but it is suggested by Django documentation that timezone should be set for performance reasons: http://bit.ly/2fMYhh1
"
10242,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10243,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10244,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
10245,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# explicitly set user/group IDs
"
10246,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10247,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10248,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
10249,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10250,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10251,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10252,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
10253,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10254,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
10255,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# arches officialy built by upstream
"
10256,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10257,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10258,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10259,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10260,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10261,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10262,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10263,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10264,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10265,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10266,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10267,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10268,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10269,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile," # backwards compat
"
10270,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
10271,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# explicitly set user/group IDs
"
10272,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10273,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10274,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
10275,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10276,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10277,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10278,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10279,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
10280,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# arches officialy built by upstream
"
10281,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10282,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10283,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10284,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10285,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10286,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10287,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10288,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10289,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10290,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10291,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10292,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10293,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10294,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile," # backwards compat
"
10295,1c018f151e703e594e85cbb5c1dc7f6c38b7d49f,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
10296,1c018f151e703e594e85cbb5c1dc7f6c38b7d49f,/9.6/Dockerfile,"# explicitly set user/group IDs
"
10297,1c018f151e703e594e85cbb5c1dc7f6c38b7d49f,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
10298,1c018f151e703e594e85cbb5c1dc7f6c38b7d49f,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10299,1c018f151e703e594e85cbb5c1dc7f6c38b7d49f,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10300,1c018f151e703e594e85cbb5c1dc7f6c38b7d49f,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10301,1c018f151e703e594e85cbb5c1dc7f6c38b7d49f,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10302,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10303,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10304,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
10305,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
10306,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10307,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10308,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10309,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10310,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10311,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10312,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10313,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10314,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10315,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10316,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10317,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
10318,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
10319,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
10320,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10321,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10322,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10323,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10324,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10325,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10326,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10327,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10328,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10329,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10330,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10331,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10332,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10333,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10334,57213ab012e6a38a27283eeac65c4726c069647a,/9.4/alpine/Dockerfile," # backwards compat
"
10335,54f46e57136635b484295b985acd6e422d0b9583,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
10336,54f46e57136635b484295b985acd6e422d0b9583,/9.4/Dockerfile,"# explicitly set user/group IDs
"
10337,54f46e57136635b484295b985acd6e422d0b9583,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
10338,54f46e57136635b484295b985acd6e422d0b9583,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10339,54f46e57136635b484295b985acd6e422d0b9583,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10340,54f46e57136635b484295b985acd6e422d0b9583,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10341,54f46e57136635b484295b985acd6e422d0b9583,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10342,54f46e57136635b484295b985acd6e422d0b9583,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10343,54f46e57136635b484295b985acd6e422d0b9583,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10344,54f46e57136635b484295b985acd6e422d0b9583,/9.4/Dockerfile," # backwards compat
"
10345,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10346,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10347,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
10348,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
10349,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10350,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10351,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10352,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10353,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10354,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10355,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10356,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10357,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
10358,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
10359,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
10360,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10361,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10362,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
10363,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# explicitly set user/group IDs
"
10364,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10365,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10366,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
10367,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10368,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10369,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10370,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10371,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
10372,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# arches officialy built by upstream
"
10373,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10374,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10375,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10376,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10377,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10378,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10379,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10380,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10381,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10382,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10383,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10384,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10385,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10386,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile," # backwards compat
"
10387,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10388,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10389,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
10390,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
10391,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10392,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10393,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10394,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10395,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10396,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10397,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10398,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10399,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10400,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10401,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10402,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile," # backwards compat
"
10403,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10404,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
10405,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10406,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
10407,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
10408,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
10409,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10410,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10411,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10412,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10413,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10414,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10415,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10416,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10417,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10418,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10419,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10420,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10421,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10422,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10423,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile," # backwards compat
"
10424,639f83fb14161c8be60119b97bb9f88796776058,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
10425,639f83fb14161c8be60119b97bb9f88796776058,/9.5/Dockerfile,"# explicitly set user/group IDs
"
10426,639f83fb14161c8be60119b97bb9f88796776058,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
10427,639f83fb14161c8be60119b97bb9f88796776058,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10428,639f83fb14161c8be60119b97bb9f88796776058,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10429,639f83fb14161c8be60119b97bb9f88796776058,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10430,639f83fb14161c8be60119b97bb9f88796776058,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10431,639f83fb14161c8be60119b97bb9f88796776058,/9.5/Dockerfile,"# arches officialy built by upstream
"
10432,639f83fb14161c8be60119b97bb9f88796776058,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10433,639f83fb14161c8be60119b97bb9f88796776058,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10434,639f83fb14161c8be60119b97bb9f88796776058,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10435,639f83fb14161c8be60119b97bb9f88796776058,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10436,639f83fb14161c8be60119b97bb9f88796776058,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10437,639f83fb14161c8be60119b97bb9f88796776058,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10438,639f83fb14161c8be60119b97bb9f88796776058,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10439,639f83fb14161c8be60119b97bb9f88796776058,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10440,639f83fb14161c8be60119b97bb9f88796776058,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10441,639f83fb14161c8be60119b97bb9f88796776058,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10442,639f83fb14161c8be60119b97bb9f88796776058,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10443,639f83fb14161c8be60119b97bb9f88796776058,/9.5/Dockerfile," # backwards compat
"
10444,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# vim:set ft=dockerfile:
"
10445,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# explicitly set user/group IDs
"
10446,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10447,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10448,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
10449,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10450,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10451,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10452,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
10453,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10454,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
10455,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# arches officialy built by upstream
"
10456,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10457,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10458,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10459,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10460,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10461,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10462,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10463,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10464,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10465,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10466,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10467,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10468,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10469,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile," # backwards compat
"
10470,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10471,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10472,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10473,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
10474,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
10475,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
10476,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10477,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10478,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10479,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10480,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10481,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10482,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10483,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10484,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10485,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10486,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10487,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10488,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10489,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10490,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile," # backwards compat
"
10491,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
10492,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# explicitly set user/group IDs
"
10493,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10494,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10495,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
10496,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10497,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10498,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10499,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
10500,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10501,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
10502,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# arches officialy built by upstream
"
10503,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10504,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10505,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10506,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10507,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10508,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10509,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10510,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10511,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10512,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10513,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10514,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10515,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10516,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile," # backwards compat
"
10517,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# vim:set ft=dockerfile:
"
10518,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# explicitly set user/group IDs
"
10519,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10520,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10521,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# grab gosu for easy step-down from root
"
10522,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10523,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10524,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10525,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
10526,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10527,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
10528,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# arches officialy built by upstream
"
10529,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10530,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10531,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10532,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10533,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10534,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10535,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10536,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10537,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10538,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10539,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10540,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10541,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10542,4dc16e44d16480d9c8e5eb705c15468d65366e43,/12/Dockerfile," # backwards compat
"
10543,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# vim:set ft=dockerfile:
"
10544,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# explicitly set user/group IDs
"
10545,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# grab gosu for easy step-down from root
"
10546,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10547,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10548,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# arches officialy built by upstream
"
10549,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10550,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10551,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10552,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10553,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10554,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10555,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10556,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10557,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10558,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10559,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10560,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile," # backwards compat
"
10561,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
10562,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile,"# explicitly set user/group IDs
"
10563,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10564,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10565,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
10566,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10567,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10568,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10569,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10570,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile,"# arches officialy built by upstream
"
10571,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10572,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10573,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10574,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10575,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10576,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10577,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10578,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10579,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10580,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10581,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10582,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.5/Dockerfile," # backwards compat
"
10583,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# vim:set ft=dockerfile:
"
10584,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# explicitly set user/group IDs
"
10585,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10586,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10587,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# grab gosu for easy step-down from root
"
10588,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10589,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10590,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10591,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10592,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
10593,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# arches officialy built by upstream
"
10594,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10595,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10596,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10597,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10598,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10599,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10600,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10601,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10602,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10603,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10604,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10605,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10606,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10607,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile," # backwards compat
"
10608,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
10609,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
10610,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
10611,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10612,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10613,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
10614,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# explicitly set user/group IDs
"
10615,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
10616,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10617,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10618,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10619,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10620,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# arches officialy built by upstream
"
10621,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10622,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10623,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10624,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10625,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10626,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10627,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10628,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10629,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10630,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10631,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10632,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile," # backwards compat
"
10633,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# vim:set ft=dockerfile:
"
10634,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# explicitly set user/group IDs
"
10635,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10636,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10637,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# grab gosu for easy step-down from root
"
10638,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10639,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10640,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10641,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
10642,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10643,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
10644,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# arches officialy built by upstream
"
10645,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10646,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10647,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10648,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10649,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10650,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10651,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10652,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10653,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10654,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10655,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10656,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10657,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10658,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile," # backwards compat
"
10659,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"# vim:set ft=dockerfile:
"
10660,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"# explicitly set user/group IDs
"
10661,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10662,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10663,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"# grab gosu for easy step-down from root
"
10664,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10665,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10666,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10667,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10668,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
10669,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"# arches officialy built by upstream
"
10670,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10671,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10672,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10673,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10674,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10675,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10676,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10677,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10678,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10679,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10680,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10681,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10682,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10683,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/10/Dockerfile," # backwards compat
"
10684,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10685,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10686,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10687,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
10688,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
10689,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
10690,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10691,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10692,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10693,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10694,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10695,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10696,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10697,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10698,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10699,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10700,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10701,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10702,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10703,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10704,81a7cf454df3564035f66936839c7c3b29ae26ea,/9.5/alpine/Dockerfile," # backwards compat
"
10705,972294a377463156c8d61297320c872fc7d370a9,/10/Dockerfile,"# vim:set ft=dockerfile:
"
10706,972294a377463156c8d61297320c872fc7d370a9,/10/Dockerfile,"# explicitly set user/group IDs
"
10707,972294a377463156c8d61297320c872fc7d370a9,/10/Dockerfile,"# grab gosu for easy step-down from root
"
10708,972294a377463156c8d61297320c872fc7d370a9,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10709,972294a377463156c8d61297320c872fc7d370a9,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10710,972294a377463156c8d61297320c872fc7d370a9,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10711,972294a377463156c8d61297320c872fc7d370a9,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10712,972294a377463156c8d61297320c872fc7d370a9,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10713,972294a377463156c8d61297320c872fc7d370a9,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10714,972294a377463156c8d61297320c872fc7d370a9,/10/Dockerfile," # backwards compat
"
10715,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
10716,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/Dockerfile,"# explicitly set user/group IDs
"
10717,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
10718,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10719,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10720,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10721,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10722,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10723,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10724,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10725,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10726,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10727,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
10728,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
10729,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
10730,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10731,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10732,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10733,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10734,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10735,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10736,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10737,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10738,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10739,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10740,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10741,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10742,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10743,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10744,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile," # backwards compat
"
10745,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
10746,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
10747,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
10748,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10749,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10750,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10751,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10752,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
10753,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
10754,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10755,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10756,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10757,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10758,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10759,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10760,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10761,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10762,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"#		krb5-dev \
"
10763,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"#		openldap-dev \
"
10764,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# configure: error: prove not found
"
10765,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10766,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10767,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10768,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10769,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10770,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10771,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10772,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10773,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10774,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10775,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10776,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10777,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10778,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10779,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile," # backwards compat
"
10780,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10781,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10782,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10783,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
10784,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
10785,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
10786,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10787,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10788,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10789,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10790,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10791,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10792,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10793,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10794,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10795,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10796,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10797,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10798,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10799,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10800,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.6/alpine/Dockerfile," # backwards compat
"
10801,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
10802,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.4/Dockerfile,"# explicitly set user/group IDs
"
10803,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
10804,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10805,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10806,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# vim:set ft=dockerfile:
"
10807,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# explicitly set user/group IDs
"
10808,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# grab gosu for easy step-down from root
"
10809,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10810,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10811,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10812,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10813,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# arches officialy built by upstream
"
10814,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10815,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10816,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10817,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10818,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10819,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10820,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10821,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10822,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10823,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10824,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10825,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile," # backwards compat
"
10826,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
10827,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/Dockerfile,"# explicitly set user/group IDs
"
10828,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
10829,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10830,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10831,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/Dockerfile,"# arches officialy built by upstream
"
10832,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10833,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10834,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10835,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10836,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10837,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10838,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10839,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10840,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10841,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10842,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10843,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/Dockerfile," # backwards compat
"
10844,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10845,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10846,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
10847,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
10848,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10849,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10850,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10851,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10852,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10853,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10854,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10855,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10856,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10857,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10858,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10859,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10860,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10861,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
10862,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
10863,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10864,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10865,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10866,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10867,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10868,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10869,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10870,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10871,6abeb8590f35c5251b9f100a667024febaeee06b,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
10872,6abeb8590f35c5251b9f100a667024febaeee06b,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10873,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
10874,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# explicitly set user/group IDs
"
10875,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10876,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10877,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
10878,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10879,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10880,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10881,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10882,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
10883,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# arches officialy built by upstream
"
10884,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10885,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10886,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10887,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10888,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10889,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10890,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10891,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10892,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10893,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10894,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10895,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10896,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10897,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile," # backwards compat
"
10898,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10899,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
10900,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10901,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"#		krb5-dev \
"
10902,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"#		openldap-dev \
"
10903,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# configure: error: prove not found
"
10904,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10905,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10906,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10907,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
10908,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10909,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10910,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10911,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10912,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10913,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10914,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10915,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10916,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10917,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10918,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10919,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10920,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
10921,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
10922,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10923,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10924,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10925,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10926,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10927,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10928,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10929,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10930,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10931,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10932,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10933,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile," # backwards compat
"
10934,03f4064a045114f56fa445eb602339faaf79eeec,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10935,03f4064a045114f56fa445eb602339faaf79eeec,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10936,03f4064a045114f56fa445eb602339faaf79eeec,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
10937,03f4064a045114f56fa445eb602339faaf79eeec,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
10938,03f4064a045114f56fa445eb602339faaf79eeec,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10939,03f4064a045114f56fa445eb602339faaf79eeec,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10940,03f4064a045114f56fa445eb602339faaf79eeec,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10941,03f4064a045114f56fa445eb602339faaf79eeec,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10942,03f4064a045114f56fa445eb602339faaf79eeec,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10943,03f4064a045114f56fa445eb602339faaf79eeec,/9.4/alpine/Dockerfile,"# tzdata loading functionality is optional, and fails gracefully
#		tzdata \
"
10944,03f4064a045114f56fa445eb602339faaf79eeec,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10945,03f4064a045114f56fa445eb602339faaf79eeec,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10946,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
10947,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/Dockerfile,"# explicitly set user/group IDs
"
10948,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
10949,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10950,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10951,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10952,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10953,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10954,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10955,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.5/Dockerfile," # backwards compat
"
10956,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10957,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10958,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
10959,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
10960,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10961,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
10962,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10963,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10964,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10965,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10966,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10967,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10968,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10969,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10970,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10971,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10972,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.2/alpine/Dockerfile," # backwards compat
"
10973,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10974,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
10975,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10976,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/10/alpine/Dockerfile,"#		krb5-dev \
"
10977,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/10/alpine/Dockerfile,"#		openldap-dev \
"
10978,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/10/alpine/Dockerfile,"# configure: error: prove not found
"
10979,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10980,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10981,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10982,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10983,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10984,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10985,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10986,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10987,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10988,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10989,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10990,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10991,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10992,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10993,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/10/alpine/Dockerfile," # backwards compat
"
10994,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10995,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10996,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10997,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"#		krb5-dev \
"
10998,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"#		openldap-dev \
"
10999,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# configure: error: prove not found
"
11000,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11001,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11002,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11003,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11004,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11005,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11006,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11007,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11008,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11009,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11010,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11011,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11012,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11013,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11014,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile," # backwards compat
"
11015,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11016,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11017,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11018,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
11019,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
11020,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
11021,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11022,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11023,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11024,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11025,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11026,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11027,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11028,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11029,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11030,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11031,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11032,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11033,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11034,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile," # backwards compat
"
11035,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11036,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11037,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11038,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
11039,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
11040,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
11041,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11042,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11043,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
11044,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11045,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11046,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11047,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11048,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11049,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11050,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11051,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11052,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11053,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11054,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11055,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11056,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11057,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile," # backwards compat
"
11058,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
11059,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.4/Dockerfile,"# explicitly set user/group IDs
"
11060,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
11061,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11062,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11063,639f83fb14161c8be60119b97bb9f88796776058,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11064,639f83fb14161c8be60119b97bb9f88796776058,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11065,639f83fb14161c8be60119b97bb9f88796776058,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11066,639f83fb14161c8be60119b97bb9f88796776058,/11/alpine/Dockerfile,"#		krb5-dev \
"
11067,639f83fb14161c8be60119b97bb9f88796776058,/11/alpine/Dockerfile,"#		openldap-dev \
"
11068,639f83fb14161c8be60119b97bb9f88796776058,/11/alpine/Dockerfile,"# configure: error: prove not found
"
11069,639f83fb14161c8be60119b97bb9f88796776058,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11070,639f83fb14161c8be60119b97bb9f88796776058,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11071,639f83fb14161c8be60119b97bb9f88796776058,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11072,639f83fb14161c8be60119b97bb9f88796776058,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11073,639f83fb14161c8be60119b97bb9f88796776058,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11074,639f83fb14161c8be60119b97bb9f88796776058,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11075,639f83fb14161c8be60119b97bb9f88796776058,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11076,639f83fb14161c8be60119b97bb9f88796776058,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11077,639f83fb14161c8be60119b97bb9f88796776058,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11078,639f83fb14161c8be60119b97bb9f88796776058,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11079,639f83fb14161c8be60119b97bb9f88796776058,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11080,639f83fb14161c8be60119b97bb9f88796776058,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11081,639f83fb14161c8be60119b97bb9f88796776058,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11082,639f83fb14161c8be60119b97bb9f88796776058,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11083,639f83fb14161c8be60119b97bb9f88796776058,/11/alpine/Dockerfile," # backwards compat
"
11084,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11085,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
11086,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11087,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"#		krb5-dev \
"
11088,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"#		openldap-dev \
"
11089,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# configure: error: prove not found
"
11090,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11091,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11092,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11093,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
11094,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11095,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11096,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11097,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11098,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11099,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11100,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11101,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11102,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11103,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11104,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# vim:set ft=dockerfile:
"
11105,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# explicitly set user/group IDs
"
11106,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11107,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11108,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# grab gosu for easy step-down from root
"
11109,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11110,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11111,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11112,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11113,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
11114,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# arches officialy built by upstream
"
11115,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11116,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11117,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11118,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11119,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11120,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11121,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11122,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11123,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11124,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11125,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11126,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11127,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11128,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile," # backwards compat
"
11129,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
11130,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# explicitly set user/group IDs
"
11131,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11132,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11133,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
11134,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11135,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11136,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11137,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11138,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
11139,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# arches officialy built by upstream
"
11140,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11141,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11142,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11143,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11144,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11145,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11146,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11147,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11148,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11149,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11150,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11151,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11152,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11153,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile," # backwards compat
"
11154,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11155,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11156,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11157,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
11158,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
11159,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
11160,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11161,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11162,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11163,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11164,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11165,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11166,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11167,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11168,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11169,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11170,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11171,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11172,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11173,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11174,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile," # backwards compat
"
11175,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"# vim:set ft=dockerfile:
"
11176,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"# explicitly set user/group IDs
"
11177,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11178,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11179,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"# grab gosu for easy step-down from root
"
11180,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11181,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11182,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11183,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11184,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
11185,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"# arches officialy built by upstream
"
11186,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11187,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11188,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11189,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11190,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11191,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11192,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11193,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11194,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11195,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11196,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11197,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
11198,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11199,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/10/Dockerfile," # backwards compat
"
11200,54f46e57136635b484295b985acd6e422d0b9583,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11201,54f46e57136635b484295b985acd6e422d0b9583,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11202,54f46e57136635b484295b985acd6e422d0b9583,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
11203,54f46e57136635b484295b985acd6e422d0b9583,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
11204,54f46e57136635b484295b985acd6e422d0b9583,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11205,54f46e57136635b484295b985acd6e422d0b9583,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11206,54f46e57136635b484295b985acd6e422d0b9583,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11207,54f46e57136635b484295b985acd6e422d0b9583,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11208,54f46e57136635b484295b985acd6e422d0b9583,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11209,54f46e57136635b484295b985acd6e422d0b9583,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11210,54f46e57136635b484295b985acd6e422d0b9583,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11211,54f46e57136635b484295b985acd6e422d0b9583,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11212,54f46e57136635b484295b985acd6e422d0b9583,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11213,54f46e57136635b484295b985acd6e422d0b9583,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11214,54f46e57136635b484295b985acd6e422d0b9583,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11215,54f46e57136635b484295b985acd6e422d0b9583,/9.6/alpine/Dockerfile," # backwards compat
"
11216,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# vim:set ft=dockerfile:
"
11217,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# explicitly set user/group IDs
"
11218,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11219,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11220,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# grab gosu for easy step-down from root
"
11221,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11222,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11223,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11224,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11225,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
11226,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# arches officialy built by upstream
"
11227,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11228,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11229,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11230,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11231,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11232,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11233,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11234,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11235,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11236,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11237,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11238,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
11239,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11240,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile," # backwards compat
"
11241,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11242,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11243,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11244,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
11245,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
11246,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
11247,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11248,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11249,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11250,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11251,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11252,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11253,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11254,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11255,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11256,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11257,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11258,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11259,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11260,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile," # backwards compat
"
11261,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
11262,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.1/Dockerfile,"# explicitly set user/group IDs
"
11263,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
11264,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11265,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11266,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.1/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11267,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.1/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11268,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
11269,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.0/Dockerfile,"# explicitly set user/group IDs
"
11270,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
11271,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11272,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11273,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11274,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11275,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11276,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
11277,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
11278,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
11279,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11280,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11281,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11282,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11283,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11284,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11285,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11286,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11287,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11288,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11289,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11290,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11291,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11292,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11293,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.4/alpine/Dockerfile," # backwards compat
"
11294,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11295,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11296,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
11297,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
11298,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11299,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11300,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11301,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11302,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11303,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11304,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11305,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11306,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11307,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11308,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11309,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11310,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11311,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11312,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"#		krb5-dev \
"
11313,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"#		openldap-dev \
"
11314,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# configure: error: prove not found
"
11315,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11316,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11317,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11318,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11319,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11320,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11321,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11322,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11323,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11324,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11325,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11326,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11327,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11328,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11329,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile," # backwards compat
"
11330,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# vim:set ft=dockerfile:
"
11331,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# explicitly set user/group IDs
"
11332,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11333,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11334,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# grab gosu for easy step-down from root
"
11335,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11336,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11337,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11338,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
11339,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11340,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
11341,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# arches officialy built by upstream
"
11342,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11343,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11344,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11345,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11346,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11347,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11348,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11349,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11350,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11351,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11352,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11353,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
11354,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11355,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile," # backwards compat
"
11356,972294a377463156c8d61297320c872fc7d370a9,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
11357,972294a377463156c8d61297320c872fc7d370a9,/9.4/Dockerfile,"# explicitly set user/group IDs
"
11358,972294a377463156c8d61297320c872fc7d370a9,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
11359,972294a377463156c8d61297320c872fc7d370a9,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11360,972294a377463156c8d61297320c872fc7d370a9,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11361,972294a377463156c8d61297320c872fc7d370a9,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11362,972294a377463156c8d61297320c872fc7d370a9,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11363,972294a377463156c8d61297320c872fc7d370a9,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11364,972294a377463156c8d61297320c872fc7d370a9,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11365,972294a377463156c8d61297320c872fc7d370a9,/9.4/Dockerfile," # backwards compat
"
11366,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11367,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11368,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
11369,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
11370,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11371,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11372,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11373,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11374,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11375,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11376,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11377,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11378,904b4637237bf17657674bafe3ca42d241e3e745,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
11379,904b4637237bf17657674bafe3ca42d241e3e745,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
11380,904b4637237bf17657674bafe3ca42d241e3e745,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
11381,904b4637237bf17657674bafe3ca42d241e3e745,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11382,904b4637237bf17657674bafe3ca42d241e3e745,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11383,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# vim:set ft=dockerfile:
"
11384,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# explicitly set user/group IDs
"
11385,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11386,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11387,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# grab gosu for easy step-down from root
"
11388,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11389,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11390,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11391,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11392,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
11393,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# arches officialy built by upstream
"
11394,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11395,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11396,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11397,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11398,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11399,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11400,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11401,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11402,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11403,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11404,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11405,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11406,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11407,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile," # backwards compat
"
11408,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11409,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11410,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11411,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"#		krb5-dev \
"
11412,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"#		openldap-dev \
"
11413,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# configure: error: prove not found
"
11414,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11415,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11416,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11417,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11418,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11419,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11420,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11421,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11422,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11423,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11424,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11425,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11426,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11427,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11428,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile," # backwards compat
"
11429,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/Dockerfile,"# vim:set ft=dockerfile:
"
11430,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/Dockerfile,"# explicitly set user/group IDs
"
11431,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/Dockerfile,"# grab gosu for easy step-down from root
"
11432,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11433,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11434,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11435,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11436,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/Dockerfile,"# arches officialy built by upstream
"
11437,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11438,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11439,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11440,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11441,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11442,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11443,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11444,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11445,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11446,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11447,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11448,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/Dockerfile," # backwards compat
"
11449,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11450,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11451,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11452,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"#		krb5-dev \
"
11453,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"#		openldap-dev \
"
11454,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# configure: error: prove not found
"
11455,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11456,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11457,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11458,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11459,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11460,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11461,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11462,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11463,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11464,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11465,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11466,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11467,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11468,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11469,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile," # backwards compat
"
11470,01058c1847400919de5282ca825a7806a9dafcda,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11471,01058c1847400919de5282ca825a7806a9dafcda,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11472,01058c1847400919de5282ca825a7806a9dafcda,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11473,01058c1847400919de5282ca825a7806a9dafcda,/11/alpine/Dockerfile,"#		krb5-dev \
"
11474,01058c1847400919de5282ca825a7806a9dafcda,/11/alpine/Dockerfile,"#		openldap-dev \
"
11475,01058c1847400919de5282ca825a7806a9dafcda,/11/alpine/Dockerfile,"# configure: error: prove not found
"
11476,01058c1847400919de5282ca825a7806a9dafcda,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11477,01058c1847400919de5282ca825a7806a9dafcda,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11478,01058c1847400919de5282ca825a7806a9dafcda,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11479,01058c1847400919de5282ca825a7806a9dafcda,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11480,01058c1847400919de5282ca825a7806a9dafcda,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11481,01058c1847400919de5282ca825a7806a9dafcda,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11482,01058c1847400919de5282ca825a7806a9dafcda,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11483,01058c1847400919de5282ca825a7806a9dafcda,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11484,01058c1847400919de5282ca825a7806a9dafcda,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11485,01058c1847400919de5282ca825a7806a9dafcda,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11486,01058c1847400919de5282ca825a7806a9dafcda,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11487,01058c1847400919de5282ca825a7806a9dafcda,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11488,01058c1847400919de5282ca825a7806a9dafcda,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11489,01058c1847400919de5282ca825a7806a9dafcda,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11490,01058c1847400919de5282ca825a7806a9dafcda,/11/alpine/Dockerfile," # backwards compat
"
11491,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
11492,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
11493,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
11494,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11495,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11496,d2b38544770a63fed430694a7aed33de3ad8b808,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11497,d2b38544770a63fed430694a7aed33de3ad8b808,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11498,d2b38544770a63fed430694a7aed33de3ad8b808,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
11499,d2b38544770a63fed430694a7aed33de3ad8b808,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
11500,d2b38544770a63fed430694a7aed33de3ad8b808,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11501,d2b38544770a63fed430694a7aed33de3ad8b808,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11502,d2b38544770a63fed430694a7aed33de3ad8b808,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11503,d2b38544770a63fed430694a7aed33de3ad8b808,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11504,d2b38544770a63fed430694a7aed33de3ad8b808,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11505,d2b38544770a63fed430694a7aed33de3ad8b808,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11506,d2b38544770a63fed430694a7aed33de3ad8b808,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11507,d2b38544770a63fed430694a7aed33de3ad8b808,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11508,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
11509,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# explicitly set user/group IDs
"
11510,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11511,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11512,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
11513,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11514,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11515,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11516,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11517,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
11518,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# arches officialy built by upstream
"
11519,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11520,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11521,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11522,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11523,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11524,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11525,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11526,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11527,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11528,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11529,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11530,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
11531,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11532,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.6/Dockerfile," # backwards compat
"
11533,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
11534,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.5/Dockerfile,"# explicitly set user/group IDs
"
11535,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
11536,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11537,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11538,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11539,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11540,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11541,01058c1847400919de5282ca825a7806a9dafcda,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11542,01058c1847400919de5282ca825a7806a9dafcda,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11543,01058c1847400919de5282ca825a7806a9dafcda,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11544,01058c1847400919de5282ca825a7806a9dafcda,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
11545,01058c1847400919de5282ca825a7806a9dafcda,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
11546,01058c1847400919de5282ca825a7806a9dafcda,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
11547,01058c1847400919de5282ca825a7806a9dafcda,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11548,01058c1847400919de5282ca825a7806a9dafcda,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11549,01058c1847400919de5282ca825a7806a9dafcda,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11550,01058c1847400919de5282ca825a7806a9dafcda,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11551,01058c1847400919de5282ca825a7806a9dafcda,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11552,01058c1847400919de5282ca825a7806a9dafcda,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11553,01058c1847400919de5282ca825a7806a9dafcda,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11554,01058c1847400919de5282ca825a7806a9dafcda,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11555,01058c1847400919de5282ca825a7806a9dafcda,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11556,01058c1847400919de5282ca825a7806a9dafcda,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11557,01058c1847400919de5282ca825a7806a9dafcda,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11558,01058c1847400919de5282ca825a7806a9dafcda,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11559,01058c1847400919de5282ca825a7806a9dafcda,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11560,01058c1847400919de5282ca825a7806a9dafcda,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11561,01058c1847400919de5282ca825a7806a9dafcda,/9.4/alpine/Dockerfile," # backwards compat
"
11562,d2b38544770a63fed430694a7aed33de3ad8b808,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11563,d2b38544770a63fed430694a7aed33de3ad8b808,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11564,d2b38544770a63fed430694a7aed33de3ad8b808,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
11565,d2b38544770a63fed430694a7aed33de3ad8b808,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
11566,d2b38544770a63fed430694a7aed33de3ad8b808,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11567,d2b38544770a63fed430694a7aed33de3ad8b808,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11568,d2b38544770a63fed430694a7aed33de3ad8b808,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11569,d2b38544770a63fed430694a7aed33de3ad8b808,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11570,d2b38544770a63fed430694a7aed33de3ad8b808,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11571,d2b38544770a63fed430694a7aed33de3ad8b808,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11572,d2b38544770a63fed430694a7aed33de3ad8b808,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11573,d2b38544770a63fed430694a7aed33de3ad8b808,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11574,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
11575,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.4/Dockerfile,"# explicitly set user/group IDs
"
11576,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
11577,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11578,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11579,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
11580,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.5/Dockerfile,"# explicitly set user/group IDs
"
11581,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
11582,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11583,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11584,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11585,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11586,546985f5cdd006c26cad6a5ee9c3e7ee666dc08c,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
11587,546985f5cdd006c26cad6a5ee9c3e7ee666dc08c,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
11588,546985f5cdd006c26cad6a5ee9c3e7ee666dc08c,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
11589,546985f5cdd006c26cad6a5ee9c3e7ee666dc08c,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11590,546985f5cdd006c26cad6a5ee9c3e7ee666dc08c,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11591,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
11592,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"# explicitly set user/group IDs
"
11593,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11594,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11595,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
11596,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11597,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11598,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11599,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11600,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
11601,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"# arches officialy built by upstream
"
11602,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11603,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11604,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11605,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11606,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11607,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11608,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11609,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11610,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11611,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11612,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11613,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
11614,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11615,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.5/Dockerfile," # backwards compat
"
11616,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
11617,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"# explicitly set user/group IDs
"
11618,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11619,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11620,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
11621,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11622,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11623,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11624,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11625,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"# see note below about ""*.pyc"" files
"
11626,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"# arches officialy built by upstream
"
11627,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11628,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11629,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11630,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11631,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11632,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11633,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11634,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11635,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11636,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11637,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11638,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
11639,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11640,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.3/Dockerfile," # backwards compat
"
11641,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11642,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
11643,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11644,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
11645,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
11646,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
11647,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11648,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11649,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11650,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
11651,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11652,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11653,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11654,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11655,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11656,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11657,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11658,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11659,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11660,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11661,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile," # backwards compat
"
11662,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# vim:set ft=dockerfile:
"
11663,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# explicitly set user/group IDs
"
11664,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11665,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11666,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# grab gosu for easy step-down from root
"
11667,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11668,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11669,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11670,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11671,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
11672,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# arches officialy built by upstream
"
11673,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11674,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11675,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11676,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11677,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11678,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11679,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11680,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11681,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11682,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11683,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11684,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11685,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11686,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile," # backwards compat
"
11687,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11688,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11689,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
11690,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
11691,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11692,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11693,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11694,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11695,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11696,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11697,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11698,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11699,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# vim:set ft=dockerfile:
"
11700,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# explicitly set user/group IDs
"
11701,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11702,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11703,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# grab gosu for easy step-down from root
"
11704,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11705,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11706,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11707,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11708,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
11709,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# arches officialy built by upstream
"
11710,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11711,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11712,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11713,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11714,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11715,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11716,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11717,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11718,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11719,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11720,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11721,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11722,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11723,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile," # backwards compat
"
11724,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
11725,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.0/Dockerfile,"# explicitly set user/group IDs
"
11726,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
11727,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11728,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11729,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
11730,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.2/Dockerfile,"# explicitly set user/group IDs
"
11731,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
11732,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11733,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11734,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11735,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11736,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
11737,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# explicitly set user/group IDs
"
11738,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
11739,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11740,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11741,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11742,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11743,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# arches officialy built by upstream
"
11744,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11745,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11746,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11747,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11748,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11749,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11750,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11751,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11752,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11753,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11754,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11755,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile," # backwards compat
"
11756,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11757,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
11758,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11759,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/11/alpine/Dockerfile,"#		krb5-dev \
"
11760,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/11/alpine/Dockerfile,"#		openldap-dev \
"
11761,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/11/alpine/Dockerfile,"# configure: error: prove not found
"
11762,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11763,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11764,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11765,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11766,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11767,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11768,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11769,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11770,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11771,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11772,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11773,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11774,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11775,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11776,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/11/alpine/Dockerfile," # backwards compat
"
11777,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
11778,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
11779,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
11780,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11781,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11782,5f401753715311752f2346cdbd32bd55e7251ddd,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
11783,5f401753715311752f2346cdbd32bd55e7251ddd,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
11784,5f401753715311752f2346cdbd32bd55e7251ddd,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
11785,5f401753715311752f2346cdbd32bd55e7251ddd,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11786,5f401753715311752f2346cdbd32bd55e7251ddd,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11787,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11788,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11789,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11790,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
11791,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
11792,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# configure: error: prove not found
"
11793,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11794,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11795,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
11796,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11797,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11798,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11799,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11800,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11801,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11802,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11803,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11804,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11805,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11806,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11807,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11808,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile," # backwards compat
"
11809,688e034f8363083cc2b1b8f8c93236c4b4445e0f,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11810,688e034f8363083cc2b1b8f8c93236c4b4445e0f,/9.5/alpine/Dockerfile,"# explicitly set user/group IDs
#RUN adduser -S -G postgres -u 999 postgres

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11811,688e034f8363083cc2b1b8f8c93236c4b4445e0f,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11812,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
11813,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# explicitly set user/group IDs
"
11814,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11815,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11816,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
11817,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11818,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11819,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11820,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11821,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
11822,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# arches officialy built by upstream
"
11823,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11824,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11825,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11826,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11827,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11828,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11829,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11830,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11831,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11832,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11833,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11834,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
11835,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11836,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile," # backwards compat
"
11837,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
11838,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# explicitly set user/group IDs
"
11839,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
11840,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11841,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11842,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# arches officialy built by upstream
"
11843,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11844,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11845,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11846,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11847,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11848,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11849,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11850,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11851,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11852,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11853,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11854,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile," # backwards compat
"
11855,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/Dockerfile,"# vim:set ft=dockerfile:
"
11856,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/Dockerfile,"# explicitly set user/group IDs
"
11857,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/Dockerfile,"# grab gosu for easy step-down from root
"
11858,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11859,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11860,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11861,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11862,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11863,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11864,466a61bac6997c368be02dff5eb43673c4ce3fa9,/10/Dockerfile," # backwards compat
"
11865,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11866,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11867,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11868,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"#		krb5-dev \
"
11869,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"#		openldap-dev \
"
11870,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# configure: error: prove not found
"
11871,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11872,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11873,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11874,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11875,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11876,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11877,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11878,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11879,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11880,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11881,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11882,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11883,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11884,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11885,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile," # backwards compat
"
11886,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11887,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11888,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11889,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/alpine/Dockerfile,"#		krb5-dev \
"
11890,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/alpine/Dockerfile,"#		openldap-dev \
"
11891,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/alpine/Dockerfile,"# configure: error: prove not found
"
11892,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11893,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11894,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11895,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11896,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11897,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11898,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11899,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11900,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11901,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11902,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11903,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11904,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11905,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11906,03f4064a045114f56fa445eb602339faaf79eeec,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11907,03f4064a045114f56fa445eb602339faaf79eeec,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11908,03f4064a045114f56fa445eb602339faaf79eeec,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
11909,03f4064a045114f56fa445eb602339faaf79eeec,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
11910,03f4064a045114f56fa445eb602339faaf79eeec,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11911,03f4064a045114f56fa445eb602339faaf79eeec,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11912,03f4064a045114f56fa445eb602339faaf79eeec,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11913,03f4064a045114f56fa445eb602339faaf79eeec,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11914,03f4064a045114f56fa445eb602339faaf79eeec,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11915,03f4064a045114f56fa445eb602339faaf79eeec,/9.3/alpine/Dockerfile,"# tzdata loading functionality is optional, and fails gracefully
#		tzdata \
"
11916,03f4064a045114f56fa445eb602339faaf79eeec,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11917,03f4064a045114f56fa445eb602339faaf79eeec,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11918,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
11919,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# explicitly set user/group IDs
"
11920,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
11921,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11922,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11923,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# arches officialy built by upstream
"
11924,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11925,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11926,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11927,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11928,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11929,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11930,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11931,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11932,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11933,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11934,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11935,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile," # backwards compat
"
11936,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11937,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11938,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11939,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
11940,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
11941,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
11942,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11943,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11944,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11945,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11946,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11947,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11948,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11949,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11950,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11951,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11952,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11953,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11954,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11955,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11956,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile," # backwards compat
"
11957,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11958,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11959,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11960,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
11961,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
11962,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
11963,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11964,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11965,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11966,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11967,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11968,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11969,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11970,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11971,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11972,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11973,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11974,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11975,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11976,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11977,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile," # backwards compat
"
11978,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
11979,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# explicitly set user/group IDs
"
11980,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
11981,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11982,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11983,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11984,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# arches officialy built by upstream
"
11985,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11986,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11987,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11988,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11989,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11990,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11991,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11992,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11993,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11994,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11995,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11996,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile," # backwards compat
"
11997,6fabe2e39c165dd1e2e32f8b758f2c02ded20d8f,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
11998,6fabe2e39c165dd1e2e32f8b758f2c02ded20d8f,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11999,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile,"# vim:set ft=dockerfile:
"
12000,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile,"# explicitly set user/group IDs
"
12001,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
12002,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
12003,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile,"# grab gosu for easy step-down from root
"
12004,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12005,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12006,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
12007,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12008,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile,"# arches officialy built by upstream
"
12009,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12010,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12011,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12012,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12013,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12014,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12015,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12016,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12017,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12018,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12019,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12020,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/11/Dockerfile," # backwards compat
"
12021,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
12022,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"# explicitly set user/group IDs
"
12023,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
12024,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
12025,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
12026,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12027,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12028,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
12029,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12030,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
12031,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"# arches officialy built by upstream
"
12032,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12033,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
12034,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12035,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12036,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12037,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12038,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12039,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12040,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12041,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
12042,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12043,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12044,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12045,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.5/Dockerfile," # backwards compat
"
12046,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12047,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12048,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
12049,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
12050,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12051,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12052,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12053,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12054,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12055,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12056,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12057,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12058,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12059,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12060,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12061,64e333ff1fd67c1d37ee99343d64770f41d3bfc6,/9.5/alpine/Dockerfile," # backwards compat
"
12062,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12063,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12064,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
12065,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
12066,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12067,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12068,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12069,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12070,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12071,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12072,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12073,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12074,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12075,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12076,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12077,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12078,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12079,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12080,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
12081,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
12082,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
12083,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12084,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12085,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12086,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12087,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12088,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12089,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12090,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12091,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12092,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12093,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12094,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12095,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12096,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile," # backwards compat
"
12097,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12098,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
12099,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12100,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
12101,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
12102,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
12103,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12104,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12105,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12106,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12107,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12108,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12109,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12110,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12111,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12112,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12113,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12114,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12115,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12116,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12117,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/9.6/alpine/Dockerfile," # backwards compat
"
12118,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
12119,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.4/Dockerfile,"# explicitly set user/group IDs
"
12120,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
12121,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12122,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12123,8a9fbcb40f13ccc7762f278b9df611cabe22d300,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
12124,8a9fbcb40f13ccc7762f278b9df611cabe22d300,/9.5/Dockerfile,"# explicitly set user/group IDs
"
12125,8a9fbcb40f13ccc7762f278b9df611cabe22d300,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
12126,8a9fbcb40f13ccc7762f278b9df611cabe22d300,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12127,8a9fbcb40f13ccc7762f278b9df611cabe22d300,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12128,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12129,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12130,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
12131,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
12132,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12133,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12134,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12135,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12136,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12137,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12138,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12139,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12140,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12141,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12142,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12143,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile," # backwards compat
"
12144,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12145,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12146,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12147,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
12148,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
12149,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# configure: error: prove not found
"
12150,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12151,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12152,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
12153,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12154,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12155,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12156,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12157,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12158,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12159,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12160,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12161,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12162,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12163,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12164,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12165,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile," # backwards compat
"
12166,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
12167,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12168,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
12169,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12170,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12171,57213ab012e6a38a27283eeac65c4726c069647a,/10/Dockerfile,"# vim:set ft=dockerfile:
"
12172,57213ab012e6a38a27283eeac65c4726c069647a,/10/Dockerfile,"# explicitly set user/group IDs
"
12173,57213ab012e6a38a27283eeac65c4726c069647a,/10/Dockerfile,"# grab gosu for easy step-down from root
"
12174,57213ab012e6a38a27283eeac65c4726c069647a,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12175,57213ab012e6a38a27283eeac65c4726c069647a,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12176,57213ab012e6a38a27283eeac65c4726c069647a,/10/Dockerfile,"# arches officialy built by upstream
"
12177,57213ab012e6a38a27283eeac65c4726c069647a,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12178,57213ab012e6a38a27283eeac65c4726c069647a,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12179,57213ab012e6a38a27283eeac65c4726c069647a,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12180,57213ab012e6a38a27283eeac65c4726c069647a,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12181,57213ab012e6a38a27283eeac65c4726c069647a,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12182,57213ab012e6a38a27283eeac65c4726c069647a,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12183,57213ab012e6a38a27283eeac65c4726c069647a,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12184,57213ab012e6a38a27283eeac65c4726c069647a,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12185,57213ab012e6a38a27283eeac65c4726c069647a,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12186,57213ab012e6a38a27283eeac65c4726c069647a,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12187,57213ab012e6a38a27283eeac65c4726c069647a,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12188,57213ab012e6a38a27283eeac65c4726c069647a,/10/Dockerfile," # backwards compat
"
12189,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
12190,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# explicitly set user/group IDs
"
12191,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
12192,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12193,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12194,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12195,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# arches officialy built by upstream
"
12196,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12197,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12198,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12199,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12200,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12201,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12202,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12203,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12204,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12205,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12206,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12207,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile," # backwards compat
"
12208,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# vim:set ft=dockerfile:
"
12209,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# explicitly set user/group IDs
"
12210,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
12211,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
12212,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# grab gosu for easy step-down from root
"
12213,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12214,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12215,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
12216,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
12217,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12218,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
12219,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# arches officialy built by upstream
"
12220,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12221,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
12222,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12223,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12224,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12225,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12226,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12227,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12228,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12229,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
12230,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12231,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
12232,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12233,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile," # backwards compat
"
12234,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# vim:set ft=dockerfile:
"
12235,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# explicitly set user/group IDs
"
12236,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# grab gosu for easy step-down from root
"
12237,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12238,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12239,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
12240,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12241,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# arches officialy built by upstream
"
12242,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12243,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12244,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12245,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12246,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12247,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12248,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12249,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12250,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12251,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12252,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12253,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile," # backwards compat
"
12254,e7222bf98572eec2a7b8875c13825015a163091c,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
12255,e7222bf98572eec2a7b8875c13825015a163091c,/9.6/Dockerfile,"# explicitly set user/group IDs
"
12256,e7222bf98572eec2a7b8875c13825015a163091c,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
12257,e7222bf98572eec2a7b8875c13825015a163091c,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12258,e7222bf98572eec2a7b8875c13825015a163091c,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12259,e7222bf98572eec2a7b8875c13825015a163091c,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12260,e7222bf98572eec2a7b8875c13825015a163091c,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12261,e7222bf98572eec2a7b8875c13825015a163091c,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12262,e7222bf98572eec2a7b8875c13825015a163091c,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12263,e7222bf98572eec2a7b8875c13825015a163091c,/9.6/Dockerfile," # backwards compat
"
12264,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12265,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12266,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
12267,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
12268,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12269,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12270,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12271,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12272,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12273,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
12274,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12275,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
12276,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12277,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12278,b36f03d03593858497e1dda862c732cd1eb2ce86,/8.4/Dockerfile,"# vim:set ft=dockerfile:
"
12279,b36f03d03593858497e1dda862c732cd1eb2ce86,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12280,b36f03d03593858497e1dda862c732cd1eb2ce86,/8.4/Dockerfile,"# grab gosu for easy step-down from root
"
12281,b36f03d03593858497e1dda862c732cd1eb2ce86,/8.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12282,b36f03d03593858497e1dda862c732cd1eb2ce86,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12283,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
12284,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# explicitly set user/group IDs
"
12285,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
12286,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
12287,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
12288,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12289,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12290,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
12291,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12292,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
12293,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# arches officialy built by upstream
"
12294,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12295,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
12296,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12297,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12298,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12299,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12300,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12301,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12302,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12303,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
12304,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12305,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
12306,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12307,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile," # backwards compat
"
12308,783906f551b9bc1472751200296f93bb2c55bc44,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
12309,783906f551b9bc1472751200296f93bb2c55bc44,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12310,783906f551b9bc1472751200296f93bb2c55bc44,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12311,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12312,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12313,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12314,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
12315,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
12316,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
12317,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12318,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12319,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12320,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12321,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12322,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12323,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12324,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12325,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12326,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12327,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12328,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12329,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12330,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12331,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile," # backwards compat
"
12332,6abeb8590f35c5251b9f100a667024febaeee06b,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12333,6abeb8590f35c5251b9f100a667024febaeee06b,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12334,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12335,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12336,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12337,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
12338,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
12339,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
12340,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12341,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12342,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
12343,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12344,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12345,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12346,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12347,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12348,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12349,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12350,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12351,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12352,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12353,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12354,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12355,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile," # backwards compat
"
12356,7c8e945a80097e80fa1c8d69d2a027145177b701,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12357,7c8e945a80097e80fa1c8d69d2a027145177b701,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12358,7c8e945a80097e80fa1c8d69d2a027145177b701,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12359,7c8e945a80097e80fa1c8d69d2a027145177b701,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12360,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12361,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
12362,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12363,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
12364,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
12365,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
12366,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12367,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12368,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12369,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12370,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12371,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12372,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12373,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12374,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12375,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12376,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12377,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12378,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12379,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12380,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile," # backwards compat
"
12381,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12382,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
12383,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12384,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"#		krb5-dev \
"
12385,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"#		openldap-dev \
"
12386,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# configure: error: prove not found
"
12387,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12388,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12389,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12390,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12391,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12392,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12393,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12394,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12395,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12396,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12397,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12398,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12399,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12400,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12401,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile," # backwards compat
"
12402,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12403,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12404,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12405,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
12406,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
12407,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
12408,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12409,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12410,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
12411,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12412,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12413,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12414,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12415,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12416,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12417,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12418,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12419,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12420,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12421,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12422,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12423,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12424,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile," # backwards compat
"
12425,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12426,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12427,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12428,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/11/alpine/Dockerfile,"#		krb5-dev \
"
12429,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/11/alpine/Dockerfile,"#		openldap-dev \
"
12430,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/11/alpine/Dockerfile,"# configure: error: prove not found
"
12431,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12432,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12433,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12434,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12435,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12436,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12437,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12438,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12439,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12440,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12441,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12442,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12443,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12444,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12445,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/11/alpine/Dockerfile," # backwards compat
"
12446,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12447,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.4/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
12448,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12449,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
12450,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
12451,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
12452,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12453,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12454,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12455,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12456,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12457,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12458,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12459,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12460,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12461,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12462,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12463,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12464,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12465,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12466,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.4/alpine/Dockerfile," # backwards compat
"
12467,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
12468,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/Dockerfile,"# explicitly set user/group IDs
"
12469,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
12470,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12471,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12472,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12473,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12474,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12475,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12476,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# vim:set ft=dockerfile:
"
12477,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# explicitly set user/group IDs
"
12478,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
12479,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
12480,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# grab gosu for easy step-down from root
"
12481,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12482,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12483,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
12484,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12485,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
12486,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# arches officialy built by upstream
"
12487,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12488,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
12489,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12490,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12491,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12492,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12493,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12494,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12495,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12496,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
12497,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12498,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
12499,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12500,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile," # backwards compat
"
12501,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
12502,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12503,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
12504,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12505,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12506,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
12507,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# explicitly set user/group IDs
"
12508,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
12509,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12510,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12511,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
12512,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12513,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# arches officialy built by upstream
"
12514,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12515,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12516,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12517,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12518,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12519,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12520,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12521,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12522,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12523,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12524,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12525,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile," # backwards compat
"
12526,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# vim:set ft=dockerfile:
"
12527,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# explicitly set user/group IDs
"
12528,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
12529,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
12530,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# grab gosu for easy step-down from root
"
12531,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12532,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12533,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
12534,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12535,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
12536,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# arches officialy built by upstream
"
12537,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12538,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
12539,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12540,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12541,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12542,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12543,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12544,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12545,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12546,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
12547,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12548,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
12549,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12550,59e5a640e9d4896f5d35261fc69402f2f174833b,/11/Dockerfile," # backwards compat
"
12551,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12552,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12553,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
12554,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
12555,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12556,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12557,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12558,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12559,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12560,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12561,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12562,12462bdfdf7d7f1f1d1f42cb09db579977a75d0b,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12563,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
12564,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/Dockerfile,"# explicitly set user/group IDs
"
12565,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
12566,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12567,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12568,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12569,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12570,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12571,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12572,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/Dockerfile," # backwards compat
"
12573,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12574,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12575,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12576,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
12577,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
12578,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
12579,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12580,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12581,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
12582,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12583,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12584,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12585,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12586,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12587,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12588,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12589,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12590,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12591,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12592,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12593,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12594,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12595,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/alpine/Dockerfile," # backwards compat
"
12596,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12597,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12598,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
12599,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
12600,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12601,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12602,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12603,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12604,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12605,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12606,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12607,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12608,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12609,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12610,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12611,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
12612,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
12613,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
12614,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12615,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12616,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12617,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12618,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12619,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12620,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12621,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12622,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12623,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12624,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12625,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12626,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12627,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12628,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile," # backwards compat
"
12629,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
12630,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# explicitly set user/group IDs
"
12631,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
12632,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12633,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12634,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# arches officialy built by upstream
"
12635,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12636,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12637,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12638,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12639,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12640,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12641,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12642,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12643,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12644,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12645,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12646,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile," # backwards compat
"
12647,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# vim:set ft=dockerfile:
"
12648,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# explicitly set user/group IDs
"
12649,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
12650,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
12651,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# grab gosu for easy step-down from root
"
12652,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12653,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12654,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
12655,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
12656,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12657,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
12658,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# arches officialy built by upstream
"
12659,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12660,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
12661,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12662,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12663,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12664,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12665,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12666,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12667,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12668,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
12669,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12670,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
12671,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12672,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/12/Dockerfile," # backwards compat
"
12673,db63c8c4eff2aa81c3f2c9e42f1ede447c7cf99c,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
12674,db63c8c4eff2aa81c3f2c9e42f1ede447c7cf99c,/9.5/Dockerfile,"# explicitly set user/group IDs
"
12675,db63c8c4eff2aa81c3f2c9e42f1ede447c7cf99c,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
12676,db63c8c4eff2aa81c3f2c9e42f1ede447c7cf99c,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12677,db63c8c4eff2aa81c3f2c9e42f1ede447c7cf99c,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12678,db63c8c4eff2aa81c3f2c9e42f1ede447c7cf99c,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12679,db63c8c4eff2aa81c3f2c9e42f1ede447c7cf99c,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12680,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
12681,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/Dockerfile,"# explicitly set user/group IDs
"
12682,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
12683,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12684,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12685,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12686,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12687,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12688,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12689,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/Dockerfile," # backwards compat
"
12690,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
12691,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12692,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
12693,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12694,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12695,486194c97f07875c5d0912da911c719671747d0c,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
12696,486194c97f07875c5d0912da911c719671747d0c,/9.5/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12697,486194c97f07875c5d0912da911c719671747d0c,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
12698,486194c97f07875c5d0912da911c719671747d0c,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12699,486194c97f07875c5d0912da911c719671747d0c,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12700,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12701,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
12702,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12703,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
12704,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
12705,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
12706,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12707,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12708,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12709,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12710,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12711,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12712,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12713,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12714,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12715,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12716,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12717,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12718,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12719,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12720,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/alpine/Dockerfile," # backwards compat
"
12721,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
12722,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.4/Dockerfile,"# explicitly set user/group IDs
"
12723,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
12724,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12725,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12726,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12727,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12728,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12729,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# vim:set ft=dockerfile:
"
12730,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# explicitly set user/group IDs
"
12731,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
12732,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
12733,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# grab gosu for easy step-down from root
"
12734,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12735,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12736,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
12737,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
12738,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12739,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
12740,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# arches officialy built by upstream
"
12741,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12742,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
12743,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12744,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12745,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12746,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12747,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12748,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12749,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12750,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
12751,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12752,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
12753,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12754,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile," # backwards compat
"
12755,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12756,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12757,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
12758,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
12759,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12760,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12761,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12762,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12763,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12764,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"# tzdata adds around 1Mb to image size, but it is suggested by Django documentation that timezone should be set for performance reasons: http://bit.ly/2fMYhh1
"
12765,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12766,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12767,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12768,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
12769,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12770,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/12/alpine/Dockerfile,"#		krb5-dev \
"
12771,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/12/alpine/Dockerfile,"#		openldap-dev \
"
12772,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/12/alpine/Dockerfile,"# configure: error: prove not found
"
12773,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12774,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12775,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12776,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12777,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12778,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12779,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12780,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12781,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12782,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12783,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12784,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12785,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12786,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12787,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
12788,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12789,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
12790,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12791,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12792,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
12793,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12794,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
12795,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12796,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12797,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12798,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12799,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12800,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
12801,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
12802,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
12803,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12804,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12805,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12806,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12807,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12808,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12809,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12810,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12811,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12812,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12813,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12814,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12815,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12816,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12817,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile," # backwards compat
"
12818,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
12819,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# explicitly set user/group IDs
"
12820,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
12821,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12822,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12823,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# arches officialy built by upstream
"
12824,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12825,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12826,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12827,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12828,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12829,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12830,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12831,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12832,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12833,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12834,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12835,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile," # backwards compat
"
12836,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12837,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12838,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12839,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
12840,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
12841,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
12842,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12843,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12844,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12845,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12846,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12847,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12848,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12849,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12850,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12851,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12852,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12853,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12854,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.4/alpine/Dockerfile," # backwards compat
"
12855,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12856,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
12857,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12858,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"#		krb5-dev \
"
12859,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"#		openldap-dev \
"
12860,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# configure: error: prove not found
"
12861,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12862,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12863,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12864,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12865,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12866,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12867,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12868,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12869,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12870,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12871,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12872,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12873,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12874,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12875,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12876,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12877,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12878,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"#		krb5-dev \
"
12879,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"#		openldap-dev \
"
12880,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# configure: error: prove not found
"
12881,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12882,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12883,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12884,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12885,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12886,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12887,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12888,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12889,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12890,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12891,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12892,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12893,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12894,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12895,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile," # backwards compat
"
12896,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
12897,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# explicitly set user/group IDs
"
12898,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
12899,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
12900,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
12901,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12902,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12903,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
12904,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
12905,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12906,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
12907,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# arches officialy built by upstream
"
12908,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12909,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
12910,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12911,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12912,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12913,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12914,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12915,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12916,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12917,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
12918,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12919,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
12920,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12921,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile," # backwards compat
"
12922,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
12923,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.3/Dockerfile,"# explicitly set user/group IDs
"
12924,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
12925,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12926,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12927,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.3/Dockerfile,"# arches officialy built by upstream
"
12928,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12929,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12930,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12931,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12932,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12933,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12934,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12935,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12936,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12937,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12938,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12939,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.3/Dockerfile," # backwards compat
"
12940,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12941,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12942,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
12943,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
12944,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12945,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12946,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12947,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12948,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12949,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12950,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12951,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12952,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12953,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12954,123aedc09bc067740fb28921c500ded83c018bd4,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12955,123aedc09bc067740fb28921c500ded83c018bd4,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12956,123aedc09bc067740fb28921c500ded83c018bd4,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
12957,123aedc09bc067740fb28921c500ded83c018bd4,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
12958,123aedc09bc067740fb28921c500ded83c018bd4,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12959,123aedc09bc067740fb28921c500ded83c018bd4,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12960,123aedc09bc067740fb28921c500ded83c018bd4,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12961,123aedc09bc067740fb28921c500ded83c018bd4,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12962,123aedc09bc067740fb28921c500ded83c018bd4,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12963,123aedc09bc067740fb28921c500ded83c018bd4,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12964,123aedc09bc067740fb28921c500ded83c018bd4,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12965,123aedc09bc067740fb28921c500ded83c018bd4,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12966,123aedc09bc067740fb28921c500ded83c018bd4,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12967,123aedc09bc067740fb28921c500ded83c018bd4,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12968,123aedc09bc067740fb28921c500ded83c018bd4,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12969,123aedc09bc067740fb28921c500ded83c018bd4,/9.4/alpine/Dockerfile," # backwards compat
"
12970,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12971,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12972,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12973,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"#		krb5-dev \
"
12974,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"#		openldap-dev \
"
12975,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# configure: error: prove not found
"
12976,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12977,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12978,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12979,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12980,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12981,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12982,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12983,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12984,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12985,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12986,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12987,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12988,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12989,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12990,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile," # backwards compat
"
12991,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12992,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12993,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12994,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"#		krb5-dev \
"
12995,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"#		openldap-dev \
"
12996,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# configure: error: prove not found
"
12997,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12998,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12999,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13000,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13001,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13002,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13003,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13004,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13005,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13006,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
13007,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13008,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13009,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13010,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13011,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile," # backwards compat
"
13012,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13013,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
13014,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13015,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"#		krb5-dev \
"
13016,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"#		openldap-dev \
"
13017,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# configure: error: prove not found
"
13018,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
13019,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13020,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13021,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13022,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13023,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13024,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13025,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13026,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13027,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
13028,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13029,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13030,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13031,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13032,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13033,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13034,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
13035,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
13036,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13037,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13038,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13039,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13040,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13041,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"# tzdata loading functionality is optional, and fails gracefully
#		tzdata \
"
13042,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13043,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13044,09b09edbea4339a008ef81f00475330172fe7630,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
13045,09b09edbea4339a008ef81f00475330172fe7630,/9.2/Dockerfile,"# explicitly set user/group IDs
"
13046,09b09edbea4339a008ef81f00475330172fe7630,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
13047,09b09edbea4339a008ef81f00475330172fe7630,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13048,09b09edbea4339a008ef81f00475330172fe7630,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13049,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"# vim:set ft=dockerfile:
"
13050,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"# explicitly set user/group IDs
"
13051,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
13052,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
13053,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"# grab gosu for easy step-down from root
"
13054,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13055,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
13056,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
13057,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13058,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
13059,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"# arches officialy built by upstream
"
13060,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13061,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
13062,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13063,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13064,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13065,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13066,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13067,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13068,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13069,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
13070,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13071,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
13072,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13073,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/11/Dockerfile," # backwards compat
"
13074,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
13075,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/Dockerfile,"# explicitly set user/group IDs
"
13076,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
13077,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13078,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13079,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13080,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13081,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13082,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13083,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
13084,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13085,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"#		krb5-dev \
"
13086,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"#		openldap-dev \
"
13087,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# configure: error: prove not found
"
13088,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
13089,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13090,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13091,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13092,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13093,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13094,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13095,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13096,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13097,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
13098,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13099,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13100,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13101,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13102,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13103,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
13104,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13105,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
13106,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
13107,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# configure: error: prove not found
"
13108,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13109,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
13110,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13111,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13112,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13113,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13114,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13115,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13116,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13117,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13118,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13119,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13120,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13121,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13122,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile," # backwards compat
"
13123,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
13124,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
13125,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
13126,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13127,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13128,ea490430aabd553f34656e8f0e846d2ed3c42930,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
13129,ea490430aabd553f34656e8f0e846d2ed3c42930,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13130,63d966973d9593c0d9890b96f10ac73566913520,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
13131,63d966973d9593c0d9890b96f10ac73566913520,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
13132,63d966973d9593c0d9890b96f10ac73566913520,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
13133,63d966973d9593c0d9890b96f10ac73566913520,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13134,63d966973d9593c0d9890b96f10ac73566913520,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13135,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
13136,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# explicitly set user/group IDs
"
13137,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
13138,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
13139,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
13140,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13141,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
13142,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
13143,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13144,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
13145,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# arches officialy built by upstream
"
13146,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13147,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
13148,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13149,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13150,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13151,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13152,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13153,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13154,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13155,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
13156,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13157,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
13158,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13159,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile," # backwards compat
"
13160,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13161,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
13162,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13163,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"#		krb5-dev \
"
13164,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"#		openldap-dev \
"
13165,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# configure: error: prove not found
"
13166,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13167,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13168,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13169,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13170,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13171,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13172,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13173,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13174,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13175,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13176,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13177,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13178,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile," # backwards compat
"
13179,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
13180,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13181,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13182,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
13183,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13184,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
13185,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
13186,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
13187,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
13188,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13189,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13190,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13191,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13192,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13193,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13194,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13195,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13196,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
13197,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13198,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13199,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13200,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13201,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile," # backwards compat
"
13202,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13203,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
13204,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13205,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
13206,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
13207,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
13208,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
13209,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13210,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13211,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13212,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13213,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13214,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13215,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13216,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13217,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
13218,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13219,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13220,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13221,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13222,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile," # backwards compat
"
13223,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13224,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13225,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
13226,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
13227,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13228,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13229,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13230,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13231,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13232,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13233,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13234,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13235,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13236,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13237,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13238,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13239,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
13240,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13241,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
13242,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
13243,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
13244,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
13245,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13246,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13247,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13248,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13249,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13250,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13251,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13252,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13253,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
13254,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13255,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13256,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13257,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13258,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.4/alpine/Dockerfile," # backwards compat
"
13259,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13260,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
13261,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13262,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
13263,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
13264,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
13265,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
13266,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13267,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13268,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13269,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13270,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13271,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13272,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13273,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13274,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
13275,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13276,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13277,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13278,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13279,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.6/alpine/Dockerfile," # backwards compat
"
13280,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# vim:set ft=dockerfile:
"
13281,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# explicitly set user/group IDs
"
13282,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
13283,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
13284,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# grab gosu for easy step-down from root
"
13285,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13286,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
13287,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
13288,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13289,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
13290,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# arches officialy built by upstream
"
13291,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13292,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
13293,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13294,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13295,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13296,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13297,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13298,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13299,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13300,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
13301,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13302,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
13303,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13304,ba24350aa02996f75cf5b44eea0af082775cc8ec,/10/Dockerfile," # backwards compat
"
13305,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13306,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
13307,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13308,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
13309,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
13310,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
13311,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
13312,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13313,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13314,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13315,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13316,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13317,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13318,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13319,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13320,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
13321,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13322,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13323,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13324,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13325,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile," # backwards compat
"
13326,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
13327,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
13328,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
13329,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13330,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13331,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"# vim:set ft=dockerfile:
"
13332,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"# explicitly set user/group IDs
"
13333,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
13334,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
13335,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"# grab gosu for easy step-down from root
"
13336,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13337,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
13338,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
13339,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13340,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
13341,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"# arches officialy built by upstream
"
13342,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13343,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
13344,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13345,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13346,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13347,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13348,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13349,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13350,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13351,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
13352,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13353,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13354,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13355,91939daa3f42d2796952f03353534cd87d181ccc,/10/Dockerfile," # backwards compat
"
13356,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
13357,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# explicitly set user/group IDs
"
13358,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
13359,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
13360,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
13361,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13362,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
13363,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
13364,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13365,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
13366,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# arches officialy built by upstream
"
13367,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13368,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
13369,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13370,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13371,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13372,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13373,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13374,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13375,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13376,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
13377,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13378,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
13379,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13380,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/Dockerfile," # backwards compat
"
13381,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13382,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
13383,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13384,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"#		krb5-dev \
"
13385,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"#		openldap-dev \
"
13386,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# configure: error: prove not found
"
13387,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
13388,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13389,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13390,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13391,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13392,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13393,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13394,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13395,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13396,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
13397,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13398,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13399,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13400,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13401,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile," # backwards compat
"
13402,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13403,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
13404,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13405,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
13406,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
13407,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13408,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
13409,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13410,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13411,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13412,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13413,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13414,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13415,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13416,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13417,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13418,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13419,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile," # backwards compat
"
13420,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
13421,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.5/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
13422,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
13423,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13424,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13425,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13426,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
13427,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13428,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
13429,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
13430,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13431,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
13432,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13433,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13434,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13435,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13436,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13437,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13438,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13439,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13440,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13441,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13442,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13443,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13444,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile," # backwards compat
"
13445,51e5166d69320581cb707d6fb102d3ba04803400,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
13446,51e5166d69320581cb707d6fb102d3ba04803400,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
13447,51e5166d69320581cb707d6fb102d3ba04803400,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
13448,51e5166d69320581cb707d6fb102d3ba04803400,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13449,51e5166d69320581cb707d6fb102d3ba04803400,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13450,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
13451,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.4/Dockerfile,"# explicitly set user/group IDs
"
13452,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
13453,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13454,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13455,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
13456,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# explicitly set user/group IDs
"
13457,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
13458,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
13459,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
13460,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13461,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
13462,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
13463,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13464,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
13465,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# arches officialy built by upstream
"
13466,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13467,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
13468,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13469,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13470,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13471,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13472,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13473,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13474,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13475,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
13476,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13477,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
13478,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13479,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile," # backwards compat
"
13480,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# vim:set ft=dockerfile:
"
13481,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# explicitly set user/group IDs
"
13482,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# grab gosu for easy step-down from root
"
13483,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13484,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
13485,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
13486,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13487,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# arches officialy built by upstream
"
13488,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13489,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13490,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13491,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13492,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13493,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13494,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13495,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13496,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13497,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13498,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13499,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile," # backwards compat
"
13500,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13501,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
13502,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13503,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
13504,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
13505,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
13506,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
13507,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13508,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13509,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
13510,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13511,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13512,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13513,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13514,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13515,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
13516,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13517,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13518,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13519,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13520,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/9.5/alpine/Dockerfile," # backwards compat
"
13521,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13522,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
13523,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13524,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
13525,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
13526,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
13527,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
13528,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13529,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13530,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13531,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13532,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13533,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13534,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13535,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13536,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
13537,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13538,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13539,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13540,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13541,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile," # backwards compat
"
13542,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
13543,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
13544,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
13545,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13546,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13547,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
13548,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.4/Dockerfile,"# explicitly set user/group IDs
"
13549,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
13550,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13551,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
13552,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
13553,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13554,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.4/Dockerfile,"# arches officialy built by upstream
"
13555,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13556,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13557,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13558,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13559,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13560,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13561,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13562,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13563,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13564,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13565,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13566,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.4/Dockerfile," # backwards compat
"
13567,73d73760957c7038dd3c07212b5b9daf86a2cb38,/8.4/Dockerfile,"# vim:set ft=dockerfile:
"
13568,73d73760957c7038dd3c07212b5b9daf86a2cb38,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
13569,73d73760957c7038dd3c07212b5b9daf86a2cb38,/8.4/Dockerfile,"# grab gosu for easy step-down from root
"
13570,73d73760957c7038dd3c07212b5b9daf86a2cb38,/8.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13571,73d73760957c7038dd3c07212b5b9daf86a2cb38,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13572,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13573,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
13574,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13575,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
13576,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
13577,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13578,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13579,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13580,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13581,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13582,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13583,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13584,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13585,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13586,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13587,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13588,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13589,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile," # backwards compat
"
13590,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13591,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
13592,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13593,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
13594,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
13595,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13596,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
13597,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13598,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13599,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13600,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13601,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13602,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13603,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13604,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13605,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13606,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13607,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13608,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13609,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.2/alpine/Dockerfile," # backwards compat
"
13610,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
13611,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/Dockerfile,"# explicitly set user/group IDs
"
13612,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
13613,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13614,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
13615,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13616,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/Dockerfile,"# arches officialy built by upstream
"
13617,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13618,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13619,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13620,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13621,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13622,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13623,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13624,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13625,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13626,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13627,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13628,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/Dockerfile," # backwards compat
"
13629,c6484bf22f5a0f72a49658ae9e5569bc01785eff,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
13630,c6484bf22f5a0f72a49658ae9e5569bc01785eff,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
13631,c6484bf22f5a0f72a49658ae9e5569bc01785eff,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13632,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# vim:set ft=dockerfile:
"
13633,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# explicitly set user/group IDs
"
13634,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
13635,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
13636,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# grab gosu for easy step-down from root
"
13637,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13638,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
13639,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
13640,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13641,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
13642,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# arches officialy built by upstream
"
13643,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13644,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
13645,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13646,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13647,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13648,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13649,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13650,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13651,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13652,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
13653,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13654,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
13655,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13656,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile," # backwards compat
"
13657,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
13658,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.3/Dockerfile,"# explicitly set user/group IDs
"
13659,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
13660,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13661,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13662,c6484bf22f5a0f72a49658ae9e5569bc01785eff,/8.4/Dockerfile,"# vim:set ft=dockerfile:
"
13663,c6484bf22f5a0f72a49658ae9e5569bc01785eff,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
13664,c6484bf22f5a0f72a49658ae9e5569bc01785eff,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13665,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
13666,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.2/Dockerfile,"# explicitly set user/group IDs
"
13667,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
13668,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13669,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13670,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13671,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13672,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
13673,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
13674,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13675,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13676,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13677,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13678,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13679,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13680,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13681,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13682,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13683,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13684,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13685,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile," # backwards compat
"
13686,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
13687,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/Dockerfile,"# explicitly set user/group IDs
"
13688,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
13689,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13690,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13691,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13692,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13693,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13694,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13695,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/Dockerfile," # backwards compat
"
13696,8c03e6aed7046c4bacbc1b7c356edd81bd72c6d5,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
13697,8c03e6aed7046c4bacbc1b7c356edd81bd72c6d5,/9.2/Dockerfile,"# explicitly set user/group IDs
"
13698,8c03e6aed7046c4bacbc1b7c356edd81bd72c6d5,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
13699,8c03e6aed7046c4bacbc1b7c356edd81bd72c6d5,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13700,8c03e6aed7046c4bacbc1b7c356edd81bd72c6d5,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13701,8c03e6aed7046c4bacbc1b7c356edd81bd72c6d5,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13702,8c03e6aed7046c4bacbc1b7c356edd81bd72c6d5,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13703,8c03e6aed7046c4bacbc1b7c356edd81bd72c6d5,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13704,8c03e6aed7046c4bacbc1b7c356edd81bd72c6d5,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13705,8c03e6aed7046c4bacbc1b7c356edd81bd72c6d5,/9.2/Dockerfile," # backwards compat
"
13706,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13707,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
13708,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13709,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
13710,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
13711,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13712,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13713,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13714,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13715,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13716,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13717,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13718,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13719,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13720,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13721,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13722,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.4/alpine/Dockerfile," # backwards compat
"
13723,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
13724,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# explicitly set user/group IDs
"
13725,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
13726,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
13727,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
13728,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13729,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
13730,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
13731,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13732,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
13733,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# arches officialy built by upstream
"
13734,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13735,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
13736,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13737,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13738,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13739,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13740,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13741,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13742,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13743,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
13744,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13745,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13746,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13747,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile," # backwards compat
"
13748,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
13749,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/Dockerfile,"# explicitly set user/group IDs
"
13750,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
13751,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13752,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13753,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13754,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13755,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13756,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13757,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/Dockerfile," # backwards compat
"
13758,bef7a7e02643bb0f104ba346395d3cdb78db1480,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
13759,bef7a7e02643bb0f104ba346395d3cdb78db1480,/9.6/Dockerfile,"# explicitly set user/group IDs
"
13760,bef7a7e02643bb0f104ba346395d3cdb78db1480,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
13761,bef7a7e02643bb0f104ba346395d3cdb78db1480,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13762,bef7a7e02643bb0f104ba346395d3cdb78db1480,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13763,bef7a7e02643bb0f104ba346395d3cdb78db1480,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13764,bef7a7e02643bb0f104ba346395d3cdb78db1480,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13765,bef7a7e02643bb0f104ba346395d3cdb78db1480,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13766,bef7a7e02643bb0f104ba346395d3cdb78db1480,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13767,bef7a7e02643bb0f104ba346395d3cdb78db1480,/9.6/Dockerfile," # backwards compat
"
13768,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13769,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
13770,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13771,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
13772,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
13773,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
13774,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
13775,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13776,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13777,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13778,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13779,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13780,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13781,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13782,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13783,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13784,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13785,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13786,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13787,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile," # backwards compat
"
13788,d74b69598c835fe15eac39a26b5c61058f99c3db,/8.4/Dockerfile,"# vim:set ft=dockerfile:
"
13789,d74b69598c835fe15eac39a26b5c61058f99c3db,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
13790,d74b69598c835fe15eac39a26b5c61058f99c3db,/8.4/Dockerfile,"# grab gosu for easy step-down from root
"
13791,d74b69598c835fe15eac39a26b5c61058f99c3db,/8.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13792,d74b69598c835fe15eac39a26b5c61058f99c3db,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13793,54f46e57136635b484295b985acd6e422d0b9583,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
13794,54f46e57136635b484295b985acd6e422d0b9583,/9.5/Dockerfile,"# explicitly set user/group IDs
"
13795,54f46e57136635b484295b985acd6e422d0b9583,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
13796,54f46e57136635b484295b985acd6e422d0b9583,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13797,54f46e57136635b484295b985acd6e422d0b9583,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13798,54f46e57136635b484295b985acd6e422d0b9583,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13799,54f46e57136635b484295b985acd6e422d0b9583,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13800,54f46e57136635b484295b985acd6e422d0b9583,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13801,54f46e57136635b484295b985acd6e422d0b9583,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13802,54f46e57136635b484295b985acd6e422d0b9583,/9.5/Dockerfile," # backwards compat
"
13803,6870d3db740a321699ef49c8068c3d812b9681e1,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
13804,6870d3db740a321699ef49c8068c3d812b9681e1,/9.3/Dockerfile,"# explicitly set user/group IDs
"
13805,6870d3db740a321699ef49c8068c3d812b9681e1,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
13806,6870d3db740a321699ef49c8068c3d812b9681e1,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13807,6870d3db740a321699ef49c8068c3d812b9681e1,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13808,6870d3db740a321699ef49c8068c3d812b9681e1,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13809,6870d3db740a321699ef49c8068c3d812b9681e1,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13810,6870d3db740a321699ef49c8068c3d812b9681e1,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13811,6870d3db740a321699ef49c8068c3d812b9681e1,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13812,6870d3db740a321699ef49c8068c3d812b9681e1,/9.3/Dockerfile," # backwards compat
"
13813,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
13814,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.6/Dockerfile,"# explicitly set user/group IDs
"
13815,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
13816,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13817,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13818,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.6/Dockerfile,"# arches officialy built by upstream
"
13819,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13820,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13821,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13822,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13823,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13824,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13825,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13826,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13827,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13828,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13829,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13830,4566cb036dd021c42c252f7a41797d5d3907c0d2,/9.6/Dockerfile," # backwards compat
"
13831,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13832,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
13833,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13834,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
13835,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
13836,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile,"# configure: error: prove not found
"
13837,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
13838,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13839,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
13840,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13841,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13842,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13843,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13844,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13845,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13846,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13847,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13848,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13849,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13850,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13851,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13852,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.2/alpine/Dockerfile," # backwards compat
"
13853,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
13854,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# explicitly set user/group IDs
"
13855,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
13856,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13857,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13858,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# arches officialy built by upstream
"
13859,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13860,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13861,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13862,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13863,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13864,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13865,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13866,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13867,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13868,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13869,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13870,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile," # backwards compat
"
13871,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
13872,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# explicitly set user/group IDs
"
13873,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
13874,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
13875,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
13876,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13877,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
13878,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
13879,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13880,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
13881,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# arches officialy built by upstream
"
13882,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13883,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
13884,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13885,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13886,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13887,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13888,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13889,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13890,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13891,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
13892,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13893,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
13894,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13895,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile," # backwards compat
"
13896,639f83fb14161c8be60119b97bb9f88796776058,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
13897,639f83fb14161c8be60119b97bb9f88796776058,/9.4/Dockerfile,"# explicitly set user/group IDs
"
13898,639f83fb14161c8be60119b97bb9f88796776058,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
13899,639f83fb14161c8be60119b97bb9f88796776058,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13900,639f83fb14161c8be60119b97bb9f88796776058,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
13901,639f83fb14161c8be60119b97bb9f88796776058,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
13902,639f83fb14161c8be60119b97bb9f88796776058,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13903,639f83fb14161c8be60119b97bb9f88796776058,/9.4/Dockerfile,"# arches officialy built by upstream
"
13904,639f83fb14161c8be60119b97bb9f88796776058,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13905,639f83fb14161c8be60119b97bb9f88796776058,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13906,639f83fb14161c8be60119b97bb9f88796776058,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13907,639f83fb14161c8be60119b97bb9f88796776058,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13908,639f83fb14161c8be60119b97bb9f88796776058,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13909,639f83fb14161c8be60119b97bb9f88796776058,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13910,639f83fb14161c8be60119b97bb9f88796776058,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13911,639f83fb14161c8be60119b97bb9f88796776058,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13912,639f83fb14161c8be60119b97bb9f88796776058,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13913,639f83fb14161c8be60119b97bb9f88796776058,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13914,639f83fb14161c8be60119b97bb9f88796776058,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13915,639f83fb14161c8be60119b97bb9f88796776058,/9.4/Dockerfile," # backwards compat
"
13916,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# vim:set ft=dockerfile:
"
13917,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# explicitly set user/group IDs
"
13918,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
13919,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
13920,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
13921,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13922,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
13923,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
13924,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
13925,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13926,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
13927,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# arches officialy built by upstream
"
13928,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13929,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
13930,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13931,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13932,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13933,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13934,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13935,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13936,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13937,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
13938,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13939,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
13940,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13941,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile," # backwards compat
"
13942,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
13943,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
13944,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
13945,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13946,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13947,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13948,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13949,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
13950,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
13951,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13952,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
13953,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13954,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13955,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13956,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13957,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13958,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13959,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13960,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13961,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13962,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13963,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile," # backwards compat
"
13964,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
13965,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13966,937cc2b25a6db9dafb60241185d492917dc842b0,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
13967,937cc2b25a6db9dafb60241185d492917dc842b0,/9.2/Dockerfile,"# explicitly set user/group IDs
"
13968,937cc2b25a6db9dafb60241185d492917dc842b0,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
13969,937cc2b25a6db9dafb60241185d492917dc842b0,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13970,937cc2b25a6db9dafb60241185d492917dc842b0,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13971,937cc2b25a6db9dafb60241185d492917dc842b0,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13972,937cc2b25a6db9dafb60241185d492917dc842b0,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13973,937cc2b25a6db9dafb60241185d492917dc842b0,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13974,937cc2b25a6db9dafb60241185d492917dc842b0,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13975,937cc2b25a6db9dafb60241185d492917dc842b0,/9.2/Dockerfile," # backwards compat
"
13976,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# vim:set ft=dockerfile:
"
13977,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# explicitly set user/group IDs
"
13978,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
13979,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
13980,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# grab gosu for easy step-down from root
"
13981,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13982,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
13983,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
13984,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13985,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
13986,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# arches officialy built by upstream
"
13987,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13988,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
13989,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13990,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13991,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13992,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13993,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13994,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13995,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13996,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
13997,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13998,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
13999,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14000,6d1f671dcd2c8d51484d19767a33c37110dd650f,/10/Dockerfile," # backwards compat
"
14001,63d966973d9593c0d9890b96f10ac73566913520,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
14002,63d966973d9593c0d9890b96f10ac73566913520,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
14003,63d966973d9593c0d9890b96f10ac73566913520,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
14004,63d966973d9593c0d9890b96f10ac73566913520,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14005,63d966973d9593c0d9890b96f10ac73566913520,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14006,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14007,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
14008,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14009,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"#		krb5-dev \
"
14010,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"#		openldap-dev \
"
14011,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# configure: error: prove not found
"
14012,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
14013,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14014,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14015,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
14016,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
14017,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14018,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14019,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14020,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14021,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
14022,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14023,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14024,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14025,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14026,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14027,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
14028,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14029,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
14030,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
14031,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
14032,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
14033,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14034,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14035,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
14036,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
14037,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14038,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14039,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14040,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14041,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
14042,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14043,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14044,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14045,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14046,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile," # backwards compat
"
14047,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# vim:set ft=dockerfile:
"
14048,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# explicitly set user/group IDs
"
14049,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
14050,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
14051,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# grab gosu for easy step-down from root
"
14052,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14053,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
14054,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
14055,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14056,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
14057,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# arches officialy built by upstream
"
14058,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
14059,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
14060,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
14061,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
14062,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
14063,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
14064,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
14065,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
14066,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
14067,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
14068,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14069,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
14070,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14071,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile," # backwards compat
"
14072,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# vim:set ft=dockerfile:
"
14073,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# explicitly set user/group IDs
"
14074,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
14075,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
14076,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# grab gosu for easy step-down from root
"
14077,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14078,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
14079,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
14080,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
14081,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14082,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
14083,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# arches officialy built by upstream
"
14084,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
14085,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
14086,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
14087,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
14088,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
14089,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
14090,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
14091,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
14092,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
14093,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
14094,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14095,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
14096,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14097,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile," # backwards compat
"
14098,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
14099,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
14100,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
14101,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14102,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14103,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
14104,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/Dockerfile,"# explicitly set user/group IDs
"
14105,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
14106,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14107,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14108,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14109,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14110,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
14111,00706ec7c2f2893aa753225074c5c1bff3b93cfc,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14112,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
14113,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/Dockerfile,"# explicitly set user/group IDs
"
14114,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
14115,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14116,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14117,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14118,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14119,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
14120,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14121,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.3/Dockerfile," # backwards compat
"
14122,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14123,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
14124,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14125,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
14126,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
14127,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile,"# configure: error: prove not found
"
14128,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
14129,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14130,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
14131,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
14132,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14133,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
14134,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
14135,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14136,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14137,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14138,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14139,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile,"#p' --recursive /usr/local \
"
14140,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14141,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14142,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14143,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14144,6750eda25a2f0856b3997309ef393475f008d6a3,/9.2/alpine/Dockerfile," # backwards compat
"
14145,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# vim:set ft=dockerfile:
"
14146,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# explicitly set user/group IDs
"
14147,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
14148,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
14149,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# grab gosu for easy step-down from root
"
14150,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14151,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
14152,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
14153,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14154,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
14155,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# arches officialy built by upstream
"
14156,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
14157,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
14158,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
14159,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
14160,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
14161,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
14162,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
14163,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
14164,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
14165,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
14166,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14167,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
14168,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14169,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile," # backwards compat
"
14170,69a30d9e6f12c57296b11d3511127210466f0197,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
14171,69a30d9e6f12c57296b11d3511127210466f0197,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
14172,69a30d9e6f12c57296b11d3511127210466f0197,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
14173,69a30d9e6f12c57296b11d3511127210466f0197,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14174,69a30d9e6f12c57296b11d3511127210466f0197,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14175,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14176,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14177,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
14178,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
14179,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14180,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14181,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
14182,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14183,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14184,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14185,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14186,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14187,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14188,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14189,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14190,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile," # backwards compat
"
14191,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14192,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
14193,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14194,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
14195,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
14196,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14197,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14198,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
14199,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
14200,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14201,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14202,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14203,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14204,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14205,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14206,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14207,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14208,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile," # backwards compat
"
14209,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# vim:set ft=dockerfile:
"
14210,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# explicitly set user/group IDs
"
14211,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
14212,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
14213,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# grab gosu for easy step-down from root
"
14214,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14215,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
14216,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
14217,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14218,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
14219,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# arches officialy built by upstream
"
14220,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
14221,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
14222,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
14223,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
14224,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
14225,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
14226,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
14227,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
14228,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
14229,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
14230,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14231,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
14232,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14233,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile," # backwards compat
"
14234,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
14235,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# explicitly set user/group IDs
"
14236,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
14237,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
14238,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
14239,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14240,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
14241,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
14242,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14243,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
14244,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# arches officialy built by upstream
"
14245,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
14246,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
14247,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
14248,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
14249,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
14250,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
14251,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
14252,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
14253,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
14254,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
14255,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14256,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
14257,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14258,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile," # backwards compat
"
14259,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
14260,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.2/Dockerfile,"# explicitly set user/group IDs
"
14261,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
14262,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14263,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14264,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14265,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
14266,a6d4922823aa8011513bb9c160c26c689301823a,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
14267,a6d4922823aa8011513bb9c160c26c689301823a,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
14268,a6d4922823aa8011513bb9c160c26c689301823a,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
14269,a6d4922823aa8011513bb9c160c26c689301823a,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14270,a6d4922823aa8011513bb9c160c26c689301823a,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14271,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14272,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
14273,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14274,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
14275,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
14276,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
14277,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
14278,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14279,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14280,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
14281,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
14282,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14283,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14284,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14285,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14286,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
14287,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14288,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14289,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14290,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14291,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile," # backwards compat
"
14292,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14293,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
14294,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14295,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
14296,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
14297,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
14298,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
14299,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14300,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14301,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
14302,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
14303,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14304,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14305,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14306,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14307,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
14308,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14309,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14310,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14311,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14312,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/9.6/alpine/Dockerfile," # backwards compat
"
14313,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# vim:set ft=dockerfile:
"
14314,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# explicitly set user/group IDs
"
14315,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
14316,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
14317,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# grab gosu for easy step-down from root
"
14318,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14319,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
14320,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
14321,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14322,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
14323,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# arches officialy built by upstream
"
14324,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
14325,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
14326,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
14327,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
14328,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
14329,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
14330,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
14331,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
14332,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
14333,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
14334,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14335,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
14336,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14337,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile," # backwards compat
"
14338,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14339,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14340,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
14341,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
14342,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14343,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14344,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
14345,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14346,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14347,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14348,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14349,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14350,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14351,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14352,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14353,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile," # backwards compat
"
14354,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/8.4/Dockerfile,"# vim:set ft=dockerfile:
"
14355,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
14356,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/8.4/Dockerfile,"# grab gosu for easy step-down from root
"
14357,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/8.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14358,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14359,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
14360,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# explicitly set user/group IDs
"
14361,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
14362,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14363,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
14364,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14365,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# arches officialy built by upstream
"
14366,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
14367,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
14368,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
14369,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
14370,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
14371,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
14372,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
14373,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
14374,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14375,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
14376,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14377,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile," # backwards compat
"
14378,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
14379,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
14380,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
14381,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14382,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14383,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
14384,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# explicitly set user/group IDs
"
14385,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
14386,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
14387,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
14388,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14389,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
14390,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
14391,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
14392,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14393,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
14394,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# arches officialy built by upstream
"
14395,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
14396,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
14397,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
14398,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
14399,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
14400,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
14401,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
14402,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
14403,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
14404,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
14405,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14406,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
14407,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14408,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile," # backwards compat
"
14409,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
14410,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# explicitly set user/group IDs
"
14411,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
14412,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14413,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14414,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# arches officialy built by upstream
"
14415,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
14416,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
14417,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
14418,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
14419,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
14420,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
14421,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
14422,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
14423,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14424,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
14425,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14426,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile," # backwards compat
"
14427,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
14428,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/Dockerfile,"# explicitly set user/group IDs
"
14429,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
14430,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14431,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14432,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14433,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14434,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
14435,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14436,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
14437,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
14438,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
14439,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14440,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14441,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14442,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
14443,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14444,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
14445,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
14446,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14447,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14448,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
14449,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
14450,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14451,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14452,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14453,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14454,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14455,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14456,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14457,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14458,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.4/alpine/Dockerfile," # backwards compat
"
14459,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
14460,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# explicitly set user/group IDs
"
14461,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
14462,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
14463,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
14464,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14465,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
14466,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
14467,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14468,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
14469,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# arches officialy built by upstream
"
14470,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
14471,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
14472,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
14473,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
14474,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
14475,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
14476,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
14477,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
14478,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
14479,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
14480,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14481,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
14482,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14483,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile," # backwards compat
"
14484,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
14485,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# explicitly set user/group IDs
"
14486,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
14487,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
14488,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
14489,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14490,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
14491,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
14492,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14493,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# arches officialy built by upstream
"
14494,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
14495,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
14496,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
14497,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
14498,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
14499,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
14500,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
14501,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
14502,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14503,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
14504,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14505,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile," # backwards compat
"
14506,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14507,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
14508,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14509,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"#		krb5-dev \
"
14510,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"#		openldap-dev \
"
14511,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# configure: error: prove not found
"
14512,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
14513,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14514,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14515,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
14516,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
14517,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14518,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14519,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14520,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14521,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
14522,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14523,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14524,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14525,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14526,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
14527,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
14528,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
14529,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14530,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14531,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
14532,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# explicitly set user/group IDs
"
14533,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
14534,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14535,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
14536,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
14537,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14538,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# arches officialy built by upstream
"
14539,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
14540,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
14541,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
14542,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
14543,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
14544,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
14545,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
14546,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
14547,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14548,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
14549,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14550,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile," # backwards compat
"
14551,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
14552,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.5/Dockerfile,"# explicitly set user/group IDs
"
14553,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
14554,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14555,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14556,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14557,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
14558,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
14559,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/Dockerfile,"# explicitly set user/group IDs
"
14560,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
14561,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14562,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14563,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14564,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14565,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
14566,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
14567,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
14568,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
14569,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14570,574a975e1977357477a0e80d6c5b1d7425c84f9a,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14571,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14572,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
14573,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14574,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
14575,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
14576,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
14577,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
14578,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14579,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14580,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
14581,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
14582,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14583,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14584,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14585,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14586,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
14587,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14588,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14589,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14590,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14591,ba24350aa02996f75cf5b44eea0af082775cc8ec,/9.4/alpine/Dockerfile," # backwards compat
"
14592,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14593,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
14594,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14595,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/12/alpine/Dockerfile,"#		krb5-dev \
"
14596,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/12/alpine/Dockerfile,"#		openldap-dev \
"
14597,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/12/alpine/Dockerfile,"# configure: error: prove not found
"
14598,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
14599,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14600,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14601,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
14602,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
14603,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14604,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14605,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14606,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14607,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
14608,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14609,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14610,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14611,aa3a2436d092ee63729b75ec8ad1441a148c94d4,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14612,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14613,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
14614,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14615,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
14616,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
14617,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14618,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
14619,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
14620,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14621,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
14622,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
14623,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14624,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14625,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14626,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14627,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14628,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14629,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14630,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14631,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile," # backwards compat
"
14632,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14633,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14634,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
14635,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
14636,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14637,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14638,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14639,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14640,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14641,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"# tzdata loading functionality is optional, and fails gracefully
#		tzdata \
"
14642,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14643,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14644,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14645,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
14646,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14647,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
14648,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
14649,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
14650,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
14651,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14652,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14653,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
14654,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
14655,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14656,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14657,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14658,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14659,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
14660,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14661,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14662,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14663,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14664,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile," # backwards compat
"
14665,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
14666,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/Dockerfile,"# explicitly set user/group IDs
"
14667,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
14668,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14669,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14670,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/Dockerfile,"# arches officialy built by upstream
"
14671,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
14672,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
14673,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
14674,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
14675,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
14676,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
14677,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
14678,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
14679,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14680,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
14681,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14682,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/Dockerfile," # backwards compat
"
14683,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14684,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
14685,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14686,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
14687,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
14688,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
14689,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
14690,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14691,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14692,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
14693,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
14694,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14695,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14696,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14697,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14698,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
14699,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14700,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14701,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14702,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14703,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile," # backwards compat
"
14704,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
14705,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/Dockerfile,"# explicitly set user/group IDs
"
14706,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
14707,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14708,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14709,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14710,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14711,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
14712,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14713,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/Dockerfile," # backwards compat
"
14714,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
14715,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# explicitly set user/group IDs
"
14716,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
14717,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
14718,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
14719,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14720,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
14721,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
14722,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14723,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
14724,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# arches officialy built by upstream
"
14725,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
14726,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
14727,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
14728,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
14729,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
14730,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
14731,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
14732,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
14733,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
14734,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
14735,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14736,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
14737,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14738,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile," # backwards compat
"
14739,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14740,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
14741,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14742,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"#		krb5-dev \
"
14743,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"#		openldap-dev \
"
14744,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# configure: error: prove not found
"
14745,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
14746,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14747,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14748,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
14749,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
14750,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14751,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14752,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14753,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14754,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
14755,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14756,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14757,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14758,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14759,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile," # backwards compat
"
14760,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# vim:set ft=dockerfile:
"
14761,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# explicitly set user/group IDs
"
14762,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
14763,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
14764,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
14765,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14766,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
14767,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
14768,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
14769,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14770,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# see note below about ""*.pyc"" files
"
14771,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# arches officialy built by upstream
"
14772,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
14773,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
14774,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
14775,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# we need DEBIAN_FRONTEND on postgresql-13 for slapd (""Please enter the password for the admin entry in your LDAP directory.""); see https://bugs.debian.org/929417
"
14776,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
14777,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
14778,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
14779,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
14780,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
14781,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
14782,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
14783,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14784,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
14785,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14786,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile," # backwards compat
"
14787,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14788,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
14789,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14790,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
14791,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
14792,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
14793,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
14794,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14795,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14796,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
14797,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
14798,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14799,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14800,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14801,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14802,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
14803,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14804,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14805,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14806,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14807,57213ab012e6a38a27283eeac65c4726c069647a,/9.6/alpine/Dockerfile," # backwards compat
"
14808,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14809,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
14810,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14811,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"#		krb5-dev \
"
14812,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"#		openldap-dev \
"
14813,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# configure: error: prove not found
"
14814,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
14815,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14816,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14817,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
14818,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
14819,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14820,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14821,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14822,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14823,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
14824,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14825,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14826,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14827,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14828,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14829,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
14830,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14831,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
14832,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
14833,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
14834,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
14835,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14836,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14837,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
14838,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
14839,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14840,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14841,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14842,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14843,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
14844,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14845,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14846,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14847,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14848,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile," # backwards compat
"
14849,2df7c179897a4a0c5dbb5a68543e46fb77215067,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
14850,2df7c179897a4a0c5dbb5a68543e46fb77215067,/9.1/Dockerfile,"# explicitly set user/group IDs
"
14851,2df7c179897a4a0c5dbb5a68543e46fb77215067,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
14852,2df7c179897a4a0c5dbb5a68543e46fb77215067,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14853,2df7c179897a4a0c5dbb5a68543e46fb77215067,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14854,2df7c179897a4a0c5dbb5a68543e46fb77215067,/9.1/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14855,2df7c179897a4a0c5dbb5a68543e46fb77215067,/9.1/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
14856,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
14857,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.1/Dockerfile,"# explicitly set user/group IDs
"
14858,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
14859,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14860,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14861,f3146f857b42bd4c4cb2be6134149fddee546584,/10/Dockerfile,"# vim:set ft=dockerfile:
"
14862,f3146f857b42bd4c4cb2be6134149fddee546584,/10/Dockerfile,"# explicitly set user/group IDs
"
14863,f3146f857b42bd4c4cb2be6134149fddee546584,/10/Dockerfile,"# grab gosu for easy step-down from root
"
14864,f3146f857b42bd4c4cb2be6134149fddee546584,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14865,f3146f857b42bd4c4cb2be6134149fddee546584,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14866,f3146f857b42bd4c4cb2be6134149fddee546584,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14867,f3146f857b42bd4c4cb2be6134149fddee546584,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14868,f3146f857b42bd4c4cb2be6134149fddee546584,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
14869,f3146f857b42bd4c4cb2be6134149fddee546584,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14870,f3146f857b42bd4c4cb2be6134149fddee546584,/10/Dockerfile," # backwards compat
"
14871,51e5166d69320581cb707d6fb102d3ba04803400,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
14872,51e5166d69320581cb707d6fb102d3ba04803400,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
14873,51e5166d69320581cb707d6fb102d3ba04803400,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
14874,51e5166d69320581cb707d6fb102d3ba04803400,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14875,51e5166d69320581cb707d6fb102d3ba04803400,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14876,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
14877,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
14878,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
14879,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14880,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14881,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
14882,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# explicitly set user/group IDs
"
14883,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
14884,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
14885,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
14886,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14887,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
14888,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
14889,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
14890,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
14891,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
14892,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# arches officialy built by upstream
"
14893,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
14894,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
14895,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
14896,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
14897,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
14898,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
14899,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
14900,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
14901,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
14902,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
14903,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14904,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
14905,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14906,4dc16e44d16480d9c8e5eb705c15468d65366e43,/9.5/Dockerfile," # backwards compat
"
14907,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
14908,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
14909,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
14910,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14911,5036e92f87fa8f3d559996e50e91596127bcc2c1,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14912,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
14913,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
14914,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
14915,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14916,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14917,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14918,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
14919,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14920,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"#		krb5-dev \
"
14921,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"#		openldap-dev \
"
14922,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# configure: error: prove not found
"
14923,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
14924,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14925,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14926,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
14927,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
14928,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14929,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14930,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14931,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14932,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14933,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14934,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14935,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14936,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile," # backwards compat
"
14937,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
14938,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
14939,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
14940,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14941,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14942,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14943,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14944,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
14945,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
14946,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14947,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14948,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
14949,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14950,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14951,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14952,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14953,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14954,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14955,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14956,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14957,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
14958,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14959,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"#		krb5-dev \
"
14960,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"#		openldap-dev \
"
14961,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# configure: error: prove not found
"
14962,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
14963,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14964,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14965,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
14966,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
14967,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
14968,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
14969,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
14970,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
14971,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
14972,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
14973,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14974,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
14975,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
14976,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile," # backwards compat
"
14977,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
14978,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.2/Dockerfile,"# explicitly set user/group IDs
"
14979,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
14980,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14981,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14982,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14983,c82348f8f18a59c6830b98150cb879c1f8613f7b,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
14984,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
14985,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.2/Dockerfile,"# explicitly set user/group IDs
"
14986,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
14987,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
14988,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
14989,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
14990,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
14991,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
14992,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
14993,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
14994,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"#		krb5-dev \
"
14995,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"#		openldap-dev \
"
14996,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# configure: error: prove not found
"
14997,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
14998,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
14999,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15000,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15001,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15002,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15003,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15004,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15005,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15006,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15007,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15008,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15009,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15010,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15011,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile," # backwards compat
"
15012,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/8.4/Dockerfile,"# vim:set ft=dockerfile:
"
15013,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
15014,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/8.4/Dockerfile,"# grab gosu for easy step-down from root
"
15015,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/8.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15016,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
15017,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
15018,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# explicitly set user/group IDs
"
15019,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
15020,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
15021,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
15022,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15023,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
15024,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
15025,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
15026,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# see note below about ""*.pyc"" files
"
15027,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# arches officialy built by upstream
"
15028,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
15029,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
15030,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
15031,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
15032,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
15033,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
15034,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
15035,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
15036,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
15037,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
15038,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15039,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
15040,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15041,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile," # backwards compat
"
15042,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# vim:set ft=dockerfile:
"
15043,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# explicitly set user/group IDs
"
15044,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# grab gosu for easy step-down from root
"
15045,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15046,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
15047,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
15048,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
15049,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# arches officialy built by upstream
"
15050,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
15051,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
15052,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
15053,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
15054,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
15055,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
15056,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
15057,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
15058,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15059,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
15060,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15061,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile," # backwards compat
"
15062,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15063,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
15064,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15065,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"#		krb5-dev \
"
15066,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"#		openldap-dev \
"
15067,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# configure: error: prove not found
"
15068,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15069,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15070,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15071,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15072,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15073,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15074,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15075,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15076,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15077,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15078,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15079,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15080,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15081,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15082,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile," # backwards compat
"
15083,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
15084,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# explicitly set user/group IDs
"
15085,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
15086,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15087,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
15088,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# arches officialy built by upstream
"
15089,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
15090,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
15091,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
15092,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
15093,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
15094,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
15095,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
15096,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
15097,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15098,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
15099,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15100,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile," # backwards compat
"
15101,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15102,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
15103,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15104,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"#		krb5-dev \
"
15105,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"#		openldap-dev \
"
15106,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# configure: error: prove not found
"
15107,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15108,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15109,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15110,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15111,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15112,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15113,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15114,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15115,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15116,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15117,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15118,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15119,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15120,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15121,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile," # backwards compat
"
15122,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
15123,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
15124,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
15125,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15126,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
15127,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# vim:set ft=dockerfile:
"
15128,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# explicitly set user/group IDs
"
15129,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
15130,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
15131,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# grab gosu for easy step-down from root
"
15132,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15133,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
15134,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
15135,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
15136,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
15137,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# arches officialy built by upstream
"
15138,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
15139,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
15140,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
15141,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
15142,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
15143,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
15144,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
15145,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
15146,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
15147,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
15148,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15149,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
15150,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15151,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile," # backwards compat
"
15152,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15153,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
15154,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15155,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
15156,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
15157,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
15158,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15159,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15160,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15161,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15162,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15163,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15164,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15165,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15166,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15167,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15168,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15169,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15170,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15171,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15172,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile," # backwards compat
"
15173,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
15174,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.4/Dockerfile,"# explicitly set user/group IDs
"
15175,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
15176,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15177,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
15178,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
15179,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15180,a7a6cdf9d4c3e540447509327d1ba89053b07170,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
15181,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# vim:set ft=dockerfile:
"
15182,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# explicitly set user/group IDs
"
15183,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
15184,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
15185,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# grab gosu for easy step-down from root
"
15186,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15187,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
15188,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
15189,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
15190,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
15191,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# arches officialy built by upstream
"
15192,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
15193,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
15194,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
15195,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
15196,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
15197,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
15198,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
15199,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
15200,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
15201,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
15202,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15203,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
15204,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15205,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile," # backwards compat
"
15206,972294a377463156c8d61297320c872fc7d370a9,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
15207,972294a377463156c8d61297320c872fc7d370a9,/9.5/Dockerfile,"# explicitly set user/group IDs
"
15208,972294a377463156c8d61297320c872fc7d370a9,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
15209,972294a377463156c8d61297320c872fc7d370a9,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15210,972294a377463156c8d61297320c872fc7d370a9,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
15211,972294a377463156c8d61297320c872fc7d370a9,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
15212,972294a377463156c8d61297320c872fc7d370a9,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15213,972294a377463156c8d61297320c872fc7d370a9,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
15214,972294a377463156c8d61297320c872fc7d370a9,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15215,972294a377463156c8d61297320c872fc7d370a9,/9.5/Dockerfile," # backwards compat
"
15216,4c4693ef1306a391785c7b73b2784d5634903467,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15217,4c4693ef1306a391785c7b73b2784d5634903467,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
15218,4c4693ef1306a391785c7b73b2784d5634903467,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15219,4c4693ef1306a391785c7b73b2784d5634903467,/11/alpine/Dockerfile,"#		krb5-dev \
"
15220,4c4693ef1306a391785c7b73b2784d5634903467,/11/alpine/Dockerfile,"#		openldap-dev \
"
15221,4c4693ef1306a391785c7b73b2784d5634903467,/11/alpine/Dockerfile,"# configure: error: prove not found
"
15222,4c4693ef1306a391785c7b73b2784d5634903467,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15223,4c4693ef1306a391785c7b73b2784d5634903467,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15224,4c4693ef1306a391785c7b73b2784d5634903467,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15225,4c4693ef1306a391785c7b73b2784d5634903467,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15226,4c4693ef1306a391785c7b73b2784d5634903467,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15227,4c4693ef1306a391785c7b73b2784d5634903467,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15228,4c4693ef1306a391785c7b73b2784d5634903467,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15229,4c4693ef1306a391785c7b73b2784d5634903467,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15230,4c4693ef1306a391785c7b73b2784d5634903467,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15231,4c4693ef1306a391785c7b73b2784d5634903467,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15232,4c4693ef1306a391785c7b73b2784d5634903467,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15233,4c4693ef1306a391785c7b73b2784d5634903467,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15234,4c4693ef1306a391785c7b73b2784d5634903467,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15235,4c4693ef1306a391785c7b73b2784d5634903467,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15236,4c4693ef1306a391785c7b73b2784d5634903467,/11/alpine/Dockerfile," # backwards compat
"
15237,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# vim:set ft=dockerfile:
"
15238,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# explicitly set user/group IDs
"
15239,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
15240,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
15241,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# grab gosu for easy step-down from root
"
15242,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15243,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
15244,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
15245,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
15246,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
15247,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# arches officialy built by upstream
"
15248,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
15249,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
15250,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
15251,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
15252,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
15253,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
15254,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
15255,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
15256,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
15257,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
15258,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15259,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
15260,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15261,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile," # backwards compat
"
15262,904b4637237bf17657674bafe3ca42d241e3e745,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
15263,904b4637237bf17657674bafe3ca42d241e3e745,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
15264,904b4637237bf17657674bafe3ca42d241e3e745,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
15265,904b4637237bf17657674bafe3ca42d241e3e745,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15266,904b4637237bf17657674bafe3ca42d241e3e745,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
15267,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15268,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
15269,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15270,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"#		krb5-dev \
"
15271,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"#		openldap-dev \
"
15272,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# configure: error: prove not found
"
15273,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15274,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15275,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15276,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15277,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15278,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15279,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15280,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15281,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15282,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15283,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15284,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15285,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15286,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15287,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile," # backwards compat
"
15288,4566cb036dd021c42c252f7a41797d5d3907c0d2,/10/Dockerfile,"# vim:set ft=dockerfile:
"
15289,4566cb036dd021c42c252f7a41797d5d3907c0d2,/10/Dockerfile,"# explicitly set user/group IDs
"
15290,4566cb036dd021c42c252f7a41797d5d3907c0d2,/10/Dockerfile,"# grab gosu for easy step-down from root
"
15291,4566cb036dd021c42c252f7a41797d5d3907c0d2,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15292,4566cb036dd021c42c252f7a41797d5d3907c0d2,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
15293,4566cb036dd021c42c252f7a41797d5d3907c0d2,/10/Dockerfile,"# arches officialy built by upstream
"
15294,4566cb036dd021c42c252f7a41797d5d3907c0d2,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
15295,4566cb036dd021c42c252f7a41797d5d3907c0d2,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
15296,4566cb036dd021c42c252f7a41797d5d3907c0d2,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
15297,4566cb036dd021c42c252f7a41797d5d3907c0d2,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
15298,4566cb036dd021c42c252f7a41797d5d3907c0d2,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
15299,4566cb036dd021c42c252f7a41797d5d3907c0d2,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
15300,4566cb036dd021c42c252f7a41797d5d3907c0d2,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
15301,4566cb036dd021c42c252f7a41797d5d3907c0d2,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
15302,4566cb036dd021c42c252f7a41797d5d3907c0d2,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15303,4566cb036dd021c42c252f7a41797d5d3907c0d2,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
15304,4566cb036dd021c42c252f7a41797d5d3907c0d2,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15305,4566cb036dd021c42c252f7a41797d5d3907c0d2,/10/Dockerfile," # backwards compat
"
15306,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# vim:set ft=dockerfile:
"
15307,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# explicitly set user/group IDs
"
15308,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
15309,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
15310,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# grab gosu for easy step-down from root
"
15311,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15312,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
15313,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
15314,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
15315,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
15316,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# arches officialy built by upstream
"
15317,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
15318,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
15319,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
15320,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
15321,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
15322,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
15323,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
15324,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
15325,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
15326,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
15327,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15328,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
15329,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15330,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile," # backwards compat
"
15331,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15332,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
15333,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15334,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
15335,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
15336,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# configure: error: prove not found
"
15337,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15338,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15339,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
15340,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15341,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15342,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15343,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15344,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15345,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15346,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15347,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15348,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15349,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15350,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15351,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15352,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile," # backwards compat
"
15353,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
15354,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"# explicitly set user/group IDs
"
15355,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
15356,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
15357,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
15358,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15359,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
15360,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
15361,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
15362,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
15363,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"# arches officialy built by upstream
"
15364,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
15365,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
15366,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
15367,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
15368,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
15369,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
15370,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
15371,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
15372,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
15373,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
15374,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15375,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
15376,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15377,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/9.6/Dockerfile," # backwards compat
"
15378,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15379,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
15380,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15381,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
15382,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
15383,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
15384,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15385,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15386,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15387,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15388,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15389,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15390,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15391,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15392,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15393,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15394,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15395,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15396,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15397,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15398,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile," # backwards compat
"
15399,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
15400,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.1/Dockerfile,"# explicitly set user/group IDs
"
15401,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
15402,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15403,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
15404,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"# vim:set ft=dockerfile:
"
15405,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"# explicitly set user/group IDs
"
15406,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
15407,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
15408,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"# grab gosu for easy step-down from root
"
15409,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15410,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
15411,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
15412,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
15413,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
15414,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"# arches officialy built by upstream
"
15415,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
15416,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
15417,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
15418,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
15419,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
15420,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
15421,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
15422,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
15423,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
15424,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
15425,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15426,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
15427,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15428,ebd0118d908b4a089950dc84f3a1d78edc7f771d,/11/Dockerfile," # backwards compat
"
15429,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15430,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
15431,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15432,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"#		krb5-dev \
"
15433,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"#		openldap-dev \
"
15434,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# configure: error: prove not found
"
15435,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15436,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15437,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15438,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
15439,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15440,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15441,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15442,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15443,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15444,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15445,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15446,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15447,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15448,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15449,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile," # backwards compat
"
15450,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15451,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
15452,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15453,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
15454,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
15455,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
15456,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15457,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15458,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15459,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15460,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15461,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15462,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15463,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15464,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15465,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15466,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15467,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15468,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15469,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15470,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile," # backwards compat
"
15471,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15472,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15473,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
15474,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
15475,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15476,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15477,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15478,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15479,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15480,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15481,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15482,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15483,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
15484,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/Dockerfile,"# explicitly set user/group IDs
"
15485,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
15486,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15487,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
15488,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
15489,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15490,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
15491,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15492,6d589780e4e2b275b2c5efe22a56c2c6b64196e9,/9.4/Dockerfile," # backwards compat
"
15493,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15494,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
15495,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15496,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
15497,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
15498,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15499,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
15500,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15501,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15502,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15503,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15504,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15505,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15506,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15507,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15508,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15509,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15510,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile," # backwards compat
"
15511,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
15512,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# explicitly set user/group IDs
"
15513,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
15514,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
15515,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
15516,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15517,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
15518,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
15519,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
15520,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
15521,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# arches officialy built by upstream
"
15522,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
15523,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
15524,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
15525,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
15526,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
15527,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
15528,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
15529,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
15530,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
15531,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
15532,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15533,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
15534,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15535,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile," # backwards compat
"
15536,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15537,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
15538,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15539,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
15540,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
15541,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile,"# configure: error: prove not found
"
15542,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15543,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15544,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
15545,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15546,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15547,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15548,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15549,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15550,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15551,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15552,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15553,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15554,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15555,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15556,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15557,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.2/alpine/Dockerfile," # backwards compat
"
15558,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
15559,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.5/Dockerfile,"# explicitly set user/group IDs
"
15560,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
15561,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15562,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
15563,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15564,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15565,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
15566,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
15567,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15568,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15569,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15570,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15571,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15572,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15573,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15574,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15575,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15576,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15577,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15578,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile," # backwards compat
"
15579,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15580,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
15581,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15582,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
15583,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
15584,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
15585,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15586,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15587,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15588,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15589,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15590,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15591,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15592,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15593,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15594,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15595,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15596,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15597,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15598,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15599,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile," # backwards compat
"
15600,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15601,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
15602,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15603,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
15604,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
15605,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
15606,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15607,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15608,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15609,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15610,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15611,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15612,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15613,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15614,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15615,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15616,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15617,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15618,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15619,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15620,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.4/alpine/Dockerfile," # backwards compat
"
15621,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# vim:set ft=dockerfile:
"
15622,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# explicitly set user/group IDs
"
15623,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
15624,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
15625,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# grab gosu for easy step-down from root
"
15626,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15627,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
15628,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
15629,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
15630,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
15631,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# arches officialy built by upstream
"
15632,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
15633,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
15634,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
15635,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
15636,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
15637,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
15638,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
15639,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
15640,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
15641,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
15642,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15643,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
15644,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15645,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile," # backwards compat
"
15646,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15647,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
15648,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15649,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
15650,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
15651,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
15652,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15653,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15654,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15655,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15656,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15657,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15658,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15659,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15660,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15661,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15662,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15663,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15664,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15665,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15666,59e5a640e9d4896f5d35261fc69402f2f174833b,/9.6/alpine/Dockerfile," # backwards compat
"
15667,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15668,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
15669,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15670,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
15671,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
15672,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
15673,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15674,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15675,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15676,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15677,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15678,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15679,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15680,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15681,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15682,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15683,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15684,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15685,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15686,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15687,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile," # backwards compat
"
15688,54f46e57136635b484295b985acd6e422d0b9583,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15689,54f46e57136635b484295b985acd6e422d0b9583,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15690,54f46e57136635b484295b985acd6e422d0b9583,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
15691,54f46e57136635b484295b985acd6e422d0b9583,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
15692,54f46e57136635b484295b985acd6e422d0b9583,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15693,54f46e57136635b484295b985acd6e422d0b9583,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15694,54f46e57136635b484295b985acd6e422d0b9583,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15695,54f46e57136635b484295b985acd6e422d0b9583,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15696,54f46e57136635b484295b985acd6e422d0b9583,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15697,54f46e57136635b484295b985acd6e422d0b9583,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15698,54f46e57136635b484295b985acd6e422d0b9583,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15699,54f46e57136635b484295b985acd6e422d0b9583,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15700,54f46e57136635b484295b985acd6e422d0b9583,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15701,54f46e57136635b484295b985acd6e422d0b9583,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15702,54f46e57136635b484295b985acd6e422d0b9583,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15703,54f46e57136635b484295b985acd6e422d0b9583,/9.4/alpine/Dockerfile," # backwards compat
"
15704,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15705,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
15706,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15707,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
15708,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
15709,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
15710,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15711,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15712,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15713,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15714,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15715,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15716,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15717,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15718,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15719,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15720,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15721,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15722,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15723,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15724,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile," # backwards compat
"
15725,6abeb8590f35c5251b9f100a667024febaeee06b,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
15726,6abeb8590f35c5251b9f100a667024febaeee06b,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
15727,783906f551b9bc1472751200296f93bb2c55bc44,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
15728,783906f551b9bc1472751200296f93bb2c55bc44,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
15729,783906f551b9bc1472751200296f93bb2c55bc44,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
15730,03f4064a045114f56fa445eb602339faaf79eeec,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15731,03f4064a045114f56fa445eb602339faaf79eeec,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15732,03f4064a045114f56fa445eb602339faaf79eeec,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
15733,03f4064a045114f56fa445eb602339faaf79eeec,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
15734,03f4064a045114f56fa445eb602339faaf79eeec,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15735,03f4064a045114f56fa445eb602339faaf79eeec,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15736,03f4064a045114f56fa445eb602339faaf79eeec,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15737,03f4064a045114f56fa445eb602339faaf79eeec,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15738,03f4064a045114f56fa445eb602339faaf79eeec,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15739,03f4064a045114f56fa445eb602339faaf79eeec,/9.6/alpine/Dockerfile,"# tzdata loading functionality is optional, and fails gracefully
#		tzdata \
"
15740,03f4064a045114f56fa445eb602339faaf79eeec,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15741,03f4064a045114f56fa445eb602339faaf79eeec,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15742,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15743,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
15744,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15745,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"#		krb5-dev \
"
15746,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"#		openldap-dev \
"
15747,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# configure: error: prove not found
"
15748,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15749,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15750,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15751,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15752,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15753,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15754,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15755,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15756,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15757,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15758,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15759,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15760,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15761,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15762,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile," # backwards compat
"
15763,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15764,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
15765,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15766,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"#		krb5-dev \
"
15767,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"#		openldap-dev \
"
15768,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# configure: error: prove not found
"
15769,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15770,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15771,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15772,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15773,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15774,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15775,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15776,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15777,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15778,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15779,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15780,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15781,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15782,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15783,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile," # backwards compat
"
15784,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15785,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
15786,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15787,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
15788,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
15789,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
15790,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15791,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15792,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15793,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15794,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15795,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15796,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15797,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15798,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15799,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15800,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15801,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15802,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15803,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15804,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile," # backwards compat
"
15805,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15806,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
15807,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15808,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
15809,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
15810,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
15811,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15812,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15813,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15814,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15815,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15816,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15817,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15818,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15819,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15820,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15821,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15822,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15823,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15824,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15825,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile," # backwards compat
"
15826,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
15827,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.5/Dockerfile,"# explicitly set user/group IDs
"
15828,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
15829,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15830,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
15831,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15832,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
15833,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15834,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"#		krb5-dev \
"
15835,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"#		openldap-dev \
"
15836,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# configure: error: prove not found
"
15837,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15838,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15839,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15840,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15841,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15842,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15843,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15844,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15845,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15846,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15847,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15848,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15849,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15850,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15851,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile," # backwards compat
"
15852,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15853,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
15854,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15855,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/12/alpine/Dockerfile,"#		krb5-dev \
"
15856,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/12/alpine/Dockerfile,"#		openldap-dev \
"
15857,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/12/alpine/Dockerfile,"# configure: error: prove not found
"
15858,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15859,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15860,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15861,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15862,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15863,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15864,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15865,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15866,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15867,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15868,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15869,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15870,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15871,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15872,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# vim:set ft=dockerfile:
"
15873,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# explicitly set user/group IDs
"
15874,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
15875,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
15876,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# grab gosu for easy step-down from root
"
15877,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15878,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
15879,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
15880,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
15881,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
15882,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
15883,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# arches officialy built by upstream
"
15884,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
15885,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
15886,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
15887,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
15888,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
15889,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
15890,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
15891,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
15892,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
15893,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
15894,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15895,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
15896,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15897,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile," # backwards compat
"
15898,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
15899,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# explicitly set user/group IDs
"
15900,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
15901,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15902,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
15903,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
15904,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
15905,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# arches officialy built by upstream
"
15906,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
15907,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
15908,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
15909,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
15910,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
15911,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
15912,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
15913,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
15914,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15915,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
15916,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15917,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile," # backwards compat
"
15918,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
15919,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.5/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
15920,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
15921,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15922,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
15923,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15924,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15925,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
15926,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
15927,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15928,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15929,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15930,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15931,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15932,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15933,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15934,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15935,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
15936,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.1/Dockerfile,"# explicitly set user/group IDs
"
15937,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
15938,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15939,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
15940,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15941,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
15942,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15943,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"#		krb5-dev \
"
15944,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"#		openldap-dev \
"
15945,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# configure: error: prove not found
"
15946,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15947,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15948,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15949,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15950,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15951,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15952,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15953,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15954,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15955,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15956,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15957,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15958,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15959,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15960,01058c1847400919de5282ca825a7806a9dafcda,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
15961,01058c1847400919de5282ca825a7806a9dafcda,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
15962,01058c1847400919de5282ca825a7806a9dafcda,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
15963,01058c1847400919de5282ca825a7806a9dafcda,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
15964,01058c1847400919de5282ca825a7806a9dafcda,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
15965,01058c1847400919de5282ca825a7806a9dafcda,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
15966,01058c1847400919de5282ca825a7806a9dafcda,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
15967,01058c1847400919de5282ca825a7806a9dafcda,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
15968,01058c1847400919de5282ca825a7806a9dafcda,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
15969,01058c1847400919de5282ca825a7806a9dafcda,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15970,01058c1847400919de5282ca825a7806a9dafcda,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
15971,01058c1847400919de5282ca825a7806a9dafcda,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
15972,01058c1847400919de5282ca825a7806a9dafcda,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
15973,01058c1847400919de5282ca825a7806a9dafcda,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
15974,01058c1847400919de5282ca825a7806a9dafcda,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
15975,01058c1847400919de5282ca825a7806a9dafcda,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
15976,01058c1847400919de5282ca825a7806a9dafcda,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
15977,01058c1847400919de5282ca825a7806a9dafcda,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15978,01058c1847400919de5282ca825a7806a9dafcda,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
15979,01058c1847400919de5282ca825a7806a9dafcda,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15980,01058c1847400919de5282ca825a7806a9dafcda,/9.6/alpine/Dockerfile," # backwards compat
"
15981,a42e1249e16d8eb0c164104410f78f3dcebe6406,/10/Dockerfile,"# vim:set ft=dockerfile:
"
15982,a42e1249e16d8eb0c164104410f78f3dcebe6406,/10/Dockerfile,"# explicitly set user/group IDs
"
15983,a42e1249e16d8eb0c164104410f78f3dcebe6406,/10/Dockerfile,"# grab gosu for easy step-down from root
"
15984,a42e1249e16d8eb0c164104410f78f3dcebe6406,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15985,a42e1249e16d8eb0c164104410f78f3dcebe6406,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
15986,a42e1249e16d8eb0c164104410f78f3dcebe6406,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
15987,a42e1249e16d8eb0c164104410f78f3dcebe6406,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
15988,a42e1249e16d8eb0c164104410f78f3dcebe6406,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
15989,a42e1249e16d8eb0c164104410f78f3dcebe6406,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
15990,a42e1249e16d8eb0c164104410f78f3dcebe6406,/10/Dockerfile," # backwards compat
"
15991,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"# vim:set ft=dockerfile:
"
15992,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"# explicitly set user/group IDs
"
15993,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
15994,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
15995,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"# grab gosu for easy step-down from root
"
15996,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
15997,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
15998,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
15999,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16000,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
16001,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"# arches officialy built by upstream
"
16002,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
16003,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
16004,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
16005,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
16006,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
16007,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
16008,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
16009,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
16010,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
16011,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
16012,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16013,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
16014,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16015,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/11/Dockerfile," # backwards compat
"
16016,347593c5d25935dc1480adc6079400c2faf7ae5f,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
16017,347593c5d25935dc1480adc6079400c2faf7ae5f,/9.3/Dockerfile,"# explicitly set user/group IDs
"
16018,347593c5d25935dc1480adc6079400c2faf7ae5f,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
16019,347593c5d25935dc1480adc6079400c2faf7ae5f,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16020,347593c5d25935dc1480adc6079400c2faf7ae5f,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16021,347593c5d25935dc1480adc6079400c2faf7ae5f,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
16022,347593c5d25935dc1480adc6079400c2faf7ae5f,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16023,347593c5d25935dc1480adc6079400c2faf7ae5f,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
16024,347593c5d25935dc1480adc6079400c2faf7ae5f,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16025,347593c5d25935dc1480adc6079400c2faf7ae5f,/9.3/Dockerfile," # backwards compat
"
16026,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16027,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
16028,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16029,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
16030,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
16031,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
16032,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
16033,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16034,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
16035,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
16036,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
16037,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
16038,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
16039,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16040,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16041,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16042,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16043,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16044,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16045,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16046,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16047,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile," # backwards compat
"
16048,2c72165e4f9dc66a61998111f69b5eba0b6b71f4,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
16049,2c72165e4f9dc66a61998111f69b5eba0b6b71f4,/9.5/Dockerfile,"# explicitly set user/group IDs
"
16050,2c72165e4f9dc66a61998111f69b5eba0b6b71f4,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
16051,2c72165e4f9dc66a61998111f69b5eba0b6b71f4,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16052,2c72165e4f9dc66a61998111f69b5eba0b6b71f4,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
16053,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16054,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16055,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
16056,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
16057,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16058,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16059,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16060,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16061,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16062,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16063,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16064,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16065,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16066,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16067,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
16068,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
16069,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16070,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
16071,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
16072,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16073,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16074,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16075,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16076,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16077,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16078,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16079,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16080,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# vim:set ft=dockerfile:
"
16081,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# explicitly set user/group IDs
"
16082,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
16083,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
16084,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# grab gosu for easy step-down from root
"
16085,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16086,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
16087,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
16088,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16089,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
16090,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# arches officialy built by upstream
"
16091,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
16092,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
16093,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
16094,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
16095,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
16096,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
16097,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
16098,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
16099,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
16100,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
16101,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16102,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
16103,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16104,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/12/Dockerfile," # backwards compat
"
16105,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
16106,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile,"# explicitly set user/group IDs
"
16107,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
16108,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
16109,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
16110,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16111,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
16112,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
16113,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16114,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile,"# arches officialy built by upstream
"
16115,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
16116,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
16117,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
16118,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
16119,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
16120,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
16121,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
16122,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
16123,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16124,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
16125,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16126,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/9.4/Dockerfile," # backwards compat
"
16127,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
16128,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# explicitly set user/group IDs
"
16129,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
16130,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
16131,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
16132,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16133,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
16134,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
16135,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16136,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
16137,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# arches officialy built by upstream
"
16138,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
16139,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
16140,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
16141,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
16142,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
16143,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
16144,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
16145,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
16146,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
16147,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
16148,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16149,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
16150,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16151,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.6/Dockerfile," # backwards compat
"
16152,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16153,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16154,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
16155,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
16156,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16157,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
16158,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
16159,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16160,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16161,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16162,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16163,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16164,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16165,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16166,e43016225fea0cdf47ae1df0888885ae02a8a7f4,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16167,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16168,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16169,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
16170,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
16171,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16172,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16173,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16174,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16175,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16176,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16177,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16178,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16179,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# vim:set ft=dockerfile:
"
16180,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# explicitly set user/group IDs
"
16181,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
16182,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
16183,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
16184,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16185,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
16186,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
16187,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
16188,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16189,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
16190,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# arches officialy built by upstream
"
16191,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
16192,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
16193,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
16194,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
16195,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
16196,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
16197,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
16198,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
16199,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
16200,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
16201,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16202,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
16203,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16204,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile," # backwards compat
"
16205,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
16206,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.1/Dockerfile,"# explicitly set user/group IDs
"
16207,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
16208,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16209,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
16210,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16211,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16212,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
16213,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
16214,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16215,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16216,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16217,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16218,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16219,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16220,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16221,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16222,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# vim:set ft=dockerfile:
"
16223,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# explicitly set user/group IDs
"
16224,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
16225,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
16226,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# grab gosu for easy step-down from root
"
16227,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16228,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
16229,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
16230,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16231,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
16232,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# arches officialy built by upstream
"
16233,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
16234,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
16235,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
16236,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
16237,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
16238,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
16239,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
16240,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
16241,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
16242,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
16243,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16244,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
16245,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16246,59e5a640e9d4896f5d35261fc69402f2f174833b,/10/Dockerfile," # backwards compat
"
16247,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
16248,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# explicitly set user/group IDs
"
16249,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
16250,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16251,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
16252,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
16253,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16254,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# arches officialy built by upstream
"
16255,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
16256,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
16257,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
16258,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
16259,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
16260,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
16261,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
16262,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
16263,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16264,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
16265,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16266,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile," # backwards compat
"
16267,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16268,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
16269,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16270,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"#		krb5-dev \
"
16271,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"#		openldap-dev \
"
16272,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# configure: error: prove not found
"
16273,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
16274,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16275,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
16276,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
16277,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
16278,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16279,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16280,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16281,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16282,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"#p' --recursive /usr/local \
"
16283,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16284,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16285,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16286,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16287,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16288,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
16289,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16290,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/11/alpine/Dockerfile,"#		krb5-dev \
"
16291,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/11/alpine/Dockerfile,"#		openldap-dev \
"
16292,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/11/alpine/Dockerfile,"# configure: error: prove not found
"
16293,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
16294,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16295,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
16296,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
16297,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
16298,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16299,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16300,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16301,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16302,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
16303,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16304,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16305,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16306,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16307,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/11/alpine/Dockerfile," # backwards compat
"
16308,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
16309,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
16310,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
16311,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16312,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
16313,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
16314,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/Dockerfile,"# explicitly set user/group IDs
"
16315,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
16316,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16317,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16318,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
16319,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16320,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
16321,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16322,7c8e945a80097e80fa1c8d69d2a027145177b701,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
16323,7c8e945a80097e80fa1c8d69d2a027145177b701,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
16324,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16325,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16326,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
16327,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
16328,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16329,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16330,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16331,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16332,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16333,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16334,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16335,069acf6f69adb67e956ceb374fff4cfe50c6180d,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16336,783906f551b9bc1472751200296f93bb2c55bc44,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
16337,783906f551b9bc1472751200296f93bb2c55bc44,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
16338,783906f551b9bc1472751200296f93bb2c55bc44,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
16339,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
16340,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/Dockerfile,"# explicitly set user/group IDs
"
16341,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
16342,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16343,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16344,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/Dockerfile,"# arches officialy built by upstream
"
16345,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
16346,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
16347,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
16348,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
16349,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
16350,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
16351,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
16352,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
16353,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16354,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
16355,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16356,57213ab012e6a38a27283eeac65c4726c069647a,/9.3/Dockerfile," # backwards compat
"
16357,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
16358,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
16359,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
16360,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16361,b36f03d03593858497e1dda862c732cd1eb2ce86,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
16362,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/10/Dockerfile,"# vim:set ft=dockerfile:
"
16363,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/10/Dockerfile,"# explicitly set user/group IDs
"
16364,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/10/Dockerfile,"# grab gosu for easy step-down from root
"
16365,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16366,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
16367,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16368,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/10/Dockerfile,"# arches officialy built by upstream
"
16369,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
16370,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
16371,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
16372,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
16373,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
16374,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
16375,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
16376,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
16377,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16378,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
16379,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16380,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/10/Dockerfile," # backwards compat
"
16381,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16382,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
16383,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16384,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/10/alpine/Dockerfile,"#		krb5-dev \
"
16385,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/10/alpine/Dockerfile,"#		openldap-dev \
"
16386,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/10/alpine/Dockerfile,"# configure: error: prove not found
"
16387,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
16388,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16389,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
16390,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
16391,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
16392,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16393,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16394,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16395,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16396,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
16397,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16398,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16399,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16400,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16401,6274e4c4c61c29a2b3d9fec61e40486254dbc859,/10/alpine/Dockerfile," # backwards compat
"
16402,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16403,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
16404,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16405,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
16406,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
16407,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
16408,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
16409,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16410,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
16411,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
16412,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
16413,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16414,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16415,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16416,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16417,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
16418,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16419,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16420,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16421,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16422,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile," # backwards compat
"
16423,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16424,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
16425,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16426,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
16427,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
16428,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
16429,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
16430,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16431,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
16432,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
16433,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
16434,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16435,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16436,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16437,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16438,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
16439,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16440,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16441,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16442,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16443,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile," # backwards compat
"
16444,2bfa44dab27b6be46333ac7bf86f2517c1479090,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
16445,2bfa44dab27b6be46333ac7bf86f2517c1479090,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
16446,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/13/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16447,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/13/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
16448,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/13/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16449,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/13/alpine/Dockerfile,"#		krb5-dev \
"
16450,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/13/alpine/Dockerfile,"#		openldap-dev \
"
16451,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/13/alpine/Dockerfile,"# configure: error: prove not found
"
16452,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/13/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
16453,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/13/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16454,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/13/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
16455,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/13/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
16456,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/13/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
16457,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/13/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16458,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/13/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16459,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/13/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16460,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/13/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16461,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/13/alpine/Dockerfile,"#p' --recursive /usr/local \
"
16462,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/13/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16463,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/13/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16464,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/13/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16465,9586595a9bded3c7cde8682d95db9d79dc0d9ca3,/13/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16466,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# vim:set ft=dockerfile:
"
16467,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# explicitly set user/group IDs
"
16468,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# grab gosu for easy step-down from root
"
16469,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16470,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16471,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# arches officialy built by upstream
"
16472,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
16473,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
16474,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
16475,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
16476,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
16477,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
16478,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
16479,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
16480,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16481,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
16482,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16483,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile," # backwards compat
"
16484,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
16485,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
16486,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
16487,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16488,403dc53653e3a98517dbcb425ee61db0a2fe7a95,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
16489,54f46e57136635b484295b985acd6e422d0b9583,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16490,54f46e57136635b484295b985acd6e422d0b9583,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16491,54f46e57136635b484295b985acd6e422d0b9583,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
16492,54f46e57136635b484295b985acd6e422d0b9583,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
16493,54f46e57136635b484295b985acd6e422d0b9583,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16494,54f46e57136635b484295b985acd6e422d0b9583,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
16495,54f46e57136635b484295b985acd6e422d0b9583,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
16496,54f46e57136635b484295b985acd6e422d0b9583,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16497,54f46e57136635b484295b985acd6e422d0b9583,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16498,54f46e57136635b484295b985acd6e422d0b9583,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16499,54f46e57136635b484295b985acd6e422d0b9583,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16500,54f46e57136635b484295b985acd6e422d0b9583,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16501,54f46e57136635b484295b985acd6e422d0b9583,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16502,54f46e57136635b484295b985acd6e422d0b9583,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16503,54f46e57136635b484295b985acd6e422d0b9583,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16504,54f46e57136635b484295b985acd6e422d0b9583,/9.3/alpine/Dockerfile," # backwards compat
"
16505,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
16506,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.5/Dockerfile,"# explicitly set user/group IDs
"
16507,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
16508,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16509,ec5ce80ca914e02c2d5eb9fde424039d4cee032e,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
16510,8904bffa5e197cd016e0d6349d1db8b480fa28a9,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
16511,8904bffa5e197cd016e0d6349d1db8b480fa28a9,/9.5/Dockerfile,"# explicitly set user/group IDs
"
16512,8904bffa5e197cd016e0d6349d1db8b480fa28a9,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
16513,8904bffa5e197cd016e0d6349d1db8b480fa28a9,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16514,8904bffa5e197cd016e0d6349d1db8b480fa28a9,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16515,8904bffa5e197cd016e0d6349d1db8b480fa28a9,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
16516,8904bffa5e197cd016e0d6349d1db8b480fa28a9,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16517,8904bffa5e197cd016e0d6349d1db8b480fa28a9,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
16518,8904bffa5e197cd016e0d6349d1db8b480fa28a9,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16519,8904bffa5e197cd016e0d6349d1db8b480fa28a9,/9.5/Dockerfile," # backwards compat
"
16520,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16521,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
16522,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16523,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
16524,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
16525,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
16526,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
16527,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16528,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
16529,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
16530,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
16531,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16532,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16533,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16534,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16535,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
16536,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16537,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16538,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16539,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16540,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile," # backwards compat
"
16541,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16542,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
16543,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16544,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
16545,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
16546,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
16547,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
16548,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16549,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
16550,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
16551,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
16552,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16553,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16554,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16555,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16556,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16557,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16558,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16559,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16560,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.5/alpine/Dockerfile," # backwards compat
"
16561,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16562,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
16563,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16564,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
16565,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
16566,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
16567,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
16568,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16569,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
16570,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
16571,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
16572,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16573,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16574,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16575,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16576,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
16577,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16578,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16579,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16580,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16581,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/9.6/alpine/Dockerfile," # backwards compat
"
16582,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16583,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
16584,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16585,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"#		krb5-dev \
"
16586,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"#		openldap-dev \
"
16587,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# configure: error: prove not found
"
16588,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
16589,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16590,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
16591,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
16592,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
16593,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16594,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16595,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16596,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16597,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
16598,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16599,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16600,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16601,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16602,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile," # backwards compat
"
16603,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16604,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
16605,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16606,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
16607,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
16608,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16609,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
16610,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
16611,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16612,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16613,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16614,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16615,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16616,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16617,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16618,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16619,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile," # backwards compat
"
16620,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16621,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16622,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
16623,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
16624,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16625,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16626,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16627,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16628,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16629,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16630,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
16631,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16632,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
16633,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
16634,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
16635,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
16636,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16637,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
16638,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
16639,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
16640,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
16641,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
16642,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16643,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16644,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16645,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16646,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
16647,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16648,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16649,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16650,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16651,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.3/alpine/Dockerfile," # backwards compat
"
16652,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
16653,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"# explicitly set user/group IDs
"
16654,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
16655,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
16656,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
16657,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16658,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
16659,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
16660,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16661,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
16662,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"# arches officialy built by upstream
"
16663,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
16664,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
16665,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
16666,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
16667,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
16668,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
16669,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
16670,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
16671,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
16672,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
16673,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16674,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
16675,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16676,73f9262456e4efac9ccfa453b3bcd5d27c6b9112,/9.4/Dockerfile," # backwards compat
"
16677,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16678,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
16679,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16680,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"#		krb5-dev \
"
16681,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"#		openldap-dev \
"
16682,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# configure: error: prove not found
"
16683,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
16684,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16685,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
16686,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
16687,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
16688,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16689,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16690,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16691,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16692,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
16693,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16694,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16695,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16696,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16697,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile,"# vim:set ft=dockerfile:
"
16698,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile,"# explicitly set user/group IDs
"
16699,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
16700,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
16701,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile,"# grab gosu for easy step-down from root
"
16702,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16703,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
16704,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
16705,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16706,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile,"# arches officialy built by upstream
"
16707,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
16708,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
16709,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
16710,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
16711,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
16712,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
16713,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
16714,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
16715,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16716,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
16717,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16718,35d6f4b68399cf2ffcb1c13c27003b92f53b9bc8,/10/Dockerfile," # backwards compat
"
16719,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
16720,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# explicitly set user/group IDs
"
16721,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
16722,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16723,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16724,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# arches officialy built by upstream
"
16725,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
16726,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
16727,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
16728,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
16729,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
16730,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
16731,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
16732,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
16733,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16734,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
16735,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16736,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile," # backwards compat
"
16737,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
16738,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
16739,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
16740,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16741,a82c28e1c407ef5ddfc2a6014dac87bcc4955a26,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
16742,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# vim:set ft=dockerfile:
"
16743,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# explicitly set user/group IDs
"
16744,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
16745,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
16746,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# grab gosu for easy step-down from root
"
16747,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16748,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
16749,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
16750,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16751,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
16752,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# arches officialy built by upstream
"
16753,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
16754,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
16755,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
16756,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
16757,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
16758,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
16759,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
16760,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
16761,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
16762,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
16763,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16764,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
16765,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16766,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile," # backwards compat
"
16767,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# vim:set ft=dockerfile:
"
16768,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# explicitly set user/group IDs
"
16769,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
16770,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
16771,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# grab gosu for easy step-down from root
"
16772,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16773,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
16774,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
16775,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
16776,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16777,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
16778,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# arches officialy built by upstream
"
16779,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
16780,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
16781,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
16782,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
16783,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
16784,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
16785,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
16786,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
16787,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
16788,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
16789,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16790,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
16791,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16792,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile," # backwards compat
"
16793,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16794,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16795,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
16796,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
16797,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16798,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16799,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16800,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16801,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16802,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16803,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16804,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16805,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
16806,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# explicitly set user/group IDs
"
16807,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
16808,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
16809,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
16810,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16811,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
16812,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
16813,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16814,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
16815,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# arches officialy built by upstream
"
16816,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
16817,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
16818,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
16819,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
16820,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
16821,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
16822,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
16823,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
16824,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
16825,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
16826,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16827,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
16828,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16829,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile," # backwards compat
"
16830,e2971da001b64a54b4a971ecc83ad9a86ad25387,/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
16831,e2971da001b64a54b4a971ecc83ad9a86ad25387,/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
16832,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
16833,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
16834,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
16835,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
16836,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
16837,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
16838,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
16839,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
16840,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
16841,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
16842,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
16843,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
16844,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
16845,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
16846,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
16847,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
16848,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
16849,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16850,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
16851,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16852,55e3dc038075e4cf1c30ec4f675d633ff849c0ef,/9.6/alpine/Dockerfile," # backwards compat
"
16853,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
16854,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.1/Dockerfile,"# explicitly set user/group IDs
"
16855,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
16856,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16857,9737ce4eeb7d580de8bd6831d8144ba08c316197,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
16858,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
16859,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# explicitly set user/group IDs
"
16860,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
16861,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16862,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
16863,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16864,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# arches officialy built by upstream
"
16865,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
16866,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
16867,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
16868,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
16869,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
16870,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
16871,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
16872,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
16873,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16874,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
16875,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16876,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile," # backwards compat
"
16877,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
16878,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# explicitly set user/group IDs
"
16879,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
16880,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
16881,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
16882,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16883,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
16884,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
16885,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
16886,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16887,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
16888,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# arches officialy built by upstream
"
16889,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
16890,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
16891,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
16892,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
16893,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
16894,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
16895,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
16896,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
16897,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
16898,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
16899,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16900,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
16901,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16902,0a0f6444f52b3bf5067a94eda9b009cc0aede651,/9.5/Dockerfile," # backwards compat
"
16903,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
16904,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.3/Dockerfile,"# explicitly set user/group IDs
"
16905,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
16906,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16907,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
16908,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16909,48d6cd0f57ea3f7de4a3d02d7b0ca8f2f9d6e991,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
16910,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
16911,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.4/Dockerfile,"# explicitly set user/group IDs
"
16912,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
16913,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16914,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
16915,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16916,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
16917,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
16918,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.5/Dockerfile,"# explicitly set user/group IDs
"
16919,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
16920,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16921,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
16922,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
16923,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# explicitly set user/group IDs
"
16924,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
16925,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
16926,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
16927,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16928,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
16929,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
16930,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16931,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
16932,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# arches officialy built by upstream
"
16933,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
16934,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
16935,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
16936,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
16937,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
16938,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
16939,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
16940,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
16941,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
16942,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
16943,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16944,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
16945,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16946,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile," # backwards compat
"
16947,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
16948,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"# explicitly set user/group IDs
"
16949,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
16950,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
16951,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
16952,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16953,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
16954,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
16955,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16956,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
16957,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"# arches officialy built by upstream
"
16958,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
16959,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
16960,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
16961,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
16962,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
16963,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
16964,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
16965,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
16966,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
16967,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
16968,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16969,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
16970,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16971,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/9.4/Dockerfile," # backwards compat
"
16972,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/Dockerfile,"# vim:set ft=dockerfile:
"
16973,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/Dockerfile,"# explicitly set user/group IDs
"
16974,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/Dockerfile,"# grab gosu for easy step-down from root
"
16975,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16976,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16977,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
16978,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
16979,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
16980,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
16981,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/Dockerfile," # backwards compat
"
16982,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
16983,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# explicitly set user/group IDs
"
16984,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
16985,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
16986,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
16987,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
16988,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
16989,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
16990,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
16991,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# see note below about ""*.pyc"" files
"
16992,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# arches officialy built by upstream
"
16993,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
16994,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
16995,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
16996,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
16997,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
16998,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
16999,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
17000,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
17001,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
17002,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
17003,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17004,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
17005,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17006,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile," # backwards compat
"
17007,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17008,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
17009,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17010,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
17011,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
17012,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
17013,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17014,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17015,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17016,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17017,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17018,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17019,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17020,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17021,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17022,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17023,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17024,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17025,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17026,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17027,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile," # backwards compat
"
17028,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# vim:set ft=dockerfile:
"
17029,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# explicitly set user/group IDs
"
17030,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# grab gosu for easy step-down from root
"
17031,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17032,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
17033,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
17034,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
17035,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# arches officialy built by upstream
"
17036,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
17037,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
17038,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
17039,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
17040,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
17041,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
17042,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
17043,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
17044,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17045,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
17046,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17047,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile," # backwards compat
"
17048,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17049,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
17050,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17051,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"#		krb5-dev \
"
17052,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"#		openldap-dev \
"
17053,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# configure: error: prove not found
"
17054,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17055,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17056,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17057,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17058,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17059,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17060,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17061,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17062,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17063,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17064,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17065,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17066,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17067,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17068,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17069,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
17070,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17071,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/alpine/Dockerfile,"#		krb5-dev \
"
17072,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/alpine/Dockerfile,"#		openldap-dev \
"
17073,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/alpine/Dockerfile,"# configure: error: prove not found
"
17074,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17075,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17076,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17077,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17078,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17079,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17080,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17081,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17082,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17083,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17084,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17085,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17086,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17087,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17088,3f8d33c06e25295260a6d30defa6dce40aea8ad8,/11/alpine/Dockerfile," # backwards compat
"
17089,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
17090,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/Dockerfile,"# explicitly set user/group IDs
"
17091,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
17092,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17093,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
17094,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
17095,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17096,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
17097,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17098,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/Dockerfile," # backwards compat
"
17099,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17100,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
17101,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17102,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
17103,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
17104,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
17105,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17106,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17107,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17108,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17109,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17110,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17111,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17112,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17113,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17114,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17115,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17116,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17117,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17118,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17119,6d1f671dcd2c8d51484d19767a33c37110dd650f,/9.4/alpine/Dockerfile," # backwards compat
"
17120,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17121,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
17122,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17123,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
17124,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
17125,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
17126,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17127,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17128,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17129,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17130,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17131,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17132,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17133,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17134,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17135,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17136,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17137,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17138,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17139,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17140,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile," # backwards compat
"
17141,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17142,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17143,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
17144,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
17145,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17146,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17147,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17148,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17149,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17150,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17151,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17152,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17153,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17154,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17155,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
17156,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/Dockerfile,"# explicitly set user/group IDs
"
17157,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
17158,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17159,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
17160,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
17161,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17162,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
17163,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17164,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/Dockerfile," # backwards compat
"
17165,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17166,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
17167,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17168,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
17169,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
17170,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
17171,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17172,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17173,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17174,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17175,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17176,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17177,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17178,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17179,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17180,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17181,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17182,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17183,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17184,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17185,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile," # backwards compat
"
17186,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17187,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
17188,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17189,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
17190,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
17191,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
17192,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17193,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17194,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17195,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17196,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17197,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17198,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17199,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17200,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17201,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17202,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17203,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17204,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17205,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17206,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile," # backwards compat
"
17207,ef1e190d84d5ef8c763cb96aeec3356916444efc,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
17208,ef1e190d84d5ef8c763cb96aeec3356916444efc,/9.3/Dockerfile,"# explicitly set user/group IDs
"
17209,ef1e190d84d5ef8c763cb96aeec3356916444efc,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
17210,ef1e190d84d5ef8c763cb96aeec3356916444efc,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17211,ef1e190d84d5ef8c763cb96aeec3356916444efc,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
17212,ef1e190d84d5ef8c763cb96aeec3356916444efc,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
17213,ef1e190d84d5ef8c763cb96aeec3356916444efc,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17214,ef1e190d84d5ef8c763cb96aeec3356916444efc,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
17215,ef1e190d84d5ef8c763cb96aeec3356916444efc,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17216,ef1e190d84d5ef8c763cb96aeec3356916444efc,/9.3/Dockerfile," # backwards compat
"
17217,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
17218,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/Dockerfile,"# explicitly set user/group IDs
"
17219,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
17220,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17221,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
17222,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/Dockerfile,"# arches officialy built by upstream
"
17223,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
17224,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
17225,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
17226,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
17227,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
17228,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
17229,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
17230,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
17231,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17232,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
17233,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17234,bef8f02d1fe2bb4547280ba609f19abd20230180,/9.6/Dockerfile," # backwards compat
"
17235,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17236,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17237,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
17238,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
17239,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17240,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17241,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17242,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17243,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17244,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"# tzdata adds around 1Mb to image size, but it is suggested by Django documentation that timezone should be set for performance reasons: http://bit.ly/2fMYhh1
"
17245,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17246,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17247,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17248,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
17249,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17250,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/10/alpine/Dockerfile,"#		krb5-dev \
"
17251,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/10/alpine/Dockerfile,"#		openldap-dev \
"
17252,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/10/alpine/Dockerfile,"# configure: error: prove not found
"
17253,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17254,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17255,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17256,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17257,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17258,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17259,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17260,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17261,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17262,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17263,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17264,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17265,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17266,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17267,441533ac6cf0c4de3f5225c20e8a9810c29b5a50,/10/alpine/Dockerfile," # backwards compat
"
17268,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
17269,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/Dockerfile,"# explicitly set user/group IDs
"
17270,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
17271,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17272,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
17273,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
17274,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17275,03a6cb67dfd3045996c024e5569d938b25bd41b6,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
17276,c6484bf22f5a0f72a49658ae9e5569bc01785eff,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
17277,c6484bf22f5a0f72a49658ae9e5569bc01785eff,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
17278,c6484bf22f5a0f72a49658ae9e5569bc01785eff,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
17279,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
17280,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/Dockerfile,"# explicitly set user/group IDs
"
17281,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
17282,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17283,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
17284,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
17285,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/Dockerfile,"# arches officialy built by upstream
"
17286,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
17287,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
17288,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
17289,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
17290,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
17291,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
17292,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
17293,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
17294,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17295,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
17296,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17297,5876d4b88ac59d56115a7f02b7a7556b4b3f9a9d,/9.5/Dockerfile," # backwards compat
"
17298,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
17299,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# explicitly set user/group IDs
"
17300,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
17301,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17302,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
17303,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
17304,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# arches officialy built by upstream
"
17305,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
17306,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
17307,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
17308,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
17309,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
17310,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
17311,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
17312,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
17313,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17314,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
17315,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17316,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile," # backwards compat
"
17317,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
17318,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.3/Dockerfile,"# explicitly set user/group IDs
"
17319,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
17320,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17321,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
17322,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
17323,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
17324,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
17325,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17326,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
17327,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
17328,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.1/Dockerfile,"# explicitly set user/group IDs
"
17329,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
17330,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17331,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
17332,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.1/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17333,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.1/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
17334,6750eda25a2f0856b3997309ef393475f008d6a3,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17335,6750eda25a2f0856b3997309ef393475f008d6a3,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
17336,6750eda25a2f0856b3997309ef393475f008d6a3,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17337,6750eda25a2f0856b3997309ef393475f008d6a3,/10/alpine/Dockerfile,"#		krb5-dev \
"
17338,6750eda25a2f0856b3997309ef393475f008d6a3,/10/alpine/Dockerfile,"#		openldap-dev \
"
17339,6750eda25a2f0856b3997309ef393475f008d6a3,/10/alpine/Dockerfile,"# configure: error: prove not found
"
17340,6750eda25a2f0856b3997309ef393475f008d6a3,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17341,6750eda25a2f0856b3997309ef393475f008d6a3,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17342,6750eda25a2f0856b3997309ef393475f008d6a3,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17343,6750eda25a2f0856b3997309ef393475f008d6a3,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17344,6750eda25a2f0856b3997309ef393475f008d6a3,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17345,6750eda25a2f0856b3997309ef393475f008d6a3,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17346,6750eda25a2f0856b3997309ef393475f008d6a3,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17347,6750eda25a2f0856b3997309ef393475f008d6a3,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17348,6750eda25a2f0856b3997309ef393475f008d6a3,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17349,6750eda25a2f0856b3997309ef393475f008d6a3,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17350,6750eda25a2f0856b3997309ef393475f008d6a3,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17351,6750eda25a2f0856b3997309ef393475f008d6a3,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17352,6750eda25a2f0856b3997309ef393475f008d6a3,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17353,6750eda25a2f0856b3997309ef393475f008d6a3,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17354,6750eda25a2f0856b3997309ef393475f008d6a3,/10/alpine/Dockerfile," # backwards compat
"
17355,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
17356,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.2/Dockerfile,"# explicitly set user/group IDs
"
17357,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
17358,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17359,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
17360,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
17361,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
17362,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
17363,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17364,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
17365,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17366,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
17367,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17368,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"#		krb5-dev \
"
17369,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"#		openldap-dev \
"
17370,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# configure: error: prove not found
"
17371,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17372,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17373,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17374,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17375,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17376,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17377,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17378,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17379,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17380,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17381,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17382,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17383,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17384,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17385,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile," # backwards compat
"
17386,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
17387,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"# explicitly set user/group IDs
"
17388,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
17389,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
17390,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
17391,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17392,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
17393,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
17394,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
17395,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"# see note below about ""*.pyc"" files
"
17396,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"# arches officialy built by upstream
"
17397,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
17398,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
17399,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
17400,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
17401,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
17402,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
17403,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
17404,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
17405,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
17406,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
17407,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17408,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
17409,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17410,91939daa3f42d2796952f03353534cd87d181ccc,/9.3/Dockerfile," # backwards compat
"
17411,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
17412,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.6/Dockerfile,"# explicitly set user/group IDs
"
17413,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
17414,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17415,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
17416,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17417,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
17418,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17419,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17420,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
17421,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
17422,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17423,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17424,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17425,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17426,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17427,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"# tzdata loading functionality is optional, and fails gracefully
#		tzdata \
"
17428,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17429,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17430,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
17431,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# explicitly set user/group IDs
"
17432,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
17433,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
17434,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
17435,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17436,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
17437,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
17438,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
17439,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# see note below about ""*.pyc"" files
"
17440,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# arches officialy built by upstream
"
17441,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
17442,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
17443,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
17444,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
17445,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
17446,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
17447,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
17448,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
17449,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
17450,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
17451,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17452,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
17453,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17454,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile," # backwards compat
"
17455,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17456,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
17457,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17458,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
17459,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
17460,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
17461,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17462,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17463,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17464,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17465,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17466,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17467,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17468,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17469,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17470,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17471,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17472,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17473,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17474,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17475,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile," # backwards compat
"
17476,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17477,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
17478,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17479,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
17480,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
17481,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
17482,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17483,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17484,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17485,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17486,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17487,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17488,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17489,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17490,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17491,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17492,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17493,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17494,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17495,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17496,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile," # backwards compat
"
17497,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
17498,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.5/Dockerfile,"# explicitly set user/group IDs
"
17499,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
17500,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17501,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
17502,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
17503,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
17504,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.5/Dockerfile,"# arches officialy built by upstream
"
17505,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
17506,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
17507,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
17508,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
17509,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
17510,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
17511,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
17512,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
17513,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17514,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
17515,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17516,c372e3b28062d4e0b7aea58e51e6b91741d839a6,/9.5/Dockerfile," # backwards compat
"
17517,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
17518,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# explicitly set user/group IDs
"
17519,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
17520,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17521,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
17522,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# arches officialy built by upstream
"
17523,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
17524,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
17525,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
17526,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
17527,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
17528,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
17529,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
17530,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
17531,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17532,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
17533,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17534,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile," # backwards compat
"
17535,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"# vim:set ft=dockerfile:
"
17536,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"# explicitly set user/group IDs
"
17537,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
17538,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
17539,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"# grab gosu for easy step-down from root
"
17540,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17541,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
17542,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
17543,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
17544,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
17545,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"# arches officialy built by upstream
"
17546,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
17547,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
17548,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
17549,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
17550,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
17551,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
17552,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
17553,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
17554,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
17555,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
17556,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17557,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
17558,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17559,91939daa3f42d2796952f03353534cd87d181ccc,/11/Dockerfile," # backwards compat
"
17560,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17561,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
17562,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17563,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
17564,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
17565,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
17566,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17567,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17568,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17569,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17570,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17571,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17572,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17573,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17574,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17575,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17576,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17577,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17578,0f55625d25faf7ad6adf821e91612d7df53d9a11,/9.6/alpine/Dockerfile," # backwards compat
"
17579,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# vim:set ft=dockerfile:
"
17580,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# explicitly set user/group IDs
"
17581,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
17582,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
17583,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# grab gosu for easy step-down from root
"
17584,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17585,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
17586,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
17587,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
17588,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
17589,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# arches officialy built by upstream
"
17590,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
17591,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
17592,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
17593,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
17594,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
17595,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
17596,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
17597,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
17598,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
17599,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
17600,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17601,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
17602,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17603,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/Dockerfile," # backwards compat
"
17604,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17605,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
17606,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17607,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"#		krb5-dev \
"
17608,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"#		openldap-dev \
"
17609,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# configure: error: prove not found
"
17610,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17611,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17612,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17613,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17614,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17615,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17616,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17617,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17618,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17619,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17620,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17621,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17622,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17623,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17624,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17625,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
17626,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17627,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"#		krb5-dev \
"
17628,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"#		openldap-dev \
"
17629,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# configure: error: prove not found
"
17630,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17631,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17632,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17633,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17634,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17635,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17636,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17637,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17638,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17639,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17640,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17641,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17642,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17643,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17644,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# vim:set ft=dockerfile:
"
17645,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# explicitly set user/group IDs
"
17646,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
17647,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
17648,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# grab gosu for easy step-down from root
"
17649,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17650,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
17651,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
17652,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
17653,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
17654,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# arches officialy built by upstream
"
17655,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
17656,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
17657,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
17658,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
17659,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
17660,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
17661,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
17662,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
17663,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
17664,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
17665,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17666,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
17667,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17668,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile," # backwards compat
"
17669,123aedc09bc067740fb28921c500ded83c018bd4,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17670,123aedc09bc067740fb28921c500ded83c018bd4,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17671,123aedc09bc067740fb28921c500ded83c018bd4,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
17672,123aedc09bc067740fb28921c500ded83c018bd4,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
17673,123aedc09bc067740fb28921c500ded83c018bd4,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17674,123aedc09bc067740fb28921c500ded83c018bd4,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17675,123aedc09bc067740fb28921c500ded83c018bd4,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17676,123aedc09bc067740fb28921c500ded83c018bd4,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17677,123aedc09bc067740fb28921c500ded83c018bd4,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17678,123aedc09bc067740fb28921c500ded83c018bd4,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17679,123aedc09bc067740fb28921c500ded83c018bd4,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17680,123aedc09bc067740fb28921c500ded83c018bd4,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17681,123aedc09bc067740fb28921c500ded83c018bd4,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17682,123aedc09bc067740fb28921c500ded83c018bd4,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17683,123aedc09bc067740fb28921c500ded83c018bd4,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17684,123aedc09bc067740fb28921c500ded83c018bd4,/9.6/alpine/Dockerfile," # backwards compat
"
17685,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17686,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
17687,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17688,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"#		krb5-dev \
"
17689,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"#		openldap-dev \
"
17690,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# configure: error: prove not found
"
17691,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17692,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17693,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17694,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17695,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17696,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17697,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17698,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17699,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17700,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17701,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17702,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17703,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17704,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17705,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile," # backwards compat
"
17706,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17707,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
17708,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17709,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
17710,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
17711,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17712,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17713,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17714,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17715,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17716,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17717,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17718,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17719,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17720,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17721,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17722,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17723,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile," # backwards compat
"
17724,548a270a6c16913a82d77503aba5814601ed4f58,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
17725,548a270a6c16913a82d77503aba5814601ed4f58,/9.4/Dockerfile,"# explicitly set user/group IDs
"
17726,548a270a6c16913a82d77503aba5814601ed4f58,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
17727,548a270a6c16913a82d77503aba5814601ed4f58,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17728,548a270a6c16913a82d77503aba5814601ed4f58,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
17729,548a270a6c16913a82d77503aba5814601ed4f58,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
17730,548a270a6c16913a82d77503aba5814601ed4f58,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17731,548a270a6c16913a82d77503aba5814601ed4f58,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
17732,548a270a6c16913a82d77503aba5814601ed4f58,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17733,548a270a6c16913a82d77503aba5814601ed4f58,/9.4/Dockerfile," # backwards compat
"
17734,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
17735,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.5/Dockerfile,"# explicitly set user/group IDs
"
17736,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
17737,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17738,ed23320582f4ec5b0e5e35c99d98966dacbc6ed8,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
17739,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
17740,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
17741,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
17742,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17743,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
17744,63d966973d9593c0d9890b96f10ac73566913520,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
17745,63d966973d9593c0d9890b96f10ac73566913520,/9.5/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
17746,63d966973d9593c0d9890b96f10ac73566913520,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
17747,63d966973d9593c0d9890b96f10ac73566913520,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17748,63d966973d9593c0d9890b96f10ac73566913520,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
17749,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17750,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
17751,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17752,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
17753,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
17754,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
17755,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17756,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17757,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17758,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17759,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17760,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17761,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17762,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17763,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17764,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17765,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17766,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17767,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17768,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17769,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile," # backwards compat
"
17770,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17771,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
17772,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17773,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"#		krb5-dev \
"
17774,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"#		openldap-dev \
"
17775,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# configure: error: prove not found
"
17776,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17777,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17778,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17779,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17780,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17781,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17782,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17783,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17784,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17785,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17786,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17787,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17788,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17789,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17790,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile," # backwards compat
"
17791,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"# vim:set ft=dockerfile:
"
17792,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"# explicitly set user/group IDs
"
17793,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
17794,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
17795,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"# grab gosu for easy step-down from root
"
17796,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17797,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
17798,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
17799,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
17800,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
17801,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"# arches officialy built by upstream
"
17802,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
17803,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
17804,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
17805,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
17806,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
17807,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
17808,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
17809,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
17810,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
17811,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
17812,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17813,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
17814,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17815,0d9c944be57617f493b4800c0489ce9d3d09f2ec,/10/Dockerfile," # backwards compat
"
17816,09b09edbea4339a008ef81f00475330172fe7630,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
17817,09b09edbea4339a008ef81f00475330172fe7630,/9.3/Dockerfile,"# explicitly set user/group IDs
"
17818,09b09edbea4339a008ef81f00475330172fe7630,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
17819,09b09edbea4339a008ef81f00475330172fe7630,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17820,09b09edbea4339a008ef81f00475330172fe7630,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
17821,57213ab012e6a38a27283eeac65c4726c069647a,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17822,57213ab012e6a38a27283eeac65c4726c069647a,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
17823,57213ab012e6a38a27283eeac65c4726c069647a,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17824,57213ab012e6a38a27283eeac65c4726c069647a,/10/alpine/Dockerfile,"#		krb5-dev \
"
17825,57213ab012e6a38a27283eeac65c4726c069647a,/10/alpine/Dockerfile,"#		openldap-dev \
"
17826,57213ab012e6a38a27283eeac65c4726c069647a,/10/alpine/Dockerfile,"# configure: error: prove not found
"
17827,57213ab012e6a38a27283eeac65c4726c069647a,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17828,57213ab012e6a38a27283eeac65c4726c069647a,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17829,57213ab012e6a38a27283eeac65c4726c069647a,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17830,57213ab012e6a38a27283eeac65c4726c069647a,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17831,57213ab012e6a38a27283eeac65c4726c069647a,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17832,57213ab012e6a38a27283eeac65c4726c069647a,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17833,57213ab012e6a38a27283eeac65c4726c069647a,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17834,57213ab012e6a38a27283eeac65c4726c069647a,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17835,57213ab012e6a38a27283eeac65c4726c069647a,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17836,57213ab012e6a38a27283eeac65c4726c069647a,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17837,57213ab012e6a38a27283eeac65c4726c069647a,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17838,57213ab012e6a38a27283eeac65c4726c069647a,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17839,57213ab012e6a38a27283eeac65c4726c069647a,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17840,57213ab012e6a38a27283eeac65c4726c069647a,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17841,57213ab012e6a38a27283eeac65c4726c069647a,/10/alpine/Dockerfile," # backwards compat
"
17842,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
17843,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/Dockerfile,"# explicitly set user/group IDs
"
17844,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
17845,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17846,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
17847,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
17848,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17849,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
17850,415b445c37de1d70cf6a669bd48b915952561f7d,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
17851,415b445c37de1d70cf6a669bd48b915952561f7d,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
17852,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17853,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
17854,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17855,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
17856,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
17857,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
17858,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17859,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17860,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17861,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17862,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17863,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17864,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17865,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17866,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17867,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17868,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17869,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17870,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17871,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17872,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile," # backwards compat
"
17873,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17874,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
17875,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17876,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
17877,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
17878,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17879,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
17880,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17881,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17882,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17883,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17884,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17885,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17886,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17887,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17888,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17889,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17890,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17891,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17892,76858f0957b5f9e1a871770cf4b984d44edc80c7,/9.3/alpine/Dockerfile," # backwards compat
"
17893,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
17894,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
17895,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17896,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
17897,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17898,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
17899,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
17900,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17901,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17902,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17903,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17904,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17905,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17906,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17907,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17908,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17909,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17910,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17911,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17912,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile," # backwards compat
"
17913,6750eda25a2f0856b3997309ef393475f008d6a3,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17914,6750eda25a2f0856b3997309ef393475f008d6a3,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
17915,6750eda25a2f0856b3997309ef393475f008d6a3,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17916,6750eda25a2f0856b3997309ef393475f008d6a3,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
17917,6750eda25a2f0856b3997309ef393475f008d6a3,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
17918,6750eda25a2f0856b3997309ef393475f008d6a3,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
17919,6750eda25a2f0856b3997309ef393475f008d6a3,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17920,6750eda25a2f0856b3997309ef393475f008d6a3,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17921,6750eda25a2f0856b3997309ef393475f008d6a3,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17922,6750eda25a2f0856b3997309ef393475f008d6a3,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17923,6750eda25a2f0856b3997309ef393475f008d6a3,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17924,6750eda25a2f0856b3997309ef393475f008d6a3,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17925,6750eda25a2f0856b3997309ef393475f008d6a3,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17926,6750eda25a2f0856b3997309ef393475f008d6a3,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17927,6750eda25a2f0856b3997309ef393475f008d6a3,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17928,6750eda25a2f0856b3997309ef393475f008d6a3,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17929,6750eda25a2f0856b3997309ef393475f008d6a3,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17930,6750eda25a2f0856b3997309ef393475f008d6a3,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17931,6750eda25a2f0856b3997309ef393475f008d6a3,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17932,6750eda25a2f0856b3997309ef393475f008d6a3,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17933,6750eda25a2f0856b3997309ef393475f008d6a3,/9.5/alpine/Dockerfile," # backwards compat
"
17934,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# vim:set ft=dockerfile:
"
17935,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# explicitly set user/group IDs
"
17936,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
17937,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
17938,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
17939,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
17940,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
17941,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
17942,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
17943,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
17944,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# see note below about ""*.pyc"" files
"
17945,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# arches officialy built by upstream
"
17946,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
17947,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
17948,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
17949,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# we need DEBIAN_FRONTEND on postgresql-13 for slapd (""Please enter the password for the admin entry in your LDAP directory.""); see https://bugs.debian.org/929417
"
17950,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
17951,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
17952,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
17953,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
17954,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
17955,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
17956,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
17957,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17958,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
17959,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17960,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile," # backwards compat
"
17961,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17962,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
17963,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17964,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
17965,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
17966,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
17967,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17968,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17969,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17970,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17971,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17972,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17973,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17974,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17975,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17976,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17977,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17978,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
17979,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
17980,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
17981,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile," # backwards compat
"
17982,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
17983,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.4/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
17984,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
17985,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
17986,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
17987,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
17988,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
17989,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
17990,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
17991,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
17992,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
17993,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17994,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
17995,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
17996,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
17997,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
17998,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
17999,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
18000,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
18001,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
18002,16dd8dbf87af47f280cf784aac8f2afb7a24c383,/9.4/alpine/Dockerfile," # backwards compat
"
18003,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
18004,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
18005,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
18006,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
18007,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
18008,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
18009,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
18010,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
18011,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
18012,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
18013,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
18014,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
18015,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
18016,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
18017,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
18018,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
18019,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
18020,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
18021,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
18022,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
18023,cd5e2ba99930a3b2a940a9ce1786767da7d36119,/9.6/alpine/Dockerfile," # backwards compat
"
18024,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
18025,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# explicitly set user/group IDs
"
18026,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
18027,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
18028,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
18029,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
18030,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
18031,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
18032,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
18033,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
18034,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
18035,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# arches officialy built by upstream
"
18036,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
18037,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
18038,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
18039,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
18040,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
18041,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
18042,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
18043,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
18044,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
18045,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
18046,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
18047,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
18048,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
18049,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile," # backwards compat
"
18050,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
18051,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
18052,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
18053,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
18054,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
18055,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
18056,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
18057,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
18058,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
18059,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
18060,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
18061,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
18062,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
18063,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
18064,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
18065,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
18066,5fddf91c236f23f750ac573d142b5b2cb94a1bca,/9.6/alpine/Dockerfile," # backwards compat
"
18067,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# vim:set ft=dockerfile:
"
18068,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# explicitly set user/group IDs
"
18069,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
18070,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
18071,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# grab gosu for easy step-down from root
"
18072,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
18073,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
18074,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
18075,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
18076,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
18077,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
18078,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# arches officialy built by upstream
"
18079,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
18080,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
18081,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
18082,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
18083,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
18084,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
18085,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
18086,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
18087,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
18088,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
18089,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
18090,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
18091,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
18092,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile," # backwards compat
"
18093,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
18094,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.5/Dockerfile,"# explicitly set user/group IDs
"
18095,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
18096,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
18097,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
18098,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
18099,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
18100,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
18101,e5cd70b504ed958911d2ae495d0d39c26f82557f,/8.4/Dockerfile,"# vim:set ft=dockerfile:
"
18102,e5cd70b504ed958911d2ae495d0d39c26f82557f,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
18103,e5cd70b504ed958911d2ae495d0d39c26f82557f,/8.4/Dockerfile,"# grab gosu for easy step-down from root
"
18104,e5cd70b504ed958911d2ae495d0d39c26f82557f,/8.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
18105,e5cd70b504ed958911d2ae495d0d39c26f82557f,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
18106,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
18107,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
18108,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
18109,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
18110,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
18111,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
18112,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
18113,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
18114,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
18115,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
18116,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
18117,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
18118,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
18119,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
18120,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
18121,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile," # backwards compat
"
18122,b1831ce069d10b14be05b9ddf6823e3d18c62cee,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
18123,b1831ce069d10b14be05b9ddf6823e3d18c62cee,/9.6/Dockerfile,"# explicitly set user/group IDs
"
18124,b1831ce069d10b14be05b9ddf6823e3d18c62cee,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
18125,b1831ce069d10b14be05b9ddf6823e3d18c62cee,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
18126,b1831ce069d10b14be05b9ddf6823e3d18c62cee,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
18127,b1831ce069d10b14be05b9ddf6823e3d18c62cee,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
18128,b1831ce069d10b14be05b9ddf6823e3d18c62cee,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
18129,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
18130,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
18131,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
18132,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
18133,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
18134,56b1a0c47ae8361eca133e41c6ddd68ad492ac2d,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
18135,56b1a0c47ae8361eca133e41c6ddd68ad492ac2d,/9.4/Dockerfile,"# explicitly set user/group IDs
"
18136,56b1a0c47ae8361eca133e41c6ddd68ad492ac2d,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
18137,56b1a0c47ae8361eca133e41c6ddd68ad492ac2d,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
18138,56b1a0c47ae8361eca133e41c6ddd68ad492ac2d,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
18139,56b1a0c47ae8361eca133e41c6ddd68ad492ac2d,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
18140,56b1a0c47ae8361eca133e41c6ddd68ad492ac2d,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
18141,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
18142,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
18143,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
18144,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
18145,e5cd70b504ed958911d2ae495d0d39c26f82557f,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
18146,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
18147,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
18148,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
18149,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
18150,981ac750a3ef6160aab69509a9e8a56304366eb2,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
18151,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
18152,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
18153,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
18154,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/alpine/Dockerfile,"#		krb5-dev \
"
18155,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/alpine/Dockerfile,"#		openldap-dev \
"
18156,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/alpine/Dockerfile,"# configure: error: prove not found
"
18157,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
18158,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
18159,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
18160,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
18161,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
18162,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
18163,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
18164,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
18165,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
18166,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
18167,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
18168,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
18169,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
18170,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
18171,ba24350aa02996f75cf5b44eea0af082775cc8ec,/11/alpine/Dockerfile," # backwards compat
"
18172,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
18173,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
18174,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
18175,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
18176,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
18177,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
18178,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
18179,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
18180,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
18181,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
18182,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
18183,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
18184,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
18185,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
18186,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
18187,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
18188,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
18189,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
18190,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
18191,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
18192,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile," # backwards compat
"
18193,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
18194,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
18195,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
18196,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
18197,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
18198,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
18199,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
18200,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
18201,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
18202,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
18203,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
18204,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
18205,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
18206,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
18207,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
18208,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
18209,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
18210,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
18211,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
18212,466a61bac6997c368be02dff5eb43673c4ce3fa9,/9.5/alpine/Dockerfile," # backwards compat
"
18213,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
18214,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# explicitly set user/group IDs
"
18215,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
18216,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
18217,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
18218,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# arches officialy built by upstream
"
18219,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
18220,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
18221,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
18222,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
18223,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
18224,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
18225,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
18226,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
18227,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
18228,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
18229,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
18230,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile," # backwards compat
"
18231,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
18232,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
18233,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
18234,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
18235,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
18236,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
18237,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
18238,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
18239,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
18240,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
18241,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
18242,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
18243,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
18244,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
18245,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
18246,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
18247,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
18248,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
18249,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
18250,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
18251,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile," # backwards compat
"
18252,2cab5040341f46331367f8766b4d249a5b7a9366,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
18253,2cab5040341f46331367f8766b4d249a5b7a9366,/9.3/Dockerfile,"# explicitly set user/group IDs
"
18254,2cab5040341f46331367f8766b4d249a5b7a9366,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
18255,2cab5040341f46331367f8766b4d249a5b7a9366,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
18256,2cab5040341f46331367f8766b4d249a5b7a9366,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
18257,2cab5040341f46331367f8766b4d249a5b7a9366,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
18258,2cab5040341f46331367f8766b4d249a5b7a9366,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
18259,2cab5040341f46331367f8766b4d249a5b7a9366,/9.3/Dockerfile,"# arches officialy built by upstream
"
18260,2cab5040341f46331367f8766b4d249a5b7a9366,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
18261,2cab5040341f46331367f8766b4d249a5b7a9366,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
18262,2cab5040341f46331367f8766b4d249a5b7a9366,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
18263,2cab5040341f46331367f8766b4d249a5b7a9366,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
18264,2cab5040341f46331367f8766b4d249a5b7a9366,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
18265,2cab5040341f46331367f8766b4d249a5b7a9366,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
18266,2cab5040341f46331367f8766b4d249a5b7a9366,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
18267,2cab5040341f46331367f8766b4d249a5b7a9366,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
18268,2cab5040341f46331367f8766b4d249a5b7a9366,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
18269,2cab5040341f46331367f8766b4d249a5b7a9366,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
18270,2cab5040341f46331367f8766b4d249a5b7a9366,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
18271,2cab5040341f46331367f8766b4d249a5b7a9366,/9.3/Dockerfile," # backwards compat
"
18272,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
18273,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/Dockerfile,"# explicitly set user/group IDs
"
18274,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
18275,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
18276,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
18277,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
18278,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
18279,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
18280,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
18281,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/Dockerfile," # backwards compat
"
18282,a6d4922823aa8011513bb9c160c26c689301823a,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
18283,a6d4922823aa8011513bb9c160c26c689301823a,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
18284,a6d4922823aa8011513bb9c160c26c689301823a,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
18285,a6d4922823aa8011513bb9c160c26c689301823a,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
18286,a6d4922823aa8011513bb9c160c26c689301823a,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
18287,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
18288,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# explicitly set user/group IDs
"
18289,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
18290,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
18291,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
18292,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
18293,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
18294,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
18295,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
18296,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
18297,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# arches officialy built by upstream
"
18298,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
18299,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
18300,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
18301,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
18302,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
18303,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
18304,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
18305,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
18306,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
18307,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
18308,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
18309,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
18310,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
18311,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile," # backwards compat
"
