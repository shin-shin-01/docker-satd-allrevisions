,CommitID,Dockerfiles,Comments
0,442a92590b7f22d3ab6b2ebdbf0217c1554541c5,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1,442a92590b7f22d3ab6b2ebdbf0217c1554541c5,/9.5/alpine/Dockerfile,"# explicitly set user/group IDs
#RUN adduser -S -G postgres -u 999 postgres

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2,442a92590b7f22d3ab6b2ebdbf0217c1554541c5,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
7,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
8,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
9,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
12,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
14,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
15,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
16,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
17,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
18,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
19,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
20,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
21,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
22,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
23,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
24,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
25,40158e3e1eab19a8faceef3f31c50869c964223c,/9.3/alpine/Dockerfile," # backwards compat
"
26,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# vim:set ft=dockerfile:
"
27,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# explicitly set user/group IDs
"
28,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
29,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
30,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# grab gosu for easy step-down from root
"
31,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
32,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
33,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
34,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
35,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
36,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# arches officialy built by upstream
"
37,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
38,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
39,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
40,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
41,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
42,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
43,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
44,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
45,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
46,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
47,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
48,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
49,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
50,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/Dockerfile," # backwards compat
"
51,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
52,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
53,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
54,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
55,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
56,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
57,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
58,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
59,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
60,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
61,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
62,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
63,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
64,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
65,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
66,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
67,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
68,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
69,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
70,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
71,5a690fbbe0f256b916a01afee293e8b2dfd3ad8d,/9.5/alpine/Dockerfile," # backwards compat
"
72,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
73,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
74,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
75,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
76,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
77,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
78,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
79,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
80,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
81,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
82,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
83,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
84,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
85,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
86,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
87,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
88,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
89,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
90,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
91,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
92,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
93,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
94,4955a99b600fa0badb1e707285617a23315421af,/9.3/alpine/Dockerfile," # backwards compat
"
95,972294a377463156c8d61297320c872fc7d370a9,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
96,972294a377463156c8d61297320c872fc7d370a9,/9.6/Dockerfile,"# explicitly set user/group IDs
"
97,972294a377463156c8d61297320c872fc7d370a9,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
98,972294a377463156c8d61297320c872fc7d370a9,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
99,972294a377463156c8d61297320c872fc7d370a9,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
100,972294a377463156c8d61297320c872fc7d370a9,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
101,972294a377463156c8d61297320c872fc7d370a9,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
102,972294a377463156c8d61297320c872fc7d370a9,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
103,972294a377463156c8d61297320c872fc7d370a9,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
104,972294a377463156c8d61297320c872fc7d370a9,/9.6/Dockerfile," # backwards compat
"
105,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
106,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# explicitly set user/group IDs
"
107,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
108,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
109,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
110,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# arches officialy built by upstream
"
111,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
112,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
113,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
114,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
115,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
116,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
117,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
118,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
119,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
120,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
121,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
122,d8ce07a1e97e7caa1436a341ae7a2b06efb852dc,/9.3/Dockerfile," # backwards compat
"
123,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# vim:set ft=dockerfile:
"
124,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# explicitly set user/group IDs
"
125,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
126,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
127,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# grab gosu for easy step-down from root
"
128,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
129,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
130,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
131,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
132,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
133,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# arches officialy built by upstream
"
134,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
135,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
136,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
137,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
138,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
139,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
140,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
141,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
142,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
143,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
144,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
145,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
146,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
147,058c5c951f6870c538cb2039e93275bee242d373,/12/Dockerfile," # backwards compat
"
148,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
149,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# explicitly set user/group IDs
"
150,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
151,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
152,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
153,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# arches officialy built by upstream
"
154,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
155,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
156,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
157,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
158,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
159,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
160,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
161,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
162,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
163,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
164,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
165,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/Dockerfile," # backwards compat
"
166,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
167,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
168,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
169,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"#		krb5-dev \
"
170,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"#		openldap-dev \
"
171,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# configure: error: prove not found
"
172,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
173,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
174,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
175,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
176,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
177,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
178,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
179,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
180,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
181,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
182,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
183,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
184,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
185,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
186,3402e9731098e1cba778c0af82b8d6fdfc698f27,/11/alpine/Dockerfile," # backwards compat
"
187,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# vim:set ft=dockerfile:
"
188,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# explicitly set user/group IDs
"
189,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
190,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
191,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# grab gosu for easy step-down from root
"
192,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
193,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
194,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
195,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
196,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
197,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# arches officialy built by upstream
"
198,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
199,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
200,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
201,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
202,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
203,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
204,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
205,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
206,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
207,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
208,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
209,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
210,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
211,966d1ba7a639171895acee9b33cc6b8053498d18,/12/Dockerfile," # backwards compat
"
212,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
213,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
214,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
215,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
216,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
217,6b7b3bd6ca3a032f393d52ce72a419235804496f,/Dockerfile.template,"# vim:set ft=dockerfile:
"
218,6b7b3bd6ca3a032f393d52ce72a419235804496f,/Dockerfile.template,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
219,6b7b3bd6ca3a032f393d52ce72a419235804496f,/Dockerfile.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
220,d74b69598c835fe15eac39a26b5c61058f99c3db,/Dockerfile.template,"# vim:set ft=dockerfile:
"
221,d74b69598c835fe15eac39a26b5c61058f99c3db,/Dockerfile.template,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
222,d74b69598c835fe15eac39a26b5c61058f99c3db,/Dockerfile.template,"# grab gosu for easy step-down from root
"
223,d74b69598c835fe15eac39a26b5c61058f99c3db,/Dockerfile.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
224,d74b69598c835fe15eac39a26b5c61058f99c3db,/Dockerfile.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
225,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
226,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
227,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
228,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
229,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
230,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
231,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
232,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
233,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
234,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
235,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
236,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
237,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
238,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
239,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
240,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.5/alpine/Dockerfile," # backwards compat
"
241,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
242,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# explicitly set user/group IDs
"
243,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
244,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
245,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
246,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
247,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
248,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
249,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
250,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
251,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# arches officialy built by upstream
"
252,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
253,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
254,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
255,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
256,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
257,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
258,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
259,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
260,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
261,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
262,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
263,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
264,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
265,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.4/Dockerfile," # backwards compat
"
266,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
267,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
268,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
269,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-alpine.template,"#		krb5-dev \
"
270,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-alpine.template,"#		openldap-dev \
"
271,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-alpine.template,"# configure: error: prove not found
"
272,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-alpine.template,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
273,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
274,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
275,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
276,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-alpine.template,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
277,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
278,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
279,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
280,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
281,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-alpine.template,"#p' --recursive /usr/local \
"
282,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
283,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
284,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
285,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-alpine.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
286,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-alpine.template," # backwards compat
"
287,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/Dockerfile.template,"# vim:set ft=dockerfile:
"
288,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/Dockerfile.template,"# explicitly set user/group IDs
"
289,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/Dockerfile.template,"# grab gosu for easy step-down from root
"
290,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/Dockerfile.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
291,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/Dockerfile.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
292,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# vim:set ft=dockerfile:
"
293,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# explicitly set user/group IDs
"
294,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
295,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
296,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# grab gosu for easy step-down from root
"
297,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
298,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
299,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
300,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
301,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
302,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# arches officialy built by upstream
"
303,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
304,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
305,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
306,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
307,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
308,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
309,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
310,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
311,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
312,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
313,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
314,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
315,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
316,87b15b6c65ba985ac958e7b35ba787422113066e,/10/Dockerfile," # backwards compat
"
317,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
318,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.3/Dockerfile,"# explicitly set user/group IDs
"
319,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
320,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
321,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
322,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
323,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
324,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
325,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.2/Dockerfile,"# explicitly set user/group IDs
"
326,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
327,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
328,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
329,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
330,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# explicitly set user/group IDs
"
331,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
332,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
333,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
334,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
335,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
336,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
337,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
338,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
339,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# arches officialy built by upstream
"
340,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
341,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
342,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
343,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
344,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
345,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
346,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
347,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
348,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
349,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
350,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
351,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
352,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
353,5beb1d4c3a2b0745752ca5bbc6eff95ec1842820,/9.4/Dockerfile," # backwards compat
"
354,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
355,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
356,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
357,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
358,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
359,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
360,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
361,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
362,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
363,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
364,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
365,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
366,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
367,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
368,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
369,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
370,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
371,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
372,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
373,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
374,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.4/alpine/Dockerfile," # backwards compat
"
375,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
376,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
377,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
378,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
379,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
380,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
381,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
382,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
383,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
384,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
385,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
386,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
387,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
388,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
389,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
390,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
391,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
392,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
393,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
394,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
395,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
396,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
397,881448bf624ca3f461f7ddd234c198ba23aea1fe,/9.3/alpine/Dockerfile," # backwards compat
"
398,f59e5f0edba2e5d4d38516e5765c1aaa8932c51e,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
399,f59e5f0edba2e5d4d38516e5765c1aaa8932c51e,/9.5/Dockerfile,"# explicitly set user/group IDs
"
400,f59e5f0edba2e5d4d38516e5765c1aaa8932c51e,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
401,f59e5f0edba2e5d4d38516e5765c1aaa8932c51e,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
402,f59e5f0edba2e5d4d38516e5765c1aaa8932c51e,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
403,f59e5f0edba2e5d4d38516e5765c1aaa8932c51e,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
404,f59e5f0edba2e5d4d38516e5765c1aaa8932c51e,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
405,f59e5f0edba2e5d4d38516e5765c1aaa8932c51e,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
406,f59e5f0edba2e5d4d38516e5765c1aaa8932c51e,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
407,f59e5f0edba2e5d4d38516e5765c1aaa8932c51e,/9.5/Dockerfile," # backwards compat
"
408,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
409,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
410,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/Dockerfile-alpine.template,"#		krb5-dev \
"
411,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/Dockerfile-alpine.template,"#		openldap-dev \
"
412,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
413,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
414,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
415,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
416,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
417,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
418,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
419,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
420,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
421,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# explicitly set user/group IDs
"
422,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
423,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
424,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
425,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
426,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# arches officialy built by upstream
"
427,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
428,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
429,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
430,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
431,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
432,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
433,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
434,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
435,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
436,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
437,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
438,5ce8fc72310bf7026c971d9ce971e4ad57f0802f,/9.3/Dockerfile," # backwards compat
"
439,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
440,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
441,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
442,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"#		krb5-dev \
"
443,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"#		openldap-dev \
"
444,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# configure: error: prove not found
"
445,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
446,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
447,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
448,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
449,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
450,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
451,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
452,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
453,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
454,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
455,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
456,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
457,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
458,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
459,c1e547b318046ec604e1bda55e110828bfffd311,/10/alpine/Dockerfile," # backwards compat
"
460,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
461,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
462,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
463,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
464,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
465,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
466,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
467,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
468,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
469,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
470,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
471,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
472,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
473,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
474,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# vim:set ft=dockerfile:
"
475,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# explicitly set user/group IDs
"
476,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# grab gosu for easy step-down from root
"
477,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
478,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
479,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# arches officialy built by upstream
"
480,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
481,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
482,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
483,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
484,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
485,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
486,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
487,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
488,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
489,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
490,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
491,2ba4ac1074bc592ffa40076e5de2f94f972afb84,/10/Dockerfile," # backwards compat
"
492,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
493,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/Dockerfile,"# explicitly set user/group IDs
"
494,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
495,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
496,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
497,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
498,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
499,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
500,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
501,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
502,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
503,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
504,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
505,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
506,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
507,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
508,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
509,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
510,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
511,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
512,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
513,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
514,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
515,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
516,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
517,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
518,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
519,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
520,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
521,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.4/alpine/Dockerfile," # backwards compat
"
522,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
523,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
524,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
525,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-alpine.template,"#		krb5-dev \
"
526,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-alpine.template,"#		openldap-dev \
"
527,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-alpine.template,"# configure: error: prove not found
"
528,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
529,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
530,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
531,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-alpine.template,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
532,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
533,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
534,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
535,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
536,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
537,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
538,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
539,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-alpine.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
540,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-alpine.template," # backwards compat
"
541,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# vim:set ft=dockerfile:
"
542,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# explicitly set user/group IDs
"
543,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
544,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
545,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# grab gosu for easy step-down from root
"
546,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
547,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
548,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
549,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
550,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
551,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# arches officialy built by upstream
"
552,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
553,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
554,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
555,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
556,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
557,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
558,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
559,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
560,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
561,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
562,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
563,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
564,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
565,d61fd19b699b2c380da08c3a95f7272137a182bb,/10/Dockerfile," # backwards compat
"
566,6abeb8590f35c5251b9f100a667024febaeee06b,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
567,6abeb8590f35c5251b9f100a667024febaeee06b,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
568,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
569,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# explicitly set user/group IDs
"
570,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
571,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
572,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
573,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
574,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
575,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
576,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
577,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
578,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# arches officialy built by upstream
"
579,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
580,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
581,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
582,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
583,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
584,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
585,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
586,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
587,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
588,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
589,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
590,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
591,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
592,87b15b6c65ba985ac958e7b35ba787422113066e,/9.4/Dockerfile," # backwards compat
"
593,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# vim:set ft=dockerfile:
"
594,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# explicitly set user/group IDs
"
595,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# grab gosu for easy step-down from root
"
596,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
597,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
598,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
599,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# arches officialy built by upstream
"
600,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
601,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
602,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
603,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
604,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
605,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
606,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
607,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
608,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
609,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
610,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
611,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/10/Dockerfile," # backwards compat
"
612,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# vim:set ft=dockerfile:
"
613,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# explicitly set user/group IDs
"
614,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
615,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
616,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# grab gosu for easy step-down from root
"
617,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
618,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
619,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
620,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
621,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
622,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# arches officialy built by upstream
"
623,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
624,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
625,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
626,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
627,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
628,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
629,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
630,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
631,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
632,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
633,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
634,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
635,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
636,cf9b6cdd64f8a81b1abf9e487886f47e4971abe2,/11/Dockerfile," # backwards compat
"
637,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
638,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
639,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
640,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
641,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
642,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
643,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
644,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
645,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
646,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"# tzdata loading functionality is optional, and fails gracefully
#		tzdata \
"
647,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
648,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
649,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# vim:set ft=dockerfile:
"
650,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# explicitly set user/group IDs
"
651,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# grab gosu for easy step-down from root
"
652,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
653,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
654,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
655,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
656,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# arches officialy built by upstream
"
657,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
658,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
659,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
660,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
661,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
662,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
663,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
664,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
665,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
666,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
667,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
668,56cf37a42a7647678a7e46b12e0df0942e26cc28,/11/Dockerfile," # backwards compat
"
669,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
670,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
671,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
672,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"#		krb5-dev \
"
673,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"#		openldap-dev \
"
674,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# configure: error: prove not found
"
675,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
676,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
677,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
678,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
679,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
680,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
681,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
682,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
683,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
684,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
685,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
686,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
687,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
688,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
689,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/10/alpine/Dockerfile," # backwards compat
"
690,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# vim:set ft=dockerfile:
"
691,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# explicitly set user/group IDs
"
692,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
693,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
694,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
695,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
696,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
697,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
698,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
699,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
700,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
701,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# arches officialy built by upstream
"
702,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
703,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
704,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
705,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
706,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
707,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
708,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
709,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
710,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
711,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
712,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
713,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
714,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
715,a1420dac644b8190df5e78e80bfa9610b2f077e2,/10/Dockerfile," # backwards compat
"
716,51e5166d69320581cb707d6fb102d3ba04803400,/Dockerfile.template,"# vim:set ft=dockerfile:
"
717,51e5166d69320581cb707d6fb102d3ba04803400,/Dockerfile.template,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
718,51e5166d69320581cb707d6fb102d3ba04803400,/Dockerfile.template,"# grab gosu for easy step-down from root
"
719,51e5166d69320581cb707d6fb102d3ba04803400,/Dockerfile.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
720,51e5166d69320581cb707d6fb102d3ba04803400,/Dockerfile.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
721,570ca9e8ea81cb6da73ea765132755f277cd0b66,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
722,570ca9e8ea81cb6da73ea765132755f277cd0b66,/9.3/Dockerfile,"# explicitly set user/group IDs
"
723,570ca9e8ea81cb6da73ea765132755f277cd0b66,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
724,570ca9e8ea81cb6da73ea765132755f277cd0b66,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
725,570ca9e8ea81cb6da73ea765132755f277cd0b66,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
726,570ca9e8ea81cb6da73ea765132755f277cd0b66,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
727,570ca9e8ea81cb6da73ea765132755f277cd0b66,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
728,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
729,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
730,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
731,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"#		krb5-dev \
"
732,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"#		openldap-dev \
"
733,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# configure: error: prove not found
"
734,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
735,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
736,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
737,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
738,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
739,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
740,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
741,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
742,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
743,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
744,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
745,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
746,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
747,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
748,5992d8be755d8001474f737a44c73049c519cff3,/11/alpine/Dockerfile," # backwards compat
"
749,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
750,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
751,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
752,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
753,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
754,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
755,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
756,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
757,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
758,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
759,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
760,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
761,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
762,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
763,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
764,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
765,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
766,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/alpine/Dockerfile," # backwards compat
"
767,6e1d6d682519cabd49e33f720f3cdeda426745c6,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
768,6e1d6d682519cabd49e33f720f3cdeda426745c6,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
769,6e1d6d682519cabd49e33f720f3cdeda426745c6,/Dockerfile-alpine.template,"#		krb5-dev \
"
770,6e1d6d682519cabd49e33f720f3cdeda426745c6,/Dockerfile-alpine.template,"#		openldap-dev \
"
771,6e1d6d682519cabd49e33f720f3cdeda426745c6,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
772,6e1d6d682519cabd49e33f720f3cdeda426745c6,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
773,6e1d6d682519cabd49e33f720f3cdeda426745c6,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
774,6e1d6d682519cabd49e33f720f3cdeda426745c6,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
775,6e1d6d682519cabd49e33f720f3cdeda426745c6,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
776,6e1d6d682519cabd49e33f720f3cdeda426745c6,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
777,6e1d6d682519cabd49e33f720f3cdeda426745c6,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
778,6e1d6d682519cabd49e33f720f3cdeda426745c6,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
779,6e1d6d682519cabd49e33f720f3cdeda426745c6,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
780,6e1d6d682519cabd49e33f720f3cdeda426745c6,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
781,6e1d6d682519cabd49e33f720f3cdeda426745c6,/Dockerfile-alpine.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
782,6e1d6d682519cabd49e33f720f3cdeda426745c6,/Dockerfile-alpine.template," # backwards compat
"
783,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
784,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
785,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
786,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
787,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
788,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
789,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
790,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
791,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
792,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
793,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# see note below about ""*.pyc"" files
"
794,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# arches officialy built by upstream
"
795,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
796,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
797,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
798,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# we don't remove APT lists here because they get re-downloaded and removed later
"
799,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
800,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
801,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
802,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
803,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
804,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
805,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
806,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
807,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
808,4f70bf2b811bcdb4ab1a015ef703373226452157,/Dockerfile-debian.template," # backwards compat
"
809,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# vim:set ft=dockerfile:
"
810,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# explicitly set user/group IDs
"
811,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
812,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
813,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# grab gosu for easy step-down from root
"
814,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
815,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
816,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
817,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
818,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
819,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# arches officialy built by upstream
"
820,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
821,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
822,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
823,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
824,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
825,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
826,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
827,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
828,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
829,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
830,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
831,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
832,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
833,246f8d41d6de8888ba82f27579bc05d9362a8641,/11/Dockerfile," # backwards compat
"
834,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# vim:set ft=dockerfile:
"
835,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# explicitly set user/group IDs
"
836,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
837,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
838,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# grab gosu for easy step-down from root
"
839,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
840,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
841,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
842,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
843,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
844,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
845,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# arches officialy built by upstream
"
846,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
847,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
848,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
849,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
850,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
851,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
852,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
853,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
854,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
855,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
856,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
857,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
858,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
859,72d7408ad3b57ab1a5c371e11460811551811bf5,/11/Dockerfile," # backwards compat
"
860,972294a377463156c8d61297320c872fc7d370a9,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
861,972294a377463156c8d61297320c872fc7d370a9,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
862,972294a377463156c8d61297320c872fc7d370a9,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
863,972294a377463156c8d61297320c872fc7d370a9,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
864,972294a377463156c8d61297320c872fc7d370a9,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
865,972294a377463156c8d61297320c872fc7d370a9,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
866,972294a377463156c8d61297320c872fc7d370a9,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
867,972294a377463156c8d61297320c872fc7d370a9,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
868,972294a377463156c8d61297320c872fc7d370a9,/Dockerfile-debian.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
869,972294a377463156c8d61297320c872fc7d370a9,/Dockerfile-debian.template," # backwards compat
"
870,63d966973d9593c0d9890b96f10ac73566913520,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
871,63d966973d9593c0d9890b96f10ac73566913520,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
872,63d966973d9593c0d9890b96f10ac73566913520,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
873,63d966973d9593c0d9890b96f10ac73566913520,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
874,63d966973d9593c0d9890b96f10ac73566913520,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
875,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# vim:set ft=dockerfile:
"
876,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# explicitly set user/group IDs
"
877,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
878,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
879,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
880,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
881,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
882,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
883,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
884,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
885,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
886,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# arches officialy built by upstream
"
887,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
888,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
889,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
890,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
891,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
892,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
893,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
894,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
895,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
896,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
897,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
898,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
899,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
900,1858993247748c52316b4690b0a6c6ea6c33f49f,/11/Dockerfile," # backwards compat
"
901,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
902,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# explicitly set user/group IDs
"
903,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
904,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
905,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
906,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# arches officialy built by upstream
"
907,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
908,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
909,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
910,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
911,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
912,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
913,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
914,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
915,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
916,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
917,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
918,b7cb3c6eacea93be2259381033be3cc435649369,/9.6/Dockerfile," # backwards compat
"
919,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
920,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/Dockerfile,"# explicitly set user/group IDs
"
921,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
922,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
923,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
924,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
925,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
926,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
927,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
928,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
929,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
930,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
931,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
932,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
933,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
934,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
935,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
936,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
937,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
938,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
939,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
940,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
941,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
942,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
943,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
944,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
945,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
946,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
947,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
948,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
949,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
950,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
951,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
952,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.4/alpine/Dockerfile," # backwards compat
"
953,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
954,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
955,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
956,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
957,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
958,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
959,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
960,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
961,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
962,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
963,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
964,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
965,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
966,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
967,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
968,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
969,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.4/alpine/Dockerfile," # backwards compat
"
970,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
971,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
972,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
973,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
974,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
975,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
976,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
977,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
978,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
979,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
980,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
981,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
982,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
983,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
984,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
985,5408eaec65c84374dd6a8f2f2e900197d50cf6c4,/9.4/alpine/Dockerfile," # backwards compat
"
986,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
987,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
988,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
989,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
990,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
991,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
992,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# explicitly set user/group IDs
"
993,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
994,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
995,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
996,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
997,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
998,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
999,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1000,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
1001,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# arches officialy built by upstream
"
1002,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1003,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
1004,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1005,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1006,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1007,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1008,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1009,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1010,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1011,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
1012,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1013,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
1014,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1015,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.4/Dockerfile," # backwards compat
"
1016,7b518a11cf0d1bcebbf27b3cbbc64cb69839db11,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
1017,7b518a11cf0d1bcebbf27b3cbbc64cb69839db11,/9.2/Dockerfile,"# explicitly set user/group IDs
"
1018,7b518a11cf0d1bcebbf27b3cbbc64cb69839db11,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
1019,7b518a11cf0d1bcebbf27b3cbbc64cb69839db11,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1020,7b518a11cf0d1bcebbf27b3cbbc64cb69839db11,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1021,7b518a11cf0d1bcebbf27b3cbbc64cb69839db11,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1022,7b518a11cf0d1bcebbf27b3cbbc64cb69839db11,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1023,7b518a11cf0d1bcebbf27b3cbbc64cb69839db11,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1024,7b518a11cf0d1bcebbf27b3cbbc64cb69839db11,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1025,7b518a11cf0d1bcebbf27b3cbbc64cb69839db11,/9.2/Dockerfile," # backwards compat
"
1026,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1027,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1028,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
1029,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
1030,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1031,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1032,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1033,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1034,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1035,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1036,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1037,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1038,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# vim:set ft=dockerfile:
"
1039,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# explicitly set user/group IDs
"
1040,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1041,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1042,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# grab gosu for easy step-down from root
"
1043,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1044,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1045,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1046,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1047,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
1048,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# arches officialy built by upstream
"
1049,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1050,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
1051,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1052,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1053,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1054,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1055,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1056,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1057,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1058,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
1059,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1060,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
1061,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1062,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/11/Dockerfile," # backwards compat
"
1063,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
1064,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# explicitly set user/group IDs
"
1065,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1066,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1067,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
1068,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1069,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1070,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1071,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1072,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
1073,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# arches officialy built by upstream
"
1074,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1075,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
1076,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1077,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1078,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1079,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1080,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1081,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1082,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1083,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
1084,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1085,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
1086,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1087,5c324b9f3e030855e94b00ae72a4936f7915d1be,/9.4/Dockerfile," # backwards compat
"
1088,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
1089,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.2/Dockerfile,"# explicitly set user/group IDs
"
1090,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
1091,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1092,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1093,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1094,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1095,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1096,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1097,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1098,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1099,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"#		krb5-dev \
"
1100,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"#		openldap-dev \
"
1101,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1102,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1103,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1104,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1105,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1106,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1107,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1108,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1109,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1110,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1111,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1112,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1113,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/alpine/Dockerfile," # backwards compat
"
1114,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1115,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1116,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1117,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"#		krb5-dev \
"
1118,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"#		openldap-dev \
"
1119,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# configure: error: prove not found
"
1120,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1121,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1122,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1123,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1124,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1125,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1126,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1127,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1128,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1129,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1130,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1131,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1132,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1133,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1134,f7dc5727b1d6b6a636350e11648845ae33477579,/10/alpine/Dockerfile," # backwards compat
"
1135,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
1136,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.5/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1137,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
1138,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1139,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1140,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
1141,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# explicitly set user/group IDs
"
1142,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
1143,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1144,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1145,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1146,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1147,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# arches officialy built by upstream
"
1148,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1149,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1150,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1151,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1152,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1153,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1154,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1155,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1156,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1157,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1158,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1159,d424c8f180ed614184059a953639d0a420477846,/9.5/Dockerfile," # backwards compat
"
1160,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
1161,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1162,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
1163,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1164,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1165,635fd0bcb3ababc96871c9da52f10743fbae4742,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
1166,635fd0bcb3ababc96871c9da52f10743fbae4742,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
1167,635fd0bcb3ababc96871c9da52f10743fbae4742,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
1168,635fd0bcb3ababc96871c9da52f10743fbae4742,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1169,635fd0bcb3ababc96871c9da52f10743fbae4742,/Dockerfile-debian.template,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1170,635fd0bcb3ababc96871c9da52f10743fbae4742,/Dockerfile-debian.template,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1171,635fd0bcb3ababc96871c9da52f10743fbae4742,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1172,635fd0bcb3ababc96871c9da52f10743fbae4742,/Dockerfile-debian.template,"# arches officialy built by upstream
"
1173,635fd0bcb3ababc96871c9da52f10743fbae4742,/Dockerfile-debian.template,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1174,635fd0bcb3ababc96871c9da52f10743fbae4742,/Dockerfile-debian.template,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1175,635fd0bcb3ababc96871c9da52f10743fbae4742,/Dockerfile-debian.template,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1176,635fd0bcb3ababc96871c9da52f10743fbae4742,/Dockerfile-debian.template,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1177,635fd0bcb3ababc96871c9da52f10743fbae4742,/Dockerfile-debian.template,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1178,635fd0bcb3ababc96871c9da52f10743fbae4742,/Dockerfile-debian.template,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1179,635fd0bcb3ababc96871c9da52f10743fbae4742,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1180,635fd0bcb3ababc96871c9da52f10743fbae4742,/Dockerfile-debian.template,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1181,635fd0bcb3ababc96871c9da52f10743fbae4742,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
1182,635fd0bcb3ababc96871c9da52f10743fbae4742,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1183,635fd0bcb3ababc96871c9da52f10743fbae4742,/Dockerfile-debian.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1184,635fd0bcb3ababc96871c9da52f10743fbae4742,/Dockerfile-debian.template," # backwards compat
"
1185,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
1186,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# explicitly set user/group IDs
"
1187,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1188,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1189,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
1190,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1191,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1192,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1193,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
1194,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1195,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
1196,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# arches officialy built by upstream
"
1197,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1198,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
1199,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1200,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1201,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1202,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1203,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1204,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1205,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1206,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
1207,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1208,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
1209,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1210,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.6/Dockerfile," # backwards compat
"
1211,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1212,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
1213,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1214,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"#		krb5-dev \
"
1215,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"#		openldap-dev \
"
1216,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# configure: error: prove not found
"
1217,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1218,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1219,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1220,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1221,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1222,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1223,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1224,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1225,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1226,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1227,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1228,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1229,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1230,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1231,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
1232,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# explicitly set user/group IDs
"
1233,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
1234,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1235,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1236,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# arches officialy built by upstream
"
1237,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1238,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1239,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1240,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1241,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1242,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1243,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1244,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1245,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1246,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1247,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1248,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.2/Dockerfile," # backwards compat
"
1249,a6d4922823aa8011513bb9c160c26c689301823a,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
1250,a6d4922823aa8011513bb9c160c26c689301823a,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1251,a6d4922823aa8011513bb9c160c26c689301823a,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
1252,a6d4922823aa8011513bb9c160c26c689301823a,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1253,a6d4922823aa8011513bb9c160c26c689301823a,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1254,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
1255,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/Dockerfile,"# explicitly set user/group IDs
"
1256,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
1257,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1258,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1259,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1260,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1261,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1262,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1263,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/Dockerfile," # backwards compat
"
1264,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
1265,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.1/Dockerfile,"# explicitly set user/group IDs
"
1266,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
1267,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1268,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1269,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.1/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1270,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.1/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1271,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1272,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1273,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1274,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
1275,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
1276,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
1277,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1278,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1279,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1280,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1281,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1282,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1283,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1284,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1285,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1286,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1287,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1288,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1289,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1290,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1291,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.5/alpine/Dockerfile," # backwards compat
"
1292,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1293,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
1294,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1295,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"#		krb5-dev \
"
1296,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"#		openldap-dev \
"
1297,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# configure: error: prove not found
"
1298,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1299,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1300,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1301,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
1302,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1303,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1304,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1305,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1306,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1307,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1308,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1309,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1310,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1311,1abff660740cb2ba89d25fa1d00be8f6511dd157,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1312,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# vim:set ft=dockerfile:
"
1313,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# explicitly set user/group IDs
"
1314,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1315,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1316,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# grab gosu for easy step-down from root
"
1317,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1318,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1319,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1320,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1321,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
1322,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# arches officialy built by upstream
"
1323,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1324,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
1325,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1326,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1327,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1328,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1329,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1330,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1331,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1332,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
1333,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1334,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
1335,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1336,faf08dbfd0675d144cbdef39f4506425ec7cee26,/11/Dockerfile," # backwards compat
"
1337,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1338,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
1339,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1340,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
1341,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
1342,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
1343,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1344,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1345,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1346,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1347,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1348,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1349,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1350,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1351,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1352,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1353,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1354,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1355,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1356,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1357,06bd57c3c36caa0c8b629e2f4b54a5e46dafa901,/9.6/alpine/Dockerfile," # backwards compat
"
1358,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
1359,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/Dockerfile,"# explicitly set user/group IDs
"
1360,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
1361,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1362,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1363,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1364,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1365,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1366,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1367,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/Dockerfile," # backwards compat
"
1368,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
1369,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/Dockerfile,"# explicitly set user/group IDs
"
1370,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
1371,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1372,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1373,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1374,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1375,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1376,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1377,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.4/Dockerfile," # backwards compat
"
1378,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1379,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1380,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
1381,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
1382,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1383,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1384,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1385,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1386,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1387,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1388,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1389,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1390,b2317dd369030a5f3f030b1daa1fc80da3cab9e0,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
1391,b2317dd369030a5f3f030b1daa1fc80da3cab9e0,/9.6/Dockerfile,"# explicitly set user/group IDs
"
1392,b2317dd369030a5f3f030b1daa1fc80da3cab9e0,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
1393,b2317dd369030a5f3f030b1daa1fc80da3cab9e0,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1394,b2317dd369030a5f3f030b1daa1fc80da3cab9e0,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1395,b2317dd369030a5f3f030b1daa1fc80da3cab9e0,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1396,b2317dd369030a5f3f030b1daa1fc80da3cab9e0,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1397,80ebeda0a68be6a8b10ce0de1846a49228af0795,/8.4/Dockerfile,"# vim:set ft=dockerfile:
"
1398,80ebeda0a68be6a8b10ce0de1846a49228af0795,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1399,80ebeda0a68be6a8b10ce0de1846a49228af0795,/8.4/Dockerfile,"# grab gosu for easy step-down from root
"
1400,80ebeda0a68be6a8b10ce0de1846a49228af0795,/8.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1401,80ebeda0a68be6a8b10ce0de1846a49228af0795,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1402,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
1403,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.4/Dockerfile,"# explicitly set user/group IDs
"
1404,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
1405,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1406,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1407,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
1408,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1409,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
1410,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1411,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1412,5159417968c6a08e2ed784498cba28f22a74b03e,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
1413,5159417968c6a08e2ed784498cba28f22a74b03e,/9.6/Dockerfile,"# explicitly set user/group IDs
"
1414,5159417968c6a08e2ed784498cba28f22a74b03e,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
1415,5159417968c6a08e2ed784498cba28f22a74b03e,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1416,5159417968c6a08e2ed784498cba28f22a74b03e,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1417,5159417968c6a08e2ed784498cba28f22a74b03e,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1418,5159417968c6a08e2ed784498cba28f22a74b03e,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1419,5159417968c6a08e2ed784498cba28f22a74b03e,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1420,5159417968c6a08e2ed784498cba28f22a74b03e,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1421,5159417968c6a08e2ed784498cba28f22a74b03e,/9.6/Dockerfile," # backwards compat
"
1422,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1423,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1424,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1425,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
1426,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
1427,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
1428,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1429,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1430,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1431,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1432,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1433,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1434,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1435,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1436,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1437,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1438,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1439,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1440,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1441,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1442,a72377975f328b42344dbefc5243f994f25ced22,/9.5/alpine/Dockerfile," # backwards compat
"
1443,d74474439c5ce1b0d7a2e17a310e53ae975e519b,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
1444,d74474439c5ce1b0d7a2e17a310e53ae975e519b,/9.5/Dockerfile,"# explicitly set user/group IDs
"
1445,d74474439c5ce1b0d7a2e17a310e53ae975e519b,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
1446,d74474439c5ce1b0d7a2e17a310e53ae975e519b,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1447,d74474439c5ce1b0d7a2e17a310e53ae975e519b,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1448,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
1449,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.5/Dockerfile,"# explicitly set user/group IDs
"
1450,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
1451,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1452,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1453,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
1454,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.1/Dockerfile,"# explicitly set user/group IDs
"
1455,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
1456,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1457,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1458,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.1/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1459,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.1/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1460,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
1461,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1462,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
1463,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1464,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1465,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1466,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1467,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1468,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"#		krb5-dev \
"
1469,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"#		openldap-dev \
"
1470,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# configure: error: prove not found
"
1471,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1472,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1473,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1474,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1475,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1476,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1477,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1478,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1479,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1480,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1481,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1482,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1483,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1484,5ad8e92a81fec890f33eb077e491ea82c76ac980,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1485,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
1486,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1487,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
1488,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1489,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1490,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1491,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1492,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1493,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
1494,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
1495,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
1496,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1497,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1498,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1499,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1500,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1501,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1502,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1503,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1504,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1505,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1506,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1507,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1508,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1509,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1510,65f0c2afd32d2b2f4b8cf3d7a68461a7c3fa00a5,/9.5/alpine/Dockerfile," # backwards compat
"
1511,73d73760957c7038dd3c07212b5b9daf86a2cb38,/Dockerfile.template,"# vim:set ft=dockerfile:
"
1512,73d73760957c7038dd3c07212b5b9daf86a2cb38,/Dockerfile.template,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1513,73d73760957c7038dd3c07212b5b9daf86a2cb38,/Dockerfile.template,"# grab gosu for easy step-down from root
"
1514,73d73760957c7038dd3c07212b5b9daf86a2cb38,/Dockerfile.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1515,73d73760957c7038dd3c07212b5b9daf86a2cb38,/Dockerfile.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1516,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# vim:set ft=dockerfile:
"
1517,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# explicitly set user/group IDs
"
1518,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1519,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1520,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# grab gosu for easy step-down from root
"
1521,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1522,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1523,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1524,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1525,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
1526,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# arches officialy built by upstream
"
1527,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1528,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
1529,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1530,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1531,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1532,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1533,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1534,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1535,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1536,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
1537,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1538,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
1539,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1540,7e80419825e4bab4e749bc61334570ffc261ea5e,/11/Dockerfile," # backwards compat
"
1541,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
1542,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1543,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
1544,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1545,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1546,51e5166d69320581cb707d6fb102d3ba04803400,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
1547,51e5166d69320581cb707d6fb102d3ba04803400,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1548,51e5166d69320581cb707d6fb102d3ba04803400,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
1549,51e5166d69320581cb707d6fb102d3ba04803400,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1550,51e5166d69320581cb707d6fb102d3ba04803400,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1551,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
1552,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.0/Dockerfile,"# explicitly set user/group IDs
"
1553,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
1554,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1555,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1556,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
1557,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# explicitly set user/group IDs
"
1558,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1559,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1560,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
1561,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1562,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1563,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1564,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1565,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# arches officialy built by upstream
"
1566,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1567,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1568,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1569,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1570,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1571,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1572,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1573,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1574,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1575,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1576,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1577,726128b358cdc0efc1753475bbe502b07cbbb540,/9.3/Dockerfile," # backwards compat
"
1578,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1579,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1580,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1581,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
1582,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
1583,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
1584,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1585,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1586,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1587,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1588,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1589,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1590,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1591,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1592,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1593,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1594,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1595,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1596,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1597,f3146f857b42bd4c4cb2be6134149fddee546584,/9.6/alpine/Dockerfile," # backwards compat
"
1598,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
1599,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1600,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/Dockerfile-alpine.template,"#		krb5-dev \
"
1601,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/Dockerfile-alpine.template,"#		openldap-dev \
"
1602,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1603,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1604,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1605,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1606,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1607,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1608,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
1609,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1610,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
1611,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.2/Dockerfile,"# explicitly set user/group IDs
"
1612,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
1613,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1614,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1615,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1616,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1617,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
1618,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.1/Dockerfile,"# explicitly set user/group IDs
"
1619,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
1620,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1621,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1622,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
1623,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
1624,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
1625,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1626,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1627,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1628,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
1629,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1630,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-debian.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1631,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-debian.template," # backwards compat
"
1632,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1633,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1634,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1635,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"#		krb5-dev \
"
1636,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"#		openldap-dev \
"
1637,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# configure: error: prove not found
"
1638,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1639,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1640,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1641,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1642,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1643,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1644,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1645,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1646,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1647,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1648,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1649,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1650,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1651,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1652,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/11/alpine/Dockerfile," # backwards compat
"
1653,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1654,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1655,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1656,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"#		krb5-dev \
"
1657,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"#		openldap-dev \
"
1658,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# configure: error: prove not found
"
1659,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1660,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1661,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1662,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1663,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1664,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1665,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1666,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1667,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1668,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1669,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1670,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1671,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1672,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1673,85aadc08c347cd20f199902c4b8b4f736341c3b8,/10/alpine/Dockerfile," # backwards compat
"
1674,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# vim:set ft=dockerfile:
"
1675,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# explicitly set user/group IDs
"
1676,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# grab gosu for easy step-down from root
"
1677,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1678,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1679,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1680,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1681,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# arches officialy built by upstream
"
1682,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1683,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1684,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1685,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1686,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1687,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1688,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1689,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1690,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1691,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1692,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1693,988d8afbdbf5d3c9e28c78a33ccc6670de337eed,/11/Dockerfile," # backwards compat
"
1694,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# vim:set ft=dockerfile:
"
1695,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# explicitly set user/group IDs
"
1696,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1697,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1698,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# grab gosu for easy step-down from root
"
1699,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1700,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1701,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1702,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1703,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
1704,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# arches officialy built by upstream
"
1705,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1706,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
1707,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1708,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1709,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1710,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1711,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1712,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1713,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1714,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
1715,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1716,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
1717,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1718,f19a74ec301fe755b70a822f905c8f537f67bc9a,/11/Dockerfile," # backwards compat
"
1719,de4122a80157b1a0a73c14bdd4f11479011a2a51,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
1720,de4122a80157b1a0a73c14bdd4f11479011a2a51,/9.2/Dockerfile,"# explicitly set user/group IDs
"
1721,de4122a80157b1a0a73c14bdd4f11479011a2a51,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
1722,de4122a80157b1a0a73c14bdd4f11479011a2a51,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1723,de4122a80157b1a0a73c14bdd4f11479011a2a51,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1724,de4122a80157b1a0a73c14bdd4f11479011a2a51,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1725,de4122a80157b1a0a73c14bdd4f11479011a2a51,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1726,de4122a80157b1a0a73c14bdd4f11479011a2a51,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1727,de4122a80157b1a0a73c14bdd4f11479011a2a51,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1728,de4122a80157b1a0a73c14bdd4f11479011a2a51,/9.2/Dockerfile," # backwards compat
"
1729,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/10/Dockerfile,"# vim:set ft=dockerfile:
"
1730,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/10/Dockerfile,"# explicitly set user/group IDs
"
1731,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/10/Dockerfile,"# grab gosu for easy step-down from root
"
1732,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1733,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1734,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1735,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1736,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1737,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1738,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/10/Dockerfile," # backwards compat
"
1739,9e6a83faa9859b35fc4df18be513320c00ecd493,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
1740,9e6a83faa9859b35fc4df18be513320c00ecd493,/9.4/Dockerfile,"# explicitly set user/group IDs
"
1741,9e6a83faa9859b35fc4df18be513320c00ecd493,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
1742,9e6a83faa9859b35fc4df18be513320c00ecd493,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1743,9e6a83faa9859b35fc4df18be513320c00ecd493,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1744,9e6a83faa9859b35fc4df18be513320c00ecd493,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1745,9e6a83faa9859b35fc4df18be513320c00ecd493,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1746,9e6a83faa9859b35fc4df18be513320c00ecd493,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1747,9e6a83faa9859b35fc4df18be513320c00ecd493,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1748,9e6a83faa9859b35fc4df18be513320c00ecd493,/9.4/Dockerfile," # backwards compat
"
1749,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
1750,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1751,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/Dockerfile-alpine.template,"#		krb5-dev \
"
1752,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/Dockerfile-alpine.template,"#		openldap-dev \
"
1753,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1754,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1755,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1756,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1757,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1758,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1759,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1760,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1761,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
1762,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1763,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/Dockerfile-alpine.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1764,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/Dockerfile-alpine.template," # backwards compat
"
1765,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
1766,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1767,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
1768,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1769,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1770,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
1771,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# explicitly set user/group IDs
"
1772,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
1773,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1774,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1775,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# arches officialy built by upstream
"
1776,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1777,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1778,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1779,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1780,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1781,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1782,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1783,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1784,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1785,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1786,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1787,b84ddd1619ee3a7f6e318bb9ac33f39818b3b548,/9.5/Dockerfile," # backwards compat
"
1788,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
1789,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1790,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
1791,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1792,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1793,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
1794,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# explicitly set user/group IDs
"
1795,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1796,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1797,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
1798,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1799,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1800,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1801,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1802,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
1803,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# arches officialy built by upstream
"
1804,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1805,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
1806,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1807,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1808,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1809,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1810,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1811,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1812,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1813,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
1814,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1815,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
1816,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1817,033f4941dde868055070eff244f23fd0f7b14ae6,/9.6/Dockerfile," # backwards compat
"
1818,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1819,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1820,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
1821,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
1822,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1823,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1824,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1825,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1826,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1827,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1828,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1829,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1830,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# vim:set ft=dockerfile:
"
1831,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# explicitly set user/group IDs
"
1832,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1833,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1834,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# grab gosu for easy step-down from root
"
1835,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1836,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1837,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1838,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1839,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# arches officialy built by upstream
"
1840,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1841,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1842,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1843,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1844,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1845,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1846,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1847,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1848,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1849,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1850,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1851,726128b358cdc0efc1753475bbe502b07cbbb540,/10/Dockerfile," # backwards compat
"
1852,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
1853,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1854,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
1855,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1856,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1857,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
1858,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# explicitly set user/group IDs
"
1859,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1860,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1861,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
1862,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1863,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1864,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1865,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1866,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
1867,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# arches officialy built by upstream
"
1868,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1869,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
1870,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1871,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1872,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1873,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1874,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1875,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1876,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1877,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
1878,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1879,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
1880,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1881,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.4/Dockerfile," # backwards compat
"
1882,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
1883,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.5/Dockerfile,"# explicitly set user/group IDs
"
1884,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
1885,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1886,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1887,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1888,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1889,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
1890,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
1891,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
1892,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1893,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1894,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1895,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
1896,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1897,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1898,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
1899,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1900,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"#		krb5-dev \
"
1901,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"#		openldap-dev \
"
1902,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# configure: error: prove not found
"
1903,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1904,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1905,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1906,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1907,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1908,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1909,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1910,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1911,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1912,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1913,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1914,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1915,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1916,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1917,cc305ee1c59d93ac1808108edda6556b879374a4,/10/alpine/Dockerfile," # backwards compat
"
1918,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
1919,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# explicitly set user/group IDs
"
1920,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1921,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1922,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
1923,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1924,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1925,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1926,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
1927,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1928,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
1929,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# arches officialy built by upstream
"
1930,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1931,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
1932,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1933,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1934,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1935,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1936,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1937,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1938,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1939,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
1940,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1941,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
1942,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1943,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.6/Dockerfile," # backwards compat
"
1944,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
1945,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
1946,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
1947,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
1948,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
1949,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
1950,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
1951,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
1952,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
1953,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
1954,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
1955,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
1956,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
1957,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
1958,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
1959,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
1960,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
1961,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1962,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
1963,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1964,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.4/alpine/Dockerfile," # backwards compat
"
1965,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# vim:set ft=dockerfile:
"
1966,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# explicitly set user/group IDs
"
1967,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# grab gosu for easy step-down from root
"
1968,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1969,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1970,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1971,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1972,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# arches officialy built by upstream
"
1973,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
1974,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
1975,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
1976,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
1977,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
1978,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
1979,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
1980,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
1981,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
1982,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
1983,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
1984,635fd0bcb3ababc96871c9da52f10743fbae4742,/11/Dockerfile," # backwards compat
"
1985,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
1986,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
1987,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
1988,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1989,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
1990,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# vim:set ft=dockerfile:
"
1991,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# explicitly set user/group IDs
"
1992,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
1993,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
1994,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# grab gosu for easy step-down from root
"
1995,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
1996,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
1997,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
1998,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
1999,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
2000,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# arches officialy built by upstream
"
2001,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2002,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
2003,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2004,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2005,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2006,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2007,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2008,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2009,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2010,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
2011,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2012,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
2013,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2014,ff832cbf1e9ffe150f66f00a0837d5b59083fec9,/10/Dockerfile," # backwards compat
"
2015,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2016,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2017,ea490430aabd553f34656e8f0e846d2ed3c42930,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2018,ea490430aabd553f34656e8f0e846d2ed3c42930,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2019,03db72ffa66b8662d50585537c90ceea8f72dfc9,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
2020,03db72ffa66b8662d50585537c90ceea8f72dfc9,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
2021,03db72ffa66b8662d50585537c90ceea8f72dfc9,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2022,03db72ffa66b8662d50585537c90ceea8f72dfc9,/Dockerfile-alpine.template,"#		krb5-dev \
"
2023,03db72ffa66b8662d50585537c90ceea8f72dfc9,/Dockerfile-alpine.template,"#		openldap-dev \
"
2024,03db72ffa66b8662d50585537c90ceea8f72dfc9,/Dockerfile-alpine.template,"# configure: error: prove not found
"
2025,03db72ffa66b8662d50585537c90ceea8f72dfc9,/Dockerfile-alpine.template,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2026,03db72ffa66b8662d50585537c90ceea8f72dfc9,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2027,03db72ffa66b8662d50585537c90ceea8f72dfc9,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2028,03db72ffa66b8662d50585537c90ceea8f72dfc9,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2029,03db72ffa66b8662d50585537c90ceea8f72dfc9,/Dockerfile-alpine.template,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2030,03db72ffa66b8662d50585537c90ceea8f72dfc9,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2031,03db72ffa66b8662d50585537c90ceea8f72dfc9,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2032,03db72ffa66b8662d50585537c90ceea8f72dfc9,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2033,03db72ffa66b8662d50585537c90ceea8f72dfc9,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2034,03db72ffa66b8662d50585537c90ceea8f72dfc9,/Dockerfile-alpine.template,"#p' --recursive /usr/local \
"
2035,03db72ffa66b8662d50585537c90ceea8f72dfc9,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2036,03db72ffa66b8662d50585537c90ceea8f72dfc9,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
2037,03db72ffa66b8662d50585537c90ceea8f72dfc9,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2038,03db72ffa66b8662d50585537c90ceea8f72dfc9,/Dockerfile-alpine.template,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2039,03db72ffa66b8662d50585537c90ceea8f72dfc9,/Dockerfile-alpine.template," # backwards compat
"
2040,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2041,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2042,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2043,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2044,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
2045,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
2046,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2047,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2048,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2049,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2050,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2051,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2052,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2053,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2054,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2055,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2056,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
2057,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
2058,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2059,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2060,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2061,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2062,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2063,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2064,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2065,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2066,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2067,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2068,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2069,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/alpine/Dockerfile," # backwards compat
"
2070,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2071,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
2072,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2073,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"#		krb5-dev \
"
2074,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"#		openldap-dev \
"
2075,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# configure: error: prove not found
"
2076,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2077,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2078,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2079,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
2080,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2081,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2082,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2083,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2084,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2085,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
2086,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2087,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2088,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2089,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2090,1bddd083582b0977075dda4258f2d9dfbc90482b,/11/alpine/Dockerfile," # backwards compat
"
2091,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
2092,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# explicitly set user/group IDs
"
2093,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
2094,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2095,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2096,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# arches officialy built by upstream
"
2097,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2098,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2099,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2100,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2101,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2102,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2103,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2104,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2105,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2106,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2107,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2108,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.6/Dockerfile," # backwards compat
"
2109,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
2110,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/Dockerfile,"# explicitly set user/group IDs
"
2111,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
2112,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2113,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2114,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2115,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2116,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2117,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2118,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/Dockerfile," # backwards compat
"
2119,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2120,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2121,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
2122,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
2123,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2124,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2125,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2126,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2127,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2128,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2129,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2130,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2131,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2132,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2133,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2134,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
2135,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.5/Dockerfile,"# explicitly set user/group IDs
"
2136,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
2137,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2138,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2139,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2140,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2141,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
2142,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# explicitly set user/group IDs
"
2143,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
2144,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
2145,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
2146,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2147,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2148,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2149,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2150,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# see note below about ""*.pyc"" files
"
2151,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# arches officialy built by upstream
"
2152,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2153,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
2154,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2155,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2156,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2157,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2158,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2159,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2160,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2161,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
2162,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2163,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2164,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2165,064113e0e481a1d0542846b81858e457fde02c90,/9.3/Dockerfile," # backwards compat
"
2166,bcfa58b2f0c971ad55f541f3fb868607cd391089,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
2167,bcfa58b2f0c971ad55f541f3fb868607cd391089,/9.6/Dockerfile,"# explicitly set user/group IDs
"
2168,bcfa58b2f0c971ad55f541f3fb868607cd391089,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
2169,bcfa58b2f0c971ad55f541f3fb868607cd391089,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2170,bcfa58b2f0c971ad55f541f3fb868607cd391089,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2171,bcfa58b2f0c971ad55f541f3fb868607cd391089,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2172,bcfa58b2f0c971ad55f541f3fb868607cd391089,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2173,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
2174,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# explicitly set user/group IDs
"
2175,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
2176,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
2177,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
2178,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2179,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2180,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2181,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2182,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
2183,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# arches officialy built by upstream
"
2184,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2185,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
2186,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2187,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2188,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2189,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2190,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2191,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2192,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2193,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
2194,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2195,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2196,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2197,0dfe0ba571b8aa2319474548403489ebdd80c52e,/9.6/Dockerfile," # backwards compat
"
2198,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
2199,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# explicitly set user/group IDs
"
2200,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
2201,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2202,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2203,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2204,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# arches officialy built by upstream
"
2205,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2206,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2207,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2208,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2209,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2210,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2211,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2212,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2213,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2214,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2215,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2216,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.3/Dockerfile," # backwards compat
"
2217,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
2218,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.6/Dockerfile,"# explicitly set user/group IDs
"
2219,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
2220,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2221,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2222,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2223,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2224,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2225,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2226,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
2227,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2228,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
2229,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
2230,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2231,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
2232,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2233,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2234,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2235,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2236,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2237,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2238,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2239,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2240,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2241,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2242,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.3/alpine/Dockerfile," # backwards compat
"
2243,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# vim:set ft=dockerfile:
"
2244,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# explicitly set user/group IDs
"
2245,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
2246,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
2247,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# grab gosu for easy step-down from root
"
2248,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2249,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2250,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2251,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
2252,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2253,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
2254,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# arches officialy built by upstream
"
2255,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2256,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
2257,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2258,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2259,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2260,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2261,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2262,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2263,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2264,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
2265,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2266,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
2267,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2268,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/12/Dockerfile," # backwards compat
"
2269,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2270,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
2271,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2272,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"#		krb5-dev \
"
2273,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"#		openldap-dev \
"
2274,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# configure: error: prove not found
"
2275,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2276,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2277,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2278,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2279,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2280,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2281,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2282,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2283,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2284,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2285,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2286,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2287,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2288,3aeab631baeee5b6c872c750259764fd5960deca,/10/alpine/Dockerfile," # backwards compat
"
2289,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2290,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
2291,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2292,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
2293,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
2294,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
2295,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2296,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2297,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
2298,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2299,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2300,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2301,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2302,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2303,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2304,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2305,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2306,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
2307,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2308,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2309,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2310,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2311,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.3/alpine/Dockerfile," # backwards compat
"
2312,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
2313,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2314,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
2315,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2316,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2317,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
2318,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2319,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
2320,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2321,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2322,783906f551b9bc1472751200296f93bb2c55bc44,/8.4/Dockerfile,"# vim:set ft=dockerfile:
"
2323,783906f551b9bc1472751200296f93bb2c55bc44,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2324,783906f551b9bc1472751200296f93bb2c55bc44,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2325,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2326,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
2327,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2328,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
2329,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
2330,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2331,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
2332,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2333,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2334,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2335,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2336,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2337,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2338,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2339,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2340,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2341,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2342,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2343,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2344,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/alpine/Dockerfile," # backwards compat
"
2345,8836191de6100bfae541c6d9a02cb4ec6e97471e,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
2346,8836191de6100bfae541c6d9a02cb4ec6e97471e,/9.5/Dockerfile,"# explicitly set user/group IDs
"
2347,8836191de6100bfae541c6d9a02cb4ec6e97471e,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
2348,8836191de6100bfae541c6d9a02cb4ec6e97471e,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2349,8836191de6100bfae541c6d9a02cb4ec6e97471e,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2350,8836191de6100bfae541c6d9a02cb4ec6e97471e,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2351,8836191de6100bfae541c6d9a02cb4ec6e97471e,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2352,8836191de6100bfae541c6d9a02cb4ec6e97471e,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2353,8836191de6100bfae541c6d9a02cb4ec6e97471e,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2354,8836191de6100bfae541c6d9a02cb4ec6e97471e,/9.5/Dockerfile," # backwards compat
"
2355,b8bc661d9222e4f91b291368a1f7f92ee67ac627,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
2356,b8bc661d9222e4f91b291368a1f7f92ee67ac627,/9.3/Dockerfile,"# explicitly set user/group IDs
"
2357,b8bc661d9222e4f91b291368a1f7f92ee67ac627,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
2358,b8bc661d9222e4f91b291368a1f7f92ee67ac627,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2359,b8bc661d9222e4f91b291368a1f7f92ee67ac627,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2360,b8bc661d9222e4f91b291368a1f7f92ee67ac627,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2361,b8bc661d9222e4f91b291368a1f7f92ee67ac627,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2362,b8bc661d9222e4f91b291368a1f7f92ee67ac627,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2363,b8bc661d9222e4f91b291368a1f7f92ee67ac627,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2364,b8bc661d9222e4f91b291368a1f7f92ee67ac627,/9.3/Dockerfile," # backwards compat
"
2365,7c8e945a80097e80fa1c8d69d2a027145177b701,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2366,7c8e945a80097e80fa1c8d69d2a027145177b701,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2367,783906f551b9bc1472751200296f93bb2c55bc44,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
2368,783906f551b9bc1472751200296f93bb2c55bc44,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2369,783906f551b9bc1472751200296f93bb2c55bc44,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2370,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
2371,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# explicitly set user/group IDs
"
2372,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
2373,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2374,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2375,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# arches officialy built by upstream
"
2376,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2377,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2378,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2379,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2380,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2381,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2382,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2383,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2384,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2385,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2386,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2387,7f18547f3779e8593e2bb35f21eba5baadc47290,/9.6/Dockerfile," # backwards compat
"
2388,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
2389,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2390,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
2391,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2392,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2393,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
2394,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# explicitly set user/group IDs
"
2395,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
2396,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2397,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2398,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2399,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2400,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# arches officialy built by upstream
"
2401,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2402,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2403,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2404,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2405,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2406,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2407,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2408,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2409,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2410,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2411,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2412,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.6/Dockerfile," # backwards compat
"
2413,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
2414,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# explicitly set user/group IDs
"
2415,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
2416,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
2417,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
2418,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2419,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2420,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2421,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2422,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
2423,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# arches officialy built by upstream
"
2424,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2425,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
2426,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2427,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2428,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2429,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2430,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2431,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2432,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2433,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
2434,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2435,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
2436,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2437,1ba3e9e1eb9337b428189dd94ecb09feeac33a36,/9.5/Dockerfile," # backwards compat
"
2438,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2439,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2440,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
2441,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
2442,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2443,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2444,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2445,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2446,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2447,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"# tzdata loading functionality is optional, and fails gracefully
#		tzdata \
"
2448,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2449,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2450,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2451,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
2452,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2453,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
2454,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
2455,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
2456,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2457,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2458,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2459,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2460,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2461,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2462,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2463,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2464,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2465,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2466,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2467,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2468,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.6/alpine/Dockerfile," # backwards compat
"
2469,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2470,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
2471,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2472,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
2473,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
2474,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
2475,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2476,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2477,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2478,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2479,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2480,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2481,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2482,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2483,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2484,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
2485,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2486,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2487,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2488,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2489,5992d8be755d8001474f737a44c73049c519cff3,/9.5/alpine/Dockerfile," # backwards compat
"
2490,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
2491,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# explicitly set user/group IDs
"
2492,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
2493,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2494,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2495,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# arches officialy built by upstream
"
2496,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2497,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2498,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2499,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2500,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2501,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2502,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2503,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2504,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2505,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2506,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2507,82e8101ff612b492507f4efc2120963b29f4188d,/9.6/Dockerfile," # backwards compat
"
2508,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
2509,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.2/Dockerfile,"# explicitly set user/group IDs
"
2510,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
2511,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2512,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2513,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
2514,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# explicitly set user/group IDs
"
2515,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
2516,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2517,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2518,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2519,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2520,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# arches officialy built by upstream
"
2521,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2522,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2523,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2524,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2525,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2526,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2527,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2528,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2529,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2530,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2531,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2532,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.3/Dockerfile," # backwards compat
"
2533,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# vim:set ft=dockerfile:
"
2534,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# explicitly set user/group IDs
"
2535,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
2536,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
2537,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# grab gosu for easy step-down from root
"
2538,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2539,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2540,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2541,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
2542,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2543,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
2544,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# arches officialy built by upstream
"
2545,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2546,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
2547,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2548,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2549,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2550,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2551,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2552,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2553,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2554,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
2555,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2556,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
2557,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2558,4f70bf2b811bcdb4ab1a015ef703373226452157,/10/Dockerfile," # backwards compat
"
2559,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2560,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
2561,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2562,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"#		krb5-dev \
"
2563,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"#		openldap-dev \
"
2564,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# configure: error: prove not found
"
2565,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2566,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2567,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2568,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
2569,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2570,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2571,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2572,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2573,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2574,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
2575,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2576,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2577,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2578,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2579,1657faac6b9918537da408915b65e92323f8c74b,/10/alpine/Dockerfile," # backwards compat
"
2580,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2581,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
2582,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2583,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
2584,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
2585,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
2586,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2587,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2588,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2589,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2590,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2591,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2592,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2593,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2594,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2595,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
2596,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2597,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2598,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2599,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2600,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.5/alpine/Dockerfile," # backwards compat
"
2601,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2602,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2603,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
2604,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
2605,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2606,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2607,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2608,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2609,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2610,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2611,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2612,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2613,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# vim:set ft=dockerfile:
"
2614,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# explicitly set user/group IDs
"
2615,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
2616,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
2617,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
2618,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2619,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2620,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2621,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
2622,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2623,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
2624,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# arches officialy built by upstream
"
2625,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2626,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
2627,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2628,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2629,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2630,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2631,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2632,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2633,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2634,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
2635,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2636,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
2637,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2638,aa4f329a17fd82077536602da12f4264fa195b20,/11/Dockerfile," # backwards compat
"
2639,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2640,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
2641,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2642,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"#		krb5-dev \
"
2643,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"#		openldap-dev \
"
2644,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# configure: error: prove not found
"
2645,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2646,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2647,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2648,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2649,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2650,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2651,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2652,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2653,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2654,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
2655,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2656,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2657,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2658,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2659,c4b019526a25d1300de77b9699d53ad187cf0dcf,/10/alpine/Dockerfile," # backwards compat
"
2660,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2661,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
2662,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2663,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"#		krb5-dev \
"
2664,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"#		openldap-dev \
"
2665,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# configure: error: prove not found
"
2666,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2667,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2668,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2669,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2670,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2671,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2672,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2673,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2674,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2675,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
2676,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2677,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2678,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2679,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2680,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/11/alpine/Dockerfile," # backwards compat
"
2681,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
2682,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
2683,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
2684,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
2685,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
2686,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2687,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2688,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2689,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2690,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"# see note below about ""*.pyc"" files
"
2691,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"# arches officialy built by upstream
"
2692,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2693,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
2694,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2695,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2696,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2697,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2698,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2699,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2700,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2701,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
2702,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
2703,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
2704,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2705,040949af1595f49f2242f6d1f9c42fb042b3eaed,/Dockerfile-debian.template," # backwards compat
"
2706,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
2707,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# explicitly set user/group IDs
"
2708,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
2709,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
2710,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
2711,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2712,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2713,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2714,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2715,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
2716,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# arches officialy built by upstream
"
2717,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2718,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
2719,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2720,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2721,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2722,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2723,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2724,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2725,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2726,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
2727,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2728,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
2729,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2730,2803c9e12ac659335a394d5712e5da8cd10bdf69,/9.5/Dockerfile," # backwards compat
"
2731,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2732,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
2733,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2734,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
2735,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
2736,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
2737,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2738,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2739,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
2740,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2741,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2742,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2743,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2744,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2745,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2746,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2747,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2748,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
2749,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2750,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2751,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2752,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2753,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.3/alpine/Dockerfile," # backwards compat
"
2754,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/Dockerfile.template,"# vim:set ft=dockerfile:
"
2755,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/Dockerfile.template,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2756,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/Dockerfile.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2757,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2758,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
2759,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2760,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
2761,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
2762,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
2763,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2764,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2765,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2766,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2767,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2768,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2769,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2770,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2771,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2772,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
2773,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2774,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2775,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2776,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2777,a0ec4f5af75da64d706cad256ba8a0245514aae6,/9.5/alpine/Dockerfile," # backwards compat
"
2778,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2779,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2780,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
2781,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
2782,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2783,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2784,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2785,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2786,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2787,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2788,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2789,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2790,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2791,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2792,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2793,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
2794,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2795,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"#		krb5-dev \
"
2796,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"#		openldap-dev \
"
2797,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# configure: error: prove not found
"
2798,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2799,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2800,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2801,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2802,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2803,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2804,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2805,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2806,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2807,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
2808,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2809,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2810,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2811,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2812,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/10/alpine/Dockerfile," # backwards compat
"
2813,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
2814,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# explicitly set user/group IDs
"
2815,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
2816,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
2817,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
2818,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2819,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2820,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2821,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2822,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
2823,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# arches officialy built by upstream
"
2824,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2825,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
2826,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2827,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2828,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2829,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2830,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2831,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2832,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2833,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
2834,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2835,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
2836,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2837,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.6/Dockerfile," # backwards compat
"
2838,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
2839,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# explicitly set user/group IDs
"
2840,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
2841,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2842,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2843,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# arches officialy built by upstream
"
2844,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2845,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2846,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2847,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2848,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2849,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2850,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2851,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2852,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2853,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2854,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2855,3b022607bec233463a3d055731fb710837978747,/9.4/Dockerfile," # backwards compat
"
2856,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2857,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
2858,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2859,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
2860,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
2861,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2862,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2863,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2864,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2865,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2866,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2867,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2868,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2869,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2870,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2871,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2872,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2873,c844ef624823fac9f0e40695d5d01a622f5fd71a,/9.5/alpine/Dockerfile," # backwards compat
"
2874,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
2875,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
2876,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
2877,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2878,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2879,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2880,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
2881,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2882,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"#		krb5-dev \
"
2883,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"#		openldap-dev \
"
2884,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# configure: error: prove not found
"
2885,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2886,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2887,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2888,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2889,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2890,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2891,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2892,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2893,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2894,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
2895,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2896,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2897,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2898,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2899,8bebabd5bcfa166ff8ac29a5166d2c1eb6e36002,/10/alpine/Dockerfile," # backwards compat
"
2900,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
2901,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
2902,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
2903,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
2904,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
2905,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2906,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
2907,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
2908,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2909,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"# see note below about ""*.pyc"" files
"
2910,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"# arches officialy built by upstream
"
2911,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
2912,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
2913,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
2914,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"# we don't remove APT lists here because they get re-downloaded and removed later
"
2915,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
2916,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
2917,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
2918,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
2919,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
2920,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
2921,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
2922,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
2923,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2924,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/Dockerfile-debian.template," # backwards compat
"
2925,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
2926,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
2927,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
2928,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2929,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2930,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2931,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
2932,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2933,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-debian.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2934,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-debian.template," # backwards compat
"
2935,e4942cb0f79b61024963dc0ac196375b26fa60dd,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
2936,e4942cb0f79b61024963dc0ac196375b26fa60dd,/9.6/Dockerfile,"# explicitly set user/group IDs
"
2937,e4942cb0f79b61024963dc0ac196375b26fa60dd,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
2938,e4942cb0f79b61024963dc0ac196375b26fa60dd,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2939,e4942cb0f79b61024963dc0ac196375b26fa60dd,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2940,e4942cb0f79b61024963dc0ac196375b26fa60dd,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2941,e4942cb0f79b61024963dc0ac196375b26fa60dd,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2942,972294a377463156c8d61297320c872fc7d370a9,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
2943,972294a377463156c8d61297320c872fc7d370a9,/9.2/Dockerfile,"# explicitly set user/group IDs
"
2944,972294a377463156c8d61297320c872fc7d370a9,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
2945,972294a377463156c8d61297320c872fc7d370a9,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
2946,972294a377463156c8d61297320c872fc7d370a9,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
2947,972294a377463156c8d61297320c872fc7d370a9,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
2948,972294a377463156c8d61297320c872fc7d370a9,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2949,972294a377463156c8d61297320c872fc7d370a9,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
2950,972294a377463156c8d61297320c872fc7d370a9,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2951,972294a377463156c8d61297320c872fc7d370a9,/9.2/Dockerfile," # backwards compat
"
2952,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2953,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
2954,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2955,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
2956,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
2957,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
2958,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2959,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2960,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2961,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
2962,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
2963,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2964,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2965,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2966,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2967,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
2968,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2969,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2970,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2971,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2972,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.6/alpine/Dockerfile," # backwards compat
"
2973,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2974,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2975,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
2976,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
2977,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2978,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
2979,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2980,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
2981,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
2982,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
2983,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
2984,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
2985,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
2986,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
2987,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
2988,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
2989,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.2/alpine/Dockerfile," # backwards compat
"
2990,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
2991,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
2992,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
2993,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"#		krb5-dev \
"
2994,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"#		openldap-dev \
"
2995,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# configure: error: prove not found
"
2996,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
2997,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
2998,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
2999,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3000,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3001,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3002,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3003,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3004,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3005,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3006,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3007,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3008,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3009,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3010,eacf33933eced1d5db93699c19e6f24b30596db8,/11/alpine/Dockerfile," # backwards compat
"
3011,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
3012,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3013,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3014,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-alpine.template,"#		krb5-dev \
"
3015,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-alpine.template,"#		openldap-dev \
"
3016,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3017,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3018,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3019,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-alpine.template,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3020,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3021,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3022,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3023,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3024,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3025,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
3026,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3027,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-alpine.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3028,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-alpine.template," # backwards compat
"
3029,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3030,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3031,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3032,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
3033,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
3034,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3035,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3036,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3037,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3038,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3039,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3040,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3041,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3042,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3043,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3044,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3045,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.6/alpine/Dockerfile," # backwards compat
"
3046,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3047,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3048,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
3049,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
3050,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3051,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3052,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3053,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3054,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3055,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3056,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3057,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3058,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3059,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3060,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3061,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.3/alpine/Dockerfile," # backwards compat
"
3062,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
3063,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# explicitly set user/group IDs
"
3064,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3065,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3066,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
3067,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3068,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3069,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3070,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3071,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
3072,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# arches officialy built by upstream
"
3073,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3074,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3075,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3076,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3077,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3078,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3079,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3080,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3081,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3082,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3083,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3084,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
3085,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3086,f13fbe5ad177aa30befdfe25379859e01b5b2d9d,/9.6/Dockerfile," # backwards compat
"
3087,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3088,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3089,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3090,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"#		krb5-dev \
"
3091,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"#		openldap-dev \
"
3092,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# configure: error: prove not found
"
3093,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3094,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3095,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3096,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3097,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3098,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3099,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3100,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3101,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3102,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3103,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3104,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3105,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3106,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3107,eed67ed0f33435bffd1e78d27b389e0492d30599,/11/alpine/Dockerfile," # backwards compat
"
3108,010a4e7e8321a692cd2fdb41c87cb8d4023567aa,/10/Dockerfile,"# vim:set ft=dockerfile:
"
3109,010a4e7e8321a692cd2fdb41c87cb8d4023567aa,/10/Dockerfile,"# explicitly set user/group IDs
"
3110,010a4e7e8321a692cd2fdb41c87cb8d4023567aa,/10/Dockerfile,"# grab gosu for easy step-down from root
"
3111,010a4e7e8321a692cd2fdb41c87cb8d4023567aa,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3112,010a4e7e8321a692cd2fdb41c87cb8d4023567aa,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3113,010a4e7e8321a692cd2fdb41c87cb8d4023567aa,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3114,010a4e7e8321a692cd2fdb41c87cb8d4023567aa,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3115,010a4e7e8321a692cd2fdb41c87cb8d4023567aa,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3116,010a4e7e8321a692cd2fdb41c87cb8d4023567aa,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3117,010a4e7e8321a692cd2fdb41c87cb8d4023567aa,/10/Dockerfile," # backwards compat
"
3118,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
3119,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# explicitly set user/group IDs
"
3120,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
3121,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3122,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3123,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# arches officialy built by upstream
"
3124,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3125,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3126,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3127,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3128,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3129,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3130,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3131,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3132,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3133,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3134,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3135,93dc51c2ec5b16d3d728b7f85804ae43113006d6,/9.4/Dockerfile," # backwards compat
"
3136,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3137,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3138,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3139,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
3140,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
3141,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3142,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
3143,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3144,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3145,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3146,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3147,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3148,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3149,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3150,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3151,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3152,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3153,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.3/alpine/Dockerfile," # backwards compat
"
3154,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# vim:set ft=dockerfile:
"
3155,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# explicitly set user/group IDs
"
3156,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3157,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3158,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# grab gosu for easy step-down from root
"
3159,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3160,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3161,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3162,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3163,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
3164,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# arches officialy built by upstream
"
3165,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3166,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3167,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3168,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3169,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3170,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3171,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3172,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3173,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3174,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3175,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3176,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
3177,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3178,c6c3621d450c4a0a1fda7af50a71c4fe4f292946,/10/Dockerfile," # backwards compat
"
3179,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3180,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3181,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3182,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
3183,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
3184,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3185,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3186,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3187,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3188,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3189,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3190,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3191,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3192,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3193,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3194,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3195,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3196,a554d043a3b77937120d325b30fefaad2e3be12d,/9.6/alpine/Dockerfile," # backwards compat
"
3197,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3198,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3199,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3200,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
3201,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
3202,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3203,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
3204,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3205,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3206,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3207,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3208,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3209,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3210,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3211,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3212,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3213,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3214,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3215,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3216,975f6a2705d981f865a2cb0536a86a46e5839534,/9.2/alpine/Dockerfile," # backwards compat
"
3217,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
3218,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# explicitly set user/group IDs
"
3219,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
3220,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3221,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3222,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3223,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3224,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# arches officialy built by upstream
"
3225,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3226,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3227,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3228,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3229,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3230,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3231,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3232,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3233,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3234,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3235,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3236,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.6/Dockerfile," # backwards compat
"
3237,0f910e3495412a854dae3add691f79d6f18a7aa5,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
3238,0f910e3495412a854dae3add691f79d6f18a7aa5,/9.6/Dockerfile,"# explicitly set user/group IDs
"
3239,0f910e3495412a854dae3add691f79d6f18a7aa5,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
3240,0f910e3495412a854dae3add691f79d6f18a7aa5,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3241,0f910e3495412a854dae3add691f79d6f18a7aa5,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3242,0f910e3495412a854dae3add691f79d6f18a7aa5,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3243,0f910e3495412a854dae3add691f79d6f18a7aa5,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3244,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# vim:set ft=dockerfile:
"
3245,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# explicitly set user/group IDs
"
3246,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3247,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3248,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# grab gosu for easy step-down from root
"
3249,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3250,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3251,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3252,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
3253,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3254,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
3255,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# arches officialy built by upstream
"
3256,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3257,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3258,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3259,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3260,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3261,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3262,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3263,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3264,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3265,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3266,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3267,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
3268,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3269,72d7408ad3b57ab1a5c371e11460811551811bf5,/10/Dockerfile," # backwards compat
"
3270,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
3271,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# explicitly set user/group IDs
"
3272,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3273,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3274,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
3275,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3276,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3277,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3278,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
3279,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3280,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
3281,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# arches officialy built by upstream
"
3282,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3283,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3284,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3285,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3286,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3287,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3288,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3289,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3290,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3291,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3292,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3293,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
3294,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3295,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.6/Dockerfile," # backwards compat
"
3296,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3297,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3298,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3299,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
3300,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
3301,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3302,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3303,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3304,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3305,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3306,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3307,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3308,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3309,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3310,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3311,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3312,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3313,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.5/alpine/Dockerfile," # backwards compat
"
3314,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3315,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
3316,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3317,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
3318,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
3319,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
3320,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3321,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3322,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3323,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3324,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3325,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3326,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3327,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3328,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3329,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3330,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3331,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3332,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3333,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3334,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.5/alpine/Dockerfile," # backwards compat
"
3335,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# vim:set ft=dockerfile:
"
3336,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# explicitly set user/group IDs
"
3337,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3338,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3339,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
3340,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3341,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3342,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3343,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
3344,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3345,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
3346,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# arches officialy built by upstream
"
3347,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3348,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3349,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3350,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3351,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3352,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3353,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3354,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3355,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3356,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3357,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3358,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
3359,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3360,a1420dac644b8190df5e78e80bfa9610b2f077e2,/11/Dockerfile," # backwards compat
"
3361,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# vim:set ft=dockerfile:
"
3362,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# explicitly set user/group IDs
"
3363,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3364,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3365,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# grab gosu for easy step-down from root
"
3366,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3367,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3368,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3369,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3370,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
3371,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# arches officialy built by upstream
"
3372,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3373,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3374,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3375,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3376,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3377,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3378,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3379,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3380,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3381,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3382,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3383,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
3384,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3385,42f9ab3bab65fdbabbf35130c68a9869b6e82ee7,/11/Dockerfile," # backwards compat
"
3386,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
3387,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# explicitly set user/group IDs
"
3388,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3389,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3390,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
3391,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3392,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3393,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3394,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3395,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
3396,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# arches officialy built by upstream
"
3397,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3398,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3399,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3400,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3401,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3402,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3403,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3404,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3405,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3406,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3407,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3408,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
3409,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3410,87b15b6c65ba985ac958e7b35ba787422113066e,/9.5/Dockerfile," # backwards compat
"
3411,6abeb8590f35c5251b9f100a667024febaeee06b,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
3412,6abeb8590f35c5251b9f100a667024febaeee06b,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3413,7c8e945a80097e80fa1c8d69d2a027145177b701,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
3414,7c8e945a80097e80fa1c8d69d2a027145177b701,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3415,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# vim:set ft=dockerfile:
"
3416,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# explicitly set user/group IDs
"
3417,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3418,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3419,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# grab gosu for easy step-down from root
"
3420,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3421,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3422,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3423,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3424,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
3425,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# arches officialy built by upstream
"
3426,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3427,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3428,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3429,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3430,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3431,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3432,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3433,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3434,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3435,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3436,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3437,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3438,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3439,d61fd19b699b2c380da08c3a95f7272137a182bb,/11/Dockerfile," # backwards compat
"
3440,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
3441,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3442,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-alpine.template,"#		krb5-dev \
"
3443,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-alpine.template,"#		openldap-dev \
"
3444,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3445,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3446,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3447,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3448,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3449,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3450,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3451,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3452,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
3453,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3454,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-alpine.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3455,fc676766b4c4b1a7afb857342b9adef78b09f28b,/Dockerfile-alpine.template," # backwards compat
"
3456,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# vim:set ft=dockerfile:
"
3457,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# explicitly set user/group IDs
"
3458,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3459,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3460,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# grab gosu for easy step-down from root
"
3461,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3462,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3463,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3464,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
3465,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3466,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
3467,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# arches officialy built by upstream
"
3468,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3469,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3470,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3471,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3472,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3473,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3474,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3475,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3476,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3477,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3478,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3479,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
3480,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3481,bdfa18e43c2b7ea7d26d2df7a18b12a674beaf92,/10/Dockerfile," # backwards compat
"
3482,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3483,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3484,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3485,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
3486,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
3487,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
3488,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3489,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3490,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3491,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3492,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3493,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3494,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3495,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3496,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3497,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3498,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3499,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3500,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3501,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3502,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.6/alpine/Dockerfile," # backwards compat
"
3503,6abeb8590f35c5251b9f100a667024febaeee06b,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
3504,6abeb8590f35c5251b9f100a667024febaeee06b,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3505,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# vim:set ft=dockerfile:
"
3506,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# explicitly set user/group IDs
"
3507,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3508,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3509,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# grab gosu for easy step-down from root
"
3510,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3511,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3512,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3513,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3514,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
3515,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# arches officialy built by upstream
"
3516,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3517,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3518,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3519,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3520,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3521,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3522,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3523,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3524,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3525,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3526,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3527,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
3528,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3529,a8613f4cda3e932245f09c4d0f6733462b14b582,/12/Dockerfile," # backwards compat
"
3530,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
3531,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/Dockerfile,"# explicitly set user/group IDs
"
3532,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
3533,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3534,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3535,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3536,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3537,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3538,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3539,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
3540,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# explicitly set user/group IDs
"
3541,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
3542,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3543,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3544,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3545,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3546,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# arches officialy built by upstream
"
3547,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3548,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3549,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3550,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3551,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3552,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3553,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3554,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3555,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3556,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3557,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3558,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.3/Dockerfile," # backwards compat
"
3559,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3560,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3561,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3562,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
3563,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
3564,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
3565,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3566,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3567,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3568,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3569,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3570,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3571,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3572,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3573,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3574,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3575,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3576,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3577,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3578,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3579,408356d52c2cdfaff96fd88246124bd2cfeb7160,/9.4/alpine/Dockerfile," # backwards compat
"
3580,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
3581,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# explicitly set user/group IDs
"
3582,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3583,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3584,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
3585,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3586,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3587,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3588,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3589,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
3590,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# arches officialy built by upstream
"
3591,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3592,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3593,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3594,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3595,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3596,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3597,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3598,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3599,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3600,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3601,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3602,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3603,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3604,d28670df74380893a098d9e08c80e9507af5ffff,/9.4/Dockerfile," # backwards compat
"
3605,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
3606,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# explicitly set user/group IDs
"
3607,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3608,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3609,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
3610,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3611,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3612,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3613,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3614,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
3615,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# arches officialy built by upstream
"
3616,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3617,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3618,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3619,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3620,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3621,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3622,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3623,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3624,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3625,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3626,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3627,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
3628,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3629,23d28bb5957e74cfa1167262fffaddab1bdea4d6,/9.4/Dockerfile," # backwards compat
"
3630,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
3631,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# explicitly set user/group IDs
"
3632,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3633,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3634,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
3635,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3636,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3637,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3638,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3639,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
3640,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# arches officialy built by upstream
"
3641,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3642,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3643,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3644,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3645,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3646,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3647,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3648,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3649,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3650,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3651,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3652,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
3653,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3654,9558084c73fd9bb5e3c7d8048e6a46f9e18a6ea2,/9.6/Dockerfile," # backwards compat
"
3655,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# vim:set ft=dockerfile:
"
3656,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# explicitly set user/group IDs
"
3657,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3658,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3659,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# grab gosu for easy step-down from root
"
3660,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3661,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3662,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3663,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3664,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
3665,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# arches officialy built by upstream
"
3666,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3667,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3668,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3669,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3670,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3671,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3672,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3673,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3674,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3675,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3676,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3677,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
3678,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3679,87b15b6c65ba985ac958e7b35ba787422113066e,/11/Dockerfile," # backwards compat
"
3680,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
3681,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.3/Dockerfile,"# explicitly set user/group IDs
"
3682,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
3683,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3684,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3685,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
3686,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.2/Dockerfile,"# explicitly set user/group IDs
"
3687,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
3688,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3689,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3690,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3691,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3692,1c0bc9d905d569fead777b9b8e3836e8af1c394c,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
3693,1c0bc9d905d569fead777b9b8e3836e8af1c394c,/9.5/Dockerfile,"# explicitly set user/group IDs
"
3694,1c0bc9d905d569fead777b9b8e3836e8af1c394c,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
3695,1c0bc9d905d569fead777b9b8e3836e8af1c394c,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3696,1c0bc9d905d569fead777b9b8e3836e8af1c394c,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3697,1c0bc9d905d569fead777b9b8e3836e8af1c394c,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3698,1c0bc9d905d569fead777b9b8e3836e8af1c394c,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3699,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
3700,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# explicitly set user/group IDs
"
3701,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3702,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3703,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
3704,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3705,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3706,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3707,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3708,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
3709,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# arches officialy built by upstream
"
3710,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3711,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3712,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3713,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3714,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3715,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3716,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3717,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3718,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3719,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3720,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3721,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3722,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3723,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.5/Dockerfile," # backwards compat
"
3724,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3725,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3726,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
3727,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
3728,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3729,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3730,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3731,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3732,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3733,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3734,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3735,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3736,1e7af691a3981ec1c86d23d585dcebd9154d1cd0,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
3737,1e7af691a3981ec1c86d23d585dcebd9154d1cd0,/9.4/Dockerfile,"# explicitly set user/group IDs
"
3738,1e7af691a3981ec1c86d23d585dcebd9154d1cd0,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
3739,1e7af691a3981ec1c86d23d585dcebd9154d1cd0,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3740,1e7af691a3981ec1c86d23d585dcebd9154d1cd0,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3741,1e7af691a3981ec1c86d23d585dcebd9154d1cd0,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3742,1e7af691a3981ec1c86d23d585dcebd9154d1cd0,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3743,1e7af691a3981ec1c86d23d585dcebd9154d1cd0,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3744,1e7af691a3981ec1c86d23d585dcebd9154d1cd0,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3745,1e7af691a3981ec1c86d23d585dcebd9154d1cd0,/9.4/Dockerfile," # backwards compat
"
3746,762e07937086fb43082ab1523ac9d0191c2c347f,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
3747,762e07937086fb43082ab1523ac9d0191c2c347f,/9.4/Dockerfile,"# explicitly set user/group IDs
"
3748,762e07937086fb43082ab1523ac9d0191c2c347f,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
3749,762e07937086fb43082ab1523ac9d0191c2c347f,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3750,762e07937086fb43082ab1523ac9d0191c2c347f,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3751,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3752,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3753,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3754,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
3755,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
3756,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
3757,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3758,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3759,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3760,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3761,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3762,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3763,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3764,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3765,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3766,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3767,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3768,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3769,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3770,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3771,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/alpine/Dockerfile," # backwards compat
"
3772,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3773,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3774,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3775,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"#		krb5-dev \
"
3776,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"#		openldap-dev \
"
3777,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# configure: error: prove not found
"
3778,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3779,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3780,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3781,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3782,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3783,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3784,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3785,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3786,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3787,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3788,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3789,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3790,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3791,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3792,06813e04bdd11c923fe531b6b73176a0b6a2bb72,/11/alpine/Dockerfile," # backwards compat
"
3793,c01405b7c324350cc796ba9e861326aee158f75e,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
3794,c01405b7c324350cc796ba9e861326aee158f75e,/9.2/Dockerfile,"# explicitly set user/group IDs
"
3795,c01405b7c324350cc796ba9e861326aee158f75e,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
3796,c01405b7c324350cc796ba9e861326aee158f75e,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3797,c01405b7c324350cc796ba9e861326aee158f75e,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
3798,c01405b7c324350cc796ba9e861326aee158f75e,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3799,c01405b7c324350cc796ba9e861326aee158f75e,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
3800,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3801,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3802,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3803,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
3804,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
3805,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3806,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3807,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3808,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3809,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3810,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3811,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3812,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3813,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3814,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3815,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3816,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3817,6420763a8acd9ba12d34b2bd76e6d6927d2c36a5,/9.4/alpine/Dockerfile," # backwards compat
"
3818,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3819,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3820,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
3821,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
3822,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3823,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3824,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3825,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3826,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3827,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"# tzdata adds around 1Mb to image size, but it is suggested by Django documentation that timezone should be set for performance reasons: http://bit.ly/2fMYhh1
"
3828,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3829,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3830,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# vim:set ft=dockerfile:
"
3831,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# explicitly set user/group IDs
"
3832,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3833,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3834,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
3835,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3836,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3837,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3838,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
3839,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3840,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
3841,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# arches officialy built by upstream
"
3842,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3843,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3844,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3845,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3846,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3847,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3848,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3849,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3850,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3851,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3852,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3853,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
3854,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3855,f1e039c4ebd8e4691af65dfd6cf280df126039aa,/10/Dockerfile," # backwards compat
"
3856,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3857,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3858,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3859,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
3860,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
3861,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
3862,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3863,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3864,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
3865,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3866,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3867,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3868,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3869,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3870,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3871,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3872,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3873,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3874,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3875,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3876,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3877,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3878,feaec8367b50af1707fc07da0643f77bd56aa912,/9.3/alpine/Dockerfile," # backwards compat
"
3879,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3880,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3881,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3882,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
3883,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
3884,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
3885,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3886,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3887,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3888,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3889,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3890,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3891,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3892,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3893,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3894,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3895,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3896,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3897,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3898,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3899,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.6/alpine/Dockerfile," # backwards compat
"
3900,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3901,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
3902,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3903,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
3904,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
3905,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
3906,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3907,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3908,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3909,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3910,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3911,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3912,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3913,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3914,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3915,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3916,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3917,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3918,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3919,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3920,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.6/alpine/Dockerfile," # backwards compat
"
3921,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
3922,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# explicitly set user/group IDs
"
3923,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
3924,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
3925,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
3926,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
3927,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
3928,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
3929,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
3930,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
3931,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
3932,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# arches officialy built by upstream
"
3933,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
3934,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
3935,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
3936,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
3937,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
3938,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
3939,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
3940,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
3941,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
3942,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
3943,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3944,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
3945,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3946,1de51ab35ec3dccbb992b9b02faf8b61ed2d1e2d,/9.5/Dockerfile," # backwards compat
"
3947,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3948,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3949,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3950,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
3951,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
3952,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3953,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3954,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3955,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3956,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3957,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3958,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3959,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3960,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3961,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3962,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3963,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3964,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/alpine/Dockerfile," # backwards compat
"
3965,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
3966,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3967,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-alpine.template,"#		krb5-dev \
"
3968,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-alpine.template,"#		openldap-dev \
"
3969,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3970,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3971,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3972,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3973,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3974,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3975,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3976,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3977,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
3978,b68154ed7975480d26e65344dcda09cce0ac1ac9,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3979,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
3980,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
3981,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
3982,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
3983,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
3984,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
3985,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
3986,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
3987,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
3988,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
3989,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
3990,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
3991,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
3992,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
3993,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
3994,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
3995,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
3996,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
3997,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
3998,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
3999,8734ceed8c5e196d3d59227a59d80df8fed70126,/9.5/alpine/Dockerfile," # backwards compat
"
4000,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4001,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4002,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4003,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"#		krb5-dev \
"
4004,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"#		openldap-dev \
"
4005,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# configure: error: prove not found
"
4006,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4007,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4008,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4009,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4010,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4011,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4012,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4013,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4014,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4015,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4016,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4017,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4018,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4019,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4020,fe8c9a4a309a889dc057d53bf3769c25c1522c65,/10/alpine/Dockerfile," # backwards compat
"
4021,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
4022,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
4023,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
4024,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4025,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4026,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4027,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4028,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4029,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"#		krb5-dev \
"
4030,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"#		openldap-dev \
"
4031,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# configure: error: prove not found
"
4032,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4033,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4034,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4035,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4036,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4037,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4038,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4039,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4040,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4041,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4042,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4043,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4044,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4045,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4046,0a66d53fface5ccc8274f99712ba2f382a1caf42,/11/alpine/Dockerfile," # backwards compat
"
4047,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
4048,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4049,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4050,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/Dockerfile-alpine.template,"#		krb5-dev \
"
4051,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/Dockerfile-alpine.template,"#		openldap-dev \
"
4052,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4053,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4054,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4055,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/Dockerfile-alpine.template,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4056,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4057,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4058,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4059,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4060,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4061,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
4062,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4063,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/Dockerfile-alpine.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4064,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/Dockerfile-alpine.template," # backwards compat
"
4065,bfa7152926890a27e9fd8925fdffa824c353480a,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
4066,bfa7152926890a27e9fd8925fdffa824c353480a,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
4067,bfa7152926890a27e9fd8925fdffa824c353480a,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
4068,bfa7152926890a27e9fd8925fdffa824c353480a,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4069,bfa7152926890a27e9fd8925fdffa824c353480a,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4070,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4071,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
4072,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4073,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
4074,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
4075,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
4076,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4077,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4078,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4079,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4080,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4081,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4082,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4083,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4084,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4085,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4086,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4087,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4088,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4089,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4090,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.5/alpine/Dockerfile," # backwards compat
"
4091,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# vim:set ft=dockerfile:
"
4092,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# explicitly set user/group IDs
"
4093,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4094,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4095,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# grab gosu for easy step-down from root
"
4096,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4097,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4098,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4099,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4100,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
4101,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# arches officialy built by upstream
"
4102,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4103,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4104,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4105,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4106,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4107,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4108,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4109,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4110,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4111,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4112,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4113,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4114,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4115,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/Dockerfile," # backwards compat
"
4116,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# vim:set ft=dockerfile:
"
4117,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# explicitly set user/group IDs
"
4118,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4119,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4120,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# grab gosu for easy step-down from root
"
4121,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4122,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4123,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4124,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4125,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
4126,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# arches officialy built by upstream
"
4127,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4128,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4129,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4130,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4131,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4132,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4133,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4134,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4135,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4136,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4137,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4138,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4139,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4140,559d29a4f8158c35d6b50870522f532abbabe3e6,/12/Dockerfile," # backwards compat
"
4141,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4142,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
4143,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4144,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"#		krb5-dev \
"
4145,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"#		openldap-dev \
"
4146,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# configure: error: prove not found
"
4147,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4148,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4149,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4150,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4151,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4152,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4153,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4154,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4155,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4156,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4157,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4158,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4159,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4160,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4161,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
4162,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# explicitly set user/group IDs
"
4163,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4164,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4165,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
4166,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4167,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4168,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4169,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
4170,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4171,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
4172,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# arches officialy built by upstream
"
4173,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4174,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4175,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4176,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4177,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4178,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4179,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4180,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4181,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4182,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4183,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4184,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4185,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4186,8b792b8005278fa2349e2c591736b57aa94d7131,/9.6/Dockerfile," # backwards compat
"
4187,c4b019526a25d1300de77b9699d53ad187cf0dcf,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
4188,c4b019526a25d1300de77b9699d53ad187cf0dcf,/Dockerfile-alpine.template,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
4189,c4b019526a25d1300de77b9699d53ad187cf0dcf,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4190,c4b019526a25d1300de77b9699d53ad187cf0dcf,/Dockerfile-alpine.template,"#		krb5-dev \
"
4191,c4b019526a25d1300de77b9699d53ad187cf0dcf,/Dockerfile-alpine.template,"#		openldap-dev \
"
4192,c4b019526a25d1300de77b9699d53ad187cf0dcf,/Dockerfile-alpine.template,"# configure: error: prove not found
"
4193,c4b019526a25d1300de77b9699d53ad187cf0dcf,/Dockerfile-alpine.template,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4194,c4b019526a25d1300de77b9699d53ad187cf0dcf,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4195,c4b019526a25d1300de77b9699d53ad187cf0dcf,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4196,c4b019526a25d1300de77b9699d53ad187cf0dcf,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4197,c4b019526a25d1300de77b9699d53ad187cf0dcf,/Dockerfile-alpine.template,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4198,c4b019526a25d1300de77b9699d53ad187cf0dcf,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4199,c4b019526a25d1300de77b9699d53ad187cf0dcf,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4200,c4b019526a25d1300de77b9699d53ad187cf0dcf,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4201,c4b019526a25d1300de77b9699d53ad187cf0dcf,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4202,c4b019526a25d1300de77b9699d53ad187cf0dcf,/Dockerfile-alpine.template,"#p' --recursive /usr/local \
"
4203,c4b019526a25d1300de77b9699d53ad187cf0dcf,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4204,c4b019526a25d1300de77b9699d53ad187cf0dcf,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
4205,c4b019526a25d1300de77b9699d53ad187cf0dcf,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4206,c4b019526a25d1300de77b9699d53ad187cf0dcf,/Dockerfile-alpine.template,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4207,c4b019526a25d1300de77b9699d53ad187cf0dcf,/Dockerfile-alpine.template," # backwards compat
"
4208,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4209,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4210,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4211,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
4212,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
4213,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
4214,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4215,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
4216,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4217,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4218,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4219,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4220,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4221,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4222,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4223,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4224,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4225,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4226,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4227,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4228,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/alpine/Dockerfile," # backwards compat
"
4229,975f6a2705d981f865a2cb0536a86a46e5839534,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
4230,975f6a2705d981f865a2cb0536a86a46e5839534,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4231,975f6a2705d981f865a2cb0536a86a46e5839534,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4232,975f6a2705d981f865a2cb0536a86a46e5839534,/Dockerfile-alpine.template,"#		krb5-dev \
"
4233,975f6a2705d981f865a2cb0536a86a46e5839534,/Dockerfile-alpine.template,"#		openldap-dev \
"
4234,975f6a2705d981f865a2cb0536a86a46e5839534,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4235,975f6a2705d981f865a2cb0536a86a46e5839534,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4236,975f6a2705d981f865a2cb0536a86a46e5839534,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4237,975f6a2705d981f865a2cb0536a86a46e5839534,/Dockerfile-alpine.template,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4238,975f6a2705d981f865a2cb0536a86a46e5839534,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4239,975f6a2705d981f865a2cb0536a86a46e5839534,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4240,975f6a2705d981f865a2cb0536a86a46e5839534,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4241,975f6a2705d981f865a2cb0536a86a46e5839534,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4242,975f6a2705d981f865a2cb0536a86a46e5839534,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4243,975f6a2705d981f865a2cb0536a86a46e5839534,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
4244,975f6a2705d981f865a2cb0536a86a46e5839534,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4245,975f6a2705d981f865a2cb0536a86a46e5839534,/Dockerfile-alpine.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4246,975f6a2705d981f865a2cb0536a86a46e5839534,/Dockerfile-alpine.template," # backwards compat
"
4247,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
4248,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
4249,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
4250,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4251,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4252,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4253,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4254,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4255,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
4256,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
4257,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4258,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
4259,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4260,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4261,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4262,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4263,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4264,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4265,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4266,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4267,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4268,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4269,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4270,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4271,87202c7e94944885c994cf1454c19a549bb7ac5b,/9.2/alpine/Dockerfile," # backwards compat
"
4272,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4273,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4274,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
4275,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
4276,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4277,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4278,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4279,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4280,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4281,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4282,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4283,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4284,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4285,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4286,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4287,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/alpine/Dockerfile," # backwards compat
"
4288,51e5166d69320581cb707d6fb102d3ba04803400,/8.4/Dockerfile,"# vim:set ft=dockerfile:
"
4289,51e5166d69320581cb707d6fb102d3ba04803400,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
4290,51e5166d69320581cb707d6fb102d3ba04803400,/8.4/Dockerfile,"# grab gosu for easy step-down from root
"
4291,51e5166d69320581cb707d6fb102d3ba04803400,/8.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4292,51e5166d69320581cb707d6fb102d3ba04803400,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4293,51e5166d69320581cb707d6fb102d3ba04803400,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
4294,51e5166d69320581cb707d6fb102d3ba04803400,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
4295,51e5166d69320581cb707d6fb102d3ba04803400,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
4296,51e5166d69320581cb707d6fb102d3ba04803400,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4297,51e5166d69320581cb707d6fb102d3ba04803400,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4298,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
4299,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
4300,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
4301,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4302,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4303,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4304,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4305,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
4306,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
4307,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4308,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4309,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4310,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4311,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4312,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4313,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4314,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4315,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4316,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4317,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4318,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
4319,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
4320,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
4321,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4322,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4323,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4324,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4325,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4326,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"#		krb5-dev \
"
4327,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"#		openldap-dev \
"
4328,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# configure: error: prove not found
"
4329,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4330,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4331,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4332,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4333,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4334,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4335,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4336,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4337,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4338,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4339,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4340,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4341,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4342,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4343,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4344,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4345,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4346,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
4347,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
4348,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4349,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4350,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4351,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4352,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4353,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4354,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4355,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4356,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4357,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4358,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4359,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.6/alpine/Dockerfile," # backwards compat
"
4360,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4361,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4362,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4363,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
4364,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
4365,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
4366,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4367,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4368,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4369,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4370,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4371,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4372,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4373,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4374,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4375,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4376,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4377,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4378,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4379,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4380,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.6/alpine/Dockerfile," # backwards compat
"
4381,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# vim:set ft=dockerfile:
"
4382,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# explicitly set user/group IDs
"
4383,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# grab gosu for easy step-down from root
"
4384,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4385,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4386,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4387,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# arches officialy built by upstream
"
4388,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4389,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4390,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4391,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4392,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4393,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4394,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4395,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4396,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4397,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4398,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4399,cdbe05265f849b028e44c01b942db7055bf37101,/10/Dockerfile," # backwards compat
"
4400,94aee2022d2014230fad3d054c048678137281d1,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
4401,94aee2022d2014230fad3d054c048678137281d1,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
4402,94aee2022d2014230fad3d054c048678137281d1,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
4403,94aee2022d2014230fad3d054c048678137281d1,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4404,94aee2022d2014230fad3d054c048678137281d1,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4405,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
4406,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
4407,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
4408,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4409,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4410,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4411,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4412,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
4413,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
4414,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4415,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4416,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4417,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4418,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4419,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
4420,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
4421,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
4422,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4423,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/Dockerfile-debian.template,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4424,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/Dockerfile-debian.template,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4425,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4426,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/Dockerfile-debian.template,"# arches officialy built by upstream
"
4427,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/Dockerfile-debian.template,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4428,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/Dockerfile-debian.template,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4429,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/Dockerfile-debian.template,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4430,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/Dockerfile-debian.template,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4431,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/Dockerfile-debian.template,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4432,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/Dockerfile-debian.template,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4433,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4434,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/Dockerfile-debian.template,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4435,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
4436,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4437,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/Dockerfile-debian.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4438,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/Dockerfile-debian.template," # backwards compat
"
4439,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# vim:set ft=dockerfile:
"
4440,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# explicitly set user/group IDs
"
4441,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4442,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4443,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# grab gosu for easy step-down from root
"
4444,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4445,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4446,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4447,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4448,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
4449,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# arches officialy built by upstream
"
4450,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4451,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4452,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4453,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4454,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4455,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4456,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4457,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4458,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4459,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4460,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4461,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4462,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4463,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/Dockerfile," # backwards compat
"
4464,9375cde5569bcfbe814a2788d97c1f8f9590e514,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
4465,9375cde5569bcfbe814a2788d97c1f8f9590e514,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4466,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4467,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
4468,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4469,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"#		krb5-dev \
"
4470,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"#		openldap-dev \
"
4471,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# configure: error: prove not found
"
4472,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4473,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4474,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4475,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4476,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4477,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4478,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4479,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4480,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4481,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4482,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4483,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4484,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4485,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4486,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/10/alpine/Dockerfile," # backwards compat
"
4487,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# vim:set ft=dockerfile:
"
4488,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# explicitly set user/group IDs
"
4489,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4490,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4491,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
4492,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4493,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4494,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4495,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
4496,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4497,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
4498,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# arches officialy built by upstream
"
4499,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4500,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4501,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4502,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4503,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4504,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4505,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4506,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4507,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4508,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4509,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4510,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4511,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4512,9f53bdfb953c67bfb030417b5038d78ff162ed2a,/10/Dockerfile," # backwards compat
"
4513,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
4514,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.4/Dockerfile,"# explicitly set user/group IDs
"
4515,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
4516,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4517,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4518,b031aa800308c595624b8d2e43707dbb2861d2f1,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
4519,b031aa800308c595624b8d2e43707dbb2861d2f1,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4520,b031aa800308c595624b8d2e43707dbb2861d2f1,/Dockerfile-alpine.template,"#		krb5-dev \
"
4521,b031aa800308c595624b8d2e43707dbb2861d2f1,/Dockerfile-alpine.template,"#		openldap-dev \
"
4522,b031aa800308c595624b8d2e43707dbb2861d2f1,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4523,b031aa800308c595624b8d2e43707dbb2861d2f1,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4524,b031aa800308c595624b8d2e43707dbb2861d2f1,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4525,b031aa800308c595624b8d2e43707dbb2861d2f1,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4526,b031aa800308c595624b8d2e43707dbb2861d2f1,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4527,b031aa800308c595624b8d2e43707dbb2861d2f1,/Dockerfile-alpine.template,"# tzdata adds around 1Mb to image size, but it is suggested by Django documentation that timezone should be set for performance reasons: http://bit.ly/2fMYhh1
"
4528,b031aa800308c595624b8d2e43707dbb2861d2f1,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
4529,b031aa800308c595624b8d2e43707dbb2861d2f1,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4530,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
4531,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# explicitly set user/group IDs
"
4532,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4533,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4534,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
4535,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4536,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4537,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4538,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4539,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# arches officialy built by upstream
"
4540,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4541,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4542,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4543,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4544,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4545,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4546,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4547,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4548,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4549,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4550,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4551,726128b358cdc0efc1753475bbe502b07cbbb540,/9.6/Dockerfile," # backwards compat
"
4552,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
4553,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
4554,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
4555,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4556,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4557,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
4558,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.5/Dockerfile,"# explicitly set user/group IDs
"
4559,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
4560,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4561,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4562,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
4563,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/Dockerfile,"# explicitly set user/group IDs
"
4564,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
4565,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4566,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4567,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4568,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4569,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4570,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4571,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/Dockerfile," # backwards compat
"
4572,a869eeccfb98c9653fca9f135f3bafa758c6f4f7,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
4573,a869eeccfb98c9653fca9f135f3bafa758c6f4f7,/9.5/Dockerfile,"# explicitly set user/group IDs
"
4574,a869eeccfb98c9653fca9f135f3bafa758c6f4f7,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
4575,a869eeccfb98c9653fca9f135f3bafa758c6f4f7,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4576,a869eeccfb98c9653fca9f135f3bafa758c6f4f7,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4577,a869eeccfb98c9653fca9f135f3bafa758c6f4f7,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4578,a869eeccfb98c9653fca9f135f3bafa758c6f4f7,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4579,a869eeccfb98c9653fca9f135f3bafa758c6f4f7,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4580,a869eeccfb98c9653fca9f135f3bafa758c6f4f7,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4581,a869eeccfb98c9653fca9f135f3bafa758c6f4f7,/9.5/Dockerfile," # backwards compat
"
4582,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
4583,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/Dockerfile,"# explicitly set user/group IDs
"
4584,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
4585,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4586,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4587,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4588,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4589,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4590,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4591,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/Dockerfile," # backwards compat
"
4592,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
4593,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# explicitly set user/group IDs
"
4594,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4595,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4596,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
4597,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4598,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4599,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4600,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4601,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
4602,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# arches officialy built by upstream
"
4603,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4604,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4605,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4606,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4607,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4608,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4609,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4610,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4611,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4612,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4613,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4614,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4615,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4616,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/Dockerfile," # backwards compat
"
4617,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4618,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4619,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4620,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"#		krb5-dev \
"
4621,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"#		openldap-dev \
"
4622,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# configure: error: prove not found
"
4623,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4624,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4625,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4626,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4627,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4628,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4629,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4630,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4631,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4632,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4633,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4634,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4635,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4636,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4637,6f7881a307a7856aa7671260b1f0b690ca51b740,/12/alpine/Dockerfile," # backwards compat
"
4638,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4639,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
4640,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4641,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
4642,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
4643,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
4644,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4645,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4646,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4647,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
4648,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4649,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4650,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4651,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4652,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4653,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4654,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4655,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4656,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4657,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4658,63fb3178b5b2cdaf920454f7e30042e73c01d75f,/9.5/alpine/Dockerfile," # backwards compat
"
4659,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
4660,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# explicitly set user/group IDs
"
4661,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4662,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4663,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
4664,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4665,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4666,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4667,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4668,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
4669,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# arches officialy built by upstream
"
4670,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4671,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4672,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4673,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4674,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4675,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4676,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4677,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4678,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4679,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4680,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4681,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4682,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4683,064113e0e481a1d0542846b81858e457fde02c90,/9.6/Dockerfile," # backwards compat
"
4684,a6d4922823aa8011513bb9c160c26c689301823a,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
4685,a6d4922823aa8011513bb9c160c26c689301823a,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
4686,a6d4922823aa8011513bb9c160c26c689301823a,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
4687,a6d4922823aa8011513bb9c160c26c689301823a,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4688,a6d4922823aa8011513bb9c160c26c689301823a,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4689,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
4690,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
4691,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
4692,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4693,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4694,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4695,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
4696,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4697,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-debian.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4698,54053ad27ac099abff3d4964bf7460fb9c541d5d,/Dockerfile-debian.template," # backwards compat
"
4699,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
4700,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/Dockerfile,"# explicitly set user/group IDs
"
4701,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
4702,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4703,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4704,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4705,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4706,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4707,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4708,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.3/Dockerfile," # backwards compat
"
4709,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
4710,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# explicitly set user/group IDs
"
4711,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
4712,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4713,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4714,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# arches officialy built by upstream
"
4715,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4716,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4717,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4718,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4719,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4720,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4721,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4722,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4723,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4724,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4725,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4726,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.3/Dockerfile," # backwards compat
"
4727,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# vim:set ft=dockerfile:
"
4728,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# explicitly set user/group IDs
"
4729,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4730,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4731,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# grab gosu for easy step-down from root
"
4732,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4733,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4734,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4735,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4736,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
4737,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# arches officialy built by upstream
"
4738,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4739,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4740,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4741,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4742,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4743,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4744,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4745,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4746,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4747,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4748,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4749,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4750,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4751,faf08dbfd0675d144cbdef39f4506425ec7cee26,/10/Dockerfile," # backwards compat
"
4752,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4753,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4754,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4755,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
4756,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
4757,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
4758,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4759,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4760,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4761,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4762,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4763,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4764,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4765,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4766,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4767,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4768,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4769,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4770,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4771,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4772,c6da877bba4184e5e112032f52e36bcabccc6ce8,/9.5/alpine/Dockerfile," # backwards compat
"
4773,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
4774,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
4775,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
4776,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4777,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/Dockerfile-debian.template,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4778,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4779,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/Dockerfile-debian.template,"# arches officialy built by upstream
"
4780,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/Dockerfile-debian.template,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4781,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/Dockerfile-debian.template,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4782,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/Dockerfile-debian.template,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4783,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/Dockerfile-debian.template,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4784,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/Dockerfile-debian.template,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4785,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/Dockerfile-debian.template,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4786,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4787,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/Dockerfile-debian.template,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4788,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
4789,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4790,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/Dockerfile-debian.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4791,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/Dockerfile-debian.template," # backwards compat
"
4792,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# vim:set ft=dockerfile:
"
4793,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# explicitly set user/group IDs
"
4794,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4795,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4796,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
4797,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4798,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4799,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4800,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
4801,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4802,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# see note below about ""*.pyc"" files
"
4803,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# arches officialy built by upstream
"
4804,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4805,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4806,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4807,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# we need DEBIAN_FRONTEND on postgresql-13 for slapd (""Please enter the password for the admin entry in your LDAP directory.""); see https://bugs.debian.org/929417
"
4808,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4809,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4810,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4811,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4812,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4813,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4814,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4815,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4816,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4817,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4818,5e2746f8ff4b94d3b3aa56a6cd7bdbdcd88a1d64,/13/Dockerfile," # backwards compat
"
4819,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
4820,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
4821,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
4822,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4823,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4824,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
4825,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
4826,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
4827,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4828,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4829,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
4830,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.3/Dockerfile,"# explicitly set user/group IDs
"
4831,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
4832,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4833,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4834,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4835,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4836,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4837,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
4838,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# explicitly set user/group IDs
"
4839,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
4840,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4841,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4842,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4843,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# arches officialy built by upstream
"
4844,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4845,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4846,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4847,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4848,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4849,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4850,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4851,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4852,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4853,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
4854,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4855,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.6/Dockerfile," # backwards compat
"
4856,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4857,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4858,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4859,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
4860,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
4861,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
4862,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4863,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4864,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4865,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4866,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4867,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4868,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4869,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4870,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4871,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4872,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4873,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4874,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4875,9d16e9e237b271da39d05d95af24724e79181b19,/9.4/alpine/Dockerfile," # backwards compat
"
4876,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4877,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4878,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
4879,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
4880,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4881,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4882,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4883,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4884,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4885,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4886,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4887,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4888,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4889,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4890,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
4891,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
4892,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4893,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4894,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4895,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4896,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4897,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4898,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4899,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4900,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
4901,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
4902,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
4903,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4904,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
4905,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
4906,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# explicitly set user/group IDs
"
4907,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4908,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4909,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
4910,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4911,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4912,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4913,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4914,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
4915,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# arches officialy built by upstream
"
4916,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4917,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4918,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4919,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4920,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4921,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4922,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4923,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4924,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4925,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4926,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4927,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4928,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4929,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.5/Dockerfile," # backwards compat
"
4930,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4931,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4932,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4933,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
4934,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
4935,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
4936,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4937,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4938,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
4939,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4940,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4941,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4942,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4943,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4944,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4945,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4946,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4947,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4948,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4949,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4950,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4951,f3146f857b42bd4c4cb2be6134149fddee546584,/9.3/alpine/Dockerfile," # backwards compat
"
4952,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
4953,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
4954,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
4955,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
4956,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
4957,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
4958,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
4959,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
4960,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
4961,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
4962,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
4963,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
4964,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
4965,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
4966,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
4967,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
4968,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
4969,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4970,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
4971,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4972,eb1fa8058f1a0c3864713860392d73a1045f0778,/9.5/alpine/Dockerfile," # backwards compat
"
4973,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
4974,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# explicitly set user/group IDs
"
4975,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
4976,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
4977,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
4978,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
4979,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
4980,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
4981,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
4982,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
4983,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
4984,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# arches officialy built by upstream
"
4985,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
4986,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
4987,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
4988,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
4989,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
4990,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
4991,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
4992,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
4993,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
4994,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
4995,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
4996,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
4997,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
4998,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.6/Dockerfile," # backwards compat
"
4999,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
5000,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# explicitly set user/group IDs
"
5001,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
5002,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5003,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5004,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# arches officialy built by upstream
"
5005,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5006,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5007,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5008,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5009,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5010,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5011,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5012,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5013,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5014,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5015,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5016,61e369ce3738e38386fa01ce4809c2304e76257c,/9.4/Dockerfile," # backwards compat
"
5017,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
5018,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5019,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5020,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-alpine.template,"#		krb5-dev \
"
5021,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-alpine.template,"#		openldap-dev \
"
5022,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5023,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5024,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5025,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-alpine.template,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5026,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5027,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5028,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5029,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5030,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5031,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
5032,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5033,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-alpine.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5034,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/Dockerfile-alpine.template," # backwards compat
"
5035,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5036,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5037,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5038,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"#		krb5-dev \
"
5039,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"#		openldap-dev \
"
5040,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# configure: error: prove not found
"
5041,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5042,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5043,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5044,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5045,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5046,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5047,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5048,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5049,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5050,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5051,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5052,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5053,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5054,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5055,6dfdc0eacba0ae39b837df5eef63f89f13556e50,/11/alpine/Dockerfile," # backwards compat
"
5056,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# vim:set ft=dockerfile:
"
5057,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# explicitly set user/group IDs
"
5058,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
5059,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
5060,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# grab gosu for easy step-down from root
"
5061,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5062,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5063,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
5064,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5065,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
5066,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# arches officialy built by upstream
"
5067,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5068,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
5069,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5070,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5071,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5072,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5073,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5074,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5075,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5076,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
5077,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5078,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
5079,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5080,59fd787a41ba4fd042f4d169556e70927c323cda,/10/Dockerfile," # backwards compat
"
5081,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# vim:set ft=dockerfile:
"
5082,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# explicitly set user/group IDs
"
5083,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
5084,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
5085,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# grab gosu for easy step-down from root
"
5086,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5087,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5088,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
5089,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5090,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
5091,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# arches officialy built by upstream
"
5092,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5093,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
5094,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5095,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5096,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5097,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5098,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5099,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5100,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5101,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
5102,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5103,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
5104,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5105,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/10/Dockerfile," # backwards compat
"
5106,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
5107,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5108,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
5109,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5110,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5111,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
5112,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/Dockerfile,"# explicitly set user/group IDs
"
5113,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
5114,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5115,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5116,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5117,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5118,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5119,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5120,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5121,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5122,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
5123,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
5124,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
5125,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5126,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5127,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5128,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5129,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5130,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5131,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5132,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5133,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5134,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5135,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5136,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5137,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5138,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5139,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.5/alpine/Dockerfile," # backwards compat
"
5140,63d966973d9593c0d9890b96f10ac73566913520,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
5141,63d966973d9593c0d9890b96f10ac73566913520,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5142,63d966973d9593c0d9890b96f10ac73566913520,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
5143,63d966973d9593c0d9890b96f10ac73566913520,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5144,63d966973d9593c0d9890b96f10ac73566913520,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5145,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5146,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5147,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5148,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
5149,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
5150,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
5151,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5152,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5153,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5154,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5155,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5156,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5157,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5158,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5159,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5160,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5161,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5162,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5163,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5164,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5165,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.5/alpine/Dockerfile," # backwards compat
"
5166,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5167,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5168,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5169,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
5170,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
5171,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
5172,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5173,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5174,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5175,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5176,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5177,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5178,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5179,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5180,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5181,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5182,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5183,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5184,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5185,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5186,4b652bf95baee9cd7ef31300a4938ad72d09ad88,/9.4/alpine/Dockerfile," # backwards compat
"
5187,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/8.4/Dockerfile,"# vim:set ft=dockerfile:
"
5188,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5189,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/8.4/Dockerfile,"# grab gosu for easy step-down from root
"
5190,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/8.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5191,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5192,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
5193,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# explicitly set user/group IDs
"
5194,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
5195,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
5196,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
5197,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5198,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5199,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
5200,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
5201,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5202,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
5203,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# arches officialy built by upstream
"
5204,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5205,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
5206,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5207,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5208,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5209,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5210,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5211,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5212,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5213,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
5214,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5215,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
5216,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5217,7ea20406a8b723e9766cd436b625356e04e33092,/9.5/Dockerfile," # backwards compat
"
5218,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5219,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5220,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5221,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
5222,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
5223,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# configure: error: prove not found
"
5224,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5225,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5226,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
5227,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5228,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5229,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5230,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5231,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5232,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5233,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5234,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5235,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5236,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5237,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5238,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5239,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5240,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.2/alpine/Dockerfile," # backwards compat
"
5241,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5242,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5243,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5244,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
5245,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
5246,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
5247,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5248,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5249,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5250,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5251,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5252,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5253,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5254,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5255,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5256,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5257,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5258,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5259,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5260,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5261,122fb0bdcc8058166d7535d30724278efbe41e86,/9.6/alpine/Dockerfile," # backwards compat
"
5262,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
5263,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# explicitly set user/group IDs
"
5264,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
5265,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5266,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5267,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# arches officialy built by upstream
"
5268,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5269,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5270,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5271,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5272,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5273,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5274,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5275,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5276,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5277,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5278,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5279,f4aa86c49b4691ea2e23934a419538df187a7f57,/9.5/Dockerfile," # backwards compat
"
5280,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5281,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
5282,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5283,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"#		krb5-dev \
"
5284,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"#		openldap-dev \
"
5285,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# configure: error: prove not found
"
5286,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5287,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5288,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5289,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5290,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5291,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5292,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5293,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5294,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5295,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5296,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5297,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5298,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5299,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5300,0de8bbbcdcdd7783acb7ce2678c85d5aab977c55,/11/alpine/Dockerfile," # backwards compat
"
5301,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5302,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5303,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5304,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
5305,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
5306,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
5307,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5308,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5309,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5310,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5311,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5312,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5313,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5314,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5315,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5316,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5317,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5318,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5319,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5320,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5321,5673b8988b3d411f0ba6b9e73e48cf6986cc959d,/9.6/alpine/Dockerfile," # backwards compat
"
5322,c6d76847c03ff9bc95ab11ebac769cf24e163ca6,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
5323,c6d76847c03ff9bc95ab11ebac769cf24e163ca6,/9.6/Dockerfile,"# explicitly set user/group IDs
"
5324,c6d76847c03ff9bc95ab11ebac769cf24e163ca6,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
5325,c6d76847c03ff9bc95ab11ebac769cf24e163ca6,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5326,c6d76847c03ff9bc95ab11ebac769cf24e163ca6,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5327,c6d76847c03ff9bc95ab11ebac769cf24e163ca6,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5328,c6d76847c03ff9bc95ab11ebac769cf24e163ca6,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5329,c6d76847c03ff9bc95ab11ebac769cf24e163ca6,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5330,c6d76847c03ff9bc95ab11ebac769cf24e163ca6,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5331,c6d76847c03ff9bc95ab11ebac769cf24e163ca6,/9.6/Dockerfile," # backwards compat
"
5332,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5333,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5334,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5335,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
5336,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
5337,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
5338,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5339,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5340,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5341,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5342,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5343,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5344,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5345,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5346,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5347,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5348,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5349,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5350,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5351,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5352,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/alpine/Dockerfile," # backwards compat
"
5353,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
5354,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
5355,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
5356,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5357,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5358,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-debian.template,"# arches officialy built by upstream
"
5359,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-debian.template,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5360,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-debian.template,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5361,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-debian.template,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5362,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-debian.template,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5363,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-debian.template,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5364,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-debian.template,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5365,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5366,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-debian.template,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5367,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
5368,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5369,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-debian.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5370,f7dc5727b1d6b6a636350e11648845ae33477579,/Dockerfile-debian.template," # backwards compat
"
5371,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5372,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5373,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5374,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
5375,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
5376,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
5377,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5378,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5379,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5380,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5381,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5382,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5383,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5384,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5385,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5386,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5387,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5388,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5389,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5390,f3146f857b42bd4c4cb2be6134149fddee546584,/9.4/alpine/Dockerfile," # backwards compat
"
5391,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
5392,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.4/Dockerfile,"# explicitly set user/group IDs
"
5393,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
5394,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5395,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5396,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5397,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5398,77b5f005d45f4b0747f5a719f329499b6ad454dc,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5399,77b5f005d45f4b0747f5a719f329499b6ad454dc,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5400,ea490430aabd553f34656e8f0e846d2ed3c42930,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5401,ea490430aabd553f34656e8f0e846d2ed3c42930,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5402,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
5403,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/Dockerfile-alpine.template,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
5404,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5405,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/Dockerfile-alpine.template,"#		krb5-dev \
"
5406,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/Dockerfile-alpine.template,"#		openldap-dev \
"
5407,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/Dockerfile-alpine.template,"# configure: error: prove not found
"
5408,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/Dockerfile-alpine.template,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5409,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5410,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5411,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5412,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/Dockerfile-alpine.template,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5413,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5414,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5415,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5416,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5417,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/Dockerfile-alpine.template,"#p' --recursive /usr/local \
"
5418,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5419,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
5420,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5421,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/Dockerfile-alpine.template,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5422,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/Dockerfile-alpine.template," # backwards compat
"
5423,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5424,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5425,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5426,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5427,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5428,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
5429,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
5430,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
5431,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5432,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5433,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5434,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5435,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5436,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5437,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5438,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5439,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5440,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5441,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5442,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5443,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5444,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5445,db452338a99764f0141aae60f7267a58f665e6b7,/9.5/alpine/Dockerfile," # backwards compat
"
5446,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
5447,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/Dockerfile,"# explicitly set user/group IDs
"
5448,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
5449,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5450,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5451,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5452,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5453,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5454,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5455,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5456,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
5457,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
5458,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5459,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5460,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5461,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5462,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5463,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5464,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5465,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5466,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5467,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5468,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5469,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"#		krb5-dev \
"
5470,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"#		openldap-dev \
"
5471,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# configure: error: prove not found
"
5472,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5473,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5474,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5475,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5476,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5477,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5478,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5479,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5480,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5481,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5482,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5483,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5484,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5485,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5486,60db3b9da9c3a83057daee618d47864ac271bebf,/10/alpine/Dockerfile," # backwards compat
"
5487,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5488,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5489,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5490,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"#		krb5-dev \
"
5491,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"#		openldap-dev \
"
5492,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# configure: error: prove not found
"
5493,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5494,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5495,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5496,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5497,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5498,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5499,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5500,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5501,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5502,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5503,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5504,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5505,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5506,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5507,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/10/alpine/Dockerfile," # backwards compat
"
5508,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
5509,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# explicitly set user/group IDs
"
5510,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
5511,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5512,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5513,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# arches officialy built by upstream
"
5514,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5515,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5516,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5517,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5518,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5519,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5520,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5521,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5522,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5523,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5524,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5525,4af033ebfe50d33214c32be78c52f2693769fb14,/9.3/Dockerfile," # backwards compat
"
5526,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# vim:set ft=dockerfile:
"
5527,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# explicitly set user/group IDs
"
5528,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# grab gosu for easy step-down from root
"
5529,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5530,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5531,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
5532,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5533,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# arches officialy built by upstream
"
5534,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5535,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5536,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5537,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5538,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5539,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5540,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5541,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5542,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5543,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5544,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5545,635fd0bcb3ababc96871c9da52f10743fbae4742,/10/Dockerfile," # backwards compat
"
5546,96498cc9b353adf67b8bada27b4aaf1fde858bd8,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
5547,96498cc9b353adf67b8bada27b4aaf1fde858bd8,/9.4/Dockerfile,"# explicitly set user/group IDs
"
5548,96498cc9b353adf67b8bada27b4aaf1fde858bd8,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
5549,96498cc9b353adf67b8bada27b4aaf1fde858bd8,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5550,96498cc9b353adf67b8bada27b4aaf1fde858bd8,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5551,96498cc9b353adf67b8bada27b4aaf1fde858bd8,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5552,96498cc9b353adf67b8bada27b4aaf1fde858bd8,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5553,96498cc9b353adf67b8bada27b4aaf1fde858bd8,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5554,96498cc9b353adf67b8bada27b4aaf1fde858bd8,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5555,96498cc9b353adf67b8bada27b4aaf1fde858bd8,/9.4/Dockerfile," # backwards compat
"
5556,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5557,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5558,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5559,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"#		krb5-dev \
"
5560,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"#		openldap-dev \
"
5561,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# configure: error: prove not found
"
5562,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5563,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5564,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5565,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5566,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5567,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5568,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5569,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5570,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5571,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5572,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5573,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5574,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5575,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5576,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/11/alpine/Dockerfile," # backwards compat
"
5577,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5578,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5579,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5580,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"#		krb5-dev \
"
5581,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"#		openldap-dev \
"
5582,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# configure: error: prove not found
"
5583,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5584,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5585,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5586,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5587,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5588,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5589,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5590,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5591,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5592,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5593,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5594,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5595,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5596,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5597,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/11/alpine/Dockerfile," # backwards compat
"
5598,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# vim:set ft=dockerfile:
"
5599,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# explicitly set user/group IDs
"
5600,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# grab gosu for easy step-down from root
"
5601,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5602,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5603,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# arches officialy built by upstream
"
5604,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5605,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5606,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5607,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5608,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5609,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5610,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5611,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5612,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5613,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5614,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5615,f7dc5727b1d6b6a636350e11648845ae33477579,/10/Dockerfile," # backwards compat
"
5616,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
5617,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.4/Dockerfile,"# explicitly set user/group IDs
"
5618,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
5619,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5620,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5621,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5622,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5623,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
5624,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# explicitly set user/group IDs
"
5625,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
5626,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
5627,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
5628,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5629,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5630,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
5631,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5632,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
5633,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# arches officialy built by upstream
"
5634,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5635,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
5636,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5637,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5638,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5639,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5640,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5641,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5642,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5643,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
5644,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5645,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
5646,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5647,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.5/Dockerfile," # backwards compat
"
5648,e677b561722c7cc9fc8181bb29cebe5f7c96c6e8,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
5649,e677b561722c7cc9fc8181bb29cebe5f7c96c6e8,/9.5/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5650,e677b561722c7cc9fc8181bb29cebe5f7c96c6e8,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
5651,e677b561722c7cc9fc8181bb29cebe5f7c96c6e8,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5652,e677b561722c7cc9fc8181bb29cebe5f7c96c6e8,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5653,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
5654,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5655,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
5656,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5657,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5658,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# vim:set ft=dockerfile:
"
5659,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# explicitly set user/group IDs
"
5660,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
5661,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
5662,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# grab gosu for easy step-down from root
"
5663,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5664,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5665,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
5666,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5667,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# arches officialy built by upstream
"
5668,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5669,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5670,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5671,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5672,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5673,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5674,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5675,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5676,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5677,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5678,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5679,726128b358cdc0efc1753475bbe502b07cbbb540,/11/Dockerfile," # backwards compat
"
5680,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5681,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5682,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5683,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
5684,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
5685,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
5686,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5687,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5688,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5689,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5690,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5691,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5692,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5693,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5694,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5695,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5696,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5697,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5698,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5699,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5700,bcfe8611162fb6b9a7190f85e9ae337eeb1057ad,/9.6/alpine/Dockerfile," # backwards compat
"
5701,80ebeda0a68be6a8b10ce0de1846a49228af0795,/Dockerfile.template,"# vim:set ft=dockerfile:
"
5702,80ebeda0a68be6a8b10ce0de1846a49228af0795,/Dockerfile.template,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
5703,80ebeda0a68be6a8b10ce0de1846a49228af0795,/Dockerfile.template,"# grab gosu for easy step-down from root
"
5704,80ebeda0a68be6a8b10ce0de1846a49228af0795,/Dockerfile.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5705,80ebeda0a68be6a8b10ce0de1846a49228af0795,/Dockerfile.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5706,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
5707,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# explicitly set user/group IDs
"
5708,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
5709,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5710,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5711,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5712,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# arches officialy built by upstream
"
5713,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5714,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5715,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5716,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5717,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5718,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5719,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5720,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5721,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5722,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5723,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5724,2534f4526aab1a378096e78a0052baeee88441b5,/9.4/Dockerfile," # backwards compat
"
5725,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5726,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
5727,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5728,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
5729,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
5730,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
5731,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5732,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5733,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5734,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5735,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5736,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5737,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5738,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5739,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5740,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5741,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5742,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5743,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5744,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5745,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.6/alpine/Dockerfile," # backwards compat
"
5746,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5747,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5748,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5749,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"#		krb5-dev \
"
5750,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"#		openldap-dev \
"
5751,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# configure: error: prove not found
"
5752,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5753,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5754,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5755,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5756,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5757,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5758,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5759,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5760,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5761,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5762,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5763,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5764,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5765,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5766,112bf5ee8455f930354bc90f32d6a1c830525ed9,/11/alpine/Dockerfile," # backwards compat
"
5767,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# vim:set ft=dockerfile:
"
5768,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# explicitly set user/group IDs
"
5769,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
5770,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
5771,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
5772,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5773,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5774,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
5775,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
5776,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5777,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# see note below about ""*.pyc"" files
"
5778,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# arches officialy built by upstream
"
5779,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5780,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
5781,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5782,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5783,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5784,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5785,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5786,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5787,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5788,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
5789,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5790,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
5791,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5792,b96659493b841100dc75ed777bff01913d9fe9e1,/13/Dockerfile," # backwards compat
"
5793,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5794,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5795,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5796,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"#		krb5-dev \
"
5797,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"#		openldap-dev \
"
5798,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# configure: error: prove not found
"
5799,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5800,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5801,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5802,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5803,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5804,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5805,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5806,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5807,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5808,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5809,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5810,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5811,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5812,26a1e84f0e95b43fa47e879e9fd000c9a68982e1,/10/alpine/Dockerfile," # backwards compat
"
5813,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5814,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5815,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
5816,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
5817,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5818,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5819,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5820,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5821,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5822,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
5823,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5824,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/Dockerfile-alpine.template,"#		krb5-dev \
"
5825,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/Dockerfile-alpine.template,"#		openldap-dev \
"
5826,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5827,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5828,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5829,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5830,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5831,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/Dockerfile-alpine.template,"# tzdata loading functionality is optional, and fails gracefully
#		tzdata \
"
5832,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
5833,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5834,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
5835,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
5836,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
5837,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5838,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5839,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5840,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
5841,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5842,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-debian.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5843,d8abce4e82533aa2673da9ba9a5a8385589ed693,/Dockerfile-debian.template," # backwards compat
"
5844,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# vim:set ft=dockerfile:
"
5845,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# explicitly set user/group IDs
"
5846,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# grab gosu for easy step-down from root
"
5847,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5848,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
5849,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5850,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# arches officialy built by upstream
"
5851,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5852,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5853,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5854,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5855,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5856,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5857,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5858,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5859,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5860,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5861,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5862,de8ba87d50de466a1e05e111927d2bc30c2db36d,/10/Dockerfile," # backwards compat
"
5863,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
5864,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.3/Dockerfile,"# explicitly set user/group IDs
"
5865,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
5866,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5867,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5868,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5869,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5870,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5871,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
5872,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5873,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"#		krb5-dev \
"
5874,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"#		openldap-dev \
"
5875,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# configure: error: prove not found
"
5876,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5877,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5878,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5879,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
5880,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5881,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5882,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5883,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5884,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5885,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5886,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5887,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5888,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5889,1bddd083582b0977075dda4258f2d9dfbc90482b,/13/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5890,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5891,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5892,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
5893,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
5894,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5895,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5896,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5897,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5898,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5899,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5900,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5901,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5902,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5903,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5904,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5905,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.4/alpine/Dockerfile," # backwards compat
"
5906,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
5907,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.1/Dockerfile,"# explicitly set user/group IDs
"
5908,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
5909,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5910,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
5911,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5912,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5913,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5914,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
5915,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
5916,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5917,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
5918,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5919,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5920,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5921,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5922,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5923,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5924,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5925,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5926,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5927,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5928,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5929,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5930,9ff1e6fb304f67eb3b6d946000c69838324dc693,/9.3/alpine/Dockerfile," # backwards compat
"
5931,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5932,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5933,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
5934,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
5935,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5936,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5937,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5938,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5939,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5940,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5941,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5942,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5943,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5944,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5945,3706d4c4562c284ed070286b9fd516151167a40c,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5946,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# vim:set ft=dockerfile:
"
5947,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# explicitly set user/group IDs
"
5948,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# grab gosu for easy step-down from root
"
5949,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
5950,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
5951,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# arches officialy built by upstream
"
5952,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
5953,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
5954,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
5955,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
5956,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
5957,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
5958,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
5959,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
5960,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5961,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
5962,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5963,3b022607bec233463a3d055731fb710837978747,/10/Dockerfile," # backwards compat
"
5964,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5965,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
5966,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5967,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
5968,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
5969,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
5970,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5971,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5972,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5973,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5974,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5975,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5976,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5977,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5978,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
5979,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
5980,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
5981,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
5982,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/alpine/Dockerfile," # backwards compat
"
5983,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
5984,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
5985,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
5986,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"#		krb5-dev \
"
5987,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"#		openldap-dev \
"
5988,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# configure: error: prove not found
"
5989,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
5990,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
5991,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
5992,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
5993,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
5994,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
5995,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
5996,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
5997,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
5998,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
5999,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6000,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6001,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6002,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6003,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/11/alpine/Dockerfile," # backwards compat
"
6004,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
6005,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# explicitly set user/group IDs
"
6006,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
6007,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6008,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6009,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6010,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# arches officialy built by upstream
"
6011,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6012,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6013,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6014,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6015,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6016,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6017,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6018,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6019,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6020,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6021,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6022,d545428bfe50f634b4aa9114eff0c5efe1d72f94,/9.5/Dockerfile," # backwards compat
"
6023,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6024,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
6025,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6026,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
6027,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
6028,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
6029,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6030,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6031,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6032,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6033,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6034,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6035,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6036,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6037,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6038,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6039,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6040,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6041,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6042,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6043,5104b38a3a159aad42014d69b3ba1a0c4d22ca4d,/9.5/alpine/Dockerfile," # backwards compat
"
6044,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# vim:set ft=dockerfile:
"
6045,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# explicitly set user/group IDs
"
6046,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# grab gosu for easy step-down from root
"
6047,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6048,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6049,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# arches officialy built by upstream
"
6050,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6051,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6052,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6053,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6054,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6055,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6056,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6057,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6058,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6059,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6060,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6061,674466e0d47517f4e05ec2025ae996e71b26cae9,/10/Dockerfile," # backwards compat
"
6062,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
6063,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# explicitly set user/group IDs
"
6064,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
6065,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
6066,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
6067,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6068,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6069,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6070,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
6071,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6072,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
6073,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# arches officialy built by upstream
"
6074,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6075,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
6076,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6077,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6078,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6079,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6080,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6081,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6082,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6083,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
6084,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6085,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
6086,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6087,23fb6d25d168890aa4499b066306849e43936efa,/9.6/Dockerfile," # backwards compat
"
6088,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
6089,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/Dockerfile-alpine.template,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
6090,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6091,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/Dockerfile-alpine.template,"#		krb5-dev \
"
6092,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/Dockerfile-alpine.template,"#		openldap-dev \
"
6093,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/Dockerfile-alpine.template,"# configure: error: prove not found
"
6094,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/Dockerfile-alpine.template,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6095,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6096,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6097,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6098,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/Dockerfile-alpine.template,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6099,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6100,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6101,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6102,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6103,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/Dockerfile-alpine.template,"#p' --recursive /usr/local \
"
6104,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6105,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
6106,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6107,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/Dockerfile-alpine.template,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6108,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/Dockerfile-alpine.template," # backwards compat
"
6109,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
6110,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# explicitly set user/group IDs
"
6111,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
6112,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6113,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6114,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# arches officialy built by upstream
"
6115,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6116,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6117,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6118,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6119,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6120,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6121,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6122,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6123,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6124,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6125,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6126,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/Dockerfile," # backwards compat
"
6127,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6128,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6129,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6130,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"#		krb5-dev \
"
6131,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"#		openldap-dev \
"
6132,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# configure: error: prove not found
"
6133,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6134,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6135,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6136,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6137,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6138,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6139,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6140,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6141,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6142,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6143,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6144,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6145,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6146,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6147,ad464b0375fc64e70e01305bf93183428a2ef0ec,/11/alpine/Dockerfile," # backwards compat
"
6148,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6149,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6150,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
6151,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
6152,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6153,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6154,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6155,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6156,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6157,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"# tzdata adds around 1Mb to image size, but it is suggested by Django documentation that timezone should be set for performance reasons: http://bit.ly/2fMYhh1
"
6158,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6159,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6160,972294a377463156c8d61297320c872fc7d370a9,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
6161,972294a377463156c8d61297320c872fc7d370a9,/9.3/Dockerfile,"# explicitly set user/group IDs
"
6162,972294a377463156c8d61297320c872fc7d370a9,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
6163,972294a377463156c8d61297320c872fc7d370a9,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6164,972294a377463156c8d61297320c872fc7d370a9,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6165,972294a377463156c8d61297320c872fc7d370a9,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6166,972294a377463156c8d61297320c872fc7d370a9,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6167,972294a377463156c8d61297320c872fc7d370a9,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6168,972294a377463156c8d61297320c872fc7d370a9,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6169,972294a377463156c8d61297320c872fc7d370a9,/9.3/Dockerfile," # backwards compat
"
6170,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6171,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6172,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
6173,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
6174,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6175,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6176,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6177,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6178,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6179,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6180,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6181,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6182,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6183,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6184,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6185,a3b8f2bf53b603713ad84344e0cfc79587507d4b,/9.3/alpine/Dockerfile," # backwards compat
"
6186,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6187,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
6188,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6189,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"#		krb5-dev \
"
6190,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"#		openldap-dev \
"
6191,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# configure: error: prove not found
"
6192,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6193,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6194,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6195,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6196,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6197,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6198,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6199,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6200,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6201,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6202,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6203,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6204,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6205,c4b019526a25d1300de77b9699d53ad187cf0dcf,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6206,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6207,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
6208,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6209,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"#		krb5-dev \
"
6210,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"#		openldap-dev \
"
6211,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# configure: error: prove not found
"
6212,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6213,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6214,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6215,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6216,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6217,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6218,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6219,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6220,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6221,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6222,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6223,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6224,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6225,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6226,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6227,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
6228,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6229,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
6230,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
6231,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
6232,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6233,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6234,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6235,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6236,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6237,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6238,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6239,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6240,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6241,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6242,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6243,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6244,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6245,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6246,33e66cdc27fb5558266b52658c081226d2272995,/9.5/alpine/Dockerfile," # backwards compat
"
6247,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6248,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6249,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6250,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
6251,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
6252,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
6253,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6254,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6255,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
6256,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6257,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6258,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6259,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6260,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6261,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6262,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6263,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6264,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6265,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6266,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6267,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6268,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6269,ea2860a21672636bed769e694f6af33f83270fda,/9.3/alpine/Dockerfile," # backwards compat
"
6270,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# vim:set ft=dockerfile:
"
6271,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# explicitly set user/group IDs
"
6272,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# grab gosu for easy step-down from root
"
6273,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6274,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6275,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6276,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6277,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# arches officialy built by upstream
"
6278,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6279,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6280,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6281,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6282,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6283,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6284,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6285,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6286,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6287,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6288,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6289,5d0b6adfd8c4b967d9fbbdc0fb96c869fcaba4f0,/11/Dockerfile," # backwards compat
"
6290,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6291,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6292,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6293,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"#		krb5-dev \
"
6294,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"#		openldap-dev \
"
6295,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# configure: error: prove not found
"
6296,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6297,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6298,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6299,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6300,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6301,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6302,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6303,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6304,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6305,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6306,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6307,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6308,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6309,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6310,1089a8971b43a675109ad886bf1f3b327c067fa1,/10/alpine/Dockerfile," # backwards compat
"
6311,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# vim:set ft=dockerfile:
"
6312,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# explicitly set user/group IDs
"
6313,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# grab gosu for easy step-down from root
"
6314,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6315,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6316,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# arches officialy built by upstream
"
6317,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6318,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6319,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6320,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6321,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6322,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6323,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6324,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6325,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6326,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6327,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6328,f34b7cb79c4209a67b573f3bc4bc7827d69800e1,/10/Dockerfile," # backwards compat
"
6329,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
6330,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# explicitly set user/group IDs
"
6331,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
6332,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6333,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6334,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# arches officialy built by upstream
"
6335,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6336,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6337,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6338,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6339,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6340,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6341,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6342,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6343,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6344,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6345,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6346,3b022607bec233463a3d055731fb710837978747,/9.5/Dockerfile," # backwards compat
"
6347,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6348,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
6349,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6350,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"#		krb5-dev \
"
6351,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"#		openldap-dev \
"
6352,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# configure: error: prove not found
"
6353,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6354,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6355,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6356,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6357,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6358,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6359,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6360,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6361,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6362,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6363,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6364,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6365,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6366,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6367,52814abac491eca146620f921a44e2cb4217088e,/11/alpine/Dockerfile," # backwards compat
"
6368,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# vim:set ft=dockerfile:
"
6369,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# explicitly set user/group IDs
"
6370,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
6371,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
6372,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# grab gosu for easy step-down from root
"
6373,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6374,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6375,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6376,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6377,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
6378,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# arches officialy built by upstream
"
6379,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6380,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
6381,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6382,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6383,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6384,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6385,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6386,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6387,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6388,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
6389,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6390,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
6391,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6392,10fe2ae44bfcc7e26d05e898f3baf3a019c82dd7,/12/Dockerfile," # backwards compat
"
6393,7fed4298db2dc8fb86844a1a41c86f4356f5f45b,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
6394,7fed4298db2dc8fb86844a1a41c86f4356f5f45b,/9.5/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
6395,7fed4298db2dc8fb86844a1a41c86f4356f5f45b,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
6396,7fed4298db2dc8fb86844a1a41c86f4356f5f45b,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6397,7fed4298db2dc8fb86844a1a41c86f4356f5f45b,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6398,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6399,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6400,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
6401,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
6402,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6403,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6404,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6405,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6406,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6407,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6408,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6409,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6410,5992d8be755d8001474f737a44c73049c519cff3,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
6411,5992d8be755d8001474f737a44c73049c519cff3,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6412,5992d8be755d8001474f737a44c73049c519cff3,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6413,5992d8be755d8001474f737a44c73049c519cff3,/Dockerfile-alpine.template,"#		krb5-dev \
"
6414,5992d8be755d8001474f737a44c73049c519cff3,/Dockerfile-alpine.template,"#		openldap-dev \
"
6415,5992d8be755d8001474f737a44c73049c519cff3,/Dockerfile-alpine.template,"# configure: error: prove not found
"
6416,5992d8be755d8001474f737a44c73049c519cff3,/Dockerfile-alpine.template,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6417,5992d8be755d8001474f737a44c73049c519cff3,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6418,5992d8be755d8001474f737a44c73049c519cff3,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6419,5992d8be755d8001474f737a44c73049c519cff3,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6420,5992d8be755d8001474f737a44c73049c519cff3,/Dockerfile-alpine.template,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6421,5992d8be755d8001474f737a44c73049c519cff3,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6422,5992d8be755d8001474f737a44c73049c519cff3,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6423,5992d8be755d8001474f737a44c73049c519cff3,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6424,5992d8be755d8001474f737a44c73049c519cff3,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6425,5992d8be755d8001474f737a44c73049c519cff3,/Dockerfile-alpine.template,"#p' --recursive /usr/local \
"
6426,5992d8be755d8001474f737a44c73049c519cff3,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6427,5992d8be755d8001474f737a44c73049c519cff3,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
6428,5992d8be755d8001474f737a44c73049c519cff3,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6429,5992d8be755d8001474f737a44c73049c519cff3,/Dockerfile-alpine.template,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6430,5992d8be755d8001474f737a44c73049c519cff3,/Dockerfile-alpine.template," # backwards compat
"
6431,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/Dockerfile.template,"# vim:set ft=dockerfile:
"
6432,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/Dockerfile.template,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
6433,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/Dockerfile.template,"# grab gosu for easy step-down from root
"
6434,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/Dockerfile.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6435,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/Dockerfile.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6436,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
6437,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# explicitly set user/group IDs
"
6438,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
6439,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
6440,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
6441,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6442,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6443,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6444,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
6445,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6446,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
6447,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# arches officialy built by upstream
"
6448,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6449,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
6450,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6451,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6452,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6453,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6454,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6455,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6456,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6457,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
6458,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6459,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
6460,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6461,fa4482cec89b300589c30fc5590995a31f569a06,/9.5/Dockerfile," # backwards compat
"
6462,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6463,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
6464,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6465,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"#		krb5-dev \
"
6466,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"#		openldap-dev \
"
6467,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# configure: error: prove not found
"
6468,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6469,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6470,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6471,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
6472,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6473,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6474,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6475,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6476,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6477,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6478,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6479,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6480,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6481,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6482,a5a072f08ad5499961875b7dd441e1b8ee8b4600,/11/alpine/Dockerfile," # backwards compat
"
6483,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# vim:set ft=dockerfile:
"
6484,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# explicitly set user/group IDs
"
6485,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
6486,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
6487,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# grab gosu for easy step-down from root
"
6488,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6489,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6490,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6491,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
6492,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6493,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
6494,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# arches officialy built by upstream
"
6495,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6496,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
6497,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6498,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6499,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6500,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6501,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6502,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6503,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6504,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
6505,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6506,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
6507,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6508,4f70bf2b811bcdb4ab1a015ef703373226452157,/11/Dockerfile," # backwards compat
"
6509,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6510,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6511,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6512,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
6513,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
6514,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
6515,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6516,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6517,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6518,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6519,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6520,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6521,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6522,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6523,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6524,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6525,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6526,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6527,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6528,9e862fa9b1d510c618d51e5d2c63f439d15381ff,/9.5/alpine/Dockerfile," # backwards compat
"
6529,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6530,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6531,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6532,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
6533,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
6534,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
6535,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6536,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6537,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6538,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6539,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6540,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6541,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6542,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6543,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6544,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6545,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6546,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6547,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6548,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6549,d564da5142b2e5fa235707b05d8aa0fc76250418,/9.4/alpine/Dockerfile," # backwards compat
"
6550,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
6551,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# explicitly set user/group IDs
"
6552,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
6553,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6554,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6555,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6556,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# arches officialy built by upstream
"
6557,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6558,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6559,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6560,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6561,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6562,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6563,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6564,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6565,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6566,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6567,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6568,253471cd5c62c48867640bcb925ffad19a24d5d9,/9.3/Dockerfile," # backwards compat
"
6569,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6570,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6571,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6572,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"#		krb5-dev \
"
6573,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"#		openldap-dev \
"
6574,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# configure: error: prove not found
"
6575,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6576,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6577,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6578,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6579,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6580,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6581,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6582,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6583,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6584,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6585,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6586,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6587,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6588,662b2e6eb359221f132b5879e3cf65a4805ce428,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6589,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6590,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6591,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6592,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
6593,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
6594,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6595,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
6596,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6597,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6598,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6599,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6600,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6601,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6602,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6603,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6604,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6605,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6606,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6607,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6608,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.2/alpine/Dockerfile," # backwards compat
"
6609,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
6610,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
6611,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
6612,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6613,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6614,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
6615,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.3/Dockerfile,"# explicitly set user/group IDs
"
6616,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
6617,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6618,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6619,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# vim:set ft=dockerfile:
"
6620,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# explicitly set user/group IDs
"
6621,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
6622,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
6623,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# grab gosu for easy step-down from root
"
6624,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6625,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6626,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6627,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6628,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
6629,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# arches officialy built by upstream
"
6630,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6631,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
6632,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6633,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6634,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6635,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6636,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6637,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6638,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6639,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
6640,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6641,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
6642,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6643,b0251ccc21fa63851cb051458c669fbf37d26227,/12/Dockerfile," # backwards compat
"
6644,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6645,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6646,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6647,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"#		krb5-dev \
"
6648,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"#		openldap-dev \
"
6649,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# configure: error: prove not found
"
6650,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6651,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6652,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6653,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6654,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6655,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6656,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6657,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6658,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6659,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6660,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6661,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6662,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6663,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6664,6c3b27f1433ad81675afb386a182098dc867e3e8,/11/alpine/Dockerfile," # backwards compat
"
6665,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6666,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6667,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6668,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
6669,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
6670,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6671,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6672,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6673,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6674,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6675,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6676,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6677,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6678,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6679,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6680,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6681,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6682,975f6a2705d981f865a2cb0536a86a46e5839534,/9.5/alpine/Dockerfile," # backwards compat
"
6683,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6684,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6685,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6686,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
6687,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
6688,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6689,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6690,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6691,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6692,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6693,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6694,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6695,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6696,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6697,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6698,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6699,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.4/alpine/Dockerfile," # backwards compat
"
6700,106e9e56fea3ad34a8bf3e66d3a041d491788552,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
6701,106e9e56fea3ad34a8bf3e66d3a041d491788552,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6702,106e9e56fea3ad34a8bf3e66d3a041d491788552,/Dockerfile-alpine.template,"#		krb5-dev \
"
6703,106e9e56fea3ad34a8bf3e66d3a041d491788552,/Dockerfile-alpine.template,"#		openldap-dev \
"
6704,106e9e56fea3ad34a8bf3e66d3a041d491788552,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6705,106e9e56fea3ad34a8bf3e66d3a041d491788552,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6706,106e9e56fea3ad34a8bf3e66d3a041d491788552,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6707,106e9e56fea3ad34a8bf3e66d3a041d491788552,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6708,106e9e56fea3ad34a8bf3e66d3a041d491788552,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6709,106e9e56fea3ad34a8bf3e66d3a041d491788552,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6710,106e9e56fea3ad34a8bf3e66d3a041d491788552,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
6711,106e9e56fea3ad34a8bf3e66d3a041d491788552,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6712,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
6713,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/Dockerfile-alpine.template,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
6714,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6715,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/Dockerfile-alpine.template,"#		krb5-dev \
"
6716,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/Dockerfile-alpine.template,"#		openldap-dev \
"
6717,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/Dockerfile-alpine.template,"# configure: error: prove not found
"
6718,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/Dockerfile-alpine.template,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6719,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6720,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6721,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6722,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/Dockerfile-alpine.template,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6723,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6724,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6725,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6726,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6727,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/Dockerfile-alpine.template,"#p' --recursive /usr/local \
"
6728,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6729,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
6730,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6731,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/Dockerfile-alpine.template,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6732,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/Dockerfile-alpine.template," # backwards compat
"
6733,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# vim:set ft=dockerfile:
"
6734,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# explicitly set user/group IDs
"
6735,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# grab gosu for easy step-down from root
"
6736,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6737,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6738,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# arches officialy built by upstream
"
6739,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6740,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6741,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6742,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6743,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6744,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6745,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6746,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6747,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6748,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6749,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6750,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/10/Dockerfile," # backwards compat
"
6751,783906f551b9bc1472751200296f93bb2c55bc44,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
6752,783906f551b9bc1472751200296f93bb2c55bc44,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
6753,783906f551b9bc1472751200296f93bb2c55bc44,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6754,7c8e945a80097e80fa1c8d69d2a027145177b701,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
6755,7c8e945a80097e80fa1c8d69d2a027145177b701,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6756,43f393cccec4b3c6066531fc5c3d594327825940,/10/Dockerfile,"# vim:set ft=dockerfile:
"
6757,43f393cccec4b3c6066531fc5c3d594327825940,/10/Dockerfile,"# explicitly set user/group IDs
"
6758,43f393cccec4b3c6066531fc5c3d594327825940,/10/Dockerfile,"# grab gosu for easy step-down from root
"
6759,43f393cccec4b3c6066531fc5c3d594327825940,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6760,43f393cccec4b3c6066531fc5c3d594327825940,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6761,43f393cccec4b3c6066531fc5c3d594327825940,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6762,43f393cccec4b3c6066531fc5c3d594327825940,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6763,43f393cccec4b3c6066531fc5c3d594327825940,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6764,43f393cccec4b3c6066531fc5c3d594327825940,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6765,43f393cccec4b3c6066531fc5c3d594327825940,/10/Dockerfile," # backwards compat
"
6766,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
6767,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# explicitly set user/group IDs
"
6768,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
6769,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6770,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6771,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# arches officialy built by upstream
"
6772,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6773,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6774,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6775,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6776,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6777,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6778,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6779,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6780,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6781,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6782,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6783,e3c9133ac3bde0aca094b616654309f3377124f2,/9.3/Dockerfile," # backwards compat
"
6784,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6785,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
6786,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6787,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
6788,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
6789,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
6790,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6791,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6792,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6793,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
6794,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6795,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6796,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6797,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6798,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6799,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6800,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6801,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6802,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6803,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6804,1bddd083582b0977075dda4258f2d9dfbc90482b,/9.5/alpine/Dockerfile," # backwards compat
"
6805,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
6806,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
6807,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
6808,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6809,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6810,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
6811,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.3/Dockerfile,"# explicitly set user/group IDs
"
6812,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
6813,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6814,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6815,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6816,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6817,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6818,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6819,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6820,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"#		krb5-dev \
"
6821,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"#		openldap-dev \
"
6822,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# configure: error: prove not found
"
6823,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6824,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6825,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6826,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6827,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6828,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6829,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6830,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6831,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6832,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6833,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6834,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6835,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6836,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6837,0b0ca18dda787003f567e7e1a51efaf2348d34d7,/10/alpine/Dockerfile," # backwards compat
"
6838,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6839,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6840,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6841,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"#		krb5-dev \
"
6842,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"#		openldap-dev \
"
6843,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# configure: error: prove not found
"
6844,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6845,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6846,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6847,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6848,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6849,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6850,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6851,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6852,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6853,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6854,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6855,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6856,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6857,ee1bb1f51c9bae5be684a4797f934dbb943e3267,/10/alpine/Dockerfile," # backwards compat
"
6858,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
6859,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
6860,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
6861,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6862,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6863,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
6864,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
6865,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
6866,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"#		krb5-dev \
"
6867,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"#		openldap-dev \
"
6868,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# configure: error: prove not found
"
6869,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
6870,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
6871,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
6872,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
6873,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
6874,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
6875,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
6876,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
6877,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
6878,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
6879,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
6880,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6881,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
6882,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6883,86972e37db26753818b25e82ff3816ede9877e7b,/10/alpine/Dockerfile," # backwards compat
"
6884,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
6885,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# explicitly set user/group IDs
"
6886,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
6887,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
6888,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
6889,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6890,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6891,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6892,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6893,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
6894,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# arches officialy built by upstream
"
6895,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6896,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
6897,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6898,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6899,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6900,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6901,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6902,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6903,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6904,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
6905,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6906,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
6907,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6908,ef7af1266db5b895a2981aeba25accf074d82a6b,/9.4/Dockerfile," # backwards compat
"
6909,51e5166d69320581cb707d6fb102d3ba04803400,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
6910,51e5166d69320581cb707d6fb102d3ba04803400,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
6911,51e5166d69320581cb707d6fb102d3ba04803400,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
6912,51e5166d69320581cb707d6fb102d3ba04803400,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6913,51e5166d69320581cb707d6fb102d3ba04803400,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6914,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
6915,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
6916,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
6917,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6918,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6919,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# vim:set ft=dockerfile:
"
6920,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# explicitly set user/group IDs
"
6921,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
6922,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
6923,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# grab gosu for easy step-down from root
"
6924,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6925,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6926,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6927,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6928,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
6929,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# arches officialy built by upstream
"
6930,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6931,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
6932,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6933,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6934,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6935,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6936,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6937,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6938,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6939,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
6940,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6941,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
6942,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6943,4a82eb932030788572b637c8e138abb94401640c,/12/Dockerfile," # backwards compat
"
6944,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
6945,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/Dockerfile,"# explicitly set user/group IDs
"
6946,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
6947,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6948,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6949,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
6950,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
6951,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6952,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6953,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.6/Dockerfile," # backwards compat
"
6954,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
6955,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
6956,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
6957,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
6958,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
6959,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6960,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6961,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6962,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6963,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"# see note below about ""*.pyc"" files
"
6964,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"# arches officialy built by upstream
"
6965,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6966,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
6967,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6968,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6969,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6970,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6971,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6972,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6973,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6974,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
6975,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
6976,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
6977,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
6978,d61fd19b699b2c380da08c3a95f7272137a182bb,/Dockerfile-debian.template," # backwards compat
"
6979,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
6980,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# explicitly set user/group IDs
"
6981,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
6982,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
6983,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
6984,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
6985,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
6986,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
6987,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
6988,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
6989,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# arches officialy built by upstream
"
6990,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
6991,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
6992,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
6993,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
6994,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
6995,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
6996,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
6997,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
6998,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
6999,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
7000,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7001,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
7002,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7003,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.5/Dockerfile," # backwards compat
"
7004,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7005,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7006,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7007,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
7008,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
7009,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7010,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
7011,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7012,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7013,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7014,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7015,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7016,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7017,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7018,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7019,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7020,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7021,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7022,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7023,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.3/alpine/Dockerfile," # backwards compat
"
7024,3cff98db82f2dd6c3647296335bbc37233e0b9bc,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
7025,3cff98db82f2dd6c3647296335bbc37233e0b9bc,/9.6/Dockerfile,"# explicitly set user/group IDs
"
7026,3cff98db82f2dd6c3647296335bbc37233e0b9bc,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
7027,3cff98db82f2dd6c3647296335bbc37233e0b9bc,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7028,3cff98db82f2dd6c3647296335bbc37233e0b9bc,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7029,3cff98db82f2dd6c3647296335bbc37233e0b9bc,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7030,3cff98db82f2dd6c3647296335bbc37233e0b9bc,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7031,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
7032,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# explicitly set user/group IDs
"
7033,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
7034,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
7035,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
7036,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7037,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7038,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7039,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7040,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
7041,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# arches officialy built by upstream
"
7042,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7043,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
7044,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7045,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7046,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7047,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7048,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7049,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7050,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7051,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
7052,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7053,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
7054,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7055,dff03e96967d204b4df297e03a90086506600590,/9.4/Dockerfile," # backwards compat
"
7056,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
7057,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.4/Dockerfile,"# explicitly set user/group IDs
"
7058,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
7059,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7060,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7061,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7062,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7063,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
7064,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
7065,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
7066,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7067,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7068,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/Dockerfile-debian.template,"# arches officialy built by upstream
"
7069,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/Dockerfile-debian.template,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7070,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/Dockerfile-debian.template,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7071,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/Dockerfile-debian.template,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7072,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/Dockerfile-debian.template,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7073,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/Dockerfile-debian.template,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7074,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/Dockerfile-debian.template,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7075,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7076,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/Dockerfile-debian.template,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7077,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
7078,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7079,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/Dockerfile-debian.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7080,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/Dockerfile-debian.template," # backwards compat
"
7081,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
7082,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
7083,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
7084,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7085,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7086,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
7087,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# explicitly set user/group IDs
"
7088,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
7089,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
7090,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
7091,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7092,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7093,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7094,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7095,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# arches officialy built by upstream
"
7096,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7097,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7098,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7099,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7100,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7101,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7102,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7103,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7104,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7105,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7106,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7107,726128b358cdc0efc1753475bbe502b07cbbb540,/9.5/Dockerfile," # backwards compat
"
7108,595fb3798892feb36bc81f01317861ddcdc6521b,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
7109,595fb3798892feb36bc81f01317861ddcdc6521b,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
7110,595fb3798892feb36bc81f01317861ddcdc6521b,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
7111,595fb3798892feb36bc81f01317861ddcdc6521b,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7112,595fb3798892feb36bc81f01317861ddcdc6521b,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7113,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7114,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7115,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7116,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
7117,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
7118,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7119,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7120,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7121,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7122,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7123,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7124,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7125,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7126,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7127,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7128,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7129,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7130,975f6a2705d981f865a2cb0536a86a46e5839534,/9.4/alpine/Dockerfile," # backwards compat
"
7131,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7132,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7133,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7134,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
7135,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
7136,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7137,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7138,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7139,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7140,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7141,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7142,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7143,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7144,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7145,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7146,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7147,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.5/alpine/Dockerfile," # backwards compat
"
7148,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
7149,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# explicitly set user/group IDs
"
7150,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
7151,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7152,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7153,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7154,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# arches officialy built by upstream
"
7155,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7156,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7157,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7158,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7159,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7160,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7161,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7162,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7163,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7164,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7165,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7166,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.5/Dockerfile," # backwards compat
"
7167,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# vim:set ft=dockerfile:
"
7168,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# explicitly set user/group IDs
"
7169,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
7170,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
7171,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# grab gosu for easy step-down from root
"
7172,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7173,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7174,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7175,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7176,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
7177,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# arches officialy built by upstream
"
7178,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7179,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
7180,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7181,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7182,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7183,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7184,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7185,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7186,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7187,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
7188,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7189,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
7190,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7191,040949af1595f49f2242f6d1f9c42fb042b3eaed,/10/Dockerfile," # backwards compat
"
7192,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7193,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7194,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7195,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
7196,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
7197,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
7198,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7199,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7200,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7201,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7202,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7203,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7204,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7205,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7206,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7207,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7208,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7209,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7210,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7211,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7212,5992d8be755d8001474f737a44c73049c519cff3,/9.6/alpine/Dockerfile," # backwards compat
"
7213,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7214,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7215,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7216,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
7217,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
7218,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
7219,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7220,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7221,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7222,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7223,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7224,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7225,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7226,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7227,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7228,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7229,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7230,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7231,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/alpine/Dockerfile," # backwards compat
"
7232,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7233,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
7234,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7235,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"#		krb5-dev \
"
7236,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"#		openldap-dev \
"
7237,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# configure: error: prove not found
"
7238,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7239,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7240,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7241,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7242,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7243,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7244,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7245,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7246,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7247,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7248,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7249,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7250,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7251,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7252,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/10/alpine/Dockerfile," # backwards compat
"
7253,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
7254,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
7255,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
7256,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7257,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7258,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7259,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
7260,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7261,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"#		krb5-dev \
"
7262,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"#		openldap-dev \
"
7263,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# configure: error: prove not found
"
7264,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7265,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7266,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7267,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7268,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7269,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7270,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7271,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7272,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7273,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7274,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7275,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7276,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7277,4edbda205c684c861e6fbf964de5d00845864d42,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7278,3b022607bec233463a3d055731fb710837978747,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
7279,3b022607bec233463a3d055731fb710837978747,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
7280,3b022607bec233463a3d055731fb710837978747,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
7281,3b022607bec233463a3d055731fb710837978747,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7282,3b022607bec233463a3d055731fb710837978747,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7283,3b022607bec233463a3d055731fb710837978747,/Dockerfile-debian.template,"# arches officialy built by upstream
"
7284,3b022607bec233463a3d055731fb710837978747,/Dockerfile-debian.template,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7285,3b022607bec233463a3d055731fb710837978747,/Dockerfile-debian.template,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7286,3b022607bec233463a3d055731fb710837978747,/Dockerfile-debian.template,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7287,3b022607bec233463a3d055731fb710837978747,/Dockerfile-debian.template,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7288,3b022607bec233463a3d055731fb710837978747,/Dockerfile-debian.template,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7289,3b022607bec233463a3d055731fb710837978747,/Dockerfile-debian.template,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7290,3b022607bec233463a3d055731fb710837978747,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7291,3b022607bec233463a3d055731fb710837978747,/Dockerfile-debian.template,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7292,3b022607bec233463a3d055731fb710837978747,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
7293,3b022607bec233463a3d055731fb710837978747,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7294,3b022607bec233463a3d055731fb710837978747,/Dockerfile-debian.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7295,3b022607bec233463a3d055731fb710837978747,/Dockerfile-debian.template," # backwards compat
"
7296,1b305a586eb552197fe96e3bf2fd95f3d5b81f79,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
7297,1b305a586eb552197fe96e3bf2fd95f3d5b81f79,/9.6/Dockerfile,"# explicitly set user/group IDs
"
7298,1b305a586eb552197fe96e3bf2fd95f3d5b81f79,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
7299,1b305a586eb552197fe96e3bf2fd95f3d5b81f79,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7300,1b305a586eb552197fe96e3bf2fd95f3d5b81f79,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7301,1b305a586eb552197fe96e3bf2fd95f3d5b81f79,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7302,1b305a586eb552197fe96e3bf2fd95f3d5b81f79,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7303,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# vim:set ft=dockerfile:
"
7304,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# explicitly set user/group IDs
"
7305,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
7306,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
7307,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# grab gosu for easy step-down from root
"
7308,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7309,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7310,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7311,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
7312,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7313,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
7314,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# arches officialy built by upstream
"
7315,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7316,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
7317,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7318,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7319,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7320,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7321,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7322,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7323,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7324,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
7325,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7326,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
7327,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7328,7491dca61e0b72e48b5b0848ca026405208222f4,/12/Dockerfile," # backwards compat
"
7329,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
7330,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# explicitly set user/group IDs
"
7331,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
7332,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7333,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7334,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7335,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7336,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# arches officialy built by upstream
"
7337,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7338,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7339,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7340,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7341,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7342,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7343,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7344,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7345,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7346,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7347,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7348,fd76b238a51597fabb63d65191798d052e373636,/9.6/Dockerfile," # backwards compat
"
7349,a6d4922823aa8011513bb9c160c26c689301823a,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
7350,a6d4922823aa8011513bb9c160c26c689301823a,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
7351,a6d4922823aa8011513bb9c160c26c689301823a,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
7352,a6d4922823aa8011513bb9c160c26c689301823a,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7353,a6d4922823aa8011513bb9c160c26c689301823a,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7354,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
7355,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# explicitly set user/group IDs
"
7356,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
7357,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
7358,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
7359,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7360,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7361,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7362,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7363,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
7364,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# arches officialy built by upstream
"
7365,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7366,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
7367,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7368,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7369,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7370,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7371,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7372,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7373,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7374,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
7375,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7376,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7377,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7378,064113e0e481a1d0542846b81858e457fde02c90,/9.5/Dockerfile," # backwards compat
"
7379,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
7380,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.3/Dockerfile,"# explicitly set user/group IDs
"
7381,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
7382,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7383,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7384,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7385,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7386,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7387,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7388,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7389,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
7390,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
7391,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
7392,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7393,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7394,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7395,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7396,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7397,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7398,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7399,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7400,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7401,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7402,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7403,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7404,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7405,58ed93931d38f96981fb3e971217e6619d23f75a,/9.6/alpine/Dockerfile," # backwards compat
"
7406,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# vim:set ft=dockerfile:
"
7407,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# explicitly set user/group IDs
"
7408,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
7409,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
7410,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# grab gosu for easy step-down from root
"
7411,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7412,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7413,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7414,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7415,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
7416,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# arches officialy built by upstream
"
7417,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7418,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
7419,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7420,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7421,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7422,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7423,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7424,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7425,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7426,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
7427,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7428,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
7429,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7430,2addeda08bf3715a9181ad139e49b67b879110f9,/11/Dockerfile," # backwards compat
"
7431,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7432,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
7433,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7434,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"#		krb5-dev \
"
7435,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"#		openldap-dev \
"
7436,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# configure: error: prove not found
"
7437,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7438,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7439,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7440,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7441,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7442,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7443,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7444,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7445,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7446,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7447,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7448,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7449,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7450,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/13/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7451,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/Dockerfile,"# vim:set ft=dockerfile:
"
7452,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/Dockerfile,"# explicitly set user/group IDs
"
7453,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/Dockerfile,"# grab gosu for easy step-down from root
"
7454,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7455,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7456,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7457,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7458,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7459,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7460,a4b217591a4ad2d15ee42be23bcc51f872f5c153,/10/Dockerfile," # backwards compat
"
7461,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7462,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7463,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
7464,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
7465,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7466,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7467,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7468,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7469,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7470,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7471,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7472,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7473,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7474,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7475,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7476,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7477,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7478,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"#		krb5-dev \
"
7479,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"#		openldap-dev \
"
7480,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# configure: error: prove not found
"
7481,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7482,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7483,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7484,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7485,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7486,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7487,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7488,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7489,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7490,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7491,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7492,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7493,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7494,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7495,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
7496,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
7497,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
7498,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7499,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7500,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7501,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7502,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7503,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
7504,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
7505,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
7506,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7507,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7508,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
7509,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7510,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7511,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7512,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7513,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7514,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7515,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7516,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7517,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7518,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7519,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7520,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7521,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7522,f7dc5727b1d6b6a636350e11648845ae33477579,/9.3/alpine/Dockerfile," # backwards compat
"
7523,63d966973d9593c0d9890b96f10ac73566913520,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
7524,63d966973d9593c0d9890b96f10ac73566913520,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
7525,63d966973d9593c0d9890b96f10ac73566913520,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
7526,63d966973d9593c0d9890b96f10ac73566913520,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7527,63d966973d9593c0d9890b96f10ac73566913520,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7528,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7529,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
7530,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7531,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
7532,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
7533,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
7534,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7535,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7536,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7537,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7538,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7539,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7540,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7541,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7542,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7543,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7544,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7545,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7546,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7547,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7548,473b58e971e2eb0351af12288dc4976bd3c591ad,/9.4/alpine/Dockerfile," # backwards compat
"
7549,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7550,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7551,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
7552,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
7553,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7554,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7555,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7556,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7557,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7558,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"# tzdata adds around 1Mb to image size, but it is suggested by Django documentation that timezone should be set for performance reasons: http://bit.ly/2fMYhh1
"
7559,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7560,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7561,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
7562,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# explicitly set user/group IDs
"
7563,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
7564,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
7565,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
7566,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7567,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7568,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7569,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
7570,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7571,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
7572,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# arches officialy built by upstream
"
7573,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7574,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
7575,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7576,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7577,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7578,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7579,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7580,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7581,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7582,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
7583,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7584,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
7585,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7586,a1420dac644b8190df5e78e80bfa9610b2f077e2,/9.5/Dockerfile," # backwards compat
"
7587,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
7588,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# explicitly set user/group IDs
"
7589,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
7590,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
7591,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
7592,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7593,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7594,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7595,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7596,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
7597,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# arches officialy built by upstream
"
7598,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7599,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
7600,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7601,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7602,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7603,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7604,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7605,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7606,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7607,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
7608,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7609,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
7610,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7611,06a831c6f1117a856f3daccec35993ba4a265d08,/9.5/Dockerfile," # backwards compat
"
7612,1c018f151e703e594e85cbb5c1dc7f6c38b7d49f,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
7613,1c018f151e703e594e85cbb5c1dc7f6c38b7d49f,/9.6/Dockerfile,"# explicitly set user/group IDs
"
7614,1c018f151e703e594e85cbb5c1dc7f6c38b7d49f,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
7615,1c018f151e703e594e85cbb5c1dc7f6c38b7d49f,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7616,1c018f151e703e594e85cbb5c1dc7f6c38b7d49f,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7617,1c018f151e703e594e85cbb5c1dc7f6c38b7d49f,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7618,1c018f151e703e594e85cbb5c1dc7f6c38b7d49f,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7619,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7620,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7621,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
7622,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
7623,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7624,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7625,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7626,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7627,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7628,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7629,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7630,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7631,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
7632,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
7633,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
7634,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7635,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7636,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
7637,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# explicitly set user/group IDs
"
7638,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
7639,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
7640,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
7641,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7642,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7643,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7644,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7645,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
7646,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# arches officialy built by upstream
"
7647,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7648,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
7649,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7650,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7651,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7652,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7653,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7654,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7655,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7656,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
7657,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7658,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
7659,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7660,f8bfec9c70f06c5fb9815653732c5d976f6f3c36,/9.6/Dockerfile," # backwards compat
"
7661,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7662,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7663,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
7664,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
7665,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7666,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7667,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7668,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7669,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7670,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7671,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7672,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7673,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7674,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7675,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7676,738ec9015ca92fa79e541514f51b37a8d69e4979,/9.5/alpine/Dockerfile," # backwards compat
"
7677,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7678,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
7679,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7680,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
7681,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
7682,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
7683,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7684,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7685,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7686,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7687,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7688,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7689,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7690,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7691,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7692,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7693,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7694,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7695,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7696,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7697,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/9.6/alpine/Dockerfile," # backwards compat
"
7698,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# vim:set ft=dockerfile:
"
7699,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# explicitly set user/group IDs
"
7700,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
7701,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
7702,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
7703,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7704,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7705,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7706,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
7707,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7708,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
7709,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# arches officialy built by upstream
"
7710,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7711,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
7712,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7713,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7714,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7715,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7716,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7717,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7718,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7719,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
7720,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7721,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
7722,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7723,a1420dac644b8190df5e78e80bfa9610b2f077e2,/12/Dockerfile," # backwards compat
"
7724,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
7725,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
7726,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
7727,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
7728,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
7729,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7730,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7731,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7732,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7733,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"# see note below about ""*.pyc"" files
"
7734,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"# arches officialy built by upstream
"
7735,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7736,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
7737,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7738,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7739,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7740,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7741,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7742,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7743,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7744,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
7745,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
7746,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7747,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7748,064113e0e481a1d0542846b81858e457fde02c90,/Dockerfile-debian.template," # backwards compat
"
7749,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7750,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7751,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7752,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
7753,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
7754,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
7755,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7756,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7757,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7758,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7759,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7760,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7761,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7762,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7763,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7764,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7765,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7766,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7767,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7768,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7769,dcf1338d3a29d8244aecc12555e18267b8aaeed3,/9.4/alpine/Dockerfile," # backwards compat
"
7770,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
7771,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# explicitly set user/group IDs
"
7772,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
7773,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
7774,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
7775,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7776,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7777,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7778,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
7779,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7780,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
7781,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# arches officialy built by upstream
"
7782,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7783,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
7784,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7785,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7786,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7787,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7788,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7789,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7790,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7791,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
7792,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7793,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
7794,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7795,72d7408ad3b57ab1a5c371e11460811551811bf5,/9.5/Dockerfile," # backwards compat
"
7796,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# vim:set ft=dockerfile:
"
7797,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# explicitly set user/group IDs
"
7798,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# grab gosu for easy step-down from root
"
7799,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7800,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7801,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# arches officialy built by upstream
"
7802,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7803,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7804,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7805,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7806,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7807,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7808,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7809,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7810,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7811,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7812,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7813,0aaaf2094034647a552f0b1ec63b1b0ec0f6c2cc,/10/Dockerfile," # backwards compat
"
7814,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# vim:set ft=dockerfile:
"
7815,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# explicitly set user/group IDs
"
7816,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
7817,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
7818,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# grab gosu for easy step-down from root
"
7819,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7820,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7821,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7822,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7823,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
7824,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# arches officialy built by upstream
"
7825,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7826,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
7827,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7828,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7829,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7830,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7831,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7832,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7833,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7834,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
7835,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7836,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7837,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7838,1acd5e225abead13b3f264e9e5a7c68598a33c67,/11/Dockerfile," # backwards compat
"
7839,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
7840,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# explicitly set user/group IDs
"
7841,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
7842,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7843,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7844,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7845,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7846,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# arches officialy built by upstream
"
7847,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7848,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7849,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7850,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7851,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7852,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7853,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7854,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7855,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7856,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7857,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7858,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.5/Dockerfile," # backwards compat
"
7859,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# vim:set ft=dockerfile:
"
7860,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# explicitly set user/group IDs
"
7861,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
7862,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
7863,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# grab gosu for easy step-down from root
"
7864,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7865,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7866,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7867,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
7868,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7869,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
7870,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# arches officialy built by upstream
"
7871,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7872,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
7873,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7874,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7875,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7876,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7877,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7878,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7879,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7880,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
7881,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7882,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
7883,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7884,71d4ab5d4192bfb04f3dcc919fd99f66326078c9,/12/Dockerfile," # backwards compat
"
7885,972294a377463156c8d61297320c872fc7d370a9,/10/Dockerfile,"# vim:set ft=dockerfile:
"
7886,972294a377463156c8d61297320c872fc7d370a9,/10/Dockerfile,"# explicitly set user/group IDs
"
7887,972294a377463156c8d61297320c872fc7d370a9,/10/Dockerfile,"# grab gosu for easy step-down from root
"
7888,972294a377463156c8d61297320c872fc7d370a9,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7889,972294a377463156c8d61297320c872fc7d370a9,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7890,972294a377463156c8d61297320c872fc7d370a9,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7891,972294a377463156c8d61297320c872fc7d370a9,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7892,972294a377463156c8d61297320c872fc7d370a9,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7893,972294a377463156c8d61297320c872fc7d370a9,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7894,972294a377463156c8d61297320c872fc7d370a9,/10/Dockerfile," # backwards compat
"
7895,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
7896,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/Dockerfile,"# explicitly set user/group IDs
"
7897,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
7898,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7899,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7900,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7901,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7902,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7903,3706d4c4562c284ed070286b9fd516151167a40c,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7904,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7905,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7906,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7907,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
7908,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
7909,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
7910,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7911,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7912,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7913,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7914,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7915,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7916,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7917,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7918,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7919,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7920,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7921,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7922,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7923,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7924,930806fc31d4ae6359cbf89bf9d0cf32b18a6522,/9.6/alpine/Dockerfile," # backwards compat
"
7925,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
7926,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
7927,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
7928,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7929,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7930,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7931,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7932,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
7933,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
7934,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7935,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7936,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7937,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7938,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7939,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7940,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
7941,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7942,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"#		krb5-dev \
"
7943,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"#		openldap-dev \
"
7944,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# configure: error: prove not found
"
7945,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
7946,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7947,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7948,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7949,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
7950,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7951,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7952,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7953,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7954,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
7955,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7956,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7957,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7958,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7959,25f99f10cb564f0a8b5c1de8a9a00a8095a587fb,/11/alpine/Dockerfile," # backwards compat
"
7960,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
7961,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.4/Dockerfile,"# explicitly set user/group IDs
"
7962,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
7963,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7964,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
7965,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# vim:set ft=dockerfile:
"
7966,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# explicitly set user/group IDs
"
7967,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# grab gosu for easy step-down from root
"
7968,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
7969,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
7970,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
7971,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
7972,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# arches officialy built by upstream
"
7973,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
7974,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
7975,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
7976,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
7977,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
7978,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
7979,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
7980,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
7981,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7982,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
7983,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
7984,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/10/Dockerfile," # backwards compat
"
7985,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
7986,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
7987,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
7988,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
7989,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
7990,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
7991,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
7992,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
7993,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
7994,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
7995,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
7996,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
7997,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
7998,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
7999,3706d4c4562c284ed070286b9fd516151167a40c,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8000,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8001,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8002,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
8003,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
8004,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8005,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8006,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8007,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8008,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8009,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8010,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8011,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8012,6abeb8590f35c5251b9f100a667024febaeee06b,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
8013,6abeb8590f35c5251b9f100a667024febaeee06b,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8014,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
8015,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# explicitly set user/group IDs
"
8016,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
8017,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
8018,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
8019,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8020,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8021,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
8022,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8023,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
8024,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# arches officialy built by upstream
"
8025,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8026,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
8027,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8028,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8029,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8030,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8031,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8032,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8033,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8034,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
8035,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8036,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
8037,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8038,87b15b6c65ba985ac958e7b35ba787422113066e,/9.6/Dockerfile," # backwards compat
"
8039,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8040,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
8041,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8042,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"#		krb5-dev \
"
8043,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"#		openldap-dev \
"
8044,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# configure: error: prove not found
"
8045,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8046,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8047,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8048,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
8049,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8050,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8051,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8052,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8053,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8054,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8055,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8056,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8057,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8058,1bddd083582b0977075dda4258f2d9dfbc90482b,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8059,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8060,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8061,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
8062,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
8063,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8064,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8065,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8066,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8067,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8068,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8069,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8070,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8071,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8072,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8073,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8074,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.5/alpine/Dockerfile," # backwards compat
"
8075,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
8076,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8077,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/Dockerfile-alpine.template,"#		krb5-dev \
"
8078,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/Dockerfile-alpine.template,"#		openldap-dev \
"
8079,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8080,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8081,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8082,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8083,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8084,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8085,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8086,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8087,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"#		krb5-dev \
"
8088,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"#		openldap-dev \
"
8089,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# configure: error: prove not found
"
8090,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8091,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8092,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8093,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8094,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8095,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8096,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8097,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8098,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8099,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8100,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8101,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8102,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8103,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8104,7c287e7800dc08743da8d6372ab752e5438f662b,/10/alpine/Dockerfile," # backwards compat
"
8105,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8106,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8107,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8108,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
8109,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
8110,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
8111,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8112,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8113,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8114,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8115,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8116,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8117,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8118,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8119,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8120,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8121,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8122,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8123,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8124,a1b76e5704e4d8f40c736454eccba863a7be75e4,/9.5/alpine/Dockerfile," # backwards compat
"
8125,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8126,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8127,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8128,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
8129,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
8130,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
8131,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8132,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8133,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
8134,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8135,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8136,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8137,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8138,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8139,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8140,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8141,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8142,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8143,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8144,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8145,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8146,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8147,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.3/alpine/Dockerfile," # backwards compat
"
8148,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
8149,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
8150,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
8151,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
8152,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
8153,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8154,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8155,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
8156,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8157,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# see note below about ""*.pyc"" files
"
8158,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# arches officialy built by upstream
"
8159,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8160,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
8161,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8162,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8163,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8164,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8165,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8166,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8167,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8168,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
8169,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
8170,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
8171,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8172,87b15b6c65ba985ac958e7b35ba787422113066e,/Dockerfile-debian.template," # backwards compat
"
8173,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8174,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
8175,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8176,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"#		krb5-dev \
"
8177,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"#		openldap-dev \
"
8178,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# configure: error: prove not found
"
8179,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8180,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8181,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8182,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
8183,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8184,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8185,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8186,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8187,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8188,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8189,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8190,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8191,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8192,06321b0cd97dc7e6523b1faed69b7a0d8fd3d2cc,/13/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8193,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# vim:set ft=dockerfile:
"
8194,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# explicitly set user/group IDs
"
8195,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
8196,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
8197,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# grab gosu for easy step-down from root
"
8198,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8199,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8200,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
8201,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8202,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
8203,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# arches officialy built by upstream
"
8204,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8205,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
8206,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8207,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8208,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8209,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8210,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8211,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8212,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8213,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
8214,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8215,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8216,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8217,064113e0e481a1d0542846b81858e457fde02c90,/11/Dockerfile," # backwards compat
"
8218,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/Dockerfile.template,"# vim:set ft=dockerfile:
"
8219,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/Dockerfile.template,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
8220,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/Dockerfile.template,"# grab gosu for easy step-down from root
"
8221,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/Dockerfile.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8222,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/Dockerfile.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8223,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
8224,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# explicitly set user/group IDs
"
8225,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
8226,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
8227,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
8228,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8229,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8230,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
8231,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8232,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
8233,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# arches officialy built by upstream
"
8234,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8235,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
8236,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8237,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8238,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8239,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8240,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8241,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8242,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8243,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
8244,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8245,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8246,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8247,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.6/Dockerfile," # backwards compat
"
8248,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8249,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8250,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8251,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
8252,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
8253,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
8254,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8255,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8256,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8257,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8258,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8259,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8260,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8261,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8262,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8263,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8264,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8265,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8266,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8267,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8268,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/alpine/Dockerfile," # backwards compat
"
8269,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# vim:set ft=dockerfile:
"
8270,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# explicitly set user/group IDs
"
8271,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
8272,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
8273,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# grab gosu for easy step-down from root
"
8274,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8275,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8276,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
8277,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8278,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
8279,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# arches officialy built by upstream
"
8280,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8281,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
8282,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8283,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8284,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8285,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8286,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8287,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8288,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8289,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
8290,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8291,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
8292,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8293,87b15b6c65ba985ac958e7b35ba787422113066e,/12/Dockerfile," # backwards compat
"
8294,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8295,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8296,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8297,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
8298,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
8299,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
8300,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8301,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8302,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8303,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8304,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8305,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8306,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8307,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8308,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8309,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8310,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8311,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8312,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8313,f3146f857b42bd4c4cb2be6134149fddee546584,/9.5/alpine/Dockerfile," # backwards compat
"
8314,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
8315,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.1/Dockerfile,"# explicitly set user/group IDs
"
8316,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
8317,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8318,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8319,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.1/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8320,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.1/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8321,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
8322,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.0/Dockerfile,"# explicitly set user/group IDs
"
8323,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
8324,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8325,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8326,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8327,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8328,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8329,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"#		krb5-dev \
"
8330,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"#		openldap-dev \
"
8331,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# configure: error: prove not found
"
8332,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8333,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8334,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8335,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8336,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8337,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8338,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8339,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8340,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8341,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8342,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8343,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8344,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8345,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8346,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/11/alpine/Dockerfile," # backwards compat
"
8347,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# vim:set ft=dockerfile:
"
8348,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# explicitly set user/group IDs
"
8349,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
8350,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
8351,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# grab gosu for easy step-down from root
"
8352,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8353,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8354,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
8355,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
8356,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8357,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
8358,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# arches officialy built by upstream
"
8359,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8360,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
8361,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8362,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8363,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8364,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8365,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8366,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8367,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8368,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
8369,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8370,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
8371,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8372,06cc08b44b4dc879e0c948ba64d2d0a00596ed50,/11/Dockerfile," # backwards compat
"
8373,972294a377463156c8d61297320c872fc7d370a9,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
8374,972294a377463156c8d61297320c872fc7d370a9,/9.4/Dockerfile,"# explicitly set user/group IDs
"
8375,972294a377463156c8d61297320c872fc7d370a9,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
8376,972294a377463156c8d61297320c872fc7d370a9,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8377,972294a377463156c8d61297320c872fc7d370a9,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8378,972294a377463156c8d61297320c872fc7d370a9,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8379,972294a377463156c8d61297320c872fc7d370a9,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8380,972294a377463156c8d61297320c872fc7d370a9,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8381,972294a377463156c8d61297320c872fc7d370a9,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8382,972294a377463156c8d61297320c872fc7d370a9,/9.4/Dockerfile," # backwards compat
"
8383,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8384,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8385,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
8386,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
8387,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8388,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8389,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8390,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8391,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8392,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8393,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8394,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8395,904b4637237bf17657674bafe3ca42d241e3e745,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
8396,904b4637237bf17657674bafe3ca42d241e3e745,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
8397,904b4637237bf17657674bafe3ca42d241e3e745,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
8398,904b4637237bf17657674bafe3ca42d241e3e745,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8399,904b4637237bf17657674bafe3ca42d241e3e745,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8400,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# vim:set ft=dockerfile:
"
8401,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# explicitly set user/group IDs
"
8402,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
8403,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
8404,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# grab gosu for easy step-down from root
"
8405,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8406,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8407,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
8408,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8409,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
8410,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# arches officialy built by upstream
"
8411,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8412,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
8413,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8414,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8415,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8416,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8417,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8418,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8419,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8420,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
8421,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8422,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8423,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8424,2d40c8a89bfc888fb99463e919ac748cd54c0fcc,/11/Dockerfile," # backwards compat
"
8425,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8426,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8427,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8428,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"#		krb5-dev \
"
8429,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"#		openldap-dev \
"
8430,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# configure: error: prove not found
"
8431,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8432,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8433,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8434,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8435,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8436,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8437,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8438,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8439,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8440,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8441,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8442,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8443,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8444,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8445,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/10/alpine/Dockerfile," # backwards compat
"
8446,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8447,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8448,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8449,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"#		krb5-dev \
"
8450,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"#		openldap-dev \
"
8451,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# configure: error: prove not found
"
8452,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8453,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8454,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8455,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8456,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8457,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8458,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8459,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8460,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8461,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8462,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8463,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8464,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8465,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8466,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/10/alpine/Dockerfile," # backwards compat
"
8467,f3146f857b42bd4c4cb2be6134149fddee546584,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
8468,f3146f857b42bd4c4cb2be6134149fddee546584,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8469,f3146f857b42bd4c4cb2be6134149fddee546584,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8470,f3146f857b42bd4c4cb2be6134149fddee546584,/Dockerfile-alpine.template,"#		krb5-dev \
"
8471,f3146f857b42bd4c4cb2be6134149fddee546584,/Dockerfile-alpine.template,"#		openldap-dev \
"
8472,f3146f857b42bd4c4cb2be6134149fddee546584,/Dockerfile-alpine.template,"# configure: error: prove not found
"
8473,f3146f857b42bd4c4cb2be6134149fddee546584,/Dockerfile-alpine.template,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8474,f3146f857b42bd4c4cb2be6134149fddee546584,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8475,f3146f857b42bd4c4cb2be6134149fddee546584,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8476,f3146f857b42bd4c4cb2be6134149fddee546584,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8477,f3146f857b42bd4c4cb2be6134149fddee546584,/Dockerfile-alpine.template,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8478,f3146f857b42bd4c4cb2be6134149fddee546584,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8479,f3146f857b42bd4c4cb2be6134149fddee546584,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8480,f3146f857b42bd4c4cb2be6134149fddee546584,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8481,f3146f857b42bd4c4cb2be6134149fddee546584,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8482,f3146f857b42bd4c4cb2be6134149fddee546584,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8483,f3146f857b42bd4c4cb2be6134149fddee546584,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
8484,f3146f857b42bd4c4cb2be6134149fddee546584,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8485,f3146f857b42bd4c4cb2be6134149fddee546584,/Dockerfile-alpine.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8486,f3146f857b42bd4c4cb2be6134149fddee546584,/Dockerfile-alpine.template," # backwards compat
"
8487,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
8488,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
8489,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
8490,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8491,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8492,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
8493,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8494,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8495,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-alpine.template,"#		krb5-dev \
"
8496,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-alpine.template,"#		openldap-dev \
"
8497,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-alpine.template,"# configure: error: prove not found
"
8498,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-alpine.template,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8499,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8500,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8501,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8502,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-alpine.template,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8503,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8504,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8505,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8506,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8507,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-alpine.template,"#p' --recursive /usr/local \
"
8508,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8509,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
8510,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8511,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-alpine.template,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8512,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-alpine.template," # backwards compat
"
8513,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
8514,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.4/Dockerfile,"# explicitly set user/group IDs
"
8515,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
8516,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8517,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8518,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
8519,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.5/Dockerfile,"# explicitly set user/group IDs
"
8520,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
8521,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8522,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8523,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8524,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8525,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8526,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
8527,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8528,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
8529,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
8530,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
8531,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8532,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8533,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8534,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
8535,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8536,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8537,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8538,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8539,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8540,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8541,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8542,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8543,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8544,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8545,0f4abf741b320d7ac53207c03867c4ac24aad6b5,/9.6/alpine/Dockerfile," # backwards compat
"
8546,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# vim:set ft=dockerfile:
"
8547,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# explicitly set user/group IDs
"
8548,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
8549,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
8550,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# grab gosu for easy step-down from root
"
8551,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8552,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8553,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
8554,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8555,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
8556,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# arches officialy built by upstream
"
8557,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8558,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
8559,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8560,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8561,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8562,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8563,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8564,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8565,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8566,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
8567,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8568,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8569,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8570,4b94743e2ef5ead3ce8c66f96e43f6dc9d877025,/11/Dockerfile," # backwards compat
"
8571,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8572,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8573,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
8574,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
8575,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8576,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8577,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8578,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8579,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8580,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8581,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8582,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8583,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# vim:set ft=dockerfile:
"
8584,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# explicitly set user/group IDs
"
8585,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
8586,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
8587,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# grab gosu for easy step-down from root
"
8588,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8589,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8590,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
8591,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8592,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
8593,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# arches officialy built by upstream
"
8594,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8595,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
8596,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8597,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8598,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8599,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8600,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8601,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8602,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8603,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
8604,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8605,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8606,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8607,6f6968e4a2ee82cc7893e12414cbb221044ed3bd,/10/Dockerfile," # backwards compat
"
8608,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
8609,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# explicitly set user/group IDs
"
8610,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
8611,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8612,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8613,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
8614,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8615,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# arches officialy built by upstream
"
8616,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8617,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8618,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8619,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8620,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8621,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8622,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8623,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8624,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8625,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8626,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8627,a0335993e11a1fba4dfea0665189dfa4423709cf,/9.3/Dockerfile," # backwards compat
"
8628,5f401753715311752f2346cdbd32bd55e7251ddd,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
8629,5f401753715311752f2346cdbd32bd55e7251ddd,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
8630,5f401753715311752f2346cdbd32bd55e7251ddd,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
8631,5f401753715311752f2346cdbd32bd55e7251ddd,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8632,5f401753715311752f2346cdbd32bd55e7251ddd,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8633,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8634,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8635,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8636,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
8637,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
8638,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# configure: error: prove not found
"
8639,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8640,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8641,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
8642,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8643,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8644,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8645,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8646,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8647,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8648,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8649,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8650,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8651,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8652,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8653,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8654,f3146f857b42bd4c4cb2be6134149fddee546584,/9.2/alpine/Dockerfile," # backwards compat
"
8655,688e034f8363083cc2b1b8f8c93236c4b4445e0f,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8656,688e034f8363083cc2b1b8f8c93236c4b4445e0f,/9.5/alpine/Dockerfile,"# explicitly set user/group IDs
#RUN adduser -S -G postgres -u 999 postgres

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8657,688e034f8363083cc2b1b8f8c93236c4b4445e0f,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8658,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
8659,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# explicitly set user/group IDs
"
8660,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
8661,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
8662,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
8663,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8664,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8665,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
8666,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8667,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
8668,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# arches officialy built by upstream
"
8669,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8670,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
8671,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8672,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8673,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8674,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8675,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8676,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8677,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8678,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
8679,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8680,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
8681,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8682,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.4/Dockerfile," # backwards compat
"
8683,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
8684,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# explicitly set user/group IDs
"
8685,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
8686,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8687,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8688,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# arches officialy built by upstream
"
8689,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8690,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8691,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8692,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8693,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8694,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8695,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8696,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8697,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8698,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8699,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8700,3b022607bec233463a3d055731fb710837978747,/9.6/Dockerfile," # backwards compat
"
8701,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8702,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8703,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8704,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"#		krb5-dev \
"
8705,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"#		openldap-dev \
"
8706,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# configure: error: prove not found
"
8707,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8708,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8709,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8710,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8711,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8712,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8713,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8714,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8715,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8716,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8717,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8718,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8719,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8720,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8721,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/alpine/Dockerfile," # backwards compat
"
8722,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
8723,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# explicitly set user/group IDs
"
8724,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
8725,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8726,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8727,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# arches officialy built by upstream
"
8728,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8729,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8730,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8731,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8732,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8733,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8734,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8735,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8736,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8737,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8738,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8739,f7dc5727b1d6b6a636350e11648845ae33477579,/9.5/Dockerfile," # backwards compat
"
8740,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8741,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8742,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8743,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
8744,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
8745,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
8746,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8747,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8748,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8749,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8750,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8751,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8752,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8753,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8754,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8755,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8756,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8757,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8758,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8759,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8760,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.4/alpine/Dockerfile," # backwards compat
"
8761,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8762,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8763,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8764,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
8765,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
8766,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
8767,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8768,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8769,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8770,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8771,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8772,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8773,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8774,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8775,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8776,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
8777,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8778,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8779,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8780,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8781,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.4/alpine/Dockerfile," # backwards compat
"
8782,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
8783,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# explicitly set user/group IDs
"
8784,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
8785,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8786,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8787,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8788,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# arches officialy built by upstream
"
8789,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8790,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8791,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8792,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8793,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8794,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8795,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8796,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8797,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8798,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8799,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8800,46bc23cd0dbb7935e3d2baaddfefaed42ac65ce2,/9.6/Dockerfile," # backwards compat
"
8801,52814abac491eca146620f921a44e2cb4217088e,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
8802,52814abac491eca146620f921a44e2cb4217088e,/Dockerfile-alpine.template,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
8803,52814abac491eca146620f921a44e2cb4217088e,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8804,52814abac491eca146620f921a44e2cb4217088e,/Dockerfile-alpine.template,"#		krb5-dev \
"
8805,52814abac491eca146620f921a44e2cb4217088e,/Dockerfile-alpine.template,"#		openldap-dev \
"
8806,52814abac491eca146620f921a44e2cb4217088e,/Dockerfile-alpine.template,"# configure: error: prove not found
"
8807,52814abac491eca146620f921a44e2cb4217088e,/Dockerfile-alpine.template,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8808,52814abac491eca146620f921a44e2cb4217088e,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8809,52814abac491eca146620f921a44e2cb4217088e,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8810,52814abac491eca146620f921a44e2cb4217088e,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8811,52814abac491eca146620f921a44e2cb4217088e,/Dockerfile-alpine.template,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8812,52814abac491eca146620f921a44e2cb4217088e,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8813,52814abac491eca146620f921a44e2cb4217088e,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8814,52814abac491eca146620f921a44e2cb4217088e,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8815,52814abac491eca146620f921a44e2cb4217088e,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8816,52814abac491eca146620f921a44e2cb4217088e,/Dockerfile-alpine.template,"#p' --recursive /usr/local \
"
8817,52814abac491eca146620f921a44e2cb4217088e,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8818,52814abac491eca146620f921a44e2cb4217088e,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
8819,52814abac491eca146620f921a44e2cb4217088e,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8820,52814abac491eca146620f921a44e2cb4217088e,/Dockerfile-alpine.template,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8821,52814abac491eca146620f921a44e2cb4217088e,/Dockerfile-alpine.template," # backwards compat
"
8822,6fabe2e39c165dd1e2e32f8b758f2c02ded20d8f,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
8823,6fabe2e39c165dd1e2e32f8b758f2c02ded20d8f,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8824,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
8825,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
8826,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
8827,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8828,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8829,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8830,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
8831,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8832,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-debian.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8833,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8834,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8835,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
8836,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
8837,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8838,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8839,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8840,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8841,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8842,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8843,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8844,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8845,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8846,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8847,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8848,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8849,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8850,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8851,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
8852,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
8853,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
8854,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8855,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8856,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8857,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8858,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8859,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8860,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8861,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8862,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8863,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8864,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8865,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8866,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8867,b2649f97aee8bca9f4e65a2c050f66fe255ec9f3,/9.4/alpine/Dockerfile," # backwards compat
"
8868,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/Dockerfile.template,"# vim:set ft=dockerfile:
"
8869,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/Dockerfile.template,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
8870,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/Dockerfile.template,"# grab gosu for easy step-down from root
"
8871,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/Dockerfile.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8872,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/Dockerfile.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8873,8a9fbcb40f13ccc7762f278b9df611cabe22d300,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
8874,8a9fbcb40f13ccc7762f278b9df611cabe22d300,/9.5/Dockerfile,"# explicitly set user/group IDs
"
8875,8a9fbcb40f13ccc7762f278b9df611cabe22d300,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
8876,8a9fbcb40f13ccc7762f278b9df611cabe22d300,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8877,8a9fbcb40f13ccc7762f278b9df611cabe22d300,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8878,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8879,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8880,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
8881,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
8882,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8883,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8884,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8885,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8886,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8887,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8888,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8889,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8890,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8891,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8892,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8893,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/alpine/Dockerfile," # backwards compat
"
8894,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8895,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
8896,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8897,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
8898,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
8899,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# configure: error: prove not found
"
8900,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
8901,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8902,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
8903,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8904,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
8905,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
8906,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
8907,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8908,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8909,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8910,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
8911,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
8912,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8913,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
8914,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8915,b3cb99032a600a27dcb8f3c52f14c72fd22d477f,/9.2/alpine/Dockerfile," # backwards compat
"
8916,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
8917,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# explicitly set user/group IDs
"
8918,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
8919,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8920,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8921,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8922,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# arches officialy built by upstream
"
8923,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8924,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8925,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8926,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8927,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8928,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8929,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8930,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8931,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8932,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8933,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8934,54bfbc5fbef9f33d678e87470e4b7ab5ce6dd12b,/9.5/Dockerfile," # backwards compat
"
8935,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# vim:set ft=dockerfile:
"
8936,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# explicitly set user/group IDs
"
8937,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
8938,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
8939,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# grab gosu for easy step-down from root
"
8940,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8941,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8942,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
8943,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
8944,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8945,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
8946,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# arches officialy built by upstream
"
8947,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8948,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
8949,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8950,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8951,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8952,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8953,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8954,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8955,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8956,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
8957,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8958,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
8959,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8960,4f70bf2b811bcdb4ab1a015ef703373226452157,/12/Dockerfile," # backwards compat
"
8961,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# vim:set ft=dockerfile:
"
8962,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# explicitly set user/group IDs
"
8963,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# grab gosu for easy step-down from root
"
8964,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8965,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
8966,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
8967,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8968,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# arches officialy built by upstream
"
8969,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
8970,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
8971,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
8972,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
8973,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
8974,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
8975,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
8976,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
8977,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8978,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8979,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8980,686aae6553981d5254649841bb89677dc33f1aeb,/11/Dockerfile," # backwards compat
"
8981,e7222bf98572eec2a7b8875c13825015a163091c,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
8982,e7222bf98572eec2a7b8875c13825015a163091c,/9.6/Dockerfile,"# explicitly set user/group IDs
"
8983,e7222bf98572eec2a7b8875c13825015a163091c,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
8984,e7222bf98572eec2a7b8875c13825015a163091c,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
8985,e7222bf98572eec2a7b8875c13825015a163091c,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
8986,e7222bf98572eec2a7b8875c13825015a163091c,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
8987,e7222bf98572eec2a7b8875c13825015a163091c,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
8988,e7222bf98572eec2a7b8875c13825015a163091c,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
8989,e7222bf98572eec2a7b8875c13825015a163091c,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
8990,e7222bf98572eec2a7b8875c13825015a163091c,/9.6/Dockerfile," # backwards compat
"
8991,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
8992,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
8993,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
8994,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
8995,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
8996,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
8997,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
8998,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
8999,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9000,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
9001,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# explicitly set user/group IDs
"
9002,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
9003,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
9004,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
9005,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9006,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9007,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9008,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9009,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
9010,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# arches officialy built by upstream
"
9011,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9012,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
9013,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9014,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9015,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9016,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9017,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9018,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9019,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9020,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
9021,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9022,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
9023,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9024,0e8afe8b6a5db91d575ea8fcd2b57920d178f215,/9.4/Dockerfile," # backwards compat
"
9025,783906f551b9bc1472751200296f93bb2c55bc44,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
9026,783906f551b9bc1472751200296f93bb2c55bc44,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9027,783906f551b9bc1472751200296f93bb2c55bc44,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9028,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9029,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9030,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9031,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
9032,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
9033,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
9034,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9035,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9036,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9037,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9038,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9039,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9040,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9041,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9042,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9043,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9044,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9045,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9046,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9047,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9048,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.6/alpine/Dockerfile," # backwards compat
"
9049,6abeb8590f35c5251b9f100a667024febaeee06b,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9050,6abeb8590f35c5251b9f100a667024febaeee06b,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9051,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9052,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9053,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9054,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
9055,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
9056,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
9057,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9058,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9059,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
9060,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9061,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9062,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9063,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9064,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9065,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9066,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9067,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9068,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9069,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9070,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9071,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9072,b1fc9b6f7506ea7357f48fb0125e8b7a3c1d96e9,/9.3/alpine/Dockerfile," # backwards compat
"
9073,7c8e945a80097e80fa1c8d69d2a027145177b701,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9074,7c8e945a80097e80fa1c8d69d2a027145177b701,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9075,7c8e945a80097e80fa1c8d69d2a027145177b701,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9076,7c8e945a80097e80fa1c8d69d2a027145177b701,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9077,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9078,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
9079,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9080,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
9081,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
9082,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
9083,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9084,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9085,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9086,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9087,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9088,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9089,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9090,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9091,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9092,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9093,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9094,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9095,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9096,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9097,7675803cba8dbf4aca2c1064b044b03cd0db6c2d,/9.6/alpine/Dockerfile," # backwards compat
"
9098,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9099,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
9100,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9101,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"#		krb5-dev \
"
9102,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"#		openldap-dev \
"
9103,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# configure: error: prove not found
"
9104,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9105,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9106,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9107,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9108,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9109,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9110,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9111,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9112,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9113,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9114,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9115,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9116,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9117,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9118,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/11/alpine/Dockerfile," # backwards compat
"
9119,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9120,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9121,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9122,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
9123,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
9124,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
9125,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9126,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9127,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
9128,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9129,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9130,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9131,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9132,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9133,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9134,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9135,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9136,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9137,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9138,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9139,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9140,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9141,35d59a4ae2e0b0ab25d305b7e59bef15cd732432,/9.3/alpine/Dockerfile," # backwards compat
"
9142,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
9143,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9144,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9145,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/Dockerfile-alpine.template,"#		krb5-dev \
"
9146,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/Dockerfile-alpine.template,"#		openldap-dev \
"
9147,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9148,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9149,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9150,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9151,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9152,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9153,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9154,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9155,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
9156,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9157,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/Dockerfile-alpine.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9158,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/Dockerfile-alpine.template," # backwards compat
"
9159,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
9160,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/Dockerfile,"# explicitly set user/group IDs
"
9161,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
9162,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9163,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9164,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9165,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9166,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9167,3706d4c4562c284ed070286b9fd516151167a40c,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9168,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# vim:set ft=dockerfile:
"
9169,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# explicitly set user/group IDs
"
9170,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
9171,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
9172,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# grab gosu for easy step-down from root
"
9173,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9174,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9175,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9176,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9177,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
9178,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# arches officialy built by upstream
"
9179,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9180,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
9181,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9182,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9183,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9184,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9185,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9186,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9187,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9188,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
9189,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9190,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
9191,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9192,f2596e6889a595e8b890010277d46b24f6a89904,/10/Dockerfile," # backwards compat
"
9193,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
9194,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9195,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
9196,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9197,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9198,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
9199,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# explicitly set user/group IDs
"
9200,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
9201,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9202,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9203,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9204,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9205,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# arches officialy built by upstream
"
9206,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9207,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9208,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9209,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9210,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9211,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9212,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9213,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9214,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9215,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9216,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9217,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.4/Dockerfile," # backwards compat
"
9218,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
9219,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/Dockerfile,"# explicitly set user/group IDs
"
9220,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
9221,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9222,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9223,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9224,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9225,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9226,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9227,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.4/Dockerfile," # backwards compat
"
9228,1bddd083582b0977075dda4258f2d9dfbc90482b,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
9229,1bddd083582b0977075dda4258f2d9dfbc90482b,/Dockerfile-alpine.template,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
9230,1bddd083582b0977075dda4258f2d9dfbc90482b,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9231,1bddd083582b0977075dda4258f2d9dfbc90482b,/Dockerfile-alpine.template,"#		krb5-dev \
"
9232,1bddd083582b0977075dda4258f2d9dfbc90482b,/Dockerfile-alpine.template,"#		openldap-dev \
"
9233,1bddd083582b0977075dda4258f2d9dfbc90482b,/Dockerfile-alpine.template,"# configure: error: prove not found
"
9234,1bddd083582b0977075dda4258f2d9dfbc90482b,/Dockerfile-alpine.template,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9235,1bddd083582b0977075dda4258f2d9dfbc90482b,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9236,1bddd083582b0977075dda4258f2d9dfbc90482b,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9237,1bddd083582b0977075dda4258f2d9dfbc90482b,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
9238,1bddd083582b0977075dda4258f2d9dfbc90482b,/Dockerfile-alpine.template,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9239,1bddd083582b0977075dda4258f2d9dfbc90482b,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9240,1bddd083582b0977075dda4258f2d9dfbc90482b,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9241,1bddd083582b0977075dda4258f2d9dfbc90482b,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9242,1bddd083582b0977075dda4258f2d9dfbc90482b,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9243,1bddd083582b0977075dda4258f2d9dfbc90482b,/Dockerfile-alpine.template,"#p' --recursive /usr/local \
"
9244,1bddd083582b0977075dda4258f2d9dfbc90482b,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9245,1bddd083582b0977075dda4258f2d9dfbc90482b,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
9246,1bddd083582b0977075dda4258f2d9dfbc90482b,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9247,1bddd083582b0977075dda4258f2d9dfbc90482b,/Dockerfile-alpine.template,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9248,1bddd083582b0977075dda4258f2d9dfbc90482b,/Dockerfile-alpine.template," # backwards compat
"
9249,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9250,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9251,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
9252,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
9253,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9254,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9255,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9256,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9257,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9258,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9259,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9260,9c9887539c87214bf86e76cafef52bf8c7e4d22f,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9261,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9262,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9263,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9264,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
9265,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
9266,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
9267,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9268,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9269,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9270,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9271,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9272,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9273,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9274,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9275,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9276,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9277,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9278,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9279,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9280,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9281,c552b2bcd8dd5ef822463343b461fe0e31445b9d,/9.6/alpine/Dockerfile," # backwards compat
"
9282,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
9283,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# explicitly set user/group IDs
"
9284,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
9285,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9286,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9287,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# arches officialy built by upstream
"
9288,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9289,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9290,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9291,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9292,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9293,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9294,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9295,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9296,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9297,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9298,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9299,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.4/Dockerfile," # backwards compat
"
9300,ea6f466b258ad42a87a753a10dc84272d56ab699,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
9301,ea6f466b258ad42a87a753a10dc84272d56ab699,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
9302,ea6f466b258ad42a87a753a10dc84272d56ab699,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
9303,ea6f466b258ad42a87a753a10dc84272d56ab699,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9304,ea6f466b258ad42a87a753a10dc84272d56ab699,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9305,ea6f466b258ad42a87a753a10dc84272d56ab699,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9306,ea6f466b258ad42a87a753a10dc84272d56ab699,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
9307,ea6f466b258ad42a87a753a10dc84272d56ab699,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9308,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
9309,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9310,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9311,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/Dockerfile-alpine.template,"#		krb5-dev \
"
9312,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/Dockerfile-alpine.template,"#		openldap-dev \
"
9313,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/Dockerfile-alpine.template,"# configure: error: prove not found
"
9314,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/Dockerfile-alpine.template,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9315,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9316,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9317,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9318,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/Dockerfile-alpine.template,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9319,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9320,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9321,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9322,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9323,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/Dockerfile-alpine.template,"#p' --recursive /usr/local \
"
9324,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9325,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
9326,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9327,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/Dockerfile-alpine.template,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9328,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/Dockerfile-alpine.template," # backwards compat
"
9329,db63c8c4eff2aa81c3f2c9e42f1ede447c7cf99c,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
9330,db63c8c4eff2aa81c3f2c9e42f1ede447c7cf99c,/9.5/Dockerfile,"# explicitly set user/group IDs
"
9331,db63c8c4eff2aa81c3f2c9e42f1ede447c7cf99c,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
9332,db63c8c4eff2aa81c3f2c9e42f1ede447c7cf99c,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9333,db63c8c4eff2aa81c3f2c9e42f1ede447c7cf99c,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9334,db63c8c4eff2aa81c3f2c9e42f1ede447c7cf99c,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9335,db63c8c4eff2aa81c3f2c9e42f1ede447c7cf99c,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9336,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
9337,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9338,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
9339,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9340,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9341,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
9342,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.4/Dockerfile,"# explicitly set user/group IDs
"
9343,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
9344,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9345,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9346,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9347,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9348,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9349,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# vim:set ft=dockerfile:
"
9350,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# explicitly set user/group IDs
"
9351,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
9352,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
9353,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# grab gosu for easy step-down from root
"
9354,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9355,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9356,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9357,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
9358,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9359,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
9360,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# arches officialy built by upstream
"
9361,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9362,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
9363,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9364,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9365,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9366,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9367,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9368,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9369,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9370,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
9371,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9372,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
9373,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9374,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/10/Dockerfile," # backwards compat
"
9375,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9376,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9377,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
9378,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
9379,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9380,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9381,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9382,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9383,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9384,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"# tzdata adds around 1Mb to image size, but it is suggested by Django documentation that timezone should be set for performance reasons: http://bit.ly/2fMYhh1
"
9385,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9386,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9387,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9388,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9389,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9390,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
9391,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
9392,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
9393,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9394,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9395,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9396,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9397,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9398,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9399,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9400,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9401,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9402,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9403,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9404,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9405,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9406,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9407,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/alpine/Dockerfile," # backwards compat
"
9408,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
9409,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# explicitly set user/group IDs
"
9410,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
9411,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9412,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9413,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# arches officialy built by upstream
"
9414,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9415,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9416,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9417,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9418,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9419,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9420,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9421,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9422,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9423,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9424,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9425,7da010d82077944ce39211cc610ce58c11366360,/9.6/Dockerfile," # backwards compat
"
9426,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9427,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
9428,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9429,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"#		krb5-dev \
"
9430,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"#		openldap-dev \
"
9431,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# configure: error: prove not found
"
9432,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9433,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9434,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9435,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9436,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9437,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9438,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9439,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9440,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9441,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9442,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9443,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9444,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9445,bb0d97951918e6d281f510adb3896da433a52bc4,/13/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9446,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9447,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9448,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9449,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"#		krb5-dev \
"
9450,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"#		openldap-dev \
"
9451,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# configure: error: prove not found
"
9452,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9453,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9454,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9455,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9456,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9457,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9458,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9459,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9460,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9461,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9462,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9463,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9464,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9465,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9466,e294fd35ca6243af9e35baa58724cfb432599248,/10/alpine/Dockerfile," # backwards compat
"
9467,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
9468,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# explicitly set user/group IDs
"
9469,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
9470,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
9471,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
9472,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9473,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9474,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9475,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
9476,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9477,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
9478,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# arches officialy built by upstream
"
9479,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9480,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
9481,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9482,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9483,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9484,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9485,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9486,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9487,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9488,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
9489,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9490,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
9491,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9492,95f4307ac7547094b5392d2a2a5aa7471301ffcb,/9.6/Dockerfile," # backwards compat
"
9493,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9494,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9495,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9496,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"#		krb5-dev \
"
9497,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"#		openldap-dev \
"
9498,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# configure: error: prove not found
"
9499,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9500,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9501,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9502,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9503,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9504,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9505,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9506,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9507,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9508,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9509,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9510,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9511,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9512,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9513,7ea5efa503c6ec5d5ee2ebe52acd5eaa50ac75ca,/11/alpine/Dockerfile," # backwards compat
"
9514,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9515,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9516,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9517,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"#		krb5-dev \
"
9518,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"#		openldap-dev \
"
9519,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# configure: error: prove not found
"
9520,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9521,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9522,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9523,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9524,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9525,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9526,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9527,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9528,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9529,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9530,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9531,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9532,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9533,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9534,2035bd0d2a3d155af981340bb9a21eb4a107c7af,/10/alpine/Dockerfile," # backwards compat
"
9535,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9536,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9537,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9538,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"#		krb5-dev \
"
9539,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"#		openldap-dev \
"
9540,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# configure: error: prove not found
"
9541,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9542,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9543,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9544,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9545,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9546,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9547,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9548,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9549,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9550,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9551,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9552,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9553,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9554,5992d8be755d8001474f737a44c73049c519cff3,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9555,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9556,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9557,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
9558,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
9559,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9560,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9561,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9562,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9563,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9564,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"# tzdata loading functionality is optional, and fails gracefully
#		tzdata \
"
9565,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9566,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9567,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
9568,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/Dockerfile,"# explicitly set user/group IDs
"
9569,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
9570,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9571,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9572,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9573,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9574,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9575,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9576,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
9577,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9578,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"#		krb5-dev \
"
9579,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"#		openldap-dev \
"
9580,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# configure: error: prove not found
"
9581,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9582,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9583,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9584,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9585,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9586,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9587,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9588,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9589,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9590,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9591,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9592,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9593,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9594,691a785b0bcb7aea28225a17e794a1edeedf531e,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9595,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9596,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9597,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9598,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
9599,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
9600,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# configure: error: prove not found
"
9601,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9602,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
9603,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9604,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9605,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9606,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9607,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9608,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9609,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9610,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9611,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9612,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9613,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9614,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9615,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.2/alpine/Dockerfile," # backwards compat
"
9616,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
9617,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9618,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
9619,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9620,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9621,ea490430aabd553f34656e8f0e846d2ed3c42930,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9622,ea490430aabd553f34656e8f0e846d2ed3c42930,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9623,63d966973d9593c0d9890b96f10ac73566913520,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
9624,63d966973d9593c0d9890b96f10ac73566913520,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9625,63d966973d9593c0d9890b96f10ac73566913520,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
9626,63d966973d9593c0d9890b96f10ac73566913520,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9627,63d966973d9593c0d9890b96f10ac73566913520,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9628,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
9629,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# explicitly set user/group IDs
"
9630,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
9631,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
9632,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
9633,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9634,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9635,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9636,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9637,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
9638,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# arches officialy built by upstream
"
9639,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9640,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
9641,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9642,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9643,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9644,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9645,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9646,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9647,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9648,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
9649,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9650,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
9651,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9652,95aa37a2b5e53c434a8bc056212ff6ac828bfad7,/9.6/Dockerfile," # backwards compat
"
9653,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9654,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9655,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9656,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"#		krb5-dev \
"
9657,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"#		openldap-dev \
"
9658,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# configure: error: prove not found
"
9659,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9660,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9661,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9662,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9663,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9664,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9665,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9666,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9667,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9668,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9669,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9670,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9671,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/alpine/Dockerfile," # backwards compat
"
9672,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
9673,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
9674,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
9675,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9676,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9677,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9678,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
9679,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9680,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/Dockerfile-debian.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9681,c686efac7c1c9db3e3b4a95cff93e2057c237a2e,/Dockerfile-debian.template," # backwards compat
"
9682,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9683,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9684,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9685,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
9686,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9687,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
9688,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
9689,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
9690,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9691,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9692,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9693,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9694,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9695,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9696,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9697,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9698,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9699,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9700,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9701,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9702,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9703,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9704,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.4/alpine/Dockerfile," # backwards compat
"
9705,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9706,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9707,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9708,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
9709,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
9710,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
9711,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9712,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9713,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9714,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9715,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9716,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9717,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9718,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9719,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9720,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9721,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9722,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9723,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9724,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9725,d8e907ea048f0f0138769ca91de1a779bf297aca,/9.4/alpine/Dockerfile," # backwards compat
"
9726,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9727,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9728,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9729,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
9730,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
9731,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
9732,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9733,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9734,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9735,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9736,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9737,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9738,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9739,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9740,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9741,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9742,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9743,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9744,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9745,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9746,dc36bbe68fb7f8c2a8b421944cb80aa73681e093,/9.4/alpine/Dockerfile," # backwards compat
"
9747,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
9748,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9749,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9750,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/Dockerfile-alpine.template,"#		krb5-dev \
"
9751,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/Dockerfile-alpine.template,"#		openldap-dev \
"
9752,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9753,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9754,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9755,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9756,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9757,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9758,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9759,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9760,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
9761,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9762,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/Dockerfile-alpine.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9763,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/Dockerfile-alpine.template," # backwards compat
"
9764,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9765,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9766,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9767,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"#		krb5-dev \
"
9768,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"#		openldap-dev \
"
9769,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# configure: error: prove not found
"
9770,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9771,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9772,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9773,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9774,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9775,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9776,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9777,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9778,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9779,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9780,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9781,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9782,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9783,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9784,a78bff54b531d6ef106e43b020712086fff6a67f,/10/alpine/Dockerfile," # backwards compat
"
9785,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9786,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9787,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9788,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
9789,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
9790,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9791,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
9792,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9793,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9794,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9795,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9796,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9797,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9798,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9799,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9800,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9801,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9802,ee20f10a40f8893d5f67d593ddd44ba05d0c9df9,/9.2/alpine/Dockerfile," # backwards compat
"
9803,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
9804,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.5/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9805,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
9806,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9807,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9808,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9809,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9810,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9811,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
9812,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
9813,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9814,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
9815,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9816,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9817,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9818,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9819,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9820,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9821,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9822,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9823,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9824,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9825,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9826,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9827,975f6a2705d981f865a2cb0536a86a46e5839534,/9.3/alpine/Dockerfile," # backwards compat
"
9828,51e5166d69320581cb707d6fb102d3ba04803400,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
9829,51e5166d69320581cb707d6fb102d3ba04803400,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9830,51e5166d69320581cb707d6fb102d3ba04803400,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
9831,51e5166d69320581cb707d6fb102d3ba04803400,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9832,51e5166d69320581cb707d6fb102d3ba04803400,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9833,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
9834,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# explicitly set user/group IDs
"
9835,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
9836,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
9837,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
9838,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9839,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9840,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9841,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9842,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
9843,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# arches officialy built by upstream
"
9844,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9845,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
9846,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9847,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9848,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9849,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9850,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9851,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9852,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9853,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
9854,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9855,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
9856,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9857,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.6/Dockerfile," # backwards compat
"
9858,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# vim:set ft=dockerfile:
"
9859,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# explicitly set user/group IDs
"
9860,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# grab gosu for easy step-down from root
"
9861,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9862,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9863,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9864,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9865,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# arches officialy built by upstream
"
9866,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9867,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9868,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9869,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9870,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9871,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9872,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9873,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9874,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9875,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
9876,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9877,927a8525cf80896f2bd146a1b0eff7d6ef2cb7bf,/11/Dockerfile," # backwards compat
"
9878,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9879,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
9880,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9881,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
9882,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
9883,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
9884,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
9885,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9886,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9887,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9888,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9889,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9890,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9891,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9892,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9893,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
9894,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9895,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9896,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9897,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9898,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.4/alpine/Dockerfile," # backwards compat
"
9899,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
9900,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9901,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
9902,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9903,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9904,73d73760957c7038dd3c07212b5b9daf86a2cb38,/8.4/Dockerfile,"# vim:set ft=dockerfile:
"
9905,73d73760957c7038dd3c07212b5b9daf86a2cb38,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
9906,73d73760957c7038dd3c07212b5b9daf86a2cb38,/8.4/Dockerfile,"# grab gosu for easy step-down from root
"
9907,73d73760957c7038dd3c07212b5b9daf86a2cb38,/8.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9908,73d73760957c7038dd3c07212b5b9daf86a2cb38,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9909,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9910,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
9911,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9912,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
9913,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
9914,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9915,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9916,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9917,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
9918,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9919,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9920,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9921,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9922,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
9923,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9924,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
9925,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9926,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.4/alpine/Dockerfile," # backwards compat
"
9927,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# vim:set ft=dockerfile:
"
9928,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# explicitly set user/group IDs
"
9929,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
9930,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
9931,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# grab gosu for easy step-down from root
"
9932,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9933,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9934,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9935,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9936,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
9937,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# arches officialy built by upstream
"
9938,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9939,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
9940,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9941,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9942,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9943,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9944,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9945,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9946,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9947,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
9948,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
9949,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
9950,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9951,505eda129119afc4cfc86fcacd407a31e9ab22c0,/11/Dockerfile," # backwards compat
"
9952,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
9953,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.3/Dockerfile,"# explicitly set user/group IDs
"
9954,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
9955,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9956,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9957,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
9958,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.2/Dockerfile,"# explicitly set user/group IDs
"
9959,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
9960,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9961,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
9962,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
9963,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
9964,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
9965,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
9966,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
9967,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
9968,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
9969,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
9970,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
9971,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
9972,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# see note below about ""*.pyc"" files
"
9973,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# arches officialy built by upstream
"
9974,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
9975,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
9976,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
9977,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# we don't remove APT lists here because they get re-downloaded and removed later
"
9978,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
9979,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
9980,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
9981,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
9982,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
9983,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
9984,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
9985,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
9986,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
9987,a1420dac644b8190df5e78e80bfa9610b2f077e2,/Dockerfile-debian.template," # backwards compat
"
9988,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
9989,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
9990,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
9991,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
9992,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
9993,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
9994,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
9995,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
9996,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
9997,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
9998,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
9999,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10000,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10001,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10002,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10003,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.6/alpine/Dockerfile," # backwards compat
"
10004,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
10005,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/Dockerfile,"# explicitly set user/group IDs
"
10006,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
10007,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10008,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10009,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10010,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10011,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10012,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10013,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/Dockerfile," # backwards compat
"
10014,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
10015,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10016,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10017,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/Dockerfile-alpine.template,"#		krb5-dev \
"
10018,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/Dockerfile-alpine.template,"#		openldap-dev \
"
10019,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/Dockerfile-alpine.template,"# configure: error: prove not found
"
10020,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/Dockerfile-alpine.template,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10021,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10022,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10023,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10024,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/Dockerfile-alpine.template,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10025,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10026,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10027,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10028,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10029,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/Dockerfile-alpine.template,"#p' --recursive /usr/local \
"
10030,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10031,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
10032,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10033,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/Dockerfile-alpine.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10034,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/Dockerfile-alpine.template," # backwards compat
"
10035,8c03e6aed7046c4bacbc1b7c356edd81bd72c6d5,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
10036,8c03e6aed7046c4bacbc1b7c356edd81bd72c6d5,/9.2/Dockerfile,"# explicitly set user/group IDs
"
10037,8c03e6aed7046c4bacbc1b7c356edd81bd72c6d5,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
10038,8c03e6aed7046c4bacbc1b7c356edd81bd72c6d5,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10039,8c03e6aed7046c4bacbc1b7c356edd81bd72c6d5,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10040,8c03e6aed7046c4bacbc1b7c356edd81bd72c6d5,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10041,8c03e6aed7046c4bacbc1b7c356edd81bd72c6d5,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10042,8c03e6aed7046c4bacbc1b7c356edd81bd72c6d5,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10043,8c03e6aed7046c4bacbc1b7c356edd81bd72c6d5,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10044,8c03e6aed7046c4bacbc1b7c356edd81bd72c6d5,/9.2/Dockerfile," # backwards compat
"
10045,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
10046,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# explicitly set user/group IDs
"
10047,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10048,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10049,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
10050,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10051,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10052,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10053,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10054,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
10055,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# arches officialy built by upstream
"
10056,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10057,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10058,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10059,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10060,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10061,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10062,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10063,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10064,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10065,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10066,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10067,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10068,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10069,34af727d7b54676c48c2f4c5f144cd395f9f93da,/9.5/Dockerfile," # backwards compat
"
10070,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
10071,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/Dockerfile,"# explicitly set user/group IDs
"
10072,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
10073,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10074,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10075,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10076,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10077,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10078,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10079,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.3/Dockerfile," # backwards compat
"
10080,bef7a7e02643bb0f104ba346395d3cdb78db1480,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
10081,bef7a7e02643bb0f104ba346395d3cdb78db1480,/9.6/Dockerfile,"# explicitly set user/group IDs
"
10082,bef7a7e02643bb0f104ba346395d3cdb78db1480,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
10083,bef7a7e02643bb0f104ba346395d3cdb78db1480,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10084,bef7a7e02643bb0f104ba346395d3cdb78db1480,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10085,bef7a7e02643bb0f104ba346395d3cdb78db1480,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10086,bef7a7e02643bb0f104ba346395d3cdb78db1480,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10087,bef7a7e02643bb0f104ba346395d3cdb78db1480,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10088,bef7a7e02643bb0f104ba346395d3cdb78db1480,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10089,bef7a7e02643bb0f104ba346395d3cdb78db1480,/9.6/Dockerfile," # backwards compat
"
10090,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10091,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10092,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10093,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
10094,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
10095,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
10096,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10097,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10098,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10099,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10100,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10101,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10102,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10103,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10104,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10105,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10106,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10107,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10108,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10109,d1725ffa8ba29ed7649bd453065eb392f63a3113,/9.6/alpine/Dockerfile," # backwards compat
"
10110,d74b69598c835fe15eac39a26b5c61058f99c3db,/8.4/Dockerfile,"# vim:set ft=dockerfile:
"
10111,d74b69598c835fe15eac39a26b5c61058f99c3db,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
10112,d74b69598c835fe15eac39a26b5c61058f99c3db,/8.4/Dockerfile,"# grab gosu for easy step-down from root
"
10113,d74b69598c835fe15eac39a26b5c61058f99c3db,/8.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10114,d74b69598c835fe15eac39a26b5c61058f99c3db,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10115,6870d3db740a321699ef49c8068c3d812b9681e1,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
10116,6870d3db740a321699ef49c8068c3d812b9681e1,/9.3/Dockerfile,"# explicitly set user/group IDs
"
10117,6870d3db740a321699ef49c8068c3d812b9681e1,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
10118,6870d3db740a321699ef49c8068c3d812b9681e1,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10119,6870d3db740a321699ef49c8068c3d812b9681e1,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10120,6870d3db740a321699ef49c8068c3d812b9681e1,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10121,6870d3db740a321699ef49c8068c3d812b9681e1,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10122,6870d3db740a321699ef49c8068c3d812b9681e1,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10123,6870d3db740a321699ef49c8068c3d812b9681e1,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10124,6870d3db740a321699ef49c8068c3d812b9681e1,/9.3/Dockerfile," # backwards compat
"
10125,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
10126,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# explicitly set user/group IDs
"
10127,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
10128,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10129,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10130,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# arches officialy built by upstream
"
10131,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10132,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10133,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10134,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10135,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10136,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10137,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10138,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10139,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10140,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10141,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10142,3001d13fcac68cf9f8b0217eafdad8e83c41907c,/9.4/Dockerfile," # backwards compat
"
10143,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
10144,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# explicitly set user/group IDs
"
10145,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10146,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10147,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
10148,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10149,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10150,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10151,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10152,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
10153,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# arches officialy built by upstream
"
10154,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10155,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10156,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10157,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10158,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10159,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10160,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10161,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10162,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10163,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10164,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10165,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10166,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10167,f45fb749594bfe5ea893fe8b3340757600f03f7e,/9.5/Dockerfile," # backwards compat
"
10168,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# vim:set ft=dockerfile:
"
10169,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# explicitly set user/group IDs
"
10170,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10171,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10172,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
10173,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10174,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10175,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10176,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
10177,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10178,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
10179,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# arches officialy built by upstream
"
10180,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10181,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10182,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10183,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10184,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10185,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10186,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10187,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10188,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10189,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10190,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10191,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10192,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10193,8787b168802a629ec12be1e7fed98b940baf90d7,/12/Dockerfile," # backwards compat
"
10194,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
10195,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
10196,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
10197,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10198,d74b69598c835fe15eac39a26b5c61058f99c3db,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10199,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10200,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10201,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
10202,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
10203,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10204,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
10205,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10206,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10207,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10208,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10209,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10210,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10211,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10212,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10213,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10214,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10215,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.3/alpine/Dockerfile," # backwards compat
"
10216,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
10217,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10218,937cc2b25a6db9dafb60241185d492917dc842b0,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
10219,937cc2b25a6db9dafb60241185d492917dc842b0,/9.2/Dockerfile,"# explicitly set user/group IDs
"
10220,937cc2b25a6db9dafb60241185d492917dc842b0,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
10221,937cc2b25a6db9dafb60241185d492917dc842b0,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10222,937cc2b25a6db9dafb60241185d492917dc842b0,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10223,937cc2b25a6db9dafb60241185d492917dc842b0,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10224,937cc2b25a6db9dafb60241185d492917dc842b0,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10225,937cc2b25a6db9dafb60241185d492917dc842b0,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10226,937cc2b25a6db9dafb60241185d492917dc842b0,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10227,937cc2b25a6db9dafb60241185d492917dc842b0,/9.2/Dockerfile," # backwards compat
"
10228,63d966973d9593c0d9890b96f10ac73566913520,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
10229,63d966973d9593c0d9890b96f10ac73566913520,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
10230,63d966973d9593c0d9890b96f10ac73566913520,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
10231,63d966973d9593c0d9890b96f10ac73566913520,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10232,63d966973d9593c0d9890b96f10ac73566913520,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10233,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10234,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10235,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10236,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"#		krb5-dev \
"
10237,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"#		openldap-dev \
"
10238,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# configure: error: prove not found
"
10239,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10240,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10241,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10242,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10243,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10244,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10245,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10246,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10247,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10248,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10249,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10250,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10251,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10252,f08b03f05b690748660ff738975a104c19fc5500,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10253,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10254,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10255,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10256,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
10257,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
10258,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
10259,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10260,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10261,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10262,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10263,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10264,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10265,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10266,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10267,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10268,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10269,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10270,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10271,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10272,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10273,cac7a604117456de7dcb0cfaf7ff7c11fb4b0520,/9.6/alpine/Dockerfile," # backwards compat
"
10274,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# vim:set ft=dockerfile:
"
10275,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# explicitly set user/group IDs
"
10276,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10277,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10278,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# grab gosu for easy step-down from root
"
10279,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10280,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10281,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10282,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10283,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
10284,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# arches officialy built by upstream
"
10285,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10286,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10287,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10288,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10289,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10290,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10291,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10292,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10293,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10294,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10295,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10296,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10297,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10298,9d8e2448436b2af1ea715822c2d209d493760007,/11/Dockerfile," # backwards compat
"
10299,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# vim:set ft=dockerfile:
"
10300,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# explicitly set user/group IDs
"
10301,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10302,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10303,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# grab gosu for easy step-down from root
"
10304,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10305,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10306,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10307,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
10308,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10309,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
10310,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# arches officialy built by upstream
"
10311,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10312,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10313,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10314,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10315,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10316,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10317,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10318,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10319,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10320,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10321,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10322,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10323,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10324,f08d426f2e1554d82259389dcc981c71527dd44d,/12/Dockerfile," # backwards compat
"
10325,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
10326,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
10327,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
10328,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10329,77438cd8e1c2b780b4f859c5efd904ae3c6c508a,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10330,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
10331,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10332,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-alpine.template,"#		krb5-dev \
"
10333,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-alpine.template,"#		openldap-dev \
"
10334,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10335,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10336,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10337,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10338,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10339,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10340,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10341,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10342,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
10343,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10344,3706d4c4562c284ed070286b9fd516151167a40c,/Dockerfile-alpine.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10345,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
10346,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
10347,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10348,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10349,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
10350,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10351,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10352,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10353,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10354,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# see note below about ""*.pyc"" files
"
10355,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# arches officialy built by upstream
"
10356,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10357,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10358,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10359,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10360,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10361,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10362,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10363,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10364,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10365,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10366,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
10367,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10368,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10369,85aadc08c347cd20f199902c4b8b4f736341c3b8,/Dockerfile-debian.template," # backwards compat
"
10370,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# vim:set ft=dockerfile:
"
10371,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# explicitly set user/group IDs
"
10372,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10373,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10374,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# grab gosu for easy step-down from root
"
10375,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10376,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10377,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10378,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10379,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
10380,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# arches officialy built by upstream
"
10381,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10382,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10383,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10384,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10385,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10386,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10387,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10388,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10389,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10390,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10391,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10392,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10393,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10394,faf08dbfd0675d144cbdef39f4506425ec7cee26,/12/Dockerfile," # backwards compat
"
10395,69a30d9e6f12c57296b11d3511127210466f0197,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
10396,69a30d9e6f12c57296b11d3511127210466f0197,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
10397,69a30d9e6f12c57296b11d3511127210466f0197,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
10398,69a30d9e6f12c57296b11d3511127210466f0197,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10399,69a30d9e6f12c57296b11d3511127210466f0197,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10400,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10401,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10402,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
10403,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
10404,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10405,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10406,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10407,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10408,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10409,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10410,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10411,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10412,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10413,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10414,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10415,6e1d6d682519cabd49e33f720f3cdeda426745c6,/9.2/alpine/Dockerfile," # backwards compat
"
10416,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10417,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10418,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10419,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
10420,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
10421,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10422,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10423,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10424,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10425,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10426,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10427,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10428,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10429,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10430,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10431,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10432,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10433,975f6a2705d981f865a2cb0536a86a46e5839534,/9.6/alpine/Dockerfile," # backwards compat
"
10434,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# vim:set ft=dockerfile:
"
10435,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# explicitly set user/group IDs
"
10436,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10437,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10438,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# grab gosu for easy step-down from root
"
10439,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10440,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10441,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10442,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10443,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
10444,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# arches officialy built by upstream
"
10445,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10446,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10447,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10448,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10449,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10450,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10451,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10452,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10453,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10454,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10455,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10456,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10457,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10458,75ebadd71bd54836de126f851f5edbc2bdee4201,/12/Dockerfile," # backwards compat
"
10459,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
10460,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# explicitly set user/group IDs
"
10461,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10462,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10463,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
10464,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10465,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10466,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10467,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10468,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
10469,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# arches officialy built by upstream
"
10470,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10471,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10472,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10473,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10474,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10475,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10476,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10477,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10478,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10479,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10480,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10481,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10482,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10483,064113e0e481a1d0542846b81858e457fde02c90,/9.4/Dockerfile," # backwards compat
"
10484,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
10485,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.2/Dockerfile,"# explicitly set user/group IDs
"
10486,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
10487,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10488,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10489,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10490,2184bbc2d7e9daba786e15b19d4baace047deeba,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10491,a6d4922823aa8011513bb9c160c26c689301823a,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
10492,a6d4922823aa8011513bb9c160c26c689301823a,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
10493,a6d4922823aa8011513bb9c160c26c689301823a,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
10494,a6d4922823aa8011513bb9c160c26c689301823a,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10495,a6d4922823aa8011513bb9c160c26c689301823a,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10496,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10497,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10498,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10499,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
10500,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
10501,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
10502,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10503,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10504,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10505,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10506,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10507,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10508,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10509,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10510,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10511,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10512,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10513,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10514,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10515,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10516,a06a9377438d8e0805e49ce65bbcb810a711df52,/9.6/alpine/Dockerfile," # backwards compat
"
10517,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# vim:set ft=dockerfile:
"
10518,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# explicitly set user/group IDs
"
10519,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10520,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10521,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# grab gosu for easy step-down from root
"
10522,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10523,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10524,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10525,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10526,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
10527,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# arches officialy built by upstream
"
10528,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10529,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10530,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10531,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10532,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10533,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10534,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10535,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10536,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10537,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10538,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10539,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10540,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10541,040949af1595f49f2242f6d1f9c42fb042b3eaed,/11/Dockerfile," # backwards compat
"
10542,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10543,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10544,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
10545,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
10546,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10547,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10548,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10549,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10550,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10551,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10552,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10553,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10554,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10555,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10556,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10557,86ef6fa873cdc310e9f23a127ae2865b1d8745ba,/9.2/alpine/Dockerfile," # backwards compat
"
10558,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/8.4/Dockerfile,"# vim:set ft=dockerfile:
"
10559,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
10560,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/8.4/Dockerfile,"# grab gosu for easy step-down from root
"
10561,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/8.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10562,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10563,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
10564,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# explicitly set user/group IDs
"
10565,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
10566,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10567,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10568,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10569,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# arches officialy built by upstream
"
10570,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10571,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10572,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10573,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10574,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10575,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10576,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10577,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10578,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10579,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10580,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10581,ef4545c07bd97e5585bb9e7f2680a4859b9ccf3c,/9.4/Dockerfile," # backwards compat
"
10582,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
10583,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# explicitly set user/group IDs
"
10584,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10585,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10586,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
10587,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10588,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10589,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10590,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
10591,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10592,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
10593,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# arches officialy built by upstream
"
10594,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10595,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10596,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10597,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10598,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10599,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10600,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10601,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10602,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10603,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10604,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10605,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10606,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10607,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/9.5/Dockerfile," # backwards compat
"
10608,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
10609,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# explicitly set user/group IDs
"
10610,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
10611,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10612,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10613,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# arches officialy built by upstream
"
10614,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10615,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10616,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10617,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10618,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10619,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10620,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10621,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10622,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10623,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10624,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10625,07ae979980f889e83ee8f4afc1fee09fdb663ab3,/9.5/Dockerfile," # backwards compat
"
10626,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
10627,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
10628,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
10629,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10630,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10631,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
10632,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# explicitly set user/group IDs
"
10633,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10634,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10635,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
10636,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10637,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10638,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10639,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10640,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
10641,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# arches officialy built by upstream
"
10642,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10643,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10644,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10645,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10646,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10647,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10648,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10649,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10650,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10651,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10652,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10653,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10654,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10655,58793919b63a1e0b2a9797b857bf435276e28436,/9.5/Dockerfile," # backwards compat
"
10656,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
10657,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# explicitly set user/group IDs
"
10658,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10659,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10660,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
10661,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10662,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10663,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10664,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10665,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# arches officialy built by upstream
"
10666,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10667,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10668,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10669,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10670,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10671,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10672,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10673,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10674,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10675,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10676,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10677,726128b358cdc0efc1753475bbe502b07cbbb540,/9.4/Dockerfile," # backwards compat
"
10678,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10679,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10680,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10681,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"#		krb5-dev \
"
10682,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"#		openldap-dev \
"
10683,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# configure: error: prove not found
"
10684,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10685,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10686,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10687,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10688,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10689,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10690,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10691,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10692,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10693,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10694,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10695,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10696,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10697,1d43a9d52107cef3a2ae8293e738bce754d4c4e6,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10698,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
10699,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
10700,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
10701,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10702,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10703,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
10704,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# explicitly set user/group IDs
"
10705,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
10706,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10707,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10708,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10709,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10710,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# arches officialy built by upstream
"
10711,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10712,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10713,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10714,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10715,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10716,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10717,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10718,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10719,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10720,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10721,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10722,6192edf44a557a7467d8f491899a9ac8f953d82c,/9.4/Dockerfile," # backwards compat
"
10723,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
10724,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.5/Dockerfile,"# explicitly set user/group IDs
"
10725,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
10726,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10727,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10728,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10729,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10730,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10731,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10732,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10733,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
10734,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
10735,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10736,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
10737,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10738,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10739,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10740,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10741,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10742,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10743,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10744,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10745,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10746,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10747,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10748,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10749,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.2/alpine/Dockerfile," # backwards compat
"
10750,c66fc738ed2eb957881a855eda7f921f785ec7a3,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
10751,c66fc738ed2eb957881a855eda7f921f785ec7a3,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10752,c66fc738ed2eb957881a855eda7f921f785ec7a3,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10753,c66fc738ed2eb957881a855eda7f921f785ec7a3,/Dockerfile-alpine.template,"#		krb5-dev \
"
10754,c66fc738ed2eb957881a855eda7f921f785ec7a3,/Dockerfile-alpine.template,"#		openldap-dev \
"
10755,c66fc738ed2eb957881a855eda7f921f785ec7a3,/Dockerfile-alpine.template,"# configure: error: prove not found
"
10756,c66fc738ed2eb957881a855eda7f921f785ec7a3,/Dockerfile-alpine.template,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10757,c66fc738ed2eb957881a855eda7f921f785ec7a3,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10758,c66fc738ed2eb957881a855eda7f921f785ec7a3,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10759,c66fc738ed2eb957881a855eda7f921f785ec7a3,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10760,c66fc738ed2eb957881a855eda7f921f785ec7a3,/Dockerfile-alpine.template,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10761,c66fc738ed2eb957881a855eda7f921f785ec7a3,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10762,c66fc738ed2eb957881a855eda7f921f785ec7a3,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10763,c66fc738ed2eb957881a855eda7f921f785ec7a3,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10764,c66fc738ed2eb957881a855eda7f921f785ec7a3,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10765,c66fc738ed2eb957881a855eda7f921f785ec7a3,/Dockerfile-alpine.template,"#p' --recursive /usr/local \
"
10766,c66fc738ed2eb957881a855eda7f921f785ec7a3,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10767,c66fc738ed2eb957881a855eda7f921f785ec7a3,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
10768,c66fc738ed2eb957881a855eda7f921f785ec7a3,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10769,c66fc738ed2eb957881a855eda7f921f785ec7a3,/Dockerfile-alpine.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10770,c66fc738ed2eb957881a855eda7f921f785ec7a3,/Dockerfile-alpine.template," # backwards compat
"
10771,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10772,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10773,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
10774,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
10775,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10776,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10777,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10778,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10779,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10780,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"# tzdata loading functionality is optional, and fails gracefully
#		tzdata \
"
10781,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10782,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10783,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10784,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10785,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10786,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
10787,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
10788,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
10789,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10790,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10791,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10792,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10793,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10794,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10795,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10796,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10797,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10798,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10799,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10800,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10801,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10802,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10803,5992d8be755d8001474f737a44c73049c519cff3,/9.4/alpine/Dockerfile," # backwards compat
"
10804,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10805,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10806,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10807,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
10808,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
10809,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
10810,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10811,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10812,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10813,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10814,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10815,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10816,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10817,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10818,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10819,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10820,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10821,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10822,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10823,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10824,cd2cafec4e998847fd2b10f08cc3444a2116e6d5,/9.4/alpine/Dockerfile," # backwards compat
"
10825,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
10826,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/Dockerfile,"# explicitly set user/group IDs
"
10827,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
10828,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10829,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10830,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10831,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10832,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10833,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10834,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.6/Dockerfile," # backwards compat
"
10835,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
10836,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# explicitly set user/group IDs
"
10837,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10838,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10839,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
10840,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10841,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10842,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10843,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10844,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# see note below about ""*.pyc"" files
"
10845,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# arches officialy built by upstream
"
10846,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10847,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10848,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10849,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10850,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10851,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10852,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10853,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10854,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10855,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10856,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10857,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10858,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10859,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.4/Dockerfile," # backwards compat
"
10860,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10861,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
10862,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10863,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"#		krb5-dev \
"
10864,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"#		openldap-dev \
"
10865,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# configure: error: prove not found
"
10866,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10867,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10868,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10869,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10870,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10871,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10872,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10873,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10874,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10875,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10876,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10877,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10878,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10879,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10880,245058ccb66fd6cb34fc512323f20ed676f1af15,/10/alpine/Dockerfile," # backwards compat
"
10881,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# vim:set ft=dockerfile:
"
10882,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# explicitly set user/group IDs
"
10883,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
10884,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
10885,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
10886,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10887,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
10888,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
10889,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
10890,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10891,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# see note below about ""*.pyc"" files
"
10892,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# arches officialy built by upstream
"
10893,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
10894,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
10895,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
10896,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# we need DEBIAN_FRONTEND on postgresql-13 for slapd (""Please enter the password for the admin entry in your LDAP directory.""); see https://bugs.debian.org/929417
"
10897,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
10898,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
10899,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
10900,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
10901,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
10902,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
10903,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
10904,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10905,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
10906,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10907,4c2e78c234a8e4293a5d6bb6a4d20421236d98d8,/13/Dockerfile," # backwards compat
"
10908,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10909,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
10910,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10911,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"#		krb5-dev \
"
10912,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"#		openldap-dev \
"
10913,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# configure: error: prove not found
"
10914,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10915,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10916,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10917,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10918,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10919,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10920,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10921,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10922,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10923,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10924,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10925,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10926,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10927,52814abac491eca146620f921a44e2cb4217088e,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10928,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10929,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10930,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10931,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
10932,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
10933,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
10934,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10935,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10936,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10937,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10938,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10939,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10940,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10941,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10942,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10943,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
10944,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10945,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10946,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10947,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10948,fd5c083fcfb276b9cc2299057a8c6c8431bc3b0a,/9.4/alpine/Dockerfile," # backwards compat
"
10949,2df7c179897a4a0c5dbb5a68543e46fb77215067,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
10950,2df7c179897a4a0c5dbb5a68543e46fb77215067,/9.1/Dockerfile,"# explicitly set user/group IDs
"
10951,2df7c179897a4a0c5dbb5a68543e46fb77215067,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
10952,2df7c179897a4a0c5dbb5a68543e46fb77215067,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10953,2df7c179897a4a0c5dbb5a68543e46fb77215067,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10954,2df7c179897a4a0c5dbb5a68543e46fb77215067,/9.1/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10955,2df7c179897a4a0c5dbb5a68543e46fb77215067,/9.1/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10956,f3146f857b42bd4c4cb2be6134149fddee546584,/10/Dockerfile,"# vim:set ft=dockerfile:
"
10957,f3146f857b42bd4c4cb2be6134149fddee546584,/10/Dockerfile,"# explicitly set user/group IDs
"
10958,f3146f857b42bd4c4cb2be6134149fddee546584,/10/Dockerfile,"# grab gosu for easy step-down from root
"
10959,f3146f857b42bd4c4cb2be6134149fddee546584,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10960,f3146f857b42bd4c4cb2be6134149fddee546584,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
10961,f3146f857b42bd4c4cb2be6134149fddee546584,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10962,f3146f857b42bd4c4cb2be6134149fddee546584,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10963,f3146f857b42bd4c4cb2be6134149fddee546584,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
10964,f3146f857b42bd4c4cb2be6134149fddee546584,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
10965,f3146f857b42bd4c4cb2be6134149fddee546584,/10/Dockerfile," # backwards compat
"
10966,51e5166d69320581cb707d6fb102d3ba04803400,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
10967,51e5166d69320581cb707d6fb102d3ba04803400,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
10968,51e5166d69320581cb707d6fb102d3ba04803400,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
10969,51e5166d69320581cb707d6fb102d3ba04803400,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10970,51e5166d69320581cb707d6fb102d3ba04803400,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10971,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
10972,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
10973,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.0/Dockerfile,"# grab gosu for easy step-down from root
"
10974,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.0/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10975,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10976,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
10977,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
10978,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
10979,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
10980,bfca9b8a92a99ccfc8f04933b7ecc29a108c7f49,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
10981,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
10982,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
10983,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
10984,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"#		krb5-dev \
"
10985,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"#		openldap-dev \
"
10986,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# configure: error: prove not found
"
10987,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
10988,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
10989,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
10990,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
10991,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
10992,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
10993,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
10994,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
10995,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
10996,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
10997,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
10998,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
10999,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11000,f3146f857b42bd4c4cb2be6134149fddee546584,/10/alpine/Dockerfile," # backwards compat
"
11001,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
11002,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
11003,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
11004,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11005,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11006,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11007,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11008,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
11009,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
11010,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11011,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11012,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11013,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11014,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11015,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11016,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11017,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11018,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11019,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11020,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11021,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
11022,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11023,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"#		krb5-dev \
"
11024,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"#		openldap-dev \
"
11025,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# configure: error: prove not found
"
11026,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11027,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11028,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11029,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11030,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11031,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11032,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11033,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11034,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11035,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11036,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11037,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11038,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11039,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11040,b1f60bd4f88fa2f82aaaa304dc1476a26938cb38,/11/alpine/Dockerfile," # backwards compat
"
11041,1089a8971b43a675109ad886bf1f3b327c067fa1,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
11042,1089a8971b43a675109ad886bf1f3b327c067fa1,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11043,1089a8971b43a675109ad886bf1f3b327c067fa1,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11044,1089a8971b43a675109ad886bf1f3b327c067fa1,/Dockerfile-alpine.template,"#		krb5-dev \
"
11045,1089a8971b43a675109ad886bf1f3b327c067fa1,/Dockerfile-alpine.template,"#		openldap-dev \
"
11046,1089a8971b43a675109ad886bf1f3b327c067fa1,/Dockerfile-alpine.template,"# configure: error: prove not found
"
11047,1089a8971b43a675109ad886bf1f3b327c067fa1,/Dockerfile-alpine.template,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11048,1089a8971b43a675109ad886bf1f3b327c067fa1,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11049,1089a8971b43a675109ad886bf1f3b327c067fa1,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11050,1089a8971b43a675109ad886bf1f3b327c067fa1,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11051,1089a8971b43a675109ad886bf1f3b327c067fa1,/Dockerfile-alpine.template,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11052,1089a8971b43a675109ad886bf1f3b327c067fa1,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11053,1089a8971b43a675109ad886bf1f3b327c067fa1,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11054,1089a8971b43a675109ad886bf1f3b327c067fa1,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11055,1089a8971b43a675109ad886bf1f3b327c067fa1,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11056,1089a8971b43a675109ad886bf1f3b327c067fa1,/Dockerfile-alpine.template,"#p' --recursive /usr/local \
"
11057,1089a8971b43a675109ad886bf1f3b327c067fa1,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11058,1089a8971b43a675109ad886bf1f3b327c067fa1,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
11059,1089a8971b43a675109ad886bf1f3b327c067fa1,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11060,1089a8971b43a675109ad886bf1f3b327c067fa1,/Dockerfile-alpine.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11061,1089a8971b43a675109ad886bf1f3b327c067fa1,/Dockerfile-alpine.template," # backwards compat
"
11062,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
11063,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.2/Dockerfile,"# explicitly set user/group IDs
"
11064,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
11065,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11066,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11067,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11068,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11069,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11070,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
11071,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11072,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"#		krb5-dev \
"
11073,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"#		openldap-dev \
"
11074,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# configure: error: prove not found
"
11075,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11076,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11077,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11078,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11079,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11080,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11081,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11082,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11083,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11084,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11085,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11086,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11087,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11088,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11089,c4b019526a25d1300de77b9699d53ad187cf0dcf,/11/alpine/Dockerfile," # backwards compat
"
11090,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/8.4/Dockerfile,"# vim:set ft=dockerfile:
"
11091,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/8.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
11092,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/8.4/Dockerfile,"# grab gosu for easy step-down from root
"
11093,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/8.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11094,33b8046b5f68b465a3c04fcc428e8923bcb7cd12,/8.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11095,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
11096,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# explicitly set user/group IDs
"
11097,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11098,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11099,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
11100,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11101,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11102,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11103,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11104,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# see note below about ""*.pyc"" files
"
11105,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# arches officialy built by upstream
"
11106,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11107,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11108,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11109,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11110,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11111,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11112,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11113,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11114,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11115,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11116,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11117,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
11118,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11119,040949af1595f49f2242f6d1f9c42fb042b3eaed,/9.3/Dockerfile," # backwards compat
"
11120,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# vim:set ft=dockerfile:
"
11121,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# explicitly set user/group IDs
"
11122,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# grab gosu for easy step-down from root
"
11123,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11124,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11125,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11126,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11127,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# arches officialy built by upstream
"
11128,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11129,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11130,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11131,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11132,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11133,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11134,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11135,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11136,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11137,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11138,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11139,9986244c45efe383456aa4116c6dfd5f5083871e,/11/Dockerfile," # backwards compat
"
11140,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11141,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11142,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11143,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"#		krb5-dev \
"
11144,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"#		openldap-dev \
"
11145,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# configure: error: prove not found
"
11146,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11147,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11148,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11149,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11150,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11151,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11152,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11153,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11154,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11155,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11156,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11157,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11158,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11159,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11160,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/10/alpine/Dockerfile," # backwards compat
"
11161,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
11162,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# explicitly set user/group IDs
"
11163,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
11164,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11165,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11166,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# arches officialy built by upstream
"
11167,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11168,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11169,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11170,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11171,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11172,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11173,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11174,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11175,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11176,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11177,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11178,3b022607bec233463a3d055731fb710837978747,/9.3/Dockerfile," # backwards compat
"
11179,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
11180,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/Dockerfile-alpine.template,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
11181,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/Dockerfile-alpine.template,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11182,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/Dockerfile-alpine.template,"#		krb5-dev \
"
11183,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/Dockerfile-alpine.template,"#		openldap-dev \
"
11184,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/Dockerfile-alpine.template,"# configure: error: prove not found
"
11185,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/Dockerfile-alpine.template,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11186,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11187,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/Dockerfile-alpine.template,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11188,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/Dockerfile-alpine.template,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11189,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/Dockerfile-alpine.template,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11190,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11191,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11192,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11193,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11194,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/Dockerfile-alpine.template,"#p' --recursive /usr/local \
"
11195,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11196,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
11197,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11198,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/Dockerfile-alpine.template,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11199,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/Dockerfile-alpine.template," # backwards compat
"
11200,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
11201,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
11202,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11203,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11204,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
11205,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11206,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11207,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11208,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
11209,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11210,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# see note below about ""*.pyc"" files
"
11211,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# arches officialy built by upstream
"
11212,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11213,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11214,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11215,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# we need DEBIAN_FRONTEND on postgresql-13 for slapd (""Please enter the password for the admin entry in your LDAP directory.""); see https://bugs.debian.org/929417
"
11216,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11217,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11218,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11219,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11220,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11221,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11222,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11223,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
11224,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
11225,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11226,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/Dockerfile-debian.template," # backwards compat
"
11227,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11228,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11229,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11230,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"#		krb5-dev \
"
11231,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"#		openldap-dev \
"
11232,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# configure: error: prove not found
"
11233,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11234,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11235,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11236,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11237,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11238,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11239,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11240,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11241,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11242,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11243,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11244,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11245,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11246,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11247,cad3d8b1f7ee31f3592c2911e014e81b9b2a1c8d,/10/alpine/Dockerfile," # backwards compat
"
11248,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
11249,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
11250,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
11251,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11252,4b132fa76a50598aa422f9cf5b5b52d9d4fc5802,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11253,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# vim:set ft=dockerfile:
"
11254,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# explicitly set user/group IDs
"
11255,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11256,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11257,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# grab gosu for easy step-down from root
"
11258,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11259,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11260,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11261,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11262,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
11263,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# arches officialy built by upstream
"
11264,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11265,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11266,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11267,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11268,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11269,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11270,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11271,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11272,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11273,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11274,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11275,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
11276,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11277,ef04f3055bab11b10d3d5c41a659acfacf2c850b,/10/Dockerfile," # backwards compat
"
11278,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11279,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
11280,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11281,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
11282,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
11283,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
11284,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11285,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11286,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11287,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11288,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11289,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11290,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11291,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11292,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11293,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11294,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11295,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11296,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11297,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11298,c4b019526a25d1300de77b9699d53ad187cf0dcf,/9.5/alpine/Dockerfile," # backwards compat
"
11299,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# vim:set ft=dockerfile:
"
11300,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# explicitly set user/group IDs
"
11301,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11302,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11303,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# grab gosu for easy step-down from root
"
11304,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11305,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11306,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11307,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11308,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
11309,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# arches officialy built by upstream
"
11310,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11311,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11312,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11313,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11314,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11315,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11316,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11317,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11318,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11319,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11320,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11321,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11322,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11323,88341a435106ea0c9a805ff305bf486f81f56e0c,/11/Dockerfile," # backwards compat
"
11324,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/Dockerfile.template,"# vim:set ft=dockerfile:
"
11325,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/Dockerfile.template,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
11326,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/Dockerfile.template,"# grab gosu for easy step-down from root
"
11327,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/Dockerfile.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11328,c9d9f4c1a0d33a161fefda666f041ef0dc4dc9f8,/Dockerfile.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11329,972294a377463156c8d61297320c872fc7d370a9,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
11330,972294a377463156c8d61297320c872fc7d370a9,/9.5/Dockerfile,"# explicitly set user/group IDs
"
11331,972294a377463156c8d61297320c872fc7d370a9,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
11332,972294a377463156c8d61297320c872fc7d370a9,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11333,972294a377463156c8d61297320c872fc7d370a9,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11334,972294a377463156c8d61297320c872fc7d370a9,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11335,972294a377463156c8d61297320c872fc7d370a9,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11336,972294a377463156c8d61297320c872fc7d370a9,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11337,972294a377463156c8d61297320c872fc7d370a9,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11338,972294a377463156c8d61297320c872fc7d370a9,/9.5/Dockerfile," # backwards compat
"
11339,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# vim:set ft=dockerfile:
"
11340,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# explicitly set user/group IDs
"
11341,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11342,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11343,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# grab gosu for easy step-down from root
"
11344,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11345,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11346,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11347,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11348,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
11349,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# arches officialy built by upstream
"
11350,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11351,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11352,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11353,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11354,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11355,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11356,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11357,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11358,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11359,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11360,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11361,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
11362,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11363,5992d8be755d8001474f737a44c73049c519cff3,/12/Dockerfile," # backwards compat
"
11364,904b4637237bf17657674bafe3ca42d241e3e745,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
11365,904b4637237bf17657674bafe3ca42d241e3e745,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
11366,904b4637237bf17657674bafe3ca42d241e3e745,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
11367,904b4637237bf17657674bafe3ca42d241e3e745,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11368,904b4637237bf17657674bafe3ca42d241e3e745,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11369,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11370,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11371,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11372,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"#		krb5-dev \
"
11373,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"#		openldap-dev \
"
11374,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# configure: error: prove not found
"
11375,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11376,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11377,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11378,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11379,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11380,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11381,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11382,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11383,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11384,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11385,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11386,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11387,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11388,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11389,f7f1e59c55bcce36cfbe7ab4604f439eb8721611,/10/alpine/Dockerfile," # backwards compat
"
11390,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# vim:set ft=dockerfile:
"
11391,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# explicitly set user/group IDs
"
11392,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11393,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11394,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# grab gosu for easy step-down from root
"
11395,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11396,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11397,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11398,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11399,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
11400,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# arches officialy built by upstream
"
11401,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11402,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11403,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11404,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11405,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11406,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11407,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11408,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11409,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11410,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11411,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11412,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11413,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11414,064113e0e481a1d0542846b81858e457fde02c90,/10/Dockerfile," # backwards compat
"
11415,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11416,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11417,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11418,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
11419,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
11420,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# configure: error: prove not found
"
11421,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11422,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11423,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
11424,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11425,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11426,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11427,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11428,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11429,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11430,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11431,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11432,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11433,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11434,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11435,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11436,49a7e2bf209f8344e8240ddbc3a1368c6b72129e,/9.2/alpine/Dockerfile," # backwards compat
"
11437,a7ba7f2b2de177069e185e748adaa76ff444d921,/Dockerfile-alpine.template,"# vim:set ft=dockerfile:
"
11438,a7ba7f2b2de177069e185e748adaa76ff444d921,/Dockerfile-alpine.template,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11439,a7ba7f2b2de177069e185e748adaa76ff444d921,/Dockerfile-alpine.template,"#		krb5-dev \
"
11440,a7ba7f2b2de177069e185e748adaa76ff444d921,/Dockerfile-alpine.template,"#		openldap-dev \
"
11441,a7ba7f2b2de177069e185e748adaa76ff444d921,/Dockerfile-alpine.template,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11442,a7ba7f2b2de177069e185e748adaa76ff444d921,/Dockerfile-alpine.template,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11443,a7ba7f2b2de177069e185e748adaa76ff444d921,/Dockerfile-alpine.template,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11444,a7ba7f2b2de177069e185e748adaa76ff444d921,/Dockerfile-alpine.template,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11445,a7ba7f2b2de177069e185e748adaa76ff444d921,/Dockerfile-alpine.template,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11446,a7ba7f2b2de177069e185e748adaa76ff444d921,/Dockerfile-alpine.template,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11447,a7ba7f2b2de177069e185e748adaa76ff444d921,/Dockerfile-alpine.template,"# make the sample config easier to munge (and ""correct by default"")
"
11448,a7ba7f2b2de177069e185e748adaa76ff444d921,/Dockerfile-alpine.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11449,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11450,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11451,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11452,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
11453,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
11454,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
11455,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11456,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11457,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11458,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11459,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11460,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11461,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11462,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11463,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11464,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11465,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11466,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11467,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11468,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11469,7063c608f7845a56d343e71540f92b5cdd2a543b,/9.5/alpine/Dockerfile," # backwards compat
"
11470,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
11471,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.1/Dockerfile,"# explicitly set user/group IDs
"
11472,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
11473,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11474,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11475,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11476,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
11477,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11478,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"#		krb5-dev \
"
11479,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"#		openldap-dev \
"
11480,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# configure: error: prove not found
"
11481,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11482,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11483,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11484,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new; \
"
11485,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11486,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11487,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11488,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11489,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11490,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11491,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11492,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11493,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11494,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11495,1bddd083582b0977075dda4258f2d9dfbc90482b,/10/alpine/Dockerfile," # backwards compat
"
11496,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11497,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11498,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11499,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
11500,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
11501,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
11502,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11503,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11504,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11505,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11506,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11507,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11508,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11509,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11510,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11511,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11512,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11513,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11514,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11515,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11516,34b633b01ddcb6473e543a2e3a1ff0e2978670cb,/9.4/alpine/Dockerfile," # backwards compat
"
11517,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11518,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11519,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
11520,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
11521,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11522,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11523,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11524,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11525,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11526,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11527,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11528,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11529,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11530,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11531,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11532,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
11533,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
11534,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11535,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
11536,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11537,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11538,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11539,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11540,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11541,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11542,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11543,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11544,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11545,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11546,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.2/alpine/Dockerfile," # backwards compat
"
11547,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
11548,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# explicitly set user/group IDs
"
11549,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11550,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11551,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
11552,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11553,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11554,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11555,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11556,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
11557,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# arches officialy built by upstream
"
11558,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11559,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11560,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11561,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11562,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11563,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11564,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11565,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11566,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11567,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11568,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11569,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
11570,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11571,3610f1e45365fb09c0fea29fa387b35f0efdb3a1,/9.6/Dockerfile," # backwards compat
"
11572,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11573,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11574,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
11575,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
11576,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11577,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11578,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11579,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11580,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11581,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11582,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11583,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11584,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11585,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11586,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11587,dd88d2f02ad0f9852a7b33a8b542e14f5867b0c1,/9.6/alpine/Dockerfile," # backwards compat
"
11588,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11589,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11590,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11591,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
11592,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
11593,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
11594,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11595,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11596,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11597,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11598,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11599,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11600,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11601,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11602,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11603,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11604,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11605,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11606,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11607,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11608,cb8d873277a533b2f1140a3f3624321a0c53f45d,/9.6/alpine/Dockerfile," # backwards compat
"
11609,41e7a62fb4e26b44e3d4746023ea977998c02252,/Dockerfile.template,"# vim:set ft=dockerfile:
"
11610,41e7a62fb4e26b44e3d4746023ea977998c02252,/Dockerfile.template,"# explicitly set user/group IDs
"
11611,41e7a62fb4e26b44e3d4746023ea977998c02252,/Dockerfile.template,"# grab gosu for easy step-down from root
"
11612,41e7a62fb4e26b44e3d4746023ea977998c02252,/Dockerfile.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11613,41e7a62fb4e26b44e3d4746023ea977998c02252,/Dockerfile.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11614,41e7a62fb4e26b44e3d4746023ea977998c02252,/Dockerfile.template,"# make the sample config easier to munge (and ""correct by default"")
"
11615,41e7a62fb4e26b44e3d4746023ea977998c02252,/Dockerfile.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11616,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
11617,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
11618,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11619,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11620,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
11621,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11622,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11623,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11624,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11625,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# see note below about ""*.pyc"" files
"
11626,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# arches officialy built by upstream
"
11627,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11628,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11629,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11630,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11631,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11632,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11633,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11634,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11635,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11636,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11637,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
11638,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
11639,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11640,faf08dbfd0675d144cbdef39f4506425ec7cee26,/Dockerfile-debian.template," # backwards compat
"
11641,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# vim:set ft=dockerfile:
"
11642,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# explicitly set user/group IDs
"
11643,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11644,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11645,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# grab gosu for easy step-down from root
"
11646,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11647,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11648,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11649,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11650,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
11651,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# arches officialy built by upstream
"
11652,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11653,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11654,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11655,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11656,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11657,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11658,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11659,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11660,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11661,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11662,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11663,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11664,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11665,f5a7e06b42aa14cad6edfaeefa676a5312d27618,/10/Dockerfile," # backwards compat
"
11666,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11667,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11668,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11669,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
11670,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
11671,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
11672,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11673,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11674,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11675,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11676,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11677,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11678,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11679,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11680,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11681,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11682,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11683,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11684,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11685,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11686,85aadc08c347cd20f199902c4b8b4f736341c3b8,/9.6/alpine/Dockerfile," # backwards compat
"
11687,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11688,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11689,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11690,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
11691,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
11692,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
11693,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11694,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11695,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11696,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11697,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11698,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11699,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11700,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11701,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11702,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11703,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11704,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11705,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11706,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11707,1cf0f1b313b7dc14bfd9331efc45e96b8603f7d2,/9.4/alpine/Dockerfile," # backwards compat
"
11708,6abeb8590f35c5251b9f100a667024febaeee06b,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
11709,6abeb8590f35c5251b9f100a667024febaeee06b,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11710,783906f551b9bc1472751200296f93bb2c55bc44,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
11711,783906f551b9bc1472751200296f93bb2c55bc44,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
11712,783906f551b9bc1472751200296f93bb2c55bc44,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11713,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11714,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
11715,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11716,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"#		krb5-dev \
"
11717,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"#		openldap-dev \
"
11718,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# configure: error: prove not found
"
11719,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11720,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11721,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11722,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11723,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11724,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11725,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11726,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11727,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11728,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11729,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11730,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11731,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11732,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11733,d3908b054de55e0f6bdcd2ec01a20a278022d5b1,/11/alpine/Dockerfile," # backwards compat
"
11734,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11735,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11736,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11737,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"#		krb5-dev \
"
11738,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"#		openldap-dev \
"
11739,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# configure: error: prove not found
"
11740,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11741,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11742,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11743,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11744,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11745,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11746,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11747,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11748,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11749,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11750,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11751,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11752,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11753,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11754,85aadc08c347cd20f199902c4b8b4f736341c3b8,/11/alpine/Dockerfile," # backwards compat
"
11755,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11756,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11757,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11758,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
11759,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
11760,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
11761,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11762,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11763,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11764,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11765,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11766,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11767,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11768,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11769,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11770,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11771,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11772,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11773,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11774,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11775,d48c7ca3c7b8c573a33b9f0598839aa7a06318ff,/9.5/alpine/Dockerfile," # backwards compat
"
11776,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11777,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11778,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11779,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
11780,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
11781,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
11782,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11783,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11784,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11785,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11786,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11787,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11788,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11789,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11790,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11791,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11792,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11793,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11794,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11795,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11796,06d27216309504eb0ed1415c0ef9afdaf9c24465,/9.5/alpine/Dockerfile," # backwards compat
"
11797,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
11798,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.5/Dockerfile,"# explicitly set user/group IDs
"
11799,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
11800,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11801,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11802,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11803,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11804,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11805,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"#		krb5-dev \
"
11806,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"#		openldap-dev \
"
11807,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# configure: error: prove not found
"
11808,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11809,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11810,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11811,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11812,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11813,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11814,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11815,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11816,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11817,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11818,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11819,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11820,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11821,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11822,6b2d9f0d5dde36d634d1bbcbd27a0b2ed7054f3c,/10/alpine/Dockerfile," # backwards compat
"
11823,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# vim:set ft=dockerfile:
"
11824,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# explicitly set user/group IDs
"
11825,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11826,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11827,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# grab gosu for easy step-down from root
"
11828,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11829,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11830,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11831,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
11832,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11833,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
11834,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# arches officialy built by upstream
"
11835,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11836,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11837,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11838,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11839,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11840,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11841,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11842,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11843,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11844,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11845,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11846,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
11847,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11848,72d7408ad3b57ab1a5c371e11460811551811bf5,/12/Dockerfile," # backwards compat
"
11849,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
11850,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# explicitly set user/group IDs
"
11851,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
11852,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11853,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11854,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11855,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11856,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# arches officialy built by upstream
"
11857,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11858,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11859,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11860,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11861,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11862,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11863,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11864,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11865,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11866,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11867,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11868,fe89a60c9bda1f1e1627f6732fdfd90f4d410bd6,/9.4/Dockerfile," # backwards compat
"
11869,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11870,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11871,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11872,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"#		krb5-dev \
"
11873,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"#		openldap-dev \
"
11874,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# configure: error: prove not found
"
11875,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11876,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11877,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11878,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11879,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11880,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11881,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11882,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11883,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11884,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
11885,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11886,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11887,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11888,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11889,a42e1249e16d8eb0c164104410f78f3dcebe6406,/10/Dockerfile,"# vim:set ft=dockerfile:
"
11890,a42e1249e16d8eb0c164104410f78f3dcebe6406,/10/Dockerfile,"# explicitly set user/group IDs
"
11891,a42e1249e16d8eb0c164104410f78f3dcebe6406,/10/Dockerfile,"# grab gosu for easy step-down from root
"
11892,a42e1249e16d8eb0c164104410f78f3dcebe6406,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11893,a42e1249e16d8eb0c164104410f78f3dcebe6406,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11894,a42e1249e16d8eb0c164104410f78f3dcebe6406,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11895,a42e1249e16d8eb0c164104410f78f3dcebe6406,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11896,a42e1249e16d8eb0c164104410f78f3dcebe6406,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11897,a42e1249e16d8eb0c164104410f78f3dcebe6406,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11898,a42e1249e16d8eb0c164104410f78f3dcebe6406,/10/Dockerfile," # backwards compat
"
11899,a7551affea985b86e5119ff36c9eae2f430e38ee,/Dockerfile.template,"# vim:set ft=dockerfile:
"
11900,a7551affea985b86e5119ff36c9eae2f430e38ee,/Dockerfile.template,"# explicitly set user/group IDs
"
11901,a7551affea985b86e5119ff36c9eae2f430e38ee,/Dockerfile.template,"# grab gosu for easy step-down from root
"
11902,a7551affea985b86e5119ff36c9eae2f430e38ee,/Dockerfile.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11903,a7551affea985b86e5119ff36c9eae2f430e38ee,/Dockerfile.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11904,347593c5d25935dc1480adc6079400c2faf7ae5f,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
11905,347593c5d25935dc1480adc6079400c2faf7ae5f,/9.3/Dockerfile,"# explicitly set user/group IDs
"
11906,347593c5d25935dc1480adc6079400c2faf7ae5f,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
11907,347593c5d25935dc1480adc6079400c2faf7ae5f,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11908,347593c5d25935dc1480adc6079400c2faf7ae5f,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11909,347593c5d25935dc1480adc6079400c2faf7ae5f,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11910,347593c5d25935dc1480adc6079400c2faf7ae5f,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11911,347593c5d25935dc1480adc6079400c2faf7ae5f,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
11912,347593c5d25935dc1480adc6079400c2faf7ae5f,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11913,347593c5d25935dc1480adc6079400c2faf7ae5f,/9.3/Dockerfile," # backwards compat
"
11914,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11915,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
11916,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11917,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
11918,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
11919,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# configure: error: prove not found
"
11920,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
11921,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11922,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# install OSSP uuid (http://www.ossp.org/pkg/lib/uuid/)
# see https://github.com/docker-library/postgres/pull/255 for more details
"
11923,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11924,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
11925,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
11926,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
11927,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11928,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11929,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11930,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11931,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11932,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11933,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11934,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11935,ce13cadcb81160cf57bce87b4131cffe36359fcd,/9.3/alpine/Dockerfile," # backwards compat
"
11936,2c72165e4f9dc66a61998111f69b5eba0b6b71f4,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
11937,2c72165e4f9dc66a61998111f69b5eba0b6b71f4,/9.5/Dockerfile,"# explicitly set user/group IDs
"
11938,2c72165e4f9dc66a61998111f69b5eba0b6b71f4,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
11939,2c72165e4f9dc66a61998111f69b5eba0b6b71f4,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11940,2c72165e4f9dc66a61998111f69b5eba0b6b71f4,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11941,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11942,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11943,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"#		krb5-dev \
"
11944,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"#		openldap-dev \
"
11945,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11946,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11947,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11948,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11949,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11950,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11951,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11952,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.2/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11953,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11954,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11955,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
11956,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
11957,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
11958,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
11959,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
11960,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
11961,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
11962,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
11963,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11964,bcf8da33d85f2a558ae1611cb310d27fe8359fea,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
11965,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# vim:set ft=dockerfile:
"
11966,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# explicitly set user/group IDs
"
11967,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
11968,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
11969,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
11970,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11971,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
11972,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
11973,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
11974,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
11975,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
11976,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# arches officialy built by upstream
"
11977,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
11978,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
11979,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
11980,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
11981,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
11982,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
11983,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
11984,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
11985,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
11986,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
11987,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
11988,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
11989,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
11990,88173efa530f1a174a7ea311c5b6ee5e383f68bd,/12/Dockerfile," # backwards compat
"
11991,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
11992,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.1/Dockerfile,"# explicitly set user/group IDs
"
11993,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
11994,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
11995,35a09c34b04019c3942d13d78b99eab66bc4b3ad,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
11996,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
11997,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
11998,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
11999,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
12000,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12001,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12002,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12003,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12004,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12005,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12006,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12007,a7ba7f2b2de177069e185e748adaa76ff444d921,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12008,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
12009,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# explicitly set user/group IDs
"
12010,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
12011,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12012,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12013,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
12014,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12015,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# arches officialy built by upstream
"
12016,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12017,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12018,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12019,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12020,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12021,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12022,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12023,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12024,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12025,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12026,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12027,635fd0bcb3ababc96871c9da52f10743fbae4742,/9.5/Dockerfile," # backwards compat
"
12028,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12029,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
12030,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12031,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"#		krb5-dev \
"
12032,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"#		openldap-dev \
"
12033,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# configure: error: prove not found
"
12034,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12035,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12036,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12037,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12038,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12039,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12040,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12041,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12042,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12043,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12044,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12045,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12046,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12047,b96659493b841100dc75ed777bff01913d9fe9e1,/13/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12048,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
12049,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.1/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12050,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
12051,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12052,baf80692b5ddd6a5b96876aed7d4b3046ced62ab,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12053,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
12054,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/Dockerfile,"# explicitly set user/group IDs
"
12055,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
12056,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12057,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12058,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12059,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12060,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12061,3706d4c4562c284ed070286b9fd516151167a40c,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12062,7c8e945a80097e80fa1c8d69d2a027145177b701,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12063,7c8e945a80097e80fa1c8d69d2a027145177b701,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12064,783906f551b9bc1472751200296f93bb2c55bc44,/9.0/Dockerfile,"# vim:set ft=dockerfile:
"
12065,783906f551b9bc1472751200296f93bb2c55bc44,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12066,783906f551b9bc1472751200296f93bb2c55bc44,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12067,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12068,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12069,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12070,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
12071,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
12072,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
12073,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12074,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12075,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12076,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12077,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12078,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12079,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12080,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12081,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12082,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12083,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12084,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12085,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12086,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12087,1089a8971b43a675109ad886bf1f3b327c067fa1,/9.6/alpine/Dockerfile," # backwards compat
"
12088,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12089,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12090,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12091,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
12092,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
12093,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
12094,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12095,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12096,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12097,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12098,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12099,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12100,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12101,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12102,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12103,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12104,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12105,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12106,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12107,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12108,cfac232e3cccb8f3b499b7a286ccdf6eafbde808,/9.6/alpine/Dockerfile," # backwards compat
"
12109,2bfa44dab27b6be46333ac7bf86f2517c1479090,/9.3/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12110,2bfa44dab27b6be46333ac7bf86f2517c1479090,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12111,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# vim:set ft=dockerfile:
"
12112,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# explicitly set user/group IDs
"
12113,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# grab gosu for easy step-down from root
"
12114,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12115,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12116,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# arches officialy built by upstream
"
12117,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12118,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12119,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12120,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12121,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12122,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12123,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12124,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12125,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12126,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12127,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12128,3d0487a6caf77a2f0a66262158ff2719d1c22c94,/10/Dockerfile," # backwards compat
"
12129,8904bffa5e197cd016e0d6349d1db8b480fa28a9,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
12130,8904bffa5e197cd016e0d6349d1db8b480fa28a9,/9.5/Dockerfile,"# explicitly set user/group IDs
"
12131,8904bffa5e197cd016e0d6349d1db8b480fa28a9,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
12132,8904bffa5e197cd016e0d6349d1db8b480fa28a9,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12133,8904bffa5e197cd016e0d6349d1db8b480fa28a9,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12134,8904bffa5e197cd016e0d6349d1db8b480fa28a9,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12135,8904bffa5e197cd016e0d6349d1db8b480fa28a9,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12136,8904bffa5e197cd016e0d6349d1db8b480fa28a9,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12137,8904bffa5e197cd016e0d6349d1db8b480fa28a9,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12138,8904bffa5e197cd016e0d6349d1db8b480fa28a9,/9.5/Dockerfile," # backwards compat
"
12139,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12140,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12141,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12142,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
12143,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
12144,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
12145,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12146,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12147,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12148,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12149,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12150,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12151,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12152,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12153,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12154,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12155,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12156,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12157,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12158,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12159,c66fc738ed2eb957881a855eda7f921f785ec7a3,/9.5/alpine/Dockerfile," # backwards compat
"
12160,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12161,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12162,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12163,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"#		krb5-dev \
"
12164,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"#		openldap-dev \
"
12165,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# configure: error: prove not found
"
12166,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12167,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12168,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12169,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12170,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12171,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12172,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12173,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12174,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12175,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12176,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12177,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12178,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12179,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12180,c8bf23b75fa75a99eef9f5ff794c557057e5d8c5,/11/alpine/Dockerfile," # backwards compat
"
12181,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12182,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12183,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12184,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
12185,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
12186,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12187,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12188,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12189,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12190,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12191,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12192,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12193,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12194,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12195,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12196,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12197,bc44222ff8a2cc66d2060129ecdf228bdb9e0ee8,/9.5/alpine/Dockerfile," # backwards compat
"
12198,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12199,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12200,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
12201,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
12202,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12203,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12204,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12205,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12206,a9c1b15a7adf7cb2bc42fac776656aff7dd7994e,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12207,63d966973d9593c0d9890b96f10ac73566913520,/Dockerfile.template,"# vim:set ft=dockerfile:
"
12208,63d966973d9593c0d9890b96f10ac73566913520,/Dockerfile.template,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12209,63d966973d9593c0d9890b96f10ac73566913520,/Dockerfile.template,"# grab gosu for easy step-down from root
"
12210,63d966973d9593c0d9890b96f10ac73566913520,/Dockerfile.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12211,63d966973d9593c0d9890b96f10ac73566913520,/Dockerfile.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12212,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12213,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12214,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12215,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"#		krb5-dev \
"
12216,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"#		openldap-dev \
"
12217,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# configure: error: prove not found
"
12218,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12219,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12220,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12221,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12222,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12223,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12224,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12225,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12226,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12227,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12228,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12229,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12230,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12231,d188180c630836a2ef5bc22f9d5ba4a250e838dd,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12232,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
12233,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# explicitly set user/group IDs
"
12234,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
12235,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12236,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12237,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# arches officialy built by upstream
"
12238,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12239,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12240,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12241,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12242,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12243,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12244,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12245,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12246,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12247,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12248,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12249,f7dc5727b1d6b6a636350e11648845ae33477579,/9.4/Dockerfile," # backwards compat
"
12250,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# vim:set ft=dockerfile:
"
12251,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# explicitly set user/group IDs
"
12252,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
12253,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
12254,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# grab gosu for easy step-down from root
"
12255,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12256,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12257,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
12258,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12259,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# see note below about ""*.pyc"" files
"
12260,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# arches officialy built by upstream
"
12261,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12262,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
12263,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12264,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12265,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12266,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12267,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12268,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12269,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12270,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
12271,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12272,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
12273,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12274,d21499fa3f55639c6751423e55ff630516bf34e3,/10/Dockerfile," # backwards compat
"
12275,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# vim:set ft=dockerfile:
"
12276,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# explicitly set user/group IDs
"
12277,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
12278,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
12279,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# grab gosu for easy step-down from root
"
12280,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12281,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12282,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
12283,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
12284,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12285,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
12286,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# arches officialy built by upstream
"
12287,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12288,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
12289,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12290,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12291,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12292,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12293,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12294,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12295,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12296,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
12297,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12298,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
12299,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12300,137fccea0cda789cdc32945c0dcc3177ba951a36,/12/Dockerfile," # backwards compat
"
12301,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12302,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12303,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
12304,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
12305,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12306,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12307,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12308,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12309,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12310,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12311,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12312,106e9e56fea3ad34a8bf3e66d3a041d491788552,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12313,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
12314,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# explicitly set user/group IDs
"
12315,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
12316,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
12317,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
12318,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12319,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12320,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
12321,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12322,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
12323,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# arches officialy built by upstream
"
12324,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12325,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
12326,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12327,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12328,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12329,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12330,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12331,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12332,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12333,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
12334,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12335,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
12336,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12337,faf08dbfd0675d144cbdef39f4506425ec7cee26,/9.5/Dockerfile," # backwards compat
"
12338,e2971da001b64a54b4a971ecc83ad9a86ad25387,/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12339,e2971da001b64a54b4a971ecc83ad9a86ad25387,/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12340,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
12341,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# explicitly set user/group IDs
"
12342,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
12343,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12344,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12345,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12346,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# arches officialy built by upstream
"
12347,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12348,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12349,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12350,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12351,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12352,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12353,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12354,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12355,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12356,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12357,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12358,e348a2fe235d28692344de64c05640c38361554d,/9.4/Dockerfile," # backwards compat
"
12359,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
12360,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.4/Dockerfile,"# explicitly set user/group IDs
"
12361,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
12362,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12363,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12364,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12365,8e867c8ba0fc8fd347e43ae53ddeba8e67242a53,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12366,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
12367,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.5/Dockerfile,"# explicitly set user/group IDs
"
12368,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
12369,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12370,a7551affea985b86e5119ff36c9eae2f430e38ee,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12371,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
12372,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# explicitly set user/group IDs
"
12373,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
12374,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
12375,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
12376,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12377,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12378,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
12379,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12380,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# see note below about ""*.pyc"" files
"
12381,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# arches officialy built by upstream
"
12382,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12383,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
12384,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12385,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12386,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12387,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12388,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12389,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12390,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12391,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
12392,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12393,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
12394,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12395,a9610d18de51c189c9d4b0197c408e2e3bfb7917,/9.6/Dockerfile," # backwards compat
"
12396,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/Dockerfile,"# vim:set ft=dockerfile:
"
12397,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/Dockerfile,"# explicitly set user/group IDs
"
12398,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/Dockerfile,"# grab gosu for easy step-down from root
"
12399,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12400,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12401,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12402,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12403,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12404,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12405,d8abce4e82533aa2673da9ba9a5a8385589ed693,/10/Dockerfile," # backwards compat
"
12406,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
12407,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# explicitly set user/group IDs
"
12408,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
12409,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
12410,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
12411,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12412,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12413,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
12414,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12415,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# see note below about ""*.pyc"" files
"
12416,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# arches officialy built by upstream
"
12417,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12418,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
12419,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12420,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12421,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12422,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12423,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12424,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12425,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12426,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
12427,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12428,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12429,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12430,d61fd19b699b2c380da08c3a95f7272137a182bb,/9.3/Dockerfile," # backwards compat
"
12431,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12432,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12433,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12434,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
12435,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
12436,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
12437,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12438,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12439,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12440,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12441,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12442,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12443,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12444,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12445,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12446,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12447,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12448,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12449,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12450,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12451,1cbd3a1666e6294cc28fa41c24983494dfcfc680,/9.4/alpine/Dockerfile," # backwards compat
"
12452,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# vim:set ft=dockerfile:
"
12453,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# explicitly set user/group IDs
"
12454,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# grab gosu for easy step-down from root
"
12455,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12456,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12457,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
12458,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12459,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# arches officialy built by upstream
"
12460,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12461,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12462,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12463,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12464,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12465,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12466,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12467,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12468,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12469,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12470,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12471,740fb98439e66c7a0e39a67880ee971c6d49e514,/10/Dockerfile," # backwards compat
"
12472,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12473,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
12474,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12475,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"#		krb5-dev \
"
12476,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"#		openldap-dev \
"
12477,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# configure: error: prove not found
"
12478,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12479,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12480,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12481,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12482,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12483,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12484,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12485,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12486,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12487,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12488,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12489,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12490,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12491,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/13/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12492,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
12493,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/Dockerfile,"# explicitly set user/group IDs
"
12494,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
12495,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12496,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12497,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12498,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12499,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12500,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12501,fc676766b4c4b1a7afb857342b9adef78b09f28b,/9.2/Dockerfile," # backwards compat
"
12502,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12503,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12504,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12505,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
12506,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
12507,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
12508,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12509,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12510,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12511,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12512,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12513,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12514,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12515,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12516,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12517,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12518,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12519,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12520,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12521,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12522,34689e2a5ba1841fb09fd5a9c29ef47a022d48dc,/9.5/alpine/Dockerfile," # backwards compat
"
12523,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12524,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12525,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"#		krb5-dev \
"
12526,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"#		openldap-dev \
"
12527,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12528,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12529,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12530,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12531,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12532,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12533,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12534,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12535,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12536,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.3/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12537,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
12538,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/Dockerfile,"# explicitly set user/group IDs
"
12539,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
12540,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12541,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12542,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12543,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12544,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12545,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12546,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.3/Dockerfile," # backwards compat
"
12547,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12548,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.12-stable
"
12549,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12550,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
12551,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
12552,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
12553,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12554,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12555,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12556,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12557,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12558,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12559,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12560,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12561,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12562,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12563,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12564,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12565,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12566,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12567,1d140375b6830c65cfeaac3642c7fda6d3e1b29a,/9.5/alpine/Dockerfile," # backwards compat
"
12568,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12569,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12570,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12571,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
12572,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
12573,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
12574,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12575,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12576,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12577,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12578,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12579,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12580,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12581,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12582,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12583,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12584,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12585,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12586,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12587,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12588,f7dc5727b1d6b6a636350e11648845ae33477579,/9.6/alpine/Dockerfile," # backwards compat
"
12589,ef1e190d84d5ef8c763cb96aeec3356916444efc,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
12590,ef1e190d84d5ef8c763cb96aeec3356916444efc,/9.3/Dockerfile,"# explicitly set user/group IDs
"
12591,ef1e190d84d5ef8c763cb96aeec3356916444efc,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
12592,ef1e190d84d5ef8c763cb96aeec3356916444efc,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12593,ef1e190d84d5ef8c763cb96aeec3356916444efc,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12594,ef1e190d84d5ef8c763cb96aeec3356916444efc,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12595,ef1e190d84d5ef8c763cb96aeec3356916444efc,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12596,ef1e190d84d5ef8c763cb96aeec3356916444efc,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12597,ef1e190d84d5ef8c763cb96aeec3356916444efc,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12598,ef1e190d84d5ef8c763cb96aeec3356916444efc,/9.3/Dockerfile," # backwards compat
"
12599,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12600,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12601,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
12602,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
12603,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12604,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12605,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12606,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12607,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12608,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"# tzdata adds around 1Mb to image size, but it is suggested by Django documentation that timezone should be set for performance reasons: http://bit.ly/2fMYhh1
"
12609,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12610,b031aa800308c595624b8d2e43707dbb2861d2f1,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12611,fc014b79c32b82e042f281b03b0eeeb6c4fab4a5,/Dockerfile.template,"# vim:set ft=dockerfile:
"
12612,fc014b79c32b82e042f281b03b0eeeb6c4fab4a5,/Dockerfile.template,"# explicitly set user/group IDs
"
12613,fc014b79c32b82e042f281b03b0eeeb6c4fab4a5,/Dockerfile.template,"# grab gosu for easy step-down from root
"
12614,fc014b79c32b82e042f281b03b0eeeb6c4fab4a5,/Dockerfile.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12615,fc014b79c32b82e042f281b03b0eeeb6c4fab4a5,/Dockerfile.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12616,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
12617,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# explicitly set user/group IDs
"
12618,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
12619,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12620,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12621,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12622,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# arches officialy built by upstream
"
12623,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12624,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12625,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12626,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12627,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12628,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12629,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12630,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12631,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12632,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12633,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12634,c4cb816b3deccc29393b8278d1a5f144d2be26f1,/9.6/Dockerfile," # backwards compat
"
12635,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
12636,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.3/Dockerfile,"# explicitly set user/group IDs
"
12637,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
12638,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12639,8f8c0bbc5236e0deedd35595c504e5fd380b1233,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12640,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
12641,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12642,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
12643,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12644,80ebeda0a68be6a8b10ce0de1846a49228af0795,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12645,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.1/Dockerfile,"# vim:set ft=dockerfile:
"
12646,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.1/Dockerfile,"# explicitly set user/group IDs
"
12647,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.1/Dockerfile,"# grab gosu for easy step-down from root
"
12648,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.1/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12649,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.1/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12650,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.1/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12651,04b1d366d51a942b88fff6c62943f92c7c38d9b6,/9.1/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12652,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
12653,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.2/Dockerfile,"# explicitly set user/group IDs
"
12654,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
12655,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12656,443c7947d548b1c607e06f7a75ca475de7ff3284,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12657,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
12658,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12659,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
12660,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12661,73d73760957c7038dd3c07212b5b9daf86a2cb38,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12662,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12663,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
12664,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12665,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"#		krb5-dev \
"
12666,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"#		openldap-dev \
"
12667,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# configure: error: prove not found
"
12668,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12669,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12670,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12671,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12672,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12673,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12674,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12675,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12676,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12677,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12678,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12679,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12680,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12681,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12682,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/11/alpine/Dockerfile," # backwards compat
"
12683,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
12684,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.6/Dockerfile,"# explicitly set user/group IDs
"
12685,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
12686,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12687,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12688,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12689,fc36c25f8ac352f1fea6d0e7cf8d9bd92a4e720f,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12690,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12691,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12692,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
12693,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
12694,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12695,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12696,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12697,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12698,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12699,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"# tzdata loading functionality is optional, and fails gracefully
#		tzdata \
"
12700,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12701,797fadcad2239919ea98aa7a3d14d32b4e8fc525,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12702,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# vim:set ft=dockerfile:
"
12703,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# explicitly set user/group IDs
"
12704,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
12705,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
12706,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# grab gosu for easy step-down from root
"
12707,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12708,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12709,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
12710,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12711,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# see note below about ""*.pyc"" files
"
12712,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# arches officialy built by upstream
"
12713,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12714,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
12715,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12716,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12717,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12718,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12719,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12720,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12721,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12722,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
12723,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12724,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12725,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12726,64bec4b1617291e3646e4e7dbbae1174404c3fd9,/9.3/Dockerfile," # backwards compat
"
12727,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12728,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12729,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12730,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
12731,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
12732,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
12733,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12734,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12735,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12736,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12737,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12738,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12739,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12740,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12741,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12742,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12743,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12744,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12745,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12746,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12747,65ed6d7deebc81377154f1c841b1b156c63dfb19,/9.6/alpine/Dockerfile," # backwards compat
"
12748,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12749,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
12750,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12751,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
12752,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
12753,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
12754,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12755,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12756,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12757,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12758,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12759,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12760,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12761,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12762,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12763,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12764,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12765,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12766,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12767,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12768,f0edc5c30ec992e4ef3ffae125adae0bb9cd2582,/9.6/alpine/Dockerfile," # backwards compat
"
12769,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
12770,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# explicitly set user/group IDs
"
12771,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
12772,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12773,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12774,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# arches officialy built by upstream
"
12775,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12776,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12777,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12778,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12779,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12780,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12781,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12782,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12783,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12784,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12785,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12786,2100e76efe6b41e001ac13d248e7af206cc022ae,/9.5/Dockerfile," # backwards compat
"
12787,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12788,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
12789,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12790,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"#		krb5-dev \
"
12791,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"#		openldap-dev \
"
12792,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# configure: error: prove not found
"
12793,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12794,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12795,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12796,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12797,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12798,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12799,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12800,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12801,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12802,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12803,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12804,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12805,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12806,f582075c1ccf252793f6f47f7b60bdd7fbf2cdb0,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12807,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12808,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12809,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12810,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"#		krb5-dev \
"
12811,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"#		openldap-dev \
"
12812,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# configure: error: prove not found
"
12813,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12814,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12815,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12816,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12817,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12818,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12819,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12820,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12821,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12822,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12823,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12824,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12825,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12826,d6e8fe3240b3d2c5d1a03f005360710812714163,/12/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12827,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# vim:set ft=dockerfile:
"
12828,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# explicitly set user/group IDs
"
12829,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
12830,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
12831,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# grab gosu for easy step-down from root
"
12832,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12833,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
12834,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
12835,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12836,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# see note below about ""*.pyc"" files
"
12837,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# arches officialy built by upstream
"
12838,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
12839,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
12840,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
12841,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
12842,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
12843,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
12844,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
12845,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
12846,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
12847,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
12848,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12849,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
12850,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12851,90ba599a267562442a1b3e2e058c620ede70624b,/12/Dockerfile," # backwards compat
"
12852,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12853,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12854,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12855,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"#		krb5-dev \
"
12856,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"#		openldap-dev \
"
12857,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# configure: error: prove not found
"
12858,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12859,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12860,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12861,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12862,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12863,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12864,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12865,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12866,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12867,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12868,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12869,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12870,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12871,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12872,5992d8be755d8001474f737a44c73049c519cff3,/10/alpine/Dockerfile," # backwards compat
"
12873,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12874,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12875,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12876,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
12877,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
12878,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12879,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12880,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12881,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12882,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12883,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12884,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12885,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12886,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12887,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12888,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12889,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12890,54053ad27ac099abff3d4964bf7460fb9c541d5d,/9.5/alpine/Dockerfile," # backwards compat
"
12891,548a270a6c16913a82d77503aba5814601ed4f58,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
12892,548a270a6c16913a82d77503aba5814601ed4f58,/9.4/Dockerfile,"# explicitly set user/group IDs
"
12893,548a270a6c16913a82d77503aba5814601ed4f58,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
12894,548a270a6c16913a82d77503aba5814601ed4f58,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12895,548a270a6c16913a82d77503aba5814601ed4f58,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12896,548a270a6c16913a82d77503aba5814601ed4f58,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12897,548a270a6c16913a82d77503aba5814601ed4f58,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12898,548a270a6c16913a82d77503aba5814601ed4f58,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12899,548a270a6c16913a82d77503aba5814601ed4f58,/9.4/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12900,548a270a6c16913a82d77503aba5814601ed4f58,/9.4/Dockerfile," # backwards compat
"
12901,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
12902,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12903,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
12904,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12905,cb70a79c1a8248d7e0db89d79dfbd08dd481be7f,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12906,63d966973d9593c0d9890b96f10ac73566913520,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
12907,63d966973d9593c0d9890b96f10ac73566913520,/9.5/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12908,63d966973d9593c0d9890b96f10ac73566913520,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
12909,63d966973d9593c0d9890b96f10ac73566913520,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12910,63d966973d9593c0d9890b96f10ac73566913520,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12911,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12912,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# 70 is the standard uid/gid for ""postgres"" in Alpine
# https://git.alpinelinux.org/aports/tree/main/postgresql/postgresql.pre-install?h=3.11-stable
"
12913,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12914,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
12915,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
12916,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
12917,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12918,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12919,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12920,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12921,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12922,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12923,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12924,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12925,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12926,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12927,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12928,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12929,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12930,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12931,ada31ea8dc1dd01a613eebd8f0d12ad1fc2f1757,/9.6/alpine/Dockerfile," # backwards compat
"
12932,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12933,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12934,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12935,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"#		krb5-dev \
"
12936,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"#		openldap-dev \
"
12937,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# configure: error: prove not found
"
12938,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12939,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12940,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12941,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12942,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12943,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12944,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12945,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12946,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12947,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12948,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12949,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12950,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12951,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12952,e5f137ce4eb3c2fd1190b7ff2db842ebafaa3a6d,/10/alpine/Dockerfile," # backwards compat
"
12953,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
12954,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/Dockerfile,"# explicitly set user/group IDs
"
12955,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
12956,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
12957,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
12958,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12959,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12960,b68154ed7975480d26e65344dcda09cce0ac1ac9,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
12961,415b445c37de1d70cf6a669bd48b915952561f7d,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12962,415b445c37de1d70cf6a669bd48b915952561f7d,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12963,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12964,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12965,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12966,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
12967,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
12968,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# configure: error: prove not found
"
12969,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
12970,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12971,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12972,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12973,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12974,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12975,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12976,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12977,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12978,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"#p' --recursive /usr/local \
"
12979,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
12980,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
12981,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
12982,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
12983,138e95956f10be942c43b6beb889716a1640fc62,/9.4/alpine/Dockerfile," # backwards compat
"
12984,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/9.0/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
12985,dc0a59178fc9e87ebfa3c0a2ba8c2634ce35bf7b,/9.0/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
12986,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
12987,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
12988,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
12989,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
12990,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
12991,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
12992,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
12993,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
12994,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
12995,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
12996,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
12997,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
12998,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
12999,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13000,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13001,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13002,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13003,2b0f642834a9ab4bad3155ff4a2a0e3ee457b75b,/9.6/alpine/Dockerfile," # backwards compat
"
13004,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# vim:set ft=dockerfile:
"
13005,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# explicitly set user/group IDs
"
13006,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
13007,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
13008,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# grab gosu for easy step-down from root
# https://github.com/tianon/gosu/releases
"
13009,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13010,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
13011,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
13012,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
13013,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13014,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# see note below about ""*.pyc"" files
"
13015,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# arches officialy built by upstream
"
13016,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13017,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
13018,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13019,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# we need DEBIAN_FRONTEND on postgresql-13 for slapd (""Please enter the password for the admin entry in your LDAP directory.""); see https://bugs.debian.org/929417
"
13020,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13021,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13022,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13023,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13024,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13025,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13026,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
13027,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13028,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
13029,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13030,682ff83c5c83f1b6f2b02caf7aa3e17a491b403a,/13/Dockerfile," # backwards compat
"
13031,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13032,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
13033,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13034,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
13035,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
13036,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
13037,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
13038,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13039,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13040,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13041,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13042,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13043,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13044,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13045,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13046,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
13047,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13048,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13049,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13050,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13051,165ffaab649aea0797ad61739cb5c9ac69466929,/9.6/alpine/Dockerfile," # backwards compat
"
13052,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
13053,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# explicitly set user/group IDs
"
13054,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
13055,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
13056,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
13057,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13058,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
13059,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
13060,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
13061,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13062,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
13063,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# arches officialy built by upstream
"
13064,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13065,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
13066,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13067,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13068,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13069,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13070,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13071,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13072,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13073,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
13074,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13075,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
13076,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13077,4f70bf2b811bcdb4ab1a015ef703373226452157,/9.5/Dockerfile," # backwards compat
"
13078,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# vim:set ft=dockerfile:
"
13079,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# explicitly set user/group IDs
"
13080,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
13081,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
13082,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# grab gosu for easy step-down from root
"
13083,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13084,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
13085,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
13086,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
13087,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13088,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# see note below about ""*.pyc"" files
"
13089,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# arches officialy built by upstream
"
13090,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13091,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
13092,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13093,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13094,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13095,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13096,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13097,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13098,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13099,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
13100,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13101,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
13102,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13103,17c71aef1940ef0d2cc8bdc8bf7fb0a2856c8326,/11/Dockerfile," # backwards compat
"
13104,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
13105,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.5/Dockerfile,"# explicitly set user/group IDs
"
13106,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
13107,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13108,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13109,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13110,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13111,ea6f466b258ad42a87a753a10dc84272d56ab699,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13112,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13113,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
# /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
# /etc/group:34:postgres:x:70:

# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13114,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"#		krb5-dev \
"
13115,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"#		openldap-dev \
"
13116,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13117,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13118,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13119,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13120,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13121,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13122,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13123,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13124,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13125,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13126,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13127,439c4976afbc9cb8c1fbc9c9783c84f62856a3c4,/9.4/alpine/Dockerfile," # backwards compat
"
13128,b1831ce069d10b14be05b9ddf6823e3d18c62cee,/9.6/Dockerfile,"# vim:set ft=dockerfile:
"
13129,b1831ce069d10b14be05b9ddf6823e3d18c62cee,/9.6/Dockerfile,"# explicitly set user/group IDs
"
13130,b1831ce069d10b14be05b9ddf6823e3d18c62cee,/9.6/Dockerfile,"# grab gosu for easy step-down from root
"
13131,b1831ce069d10b14be05b9ddf6823e3d18c62cee,/9.6/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13132,b1831ce069d10b14be05b9ddf6823e3d18c62cee,/9.6/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13133,b1831ce069d10b14be05b9ddf6823e3d18c62cee,/9.6/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13134,b1831ce069d10b14be05b9ddf6823e3d18c62cee,/9.6/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13135,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.2/Dockerfile,"# vim:set ft=dockerfile:
"
13136,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.2/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
13137,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.2/Dockerfile,"# grab gosu for easy step-down from root
"
13138,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.2/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13139,b9ea5d40cbedf35606ac638950a824f3e97aae5b,/9.2/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13140,56b1a0c47ae8361eca133e41c6ddd68ad492ac2d,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
13141,56b1a0c47ae8361eca133e41c6ddd68ad492ac2d,/9.4/Dockerfile,"# explicitly set user/group IDs
"
13142,56b1a0c47ae8361eca133e41c6ddd68ad492ac2d,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
13143,56b1a0c47ae8361eca133e41c6ddd68ad492ac2d,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13144,56b1a0c47ae8361eca133e41c6ddd68ad492ac2d,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13145,56b1a0c47ae8361eca133e41c6ddd68ad492ac2d,/9.4/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13146,56b1a0c47ae8361eca133e41c6ddd68ad492ac2d,/9.4/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13147,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13148,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
13149,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13150,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"#		krb5-dev \
"
13151,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"#		openldap-dev \
"
13152,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# configure: error: prove not found
"
13153,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
13154,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13155,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13156,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13157,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13158,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13159,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13160,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13161,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13162,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"#p' --recursive /usr/local \
"
13163,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13164,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13165,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13166,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13167,3d152d1a0d08cf52a1392b58243ff3c423588ccc,/9.6/alpine/Dockerfile," # backwards compat
"
13168,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
13169,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# explicitly set user/group IDs
"
13170,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
13171,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13172,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13173,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# arches officialy built by upstream
"
13174,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13175,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13176,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13177,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13178,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13179,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13180,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13181,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13182,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13183,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13184,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13185,cd3f3b1c483e17a0c174d2bfa80d61a5b0f72d2e,/9.5/Dockerfile," # backwards compat
"
13186,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# vim:set ft=dockerfile:
"
13187,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# alpine includes ""postgres"" user/group in base install
#   /etc/passwd:22:postgres:x:70:70::/var/lib/postgresql:/bin/sh
#   /etc/group:34:postgres:x:70:
# the home directory for the postgres user, however, is not created by default
# see https://github.com/docker-library/postgres/issues/274
"
13188,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# su-exec (gosu-compatible) is installed further down

# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
# alpine doesn't require explicit locale-file generation
"
13189,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"#		krb5-dev \
"
13190,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"#		openldap-dev \
"
13191,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# configure: error: prove not found
"
13192,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# configure: error: Perl module IPC::Run is required to run TAP tests
"
13193,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"#		perl-dev \
#		python-dev \
#		python3-dev \
#		tcl-dev \
"
13194,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# update ""DEFAULT_PGSOCKET_DIR"" to ""/var/run/postgresql"" (matching Debian)
# see https://anonscm.debian.org/git/pkg-postgresql/postgresql.git/tree/debian/patches/51-default-sockets-in-var.patch?id=8b539fcb3e093a521c095e70bdfa76887217b89f
"
13195,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"#define"" && $2 == ""DEFAULT_PGSOCKET_DIR"" && $3 == ""\""/tmp\"""" { $3 = ""\""/var/run/postgresql\""""; print; next } { print }' src/include/pg_config_manual.h > src/include/pg_config_manual.h.new \
"
13196,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# explicitly update autoconf config.guess and config.sub so they support more arches/libcs
"
13197,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# configure options taken from:
# https://anonscm.debian.org/cgit/pkg-postgresql/postgresql.git/tree/debian/rules?h=9.5
"
13198,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# ""/usr/src/postgresql/src/backend/access/common/tupconvert.c:105: undefined reference to `libintl_gettext'""
#		--enable-nls \
"
13199,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# skip debugging info -- we want tiny size instead
#		--enable-debug \
"
13200,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# these make our image abnormally large (at least 100MB larger), which seems uncouth for an ""Alpine"" (ie, ""small"") variant :)
#		--with-krb5 \
#		--with-gssapi \
#		--with-ldap \
#		--with-tcl \
#		--with-perl \
#		--with-python \
#		--with-pam \
"
13201,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"#p' --recursive /usr/local \
"
13202,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# tzdata is optional, but only adds around 1Mb to image size and is recommended by Django documentation:
# https://docs.djangoproject.com/en/1.10/ref/databases/#optimizing-postgresql-s-configuration
"
13203,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13204,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/local/share/postgresql/postgresql.conf.sample

"
13205,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13206,f8e61ad42f6b1704700769c511fe1bb4e75fba1e,/9.5/alpine/Dockerfile," # backwards compat
"
13207,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
13208,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/Dockerfile,"# explicitly set user/group IDs
"
13209,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
13210,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13211,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13212,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13213,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13214,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13215,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/Dockerfile," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13216,d8abce4e82533aa2673da9ba9a5a8385589ed693,/9.5/Dockerfile," # backwards compat
"
13217,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
13218,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
13219,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
13220,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
13221,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
13222,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13223,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
13224,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
13225,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13226,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template,"# arches officialy built by upstream
"
13227,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13228,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13229,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13230,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13231,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13232,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13233,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13234,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13235,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
13236,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample

"
13237,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template," # this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13238,726128b358cdc0efc1753475bbe502b07cbbb540,/Dockerfile-debian.template," # backwards compat
"
13239,a6d4922823aa8011513bb9c160c26c689301823a,/9.4/Dockerfile,"# vim:set ft=dockerfile:
"
13240,a6d4922823aa8011513bb9c160c26c689301823a,/9.4/Dockerfile,"# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added
"
13241,a6d4922823aa8011513bb9c160c26c689301823a,/9.4/Dockerfile,"# grab gosu for easy step-down from root
"
13242,a6d4922823aa8011513bb9c160c26c689301823a,/9.4/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13243,a6d4922823aa8011513bb9c160c26c689301823a,/9.4/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf \
"
13244,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# vim:set ft=dockerfile:
"
13245,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# explicitly set user/group IDs
"
13246,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
13247,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
13248,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# grab gosu for easy step-down from root
"
13249,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13250,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
13251,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
13252,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13253,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# see note below about ""*.pyc"" files
"
13254,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# arches officialy built by upstream
"
13255,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13256,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
13257,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13258,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13259,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13260,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13261,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13262,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13263,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13264,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
13265,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# make the sample config easier to munge (and ""correct by default"")
"
13266,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
13267,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13268,04626521017c8f1daa3839e3e5d36a606ec98f80,/9.5/Dockerfile," # backwards compat
"
13269,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# vim:set ft=dockerfile:
"
13270,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# explicitly set user/group IDs
"
13271,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# https://salsa.debian.org/postgresql/postgresql-common/blob/997d842ee744687d99a2b2d95c1083a2615c79e8/debian/postgresql-common.postinst#L32-35
"
13272,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# also create the postgres user's home directory with appropriate permissions
# see https://github.com/docker-library/postgres/issues/274
"
13273,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# grab gosu for easy step-down from root
"
13274,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# make the ""en_US.UTF-8"" locale so postgres will be utf-8 enabled by default
"
13275,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# if this file exists, we're likely in ""debian:xxx-slim"", and locales are thus being excluded so we need to remove that exclusion (since we need locales)
"
13276,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# install ""nss_wrapper"" in case we need to fake ""/etc/passwd"" and ""/etc/group"" (especially for OpenShift)
# https://github.com/docker-library/postgres/issues/359
# https://cwrap.org/nss_wrapper.html
"
13277,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# install ""xz-utils"" for .sql.xz docker-entrypoint-initdb.d files
"
13278,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# pub   4096R/ACCC4CF8 2011-10-13 [expires: 2019-07-02]
#       Key fingerprint = B97B 0AFC AA1A 47F0 44F2  44A0 7FCC 7D46 ACCC 4CF8
# uid                  PostgreSQL Debian Repository
"
13279,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# see note below about ""*.pyc"" files
"
13280,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# arches officialy built by upstream
"
13281,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# we're on an architecture upstream doesn't officially build for
# let's build binaries from their published source packages
"
13282,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# https://github.com/docker-library/postgres/issues/484 (clang-6.0 required, only available in stretch-backports)
# TODO remove this once we hit buster+
"
13283,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# build .deb files from upstream's source packages (which are verified by apt-get)
"
13284,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# we don't remove APT lists here because they get re-downloaded and removed later
"
13285,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# reset apt-mark's ""manual"" list so that ""purge --auto-remove"" will remove all build dependencies
# (which is done after we install the built packages so we don't have to redownload any overlapping dependencies)
"
13286,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# create a temporary local APT repo to install from (so that dependency resolution can be handled by APT, as it should be)
"
13287,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# work around the following APT issue by using ""Acquire::GzipIndexes=false"" (overriding ""/etc/apt/apt.conf.d/docker-gzip-indexes"")
#   Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
#   ...
#   E: Failed to fetch store:/var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages  Could not open file /var/lib/apt/lists/partial/_tmp_tmp.ODWljpQfkE_._Packages - open (13: Permission denied)
"
13288,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"#(create_main_cluster) .*$/\1 = false/' /etc/postgresql-common/createcluster.conf; \
"
13289,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# if we have leftovers from building, let's purge them (including extra, unnecessary build deps)
"
13290,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# some of the steps above generate a lot of ""*.pyc"" files (and setting ""PYTHONDONTWRITEBYTECODE"" beforehand doesn't propagate properly for some reason), so we clean them up manually (as long as they aren't owned by a package)
"
13291,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# make the sample config easier to munge (and ""correct by default"")
"
13292,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"#?(listen_addresses)\s*=\s*\S+.*!\1 = '*'!"" /usr/share/postgresql/postgresql.conf.sample; \
"
13293,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template,"# this 777 will be replaced by 700 at runtime (allows semi-arbitrary ""--user"" values)
"
13294,72d7408ad3b57ab1a5c371e11460811551811bf5,/Dockerfile-debian.template," # backwards compat
"
